<!doctype html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Bell's Inequalities: A quantum computing experiment with Qiskit - Cdani's Blog</title><meta name=Description content="Cdani's Blog"><meta property="og:url" content="https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/"><meta property="og:site_name" content="Cdani's Blog"><meta property="og:title" content="Bell's Inequalities: A quantum computing experiment with Qiskit"><meta property="og:description" content="1. Introduction 1.1. Intro to the intro I‚Äôm not quite sure what this article is‚Äîa mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.
I‚Äôve had this in my drawer for a while, since I read this article by some CERN researchers that explains how you can simulate an experiment on Bell‚Äôs inequalities using the Qibo framework."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-12T00:00:00+02:00"><meta property="article:modified_time" content="2025-10-12T00:00:00+02:00"><meta property="article:tag" content="Einstein"><meta property="article:tag" content="Bell"><meta property="article:tag" content="Quantum Mechanics"><meta property="article:tag" content="Entanglement"><meta property="og:image" content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Bell's Inequalities: A quantum computing experiment with Qiskit"><meta name=twitter:description content="1. Introduction 1.1. Intro to the intro I‚Äôm not quite sure what this article is‚Äîa mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.
I‚Äôve had this in my drawer for a while, since I read this article by some CERN researchers that explains how you can simulate an experiment on Bell‚Äôs inequalities using the Qibo framework."><meta name=application-name content="Cdani's Blog"><meta name=apple-mobile-web-app-title content="Cdani's Blog"><meta name=referrer content="no-referrer"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/logo_cd_v3.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#00872b><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/><link rel=prev href=https://c-daniele.github.io/en/posts/2025-08-31-alphaagents-a2a/><link rel=next href=https://c-daniele.github.io/en/posts/2025-11-10-genai-frameworks-update/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Bell's Inequalities: A quantum computing experiment with Qiskit","inLanguage":"en-US","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/c-daniele.github.io\/en\/posts\/2025-10-11-bells-inequalities\/"},"genre":"posts","keywords":"Einstein, Bell, Quantum Mechanics, Entanglement","wordcount":9252,"url":"https:\/\/c-daniele.github.io\/en\/posts\/2025-10-11-bells-inequalities\/","datePublished":"2025-10-12T00:00:00+02:00","dateModified":"2025-10-12T00:00:00+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Me"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script>const query=window.matchMedia("(prefers-color-scheme: dark)");function applyTheme(){let e=window.localStorage?.getItem("theme")||"auto",t=e==="dark"||e==="auto"&&query.matches;document.body.setAttribute("theme",t?"dark":"light"),document.body.setAttribute("cfg-theme",e)}applyTheme(),query.addEventListener("change",applyTheme)</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/en/ title="Cdani's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo_cd_v3.svg data-srcset="/logo_cd_v3.svg, /logo_cd_v3.svg 1.5x, /logo_cd_v3.svg 2x" data-sizes=auto alt=/logo_cd_v3.svg title=/logo_cd_v3.svg>Cdani's Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/en/posts/>Archive </a><a class=menu-item href=/en/tags/>Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=Search... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/it/posts/2025-10-11-bells-inequalities/>Italiano</option><option value=/en/posts/2025-10-11-bells-inequalities/ selected>English</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/en/ title="Cdani's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo_cd_v3.svg data-srcset="/logo_cd_v3.svg, /logo_cd_v3.svg 1.5x, /logo_cd_v3.svg 2x" data-sizes=auto alt=/logo_cd_v3.svg title=/logo_cd_v3.svg>Cdani's Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=Search... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/en/posts/ title>Archive</a><a class=menu-item href=/en/tags/ title>Tags</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/it/posts/2025-10-11-bells-inequalities/>Italiano</option><option value=/en/posts/2025-10-11-bells-inequalities/ selected>English</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Bell's Inequalities: A quantum computing experiment with Qiskit</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/en/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Me</a></span>&nbsp;<span class=post-category>included in <a href=/en/categories/science/><i class="far fa-folder fa-fw" aria-hidden=true></i>Science</a>&nbsp;<a href=/en/categories/quantum-computing/><i class="far fa-folder fa-fw" aria-hidden=true></i>Quantum Computing</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="October 12, 2025">October 12, 2025</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;9252 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;44 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#11-intro-to-the-intro>1.1. Intro to the intro</a></li><li><a href=#12-the-real-intro>1.2. The real intro</a></li></ul><ul><li><a href=#21-einstein-and-quantum-mechanics>2.1. Einstein and quantum mechanics</a></li><li><a href=#22-what-is-reality>2.2. What is reality?</a></li><li><a href=#23-the-scientific-worlds-interest-in-the-question>2.3 The scientific world&rsquo;s interest in the question</a></li></ul><ul><li><a href=#31-quantum-superposition>3.1. Quantum superposition</a></li><li><a href=#32-quantum-measurement>3.2. Quantum measurement</a></li><li><a href=#33-entanglement>3.3. Entanglement</a><ul><li><a href=#331-entanglement-and-quantum-computing>3.3.1. Entanglement and Quantum Computing</a></li></ul></li><li><a href=#34-hidden-variable-theories>3.4 Hidden variable theories</a></li></ul><ul><li><a href=#41-john-bells-work>4.1. John Bell&rsquo;s work</a></li><li><a href=#42-the-chsh-test>4.2. The CHSH test</a><ul><li><a href=#421-non-commutative-quantities>4.2.1. Non-commutative quantities</a></li></ul></li><li><a href=#43-the-experiments-that-earned-the-2022-nobel>4.3. The experiments that earned the 2022 Nobel</a><ul><li><a href=#431-the-loopholes-and-how-they-were-eliminated>4.3.1. The &ldquo;loopholes&rdquo; and how they were eliminated</a></li></ul></li></ul><ul><li><a href=#51-qubits-and-quantum-gates>5.1. Qubits and quantum gates</a></li><li><a href=#52-quantum-circuits>5.2. Quantum circuits</a></li><li><a href=#53-quantum-computing-platforms>5.3. Quantum Computing platforms</a></li></ul><ul><li><a href=#61-experiment-setup>6.1. Experiment setup</a><ul><li><a href=#necessary-ingredients>Necessary ingredients:</a></li></ul></li><li><a href=#62-the-quantum-circuit>6.2. The quantum circuit</a></li><li><a href=#63-complete-code>6.3. Complete code</a></li><li><a href=#64-expected-results>6.4. Expected results</a></li><li><a href=#65-meaning-of-angles-and-bloch-sphere>6.5. Meaning of angles and Bloch sphere</a><ul><li><a href=#651-the-bloch-sphere>6.5.1. The Bloch sphere</a></li><li><a href=#what-does-measuring-according-to-an-angle-mean>What does &ldquo;measuring according to an angle&rdquo; mean?</a></li><li><a href=#652-the-optimal-angles-of-the-chsh-test>6.5.2. The optimal angles of the CHSH test</a></li><li><a href=#653-visualization-of-optimal-angles>6.5.3. Visualization of optimal angles</a></li><li><a href=#654-graph-interpretation>6.5.4. Graph interpretation</a></li></ul></li><li><a href=#66-what-does-this-result-mean>6.6. What does this result mean?</a></li><li><a href=#67-other-interactive-experiments>6.7. Other interactive experiments</a><ul><li><a href=#671-variation-of-chsh-value-with-angles>6.7.1. Variation of CHSH value with angles</a></li><li><a href=#672-quantum-vs-classical-comparison-correlation-heatmap>6.7.2. Quantum vs classical comparison: correlation heatmap</a></li><li><a href=#673-interactive-exploration-of-chsh-parameters>6.7.3. Interactive exploration of CHSH parameters</a></li><li><a href=#674-simulation-with-realistic-noise>6.7.4. Simulation with realistic noise</a></li></ul></li></ul><ul><li><a href=#71-who-was-right>7.1. Who was right?</a></li><li><a href=#72-the-nature-of-reality>7.2. The nature of reality</a></li><li><a href=#references>References</a></li></ul></nav></div></div><div class=content id=content><h1 id=1-introduction>1. Introduction</h1><h2 id=11-intro-to-the-intro>1.1. Intro to the intro</h2><p>I&rsquo;m not quite sure what this article is‚Äîa mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.</p><p>I&rsquo;ve had this in my drawer for a while, since I read <a href=https://arxiv.org/html/2501.01434v1#abstract target=_blank rel="noopener noreffer">this article</a> by some CERN researchers that explains how you can simulate an experiment on Bell&rsquo;s inequalities using the Qibo framework.</p><p>Reading that article led me to a realization that, at least for me, is super fascinating: today in 2025, anyone with even basic programming knowledge and a couple of foundational concepts can run (or at least <strong>simulate</strong>) a quantum mechanics experiment that 20 or 30 years ago would only have been possible in a physics lab with extremely expensive equipment.</p><p>However, just copy-pasting code and running it doesn&rsquo;t seem particularly interesting to me, at least not without really understanding what we&rsquo;re talking about. That&rsquo;s why I started studying a bit of the history and some basic principles.</p><p>This little deep-dive exercise, which spans more than a century of history‚Äîfrom the origins (1905) to the 2022 Nobel Prize (in my opinion, it deserves a movie or a novel)‚Äîand touches on some of the deepest epistemological problems humanity has ever faced, has given meaning to the final exercise, which still remains little more than copy-paste from the CERN article and some suggestions from Claude üòÉ</p><h2 id=12-the-real-intro>1.2. The real intro</h2><p>Many people wonder if/when quantum computing will become a reality. To be honest, after strong market expansion in the post-COVID period, there was a moderate growth trend between 2022 and 2024, probably due to the global economic crisis and attention shifting to generative artificial intelligence.</p><table><thead><tr><th>Year</th><th>Global Market Revenues</th></tr></thead><tbody><tr><td>2020</td><td>‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà $412M</td></tr><tr><td>2021</td><td>‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà $391M</td></tr><tr><td>2022</td><td>‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà $713M</td></tr><tr><td>2023</td><td>‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà $885M</td></tr><tr><td>2024</td><td>‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà $1,107M</td></tr></tbody></table><p>Sources:</p><ul><li><a href=https://www.fortunebusinessinsights.com/quantum-computing-market-104855 target=_blank rel="noopener noreffer">Fortune Business Insights</a></li><li><a href=https://www.sri.com/press/story/new-data-on-the-growing-quantum-industry/ target=_blank rel="noopener noreffer">SRI</a></li></ul><p>In particular, in 2024 the main players operating in the Quantum Computing sector slowed down a bit in the race for more qubits, focusing on developing new architectures to reduce the so-called <a href=https://en.wikipedia.org/wiki/Quantum_decoherence target=_blank rel="noopener noreffer">quantum decoherence</a> phenomenon, which is one of the main obstacles to the scalability of current systems.
However, in 2025 there&rsquo;s been a resurgence, with announcements of new prototypes from IBM, Google, and Microsoft, and in the last 6 months, Rigetti&rsquo;s stock (another player that, unlike the previous ones, operates exclusively in the quantum computing sector) has grown by 380% on the stock market!</p><p>In any case, we haven&rsquo;t yet seen any real revolution, and almost everyone agrees that QC will probably never replace the classical computing model but, at best, will complement it, allowing for efficient solutions to complex problems.</p><p>An example of a problem that could be efficiently solved with a quantum computer is the factorization of very large integers into prime factors, using <a href=https://en.wikipedia.org/wiki/Shor%27s_algorithm target=_blank rel="noopener noreffer">Shor&rsquo;s algorithm</a> to evolve (or break) currently used cryptographic systems.</p><p>However, current limitations of quantum computers don&rsquo;t yet allow for the efficient execution of this algorithm on numbers large enough to undermine the security of current cryptographic systems.
Apart from this potential use case and some other special cases limited to very specific fields‚Äîsuch as <a href=https://arxiv.org/pdf/quant-ph/9605043 target=_blank rel="noopener noreffer">Grover&rsquo;s algorithm</a> for searching in unsorted lists‚Äîwe still don&rsquo;t see practical applications of quantum computing.
While we wait for practical applications to arrive, we can already today use it to conduct real quantum mechanics experiments.
These experiments, which for me are little more than a game, refer to much more serious work that lasted several decades and led John Clauser, Alain Aspect, and Anton Zeilinger to win the 2022 Nobel Prize in Physics: <a href=https://it.wikipedia.org/wiki/Esperimento_sulla_correlazione_quantistica_di_Aspect target=_blank rel="noopener noreffer">experiments on Bell&rsquo;s Inequalities</a>.</p><p>Needless to say, what&rsquo;s reported here isn&rsquo;t even a real &ldquo;experiment,&rdquo; since I used a simulator (not a real quantum computer). Moreover, the circuit I implemented is based on an <strong>extreme simplification of the original experiment</strong>, but the theoretical principles are the same, and it could be ported to a real commercial Quantum Computer with little effort. So it&rsquo;s an interesting exercise to understand what &ldquo;non-locality&rdquo; really means in quantum mechanics and how the same principles underlie the functioning of Quantum Computing.</p><p>To do this, we need a few ingredients:</p><ol><li>A bit of history</li><li>Some notions of quantum mechanics</li><li>A deep dive into Bell&rsquo;s inequalities</li><li>The basics of Quantum Computing</li></ol><h1 id=2-a-bit-of-history>2. A bit of history</h1><h2 id=21-einstein-and-quantum-mechanics>2.1. Einstein and quantum mechanics</h2><p>Perhaps not everyone knows that Albert Einstein didn&rsquo;t win the Nobel Prize for his theories on relativity, but rather for his explanation of the <a href=https://en.wikipedia.org/wiki/Photoelectric_effect target=_blank rel="noopener noreffer">photoelectric effect</a>, drawing from an idea by Max Planck.
Like his studies on relativity, that work by Einstein was enormously important for 20th-century physics because it kicked off the other great branch of physics: quantum mechanics. A noteworthy fact is that no Nobel Prize has ever been awarded for discoveries directly connected to the theory of relativity, while since 1920, at least 16 Nobels have been awarded for studies or discoveries directly connected to quantum mechanics.</p><p>At the beginning of the twentieth century, the idea of light as a &ldquo;corpuscle&rdquo; was in contrast with the wave representation of light, which was well established and dated back to the works of <a href=https://en.wikipedia.org/wiki/Christiaan_Huygens target=_blank rel="noopener noreffer">Christiaan Huygens</a> from around the mid-1600s. Over the centuries, the wave nature was questioned several times, but interference experiments and the solid theoretical foundations introduced by Thomas Young in 1801, and later by James Clerk Maxwell with his electromagnetic theory of light, seemed to have definitively closed the question.
Consequently, Planck himself, when he introduced the idea of quanta in 1900, didn&rsquo;t really believe in the corpuscular nature of light. From his point of view, it was just a theoretical abstraction that served to explain the problem of <a href=https://en.wikipedia.org/wiki/Ultraviolet_catastrophe target=_blank rel="noopener noreffer">black body radiation</a>, but had no real physical correspondence.</p><p>Einstein&rsquo;s great merit was taking Planck&rsquo;s intuition seriously‚Äîthat energy couldn&rsquo;t be exchanged continuously but rather in discrete &ldquo;packets&rdquo; that Planck called &ldquo;quanta&rdquo; (hence the name &ldquo;quantum mechanics&rdquo;).
In 1905, Einstein applied this idea to explain the photoelectric effect, hypothesizing that light was composed of &ldquo;light quanta,&rdquo; which we now call photons, and this earned him the Nobel Prize in Physics in 1921.</p><p>However, initially no one believed Einstein, not even Max Planck, who had provided the initial intuition. It was only thanks to <a href=https://en.wikipedia.org/wiki/Robert_Millikan#Photoelectric_effect target=_blank rel="noopener noreffer">the work of Robert Millikan</a>‚Äîwho, with the objective of discrediting Einstein&rsquo;s thesis, conducted numerous experiments and took several years to surrender to the fact that Einstein&rsquo;s explanation of the photoelectric effect was correct and thus the hypothesis of quanta was anything but a simple theoretical abstraction.</p><p>From here on, it&rsquo;s a succession of studies and discoveries that make quantum mechanics the most accurate and precise physical theory ever developed, leading in just a few years to an incredible sequence of Nobel Prizes, among which the most important are:</p><ul><li>1922 - Niels Bohr for his studies on atomic structure</li><li>1923 - Millikan for his experimental work on the photoelectric effect and the measurement of electron charge</li><li>1927 - Arthur Compton for the discovery of the Compton effect</li><li>1929 - Louis de Broglie for the discovery of the wave nature of the electron</li><li>1932 - Werner Heisenberg for the formulation of quantum mechanics</li><li>1933 - Erwin Schr√∂dinger and Paul Dirac for the formulation of wave mechanics</li><li>1945 - Wolfgang Pauli for the discovery of the exclusion principle</li><li>1954 - Max Born for the formulation of quantum mechanics in probabilistic terms</li><li>1965 - Richard Feynman, Julian Schwinger, and Sin-itiro Tomonaga for the development of quantum electrodynamics</li></ul><p>Ironically, Einstein himself‚Äîwho had started that revolution‚Äîbecame increasingly skeptical of the theory as it developed, to the point of isolating himself from the scientific community that had meanwhile fully embraced it.</p><p>But why was Einstein so skeptical about the representation of reality according to quantum mechanics?
The answer to this question has to do with the very concept of Reality itself and requires a deeper look to understand Einstein&rsquo;s point of view.</p><h2 id=22-what-is-reality>2.2. What is reality?</h2><p>In a certain sense, Einstein&rsquo;s approach to the problems raised by quantum mechanics was similar to what had characterized his approach to Relativity. When he faced an apparently unsolvable problem (such as the constancy of the speed of light across all inertial reference frames), he didn&rsquo;t try at all costs to adapt the theory, but rather began to question and define a new formalism for concepts that seemed well established, such as the concept of simultaneity, time, and space.</p><p>Something similar happened with the concept of Reality, through which Einstein, Podolsky, and Rosen formulated the famous EPR paradox, which questioned the completeness of quantum mechanics.</p><p>From Einstein&rsquo;s point of view, the description of the physical world had to obey 2 fundamental principles:</p><ul><li><strong>Locality</strong>: an object can only be influenced by its <strong>immediate surroundings</strong>, and not by events occurring at arbitrarily large distances. In other words, there cannot be &ldquo;action at a distance&rdquo; (<em>spooky action at a distance</em>).</li><li><strong>Realism</strong>: objects have <strong>defined properties</strong> independent of observation. In other words, reality exists independently of whether we observe it or not.</li></ul><p>The <a href=https://en.wikipedia.org/wiki/Einstein%E2%80%93Podolsky%E2%80%93Rosen_paradox target=_blank rel="noopener noreffer">EPR Paradox</a> describes some thought experiments through which the authors try to demonstrate that quantum mechanics cannot be a complete theory because it violates at least one of the principles listed above.</p><p>In other words, if quantum mechanics is correct, then at least one of the following statements holds:</p><div class="callout callout-note"><div class=callout-title>‚ÑπÔ∏è Note</div><div class=callout-content><ul><li><em>the principle of locality is false, and therefore there exist actions at a distance that violate the speed of light limit</em></li><li><em>the principle of realism is false, and therefore objects don&rsquo;t have defined properties independent of observation, but rather physical properties manifest only at the moment they are measured</em></li></ul></div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><p>From a technical point of view, the EPR paradox is based on the concept of <strong>entanglement</strong> which, besides being one of the strangest and most fascinating concepts in quantum mechanics (often misunderstood and misinterpreted), is also at the basis of how quantum computers work.</p><h2 id=23-the-scientific-worlds-interest-in-the-question>2.3 The scientific world&rsquo;s interest in the question</h2><p>For decades, the entire question of the EPR paradox and the epistemological interpretation of quantum mechanics remained confined to philosophical discussions among a few experts, and already after the 1930s, quantum mechanics was so well established that no one worried about these aspects anymore.
Bell himself worked as a particle physicist at various research institutions in the UK and then at CERN and devoted himself to this topic only in his spare time.
In 1964, during a sabbatical year in the United States, Bell published the famous article &ldquo;<em>On the Einstein Podolsky Rosen paradox</em>&rdquo; in which he proposed a way to experimentally verify whether Einstein was right or not.
The article aroused some interest, but nevertheless, even after Bell&rsquo;s publication, only a few daring souls were interested in a potential experiment to verify Bell&rsquo;s inequalities, also because shortly after, the very journal in which Bell had published the article went bankrupt, and this certainly didn&rsquo;t help spread the idea.</p><p>John Clauser himself, one of the three 2022 Nobel Prize winners, was initially not very convinced about tackling the question and recounts that when he asked the legendary Richard Feynman for advice about doing his first experiment to test Bell&rsquo;s inequalities, he was told it was a &ldquo;waste of time&rdquo; because quantum mechanics had already been extensively verified and no one expected Einstein to be right.</p><h1 id=3-some-notions-of-quantum-mechanics>3. Some notions of quantum mechanics</h1><h2 id=31-quantum-superposition>3.1. Quantum superposition</h2><p>In quantum mechanics, a system can be in a state of <strong>superposition</strong>, that is, in a combination of multiple states simultaneously.</p><p>In the world of quantum computing, the superposition state can be implemented through the application of some operators (<em>quantum gates</em>) on <strong>qubits</strong>, the quantum analog of the classical bit. While a classical bit can only take values 0 or 1, a qubit can be in a superposition of the two states, represented mathematically as:</p><p>$$|\psi\rangle = \alpha|0\rangle + \beta|1\rangle$$</p><p>where $\alpha$ and $\beta$ are complex numbers that satisfy the condition $|\alpha|^2 + |\beta|^2 = 1$.</p><h2 id=32-quantum-measurement>3.2. Quantum measurement</h2><p>When we measure a qubit, the superposition &ldquo;collapses&rdquo; into one of the two basis states (0 or 1), with probabilities $|\alpha|^2$ and $|\beta|^2$ respectively.</p><p>This is one of the most controversial aspects of quantum mechanics: before measurement, the system is effectively in both states simultaneously (according to the <a href=https://en.wikipedia.org/wiki/Copenhagen_interpretation target=_blank rel="noopener noreffer">Copenhagen interpretation</a>), but the moment we measure it, reality &ldquo;<em>chooses</em>&rdquo; one of the two states probabilistically.</p><p>Einstein never accepted this interpretation. At first, he tried to demonstrate that quantum mechanics was incorrect. His criticisms of Bohr during <a href=https://en.wikipedia.org/wiki/Solvay_Conference target=_blank rel="noopener noreffer">the Solvay Conferences</a> and the thought experiments that tried to challenge the theoretical framework of quantum mechanics that we can now call &ldquo;orthodox&rdquo; are now legendary.
However, Bohr and Heisenberg always managed to find an answer to Einstein&rsquo;s challenge, supported by the theory itself.
In the end, Einstein surrendered to the evidence: <strong>quantum mechanics was correct</strong>.</p><p>However, he continued to maintain that it was an incomplete theory and that there had to be a more complete description of reality that included &ldquo;hidden variables&rdquo; that would allow predicting the measurement result deterministically.</p><p>Beyond the philosophical implications, the concept of &ldquo;measurement&rdquo; also has practical implications in quantum programming since, for example, we can&rsquo;t simply &ldquo;read&rdquo; the state of a qubit in a superposition state without altering it. In the Copenhagen interpretation, this alteration (that is, this &ldquo;measurement&rdquo;) is equivalent to the concept of <strong>wave function collapse</strong>.</p><h2 id=33-entanglement>3.3. Entanglement</h2><p><strong>Entanglement</strong> (quantum correlation) is perhaps the strangest and most counterintuitive phenomenon in quantum mechanics. When two particles are entangled, they form a single quantum system, even if they are separated by arbitrarily large distances.</p><p>This correlation leads to phenomena that Einstein called &ldquo;spooky actions at a distance&rdquo; and led him to believe that quantum mechanics must be an incomplete theory.</p><p>Nevertheless, as strange and counterintuitive as it is (in fact, perhaps precisely because of this aspect), the phenomenon of entanglement has been experimented and verified countless times in laboratories.</p><p>In the vast majority of cases, tests refer to individual particles, but there are also cases where the <a href=https://research.princeton.edu/news/physicists-%E2%80%98entangle%E2%80%99-individual-molecules-first-time-bringing-about-new-platform-quantum target=_blank rel="noopener noreffer">entangled state of macroscopic systems like molecules</a> has been verified.</p><p>The most extreme and famous example is the thought experiment of <a href=https://en.wikipedia.org/wiki/Schr%C3%B6dinger%27s_cat target=_blank rel="noopener noreffer">Schr√∂dinger&rsquo;s cat</a>, which is simultaneously alive and dead until it&rsquo;s observed.</p><h3 id=331-entanglement-and-quantum-computing>3.3.1. Entanglement and Quantum Computing</h3><p>From the Quantum Computing perspective, a classic example is that of two qubits in a Bell state:</p><p>$$|\Phi^+\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle)$$</p><p>This state represents a <strong>superposition</strong> in which the two qubits are both 0 or both 1 with 50% probability. The extraordinary thing is that when we measure the first qubit and obtain (for example) 0, instantly the second qubit also collapses to state 0, regardless of the distance separating them.</p><h2 id=34-hidden-variable-theories>3.4 Hidden variable theories</h2><p>According to Einstein, quantum mechanics was an <strong>incomplete</strong> theory: the probabilities we observe in quantum measurements wouldn&rsquo;t reflect a real indeterminacy of nature, but simply our ignorance of some <strong>hidden variables</strong> that in theory could be used to precisely determine the measurement result.</p><p>To better understand this concept, we can make an analogy with flipping a coin:</p><ul><li>From a practical point of view, the result (heads or tails) seems random with 50% probability</li><li>But we know that in reality the result is completely determined by initial conditions: speed, launch angle, force, air resistance, etc.</li><li>If we perfectly knew all these &ldquo;hidden variables,&rdquo; we could predict the result with certainty</li></ul><p>Einstein believed something similar happened in quantum mechanics. When we prepare an electron in a superposition state and then measure it, according to Einstein:</p><ol><li>The electron already possesses a defined property <strong>before</strong> the measurement</li><li>This property is determined by variables that the current theory doesn&rsquo;t include (hidden variables)</li><li>The probabilistic nature of quantum mechanics derives only from our ignorance of these variables</li><li>A more complete theory that included these variables would be completely deterministic</li></ol><p>This point of view is called <strong>local realism with hidden variables</strong>:</p><ul><li><strong>Local</strong>: hidden variables are intrinsic properties of the system, not influenced by distant events</li><li><strong>Realist</strong>: physical properties exist independently of observation</li><li><strong>Deterministic</strong>: knowing the hidden variables, the measurement result would be predetermined</li></ul><p>The EPR paradox was precisely an attempt by Einstein, Podolsky, and Rosen to demonstrate that such hidden variables must necessarily exist to maintain the principles of locality and realism.</p><h1 id=4-a-deep-dive-into-bells-inequalities>4. A deep dive into Bell&rsquo;s inequalities</h1><h2 id=41-john-bells-work>4.1. John Bell&rsquo;s work</h2><p>In 1964, Irish physicist John Stewart Bell proposed a way to experimentally verify whether Einstein was right. Bell formulated a series of mathematical inequalities that must be satisfied if the principle of <strong>local realism</strong> holds (that is, if both the principle of locality and that of realism hold together).</p><p>Bell&rsquo;s brilliant idea was to find a measurable quantity that:</p><ul><li>If quantum mechanics is correct, violates the inequalities</li><li>If there exists a &ldquo;local hidden variables&rdquo; theory (as Einstein maintained), respects the inequalities</li></ul><p>This work, however, was entirely mathematical in nature. The brilliance of the physicists who came after (and for which the 2022 Nobel was ultimately recognized) was to design and carry out experiments to implement it in the real world.</p><h2 id=42-the-chsh-test>4.2. The CHSH test</h2><p>One of the most used formulations of Bell&rsquo;s inequalities is the CHSH test (from Clauser, Horne, Shimony, and Holt), which takes its name from the four physicists who proposed it in 1969.</p><p>The experiment involves:</p><ol><li>A source that produces entangled particle pairs (for example, polarized photons)</li><li>The usual &ldquo;Alice&rdquo; and &ldquo;Bob&rdquo; from all physics experiments, who can choose between two possible measurements to perform</li><li>Measuring the <strong>correlations</strong> between the results obtained by Alice and Bob</li></ol><p>More formally:</p><ul><li>Alice can choose to measure according to angle $a_0$ or $a_1$</li><li>Bob can choose to measure according to angle $b_0$ or $b_1$</li><li>Each measurement produces a result +1 or -1</li></ul><p>The CHSH quantity is then defined:</p><p>$$S = E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)$$</p><p>where $E(a_i, b_j)$ is the correlation between Alice&rsquo;s and Bob&rsquo;s measurements.</p><h3 id=421-non-commutative-quantities>4.2.1. Non-commutative quantities</h3><p>In the CHSH test, Alice and Bob measure <strong>photon polarization according to different angles</strong>, but similar experiments can be done with other physical quantities, such as the spin of electrons (also in an entangled state).</p><p>In any case, the experiment only works if the measured quantities are of a <strong>non-commutative</strong> nature.</p><p>In classical physics, if we want to measure two properties of an object (for example, its position and its velocity), we can do so in any order and always get the same results. The order of measurements doesn&rsquo;t matter.</p><p>In quantum mechanics, however, there exist pairs of physical quantities for which <strong>the order of measurements is important</strong>. When we measure A first and then B, we get different results compared to when we measure B first and then A. Mathematically, this is expressed by saying that the corresponding operators don&rsquo;t commute:</p><p>$$\hat{A}\hat{B} \neq \hat{B}\hat{A}$$</p><p>Non-commutativity is closely linked to Heisenberg&rsquo;s uncertainty principle.</p><p>The most famous examples of non-commutative quantities are:</p><ul><li><strong>Position and momentum</strong>: Heisenberg&rsquo;s uncertainty principle derives precisely from the non-commutativity of these two quantities</li><li><strong>Spin components along different axes</strong>: measuring spin along the x-axis and then along the y-axis gives different results compared to the inverse order</li><li><strong>Photon polarization according to different angles</strong>: precisely what we measure in the CHSH test</li></ul><p>In our experiment, when Alice measures polarization according to angle $a_0 = 0¬∞$ and Bob according to $b_0 = 45¬∞$, they are measuring non-commutative quantities because they&rsquo;re <strong>associated with the same entangled system</strong>.</p><figure><img src=/images/2025/bell/image-11.png alt="Diagram of a 2-channel Bell inequality test" style=max-width:100%;margin:auto;display:block><figcaption>Typical configuration of a CHSH experiment. A source produces entangled particle pairs that are sent to two spatially separated observers (Alice and Bob). Each observer can choose between two possible measurement angles (for example, polarizers oriented at 0¬∞ or 45¬∞ for Alice and 22.5¬∞ or 67.5¬∞ for Bob). The measurement results (+1 or -1) received by the 4 detectors are then used to calculate the CHSH quantity $S$.<br>Source: wikipedia</figcaption></figure><p>According to &ldquo;orthodox&rdquo; quantum mechanics, we can summarize that:</p><ol><li><strong>We cannot simultaneously know</strong> both polarizations with absolute certainty</li><li><strong>The first measurement influences the second</strong>: if Alice measures first, Bob&rsquo;s result will be influenced by the wave function collapse caused by Alice&rsquo;s measurement</li><li><strong>There are no &ldquo;pre-existing values&rdquo;</strong> for both polarizations: properties manifest only at the moment of measurement</li></ol><p>Conversely, hidden variable theories assume that each particle carries a &ldquo;hidden instruction&rdquo; that predetermines the result for every possible measurement angle. But if quantities don&rsquo;t commute, there cannot simultaneously exist predetermined values for all possible measurements.</p><p>Bell&rsquo;s genius was realizing that this difference between the classical world (where all quantities commute) and the quantum one (where some quantities don&rsquo;t commute) translates into a <strong>measurable</strong> difference in statistical correlations over a sufficiently large sample of measurements.</p><ul><li><strong>According to local realism</strong>: $|S| \leq 2$</li><li><strong>According to quantum mechanics</strong>: $|S|$ can reach up to $2\sqrt{2} \approx 2.828$</li></ul><p>But why these limits? Let&rsquo;s try to understand with an intuitive analogy.</p><h4 id=4211-the-local-realism-reasoning-the-limit-of-2>4.2.1.1. The local realism reasoning (the limit of 2)</h4><p>Imagine that each pair of entangled particles carries a hidden &ldquo;instruction sheet&rdquo; that predetermines the result for every possible measurement angle. This sheet contains 4 predetermined values:</p><ul><li>$A_0$: Alice&rsquo;s result if measuring according to $a_0$ (can be +1 or -1)</li><li>$A_1$: Alice&rsquo;s result if measuring according to $a_1$ (can be +1 or -1)</li><li>$B_0$: Bob&rsquo;s result if measuring according to $b_0$ (can be +1 or -1)</li><li>$B_1$: Bob&rsquo;s result if measuring according to $b_1$ (can be +1 or -1)</li></ul><p>For each single pair of particles, we can calculate:</p><p>$$S_{\text{single}} = A_0 B_0 + A_0 B_1 + A_1 B_0 - A_1 B_1$$</p><p>Let&rsquo;s do a concrete example. Suppose a particular pair has:</p><ul><li>$A_0 = +1$, $A_1 = -1$, $B_0 = +1$, $B_1 = +1$</li></ul><p>Then:
$$S = (+1)(+1) + (+1)(+1) + (-1)(+1) - (-1)(+1) = 1 + 1 - 1 + 1 = 2$$</p><p>Let&rsquo;s try another combination:</p><ul><li>$A_0 = +1$, $A_1 = +1$, $B_0 = +1$, $B_1 = -1$</li></ul><p>$$S = (+1)(+1) + (+1)(-1) + (+1)(+1) - (+1)(-1) = 1 - 1 + 1 + 1 = 2$$</p><p>We can rewrite $S$ as:
$$S = A_0(B_0 + B_1) + A_1(B_0 - B_1)$$</p><p>Now observe that:</p><ul><li>If $B_0 = B_1$, then $(B_0 + B_1) = \pm 2$ and $(B_0 - B_1) = 0$, so $S = \pm 2A_0$, i.e., $|S| = 2$</li><li>If $B_0 = -B_1$, then $(B_0 + B_1) = 0$ and $(B_0 - B_1) = \pm 2$, so $S = \pm 2A_1$, i.e., $|S| = 2$</li></ul><p>In both cases, for a single pair with predetermined values, we always get $|S| = 2$</p><p>When we make many measurements and calculate the average of the correlations $E(a_i, b_j)$, we&rsquo;re averaging over all possible combinations of hidden instructions. But since each single pair gives $|S| = 2$, the average can never exceed this value:</p><p>$$|S| = |E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)| \leq 2$$</p><p>This is therefore the <strong>classical limit</strong> and is valid for any local hidden variable theory.</p><h4 id=4212-the-quantum-reasoning-the-limit-of-22>4.2.1.2. The quantum reasoning (the limit of 2‚àö2)</h4><p>In quantum mechanics, instead, predetermined values don&rsquo;t exist. The particles are in an entangled Bell state:</p><p>$$|\Phi^+\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle)$$</p><p>When Alice and Bob measure according to different angles, the correlations depend on the angular difference $\theta$ between their measurement directions according to the formula:</p><p>$$E(\theta) = \cos(2\theta)$$</p><p>For the optimal angles of the CHSH test:</p><ul><li>$a_0 = 0¬∞$, $a_1 = 45¬∞$</li><li>$b_0 = 22.5¬∞$, $b_1 = -22.5¬∞$</li></ul><p>With these angles:</p><ul><li>$E(a_0, b_0) = \cos(2 \times 22.5¬∞) = \cos(45¬∞) = \frac{1}{\sqrt{2}}$</li><li>$E(a_0, b_1) = \cos(2 \times 22.5¬∞) = \cos(45¬∞) = \frac{1}{\sqrt{2}}$</li><li>$E(a_1, b_0) = \cos(2 \times 22.5¬∞) = \cos(45¬∞) = \frac{1}{\sqrt{2}}$</li><li>$E(a_1, b_1) = \cos(2 \times 67.5¬∞) = \cos(135¬∞) = -\frac{1}{\sqrt{2}}$</li></ul><p>Therefore:
$$S = \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} - \left(-\frac{1}{\sqrt{2}}\right) = \frac{4}{\sqrt{2}} = 2\sqrt{2} \approx 2.828$$</p><p>This instead is <strong>Tsirelson&rsquo;s bound</strong> and is the maximum theoretical value predicted by quantum mechanics.</p><div class="callout callout-note"><div class=callout-title>‚ÑπÔ∏è Note</div><div class=callout-content>to better understand what we mean by &ldquo;measurement angles&rdquo; and how correlations are calculated in quantum mechanics, I did a little deep-dive in section 6.5.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h4 id=4213-where-does-this-difference-come-from>4.2.1.3. Where does this difference come from?</h4><p>The fundamental difference is this:</p><ul><li><p><strong>Local realism</strong>: assumes that each particle has 4 defined properties simultaneously ($A_0, A_1, B_0, B_1$), even if we only measure one. This assumption limits the possible correlations.</p></li><li><p><strong>Quantum mechanics</strong>: properties don&rsquo;t exist before measurement. Particles are in superposition and the measurement angle determines the &ldquo;basis&rdquo; onto which we project the state. This allows stronger correlations.</p></li></ul><p>An analogy: it&rsquo;s as if in the classical case each particle carried with it 4 already-flipped coins (but covered), while in the quantum case the coins are flipped only when we uncover them, and the way we uncover Alice&rsquo;s <strong>instantly influences the probabilities</strong> for Bob&rsquo;s, even if they&rsquo;re far apart.</p><h2 id=43-the-experiments-that-earned-the-2022-nobel>4.3. The experiments that earned the 2022 Nobel</h2><p>Starting from the 1970s, a series of experiments based on Bell&rsquo;s theoretical framework and particularly on the CHSH test unequivocally demonstrated that Bell&rsquo;s inequalities are violated exactly as predicted by the theoretical framework of quantum mechanics, confirming that local realism cannot be maintained:</p><ol><li><strong>1972 - John Clauser</strong>: first experiment that violated Bell&rsquo;s inequalities using polarized photons</li><li><strong>1982 - Alain Aspect</strong>: more refined experiments that eliminated various possible &ldquo;loopholes&rdquo;</li><li><strong>1998-2015 - Anton Zeilinger</strong>: experiments with entanglement over increasingly greater distances, eventually demonstrating quantum teleportation</li></ol><p>In 2022, these three physicists received the Nobel Prize in Physics precisely for these pioneering experiments.</p><h3 id=431-the-loopholes-and-how-they-were-eliminated>4.3.1. The &ldquo;loopholes&rdquo; and how they were eliminated</h3><p>Despite Clauser&rsquo;s first experiments in the 1970s having violated Bell&rsquo;s inequalities, some possible technical objections remained that could have allowed a supporter of local realism to doubt the results. These objections are called <strong>loopholes</strong>, and much of the subsequent experimental work focused on eliminating them one by one.</p><h4 id=4311-locality-loophole>4.3.1.1. Locality Loophole</h4><p><strong>The problem</strong>: In the first experiments, Alice&rsquo;s and Bob&rsquo;s measurements weren&rsquo;t sufficiently separated in spacetime. In theory, a classical signal (traveling at or below the speed of light) could have traveled from one detector to the other, influencing the result without the experimental apparatus being able to detect it.</p><p><strong>Alain Aspect&rsquo;s solution (1982)</strong>: Aspect introduced a system of <strong>ultrafast switching</strong> of measurement angles:</p><ul><li>Measurement angles were randomly changed during photon flight</li><li>The change occurred so quickly that no subluminal signal could travel from one detector to the other</li><li>This guaranteed the <strong>spacelike separation</strong> of measurements</li></ul><p>These modifications were implemented so that the time interval between production and detection was 20 ns, while the channel switches inverted orientation asynchronously every 10 ns, keeping the various sections sufficiently far apart to guarantee spacelike distances between them.
This ensures that Alice&rsquo;s measurement event is causally disconnected from Bob&rsquo;s.</p><h4 id=4312-fair-sampling-loophole>4.3.1.2. Fair Sampling Loophole</h4><p><strong>The problem</strong>: No detector is 100% perfect. In early photon experiments, only a small fraction of produced particle pairs was actually detected and measured. In Clauser&rsquo;s experiments, for example, detection efficiency was less than 5%.</p><p>This opens up a possible objection: how can we be sure that the particle pairs <strong>actually detected</strong> are a representative sample of all pairs produced?</p><p>A supporter of local realism could argue that:</p><ul><li>Particles carry &ldquo;hidden instructions&rdquo; that determine both the measurement result and the probability of being detected</li><li>Particles with certain combinations of hidden instructions have a higher probability of being detected than others</li><li>The observed sample is therefore <strong>biased</strong>, and measured correlations don&rsquo;t reflect the true correlations of the complete set</li></ul><p>In other words, it&rsquo;s as if we did a political poll by only interviewing people who answer the phone: the sample might not be representative of the general population.</p><p>Mathematically, this objection works because the proof of Bell&rsquo;s Inequalities assumes all produced pairs are measured. If we can only measure a subset, and this subset isn&rsquo;t randomly chosen but depends on hidden variables, then the inequalities could be violated even in a local hidden variable theory.</p><p><strong>The fair sampling assumption</strong>: For many years, experiments relied on the <strong>fair sampling assumption</strong>, which assumes that detected particles are a representative random sample. This assumption is reasonable from a physics standpoint, but it&rsquo;s not a rigorous proof.</p><p><strong>The solution</strong>: To completely eliminate this loophole, you need to achieve <strong>detection efficiency</strong> above a critical threshold. For the CHSH test, this threshold is about <strong>82.8%</strong> (more precisely, $\eta > 2/3 \approx 66.7%$ for optimal configurations, but in practice you need higher efficiency to account for other factors).</p><p>This goal was very difficult to achieve and required decades of technological progress:</p><p><strong>First solution - Trapped ions (2000s)</strong>:</p><ul><li><strong>Ions</strong> (charged atoms trapped in electromagnetic fields) are much more controllable than photons</li><li>They can be kept in precise positions and measured with very high efficiency (>90%)</li><li>Pioneering experiments by Rowe et al. (2001) and Matsukevich et al. (2008) achieved efficiencies above the critical threshold</li><li><strong>Disadvantage</strong>: ions are difficult to spatially separate, making it more complicated to simultaneously close the locality loophole</li></ul><p><strong>Second solution - Superconducting detectors for photons (2010s)</strong>:</p><ul><li><strong>Superconducting nanowire single-photon detectors</strong> (SNSPDs) revolutionized photon detection</li><li>They operate at cryogenic temperatures (near absolute zero)</li><li>They achieve 75-98% efficiency in the infrared band</li><li>They allow using photons (easily separable over large distances) while maintaining high detection efficiency</li></ul><p><strong>Third solution - Neutral atoms and color centers</strong>:</p><ul><li><strong>Color centers in diamond</strong> (like NV centers - nitrogen-vacancy): defects in the diamond crystal structure that behave like single quantum systems</li><li><strong>Trapped neutral atoms</strong>: atoms cooled with lasers and trapped in optical tweezers</li><li>Combine the advantages of both approaches: high efficiency and possibility of spatial separation</li></ul><div class="callout callout-note"><div class=callout-title>‚ÑπÔ∏è Note</div><div class=callout-content><strong>Why this 82.8% threshold?</strong>: This percentage derives from mathematical analysis of the CHSH test. With lower efficiency, it&rsquo;s possible to construct a local hidden variable model that reproduces the observed statistics by precisely exploiting unfair sampling. Above this threshold, instead, it becomes mathematically impossible to explain the results with local realism, even assuming the worst possible case of sampling bias.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h4 id=4313-freedom-of-choice-loophole>4.3.1.3. Freedom-of-Choice Loophole</h4><p><strong>The problem</strong>: How are measurement angles chosen for Alice and Bob? If the choice isn&rsquo;t truly random but is somehow correlated with the particles&rsquo; &ldquo;hidden instructions,&rdquo; then the results could be explained with local realism.</p><p>This objection may seem strange, but from a logical point of view it&rsquo;s valid: if the universe is deterministic, then even the &ldquo;random&rdquo; choice of angle could be predetermined by the same hidden variables that determine the measurement result!</p><p><strong>The solution</strong>: Use sources of randomness that are as &ldquo;free&rdquo; as possible:</p><ul><li><p><strong>Quantum random number generators</strong> (QRNG): exploit intrinsically random quantum processes</p></li><li><p><strong>Light from distant stars</strong> (Zeilinger&rsquo;s experiments, 2017): they used light coming from stars thousands of light-years away to decide measurement angles. This way, the &ldquo;hidden instructions&rdquo; would have had to be correlated with events that, at least as a first approximation, we can assume to be causally disconnected from the entangled particles.</p></li><li><p><strong>Human participation</strong>: in an experiment called &ldquo;The BIG Bell Test&rdquo; (2016), thousands of people around the world chose measurement angles through an online video game</p></li></ul><h4 id=4314-memory-loophole>4.3.1.4. Memory Loophole</h4><p><strong>The problem</strong>: If particle pairs are measured in sequence and results are accumulated over time, there could be spurious correlations due to variations in the experimental apparatus.</p><p><strong>The solution</strong>: Ensure the apparatus is stable over time or, even better, complete the experiment in such a short time as to exclude instrumental drift.</p><h4 id=4315-loophole-free-experiments>4.3.1.5. &ldquo;Loophole-free&rdquo; experiments</h4><p>The real milestone was reached in <strong>2015</strong>, when three independent groups succeeded in carrying out experiments that closed <strong>simultaneously</strong> all the main loopholes:</p><ol><li><p><strong><a href=https://www.nature.com/articles/nature15759 target=_blank rel="noopener noreffer">Delft (Netherlands) - Hensen et al</a>.</strong>: used two <strong>color centers in diamond</strong> (defects in the crystal structure) separated by 1.3 km, connected via entanglement</p><ul><li>‚úì Locality loophole closed (distance 1.3 km)</li><li>‚úì Detection loophole closed (efficiency > 90%)</li></ul></li><li><p><strong><a href=https://arxiv.org/abs/1511.03190 target=_blank rel="noopener noreffer">Vienna (Austria) - Giustina et al</a>.</strong>: used <strong>entangled photons</strong> with superconducting detectors</p><ul><li>‚úì Locality loophole closed</li><li>‚úì Detection loophole closed (75% efficiency)</li></ul></li><li><p><strong><a href=https://www.nist.gov/news-events/news/2025/06/nist-and-partners-use-quantum-mechanics-make-factory-random-numbers target=_blank rel="noopener noreffer">Boulder, Colorado (USA) - Shalm et al</a>.</strong>: used <strong>entangled photons</strong> separated by 185 meters</p><ul><li>‚úì Locality loophole closed</li><li>‚úì Detection loophole closed (75% efficiency)</li></ul></li></ol><p>These experiments definitively demonstrated that <strong>it&rsquo;s not possible to save local realism</strong>: nature truly violates Bell&rsquo;s inequalities, and it&rsquo;s not an experimental artifact.</p><h4 id=4316-are-there-still-open-loopholes>4.3.1.6. Are there still open loopholes?</h4><p>From a practical point of view, <strong>no</strong>: modern experiments are convincing beyond any reasonable doubt. However, from a philosophical point of view, there still exists an extremely speculative theoretical &ldquo;loophole&rdquo;:</p><p>This is the so-called <strong>Superdeterminism</strong>: the hypothesis that <em>everything</em> in the universe is predetermined from the Big Bang, including experimenters&rsquo; choices and measurement results. In this extreme scenario, free will wouldn&rsquo;t exist even in an operational sense. This position is considered by most physicists to be a non-falsifiable hypothesis and therefore not scientific.</p><p>In conclusion, scientific consensus is unanimous: Bell&rsquo;s inequalities are violated, local realism is incompatible with nature, and the experiments that demonstrated it fully deserved the 2022 Nobel Prize.</p><h1 id=5-the-basics-of-quantum-computing>5. The basics of Quantum Computing</h1><h2 id=51-qubits-and-quantum-gates>5.1. Qubits and quantum gates</h2><p>In quantum computing, information is encoded in qubits instead of classical bits. Qubits can be physically implemented in various ways: electron spin, polarized photons, energy states of trapped atoms, etc.</p><p>Operations on qubits are performed through <strong>quantum gates</strong>, which are the analog of classical logic gates (AND, OR, NOT, etc.). The most common quantum gates are:</p><ul><li><strong>X gate</strong>: similar to classical NOT, swaps states |0‚ü© and |1‚ü©</li><li><strong>H gate (Hadamard)</strong>: creates an equiprobable superposition between |0‚ü© and |1‚ü©</li><li><strong>CNOT gate</strong>: two-qubit gate that inverts the second qubit if the first is |1‚ü©</li><li><strong>Rotation gates</strong>: allow manipulating the qubit state with precision</li></ul><h2 id=52-quantum-circuits>5.2. Quantum circuits</h2><p>A quantum program is represented as a <strong>quantum circuit</strong>, a sequence of quantum gates applied to one or more qubits. Unlike classical circuits, quantum circuits are reversible (except for measurement, which is irreversible).</p><p>To create entanglement between two qubits, typically a combination of Hadamard and CNOT gates is used:</p><ol><li>Apply an H gate to the first qubit to create superposition</li><li>Apply a CNOT gate using the first qubit as control and the second as target</li></ol><p>This creates a Bell state, completely entangled.</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-makefile"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nf>q0</span><span class=o>:</span> ‚îÄ‚îÄ<span class=n>H</span>‚îÄ‚îÄ‚ñ†‚îÄ‚îÄ
</span></span><span class=line><span class=cl>         ‚îÇ
</span></span><span class=line><span class=cl><span class=nf>q1</span><span class=o>:</span> ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<span class=n>X</span>‚îÄ‚îÄ</span></span></code></pre></div></div><h2 id=53-quantum-computing-platforms>5.3. Quantum Computing platforms</h2><p>Today there are several platforms that allow running real programs on actual quantum computers, including for example:</p><ul><li><strong>IBM Quantum Experience</strong>: allows free access to IBM&rsquo;s real quantum computers</li><li><strong>Amazon Braket</strong>: AWS&rsquo;s quantum computing service</li><li><strong>Google Quantum AI</strong>: Google&rsquo;s quantum computing platform</li><li><strong>Local simulators</strong>: libraries like Qiskit, Cirq, Q# allow simulating quantum circuits on your own computer</li></ul><h1 id=6-lets-do-the-experiment>6. Let&rsquo;s do the experiment</h1><h2 id=61-experiment-setup>6.1. Experiment setup</h2><p>We can reproduce the CHSH test using a real quantum computer or a simulator. We&rsquo;ll use two qubits in an entangled state and measure correlations according to different configurations.</p><h3 id=necessary-ingredients>Necessary ingredients:</h3><ol><li>A quantum computing platform (Qiskit, IBM Quantum, etc.)</li><li>Two qubits</li><li>Quantum circuits to create entanglement and perform rotations</li></ol><h2 id=62-the-quantum-circuit>6.2. The quantum circuit</h2><p>The basic circuit for the CHSH test is as follows:</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>QuantumRegister</span><span class=p>,</span> <span class=n>ClassicalRegister</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create 2 qubits and 2 classical bits for measurements</span>
</span></span><span class=line><span class=cl><span class=n>qr</span> <span class=o>=</span> <span class=n>QuantumRegister</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;q&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cr</span> <span class=o>=</span> <span class=n>ClassicalRegister</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=n>qr</span><span class=p>,</span> <span class=n>cr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 1: Create an entangled Bell state</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>        <span class=c1># Hadamard on first qubit</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=c1># CNOT to create entanglement</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: Apply rotations for Alice and Bob</span>
</span></span><span class=line><span class=cl><span class=c1># (angles depend on which configuration we want to test)</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># Rotation for Alice</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=n>theta_b</span><span class=p>,</span> <span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Rotation for Bob</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: Measure</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=n>qr</span><span class=p>,</span> <span class=n>cr</span><span class=p>)</span></span></span></code></pre></div></div><p>For the optimal CHSH test, the angles must be:</p><ul><li>$a_0 = 0¬∞$, $a_1 = 45¬∞$ (for Alice)</li><li>$b_0 = 22.5¬∞$, $b_1 = -22.5¬∞$ (for Bob)</li></ul><div class="callout callout-note"><div class=callout-title>‚ÑπÔ∏è Note</div><div class=callout-content>obviously, the measurement must be repeated a certain number of times (shots) to obtain statistically significant samples on which to apply the CHSH formula.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h2 id=63-complete-code>6.3. Complete code</h2><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_chsh_circuit</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create a circuit for the CHSH test with specific angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Create entangled state</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Rotations for Alice and Bob</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Measure</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>qc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate the correlation E(a,b) for given angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>create_chsh_circuit</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Execute the circuit</span>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate correlation</span>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=c1># +1 if bits are equal, -1 if different</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Optimal angles for CHSH test (in radians)</span>
</span></span><span class=line><span class=cl><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>b0</span><span class=p>,</span> <span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span><span class=p>,</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Calculate the 4 correlations</span>
</span></span><span class=line><span class=cl><span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Calculate the CHSH value</span>
</span></span><span class=line><span class=cl><span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a0, b0) = </span><span class=si>{</span><span class=n>E_a0_b0</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a0, b1) = </span><span class=si>{</span><span class=n>E_a0_b1</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a1, b0) = </span><span class=si>{</span><span class=n>E_a1_b0</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a1, b1) = </span><span class=si>{</span><span class=n>E_a1_b1</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>CHSH value S = </span><span class=si>{</span><span class=n>S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Classical limit: |S| ‚â§ 2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Quantum limit: |S| ‚â§ 2‚àö2 ‚âà 2.828&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>S</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>‚úì Bell&#39;s inequalities are VIOLATED!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Einstein was wrong: local realism is incompatible with the results.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>‚úó Bell&#39;s inequalities are respected.&#34;</span><span class=p>)</span></span></span></code></pre></div></div><h2 id=64-expected-results>6.4. Expected results</h2><p>Running the code above, we should get an S value close to $2\sqrt{2} \approx 2.828$, thus violating Bell&rsquo;s inequalities.</p><p>In practice, due to noise and imperfections of real quantum computers, we might get slightly lower values, but still above 2, demonstrating the violation of local realism.</p><h2 id=65-meaning-of-angles-and-bloch-sphere>6.5. Meaning of angles and Bloch sphere</h2><p>To really understand what we&rsquo;re doing when we choose these specific angles in the CHSH test, we can introduce a fairly intuitive tool often used in quantum mechanics: the <strong>Bloch sphere</strong>.</p><h3 id=651-the-bloch-sphere>6.5.1. The Bloch sphere</h3><p>The Bloch sphere is a geometric representation of the state of a single qubit. Each point on the sphere&rsquo;s surface represents a pure quantum state. The two poles of the sphere represent the basis states:</p><ul><li>North pole: state $|0\rangle$</li><li>South pole: state $|1\rangle$</li></ul><p>The general state of a qubit can be written as:
$$|\psi\rangle = \cos(\theta/2)|0\rangle + e^{i\phi}\sin(\theta/2)|1\rangle$$</p><p>where:</p><ul><li>$\theta$ is the polar angle (from 0¬∞ at the north pole to 180¬∞ at the south pole)</li><li>$\phi$ is the azimuthal angle (rotation around the z-axis)</li></ul><h3 id=what-does-measuring-according-to-an-angle-mean>What does &ldquo;measuring according to an angle&rdquo; mean?</h3><p>Imagine the polarizer as an orientable filter: you can decide in which direction to orient it to measure the photon&rsquo;s polarization.</p><p><strong>Physical example with polarizers:</strong></p><ul><li>Alice orients her polarizer to $a_0 = 0¬∞$ (vertical): she&rsquo;s asking &ldquo;is the photon polarized vertically or horizontally?&rdquo;</li><li>Alice orients her polarizer to $a_1 = 45¬∞$ (diagonal): she&rsquo;s asking &ldquo;is the photon polarized at 45¬∞ or at 135¬∞?&rdquo;</li></ul><p>Each polarizer orientation angle corresponds to a <strong>different question</strong> we ask the photon.</p><p><strong>In quantum computing:</strong>
Since quantum computers can only measure in the standard basis (called Z basis: $|0\rangle$ and $|1\rangle$), to measure according to a different angle we must:</p><ol><li><strong>Rotate</strong> the qubit&rsquo;s state by the desired angle</li><li><strong>Measure</strong> in the standard basis</li><li>The result is equivalent to having measured in the rotated basis</li></ol><p>In practice, in the code we use the gate <code>ry(2*Œ∏)</code> before measurement. The factor 2 is a mathematical convention of the Bloch sphere (physical angles are doubled in the mathematical representation).</p><h3 id=652-the-optimal-angles-of-the-chsh-test>6.5.2. The optimal angles of the CHSH test</h3><p>The optimal angles to maximize Bell inequality violation are:</p><ul><li>Alice: $a_0 = 0¬∞$ and $a_1 = 45¬∞$</li><li>Bob: $b_0 = 22.5¬∞$ and $b_1 = -22.5¬∞$</li></ul><p>These angles are arranged symmetrically and form a specific pattern on the Bloch sphere. The key is that:</p><ul><li>Alice&rsquo;s measurement directions ($a_0$ and $a_1$) are separated by 45¬∞</li><li>Bob&rsquo;s measurement directions ($b_0$ and $b_1$) are separated by 45¬∞ (from -22.5¬∞ to +22.5¬∞)</li><li>$b_0 = 22.5¬∞$ is exactly halfway between $a_0$ and $a_1$</li><li>$b_1 = -22.5¬∞$ is symmetric to $b_0$ with respect to the a‚ÇÄ axis</li></ul><p>The configuration creates a symmetric arrangement where:</p><ul><li>The angular difference between $a_0$ and $b_0$ is 22.5¬∞</li><li>The angular difference between $a_0$ and $b_1$ is 22.5¬∞ (in absolute value)</li><li>The angular difference between $a_1$ and $b_0$ is 22.5¬∞</li><li>The angular difference between $a_1$ and $b_1$ is 67.5¬∞</li></ul><p>This symmetry, with three differences of 22.5¬∞ and one of 67.5¬∞, maximizes the quantum correlations that violate Bell&rsquo;s inequalities.</p><h3 id=653-visualization-of-optimal-angles>6.5.3. Visualization of optimal angles</h3><h4 id=6531-interactive-version-plotly---for-jupyter-notebook>6.5.3.1. Interactive version (Plotly - for Jupyter Notebook)</h4><p>For an <strong>interactive</strong> visualization of optimal angles within the Bloch sphere, you can use this code based on Plotly (ideal for Jupyter Notebook):</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>plotly.graph_objects</span> <span class=k>as</span> <span class=nn>go</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>angle_to_bloch_vector</span><span class=p>(</span><span class=n>theta</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Convert angles (theta, phi) to a vector on the Bloch sphere&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>theta_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>theta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>phi_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>phi_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>phi_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_sphere_mesh</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create mesh for Bloch sphere&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>size</span><span class=p>(</span><span class=n>u</span><span class=p>)),</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>plot_interactive_bloch_sphere</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create an interactive visualization of the Bloch sphere with CHSH angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fig</span> <span class=o>=</span> <span class=n>go</span><span class=o>.</span><span class=n>Figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add Bloch sphere</span>
</span></span><span class=line><span class=cl>    <span class=n>x_sphere</span><span class=p>,</span> <span class=n>y_sphere</span><span class=p>,</span> <span class=n>z_sphere</span> <span class=o>=</span> <span class=n>create_sphere_mesh</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Surface</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=n>x_sphere</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_sphere</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=n>z_sphere</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>opacity</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>colorscale</span><span class=o>=</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;lightgray&#39;</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;lightgray&#39;</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>        <span class=n>showscale</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add coordinate axes</span>
</span></span><span class=line><span class=cl>    <span class=n>axis_length</span> <span class=o>=</span> <span class=mf>1.3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># X axis</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;&lt;b&gt;X&lt;/b&gt;&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Y axis</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;&lt;b&gt;Y&lt;/b&gt;&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Z axis</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Labels |0‚ü© and |1‚ü©</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>z_pos</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=p>[(</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>,</span> <span class=s1>&#39;&lt;b&gt;|0‚ü©&lt;/b&gt;&#39;</span><span class=p>),</span> <span class=p>(</span><span class=o>-</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>,</span> <span class=s1>&#39;&lt;b&gt;|1‚ü©&lt;/b&gt;&#39;</span><span class=p>)]:</span>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z_pos</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>label</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Optimal CHSH angles</span>
</span></span><span class=line><span class=cl>    <span class=n>alice_angles</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>45</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>bob_angles</span> <span class=o>=</span> <span class=p>[</span><span class=mf>22.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>22.5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>colors_alice</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;darkred&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>colors_bob</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;darkblue&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>labels_alice</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;a‚ÇÄ (0¬∞)&#39;</span><span class=p>,</span> <span class=s1>&#39;a‚ÇÅ (45¬∞)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>labels_bob</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;b‚ÇÄ (22.5¬∞)&#39;</span><span class=p>,</span> <span class=s1>&#39;b‚ÇÅ (-22.5¬∞)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add Alice&#39;s vectors</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>angle</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>alice_angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span> <span class=o>=</span> <span class=n>angle_to_bloch_vector</span><span class=p>(</span><span class=n>angle</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>y</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines+markers&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors_alice</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>8</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>marker</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>hovertemplate</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>}</span><span class=s1>&lt;extra&gt;&lt;/extra&gt;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>x</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>y</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add Bob&#39;s vectors</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>angle</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>bob_angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span> <span class=o>=</span> <span class=n>angle_to_bloch_vector</span><span class=p>(</span><span class=n>angle</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>y</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines+markers&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors_bob</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>8</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>marker</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>hovertemplate</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>}</span><span class=s1>&lt;extra&gt;&lt;/extra&gt;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>x</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>y</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Layout</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>update_layout</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>title</span><span class=o>=</span><span class=s1>&#39;Interactive Bloch Sphere: Optimal CHSH Angles&lt;br&gt;&#39;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s1>&#39;&lt;sub&gt;Rotate with mouse ‚Ä¢ Zoom with wheel ‚Ä¢ Pan with Shift+drag&lt;/sub&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>scene</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>xaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>yaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>zaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>aspectmode</span><span class=o>=</span><span class=s1>&#39;cube&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>camera</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>eye</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=mf>1.2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>height</span><span class=o>=</span><span class=mi>700</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fig</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create and show interactive graph</span>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plot_interactive_bloch_sphere</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Optional: save as interactive HTML</span>
</span></span><span class=line><span class=cl><span class=c1># fig.write_html(&#34;bloch_sphere_interactive.html&#34;)</span></span></span></code></pre></div></div><h3 id=654-graph-interpretation>6.5.4. Graph interpretation</h3><p><a href=/images/2025/bell/image-12.png><img src=/images/2025/bell/image-12.png alt="Visualization of optimal angles in the Bloch Sphere"></a></p><p><strong>Bloch Sphere (3D and 2D)</strong>: The geometric arrangement of measurement angles. Note the symmetry of the configuration: $b_0$ (22.5¬∞) is positioned exactly halfway between $a_0$ (0¬∞) and $a_1$ (45¬∞), while $b_1$ (-22.5¬∞) is symmetric with respect to the origin.</p><p><a href=/images/2025/bell/image-3.png><img src=/images/2025/bell/image-3.png alt="Correlation graphs"></a></p><ul><li><strong>Correlation vs Angular Difference</strong>: Shows how quantum correlation $E(\theta) = \cos(2\theta)$ depends on angular difference. CHSH angles are chosen to obtain specific correlation values that maximize S.</li><li><strong>CHSH value optimization</strong>: Visually demonstrates that the configuration with $a_1 = 45¬∞$ (and consequently $b_0 = 22.5¬∞$, $b_1 = -22.5¬∞$) effectively maximizes the violation of Bell&rsquo;s inequalities.</li></ul><p>In the CHSH experiment, measurement directions are symmetrically arranged to maximally exploit quantum correlations allowed by entanglement, exceeding the classical limit of 2 and reaching Tsirelson&rsquo;s bound of $2\sqrt{2}$.</p><h2 id=66-what-does-this-result-mean>6.6. What does this result mean?</h2><p>Bell inequality violation tells us that:</p><blockquote><p><strong>There cannot exist a description of the physical world that satisfies the principles of locality and realism.</strong></p></blockquote><p>In other words:</p><ul><li>Either &ldquo;actions at a distance&rdquo; exist that allow entangled particles to &ldquo;communicate&rdquo; instantaneously (violation of locality)</li><li>Or physical properties don&rsquo;t exist before measurement but are created by the act of observation itself (violation of realism)</li></ul><p>Most physicists today accept the interpretation that it&rsquo;s <strong>realism</strong> that&rsquo;s violated, while locality is preserved (although in a subtle way).</p><h2 id=67-other-interactive-experiments>6.7. Other interactive experiments</h2><p>Now that we&rsquo;ve seen the basic CHSH test, let&rsquo;s explore some additional experiments that help us better understand Bell inequality violation and the differences between quantum mechanics and local realism.</p><h3 id=671-variation-of-chsh-value-with-angles>6.7.1. Variation of CHSH value with angles</h3><p>This experiment shows how the CHSH value varies as Alice&rsquo;s angle $a_1$ varies, keeping other angles fixed. It allows us to graphically see why 45¬∞ is the optimal angle.</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_chsh_value</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate CHSH value for a given angle configuration&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>S</span><span class=p>,</span> <span class=p>(</span><span class=n>E_a0_b0</span><span class=p>,</span> <span class=n>E_a0_b1</span><span class=p>,</span> <span class=n>E_a1_b0</span><span class=p>,</span> <span class=n>E_a1_b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vary angle a1 from 0 to 90 degrees</span>
</span></span><span class=line><span class=cl><span class=n>a1_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_values_quantum</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>s_values_classical</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>a1_values</span><span class=p>)</span>  <span class=c1># Classical limit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Calculating CHSH values for different angles...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a1</span> <span class=ow>in</span> <span class=n>a1_values</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Fixed angles</span>
</span></span><span class=line><span class=cl>    <span class=n>a0</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>b0</span> <span class=o>=</span> <span class=n>a1</span> <span class=o>/</span> <span class=mi>2</span>  <span class=c1># Optimal: halfway between a0 and a1</span>
</span></span><span class=line><span class=cl>    <span class=n>b1</span> <span class=o>=</span> <span class=o>-</span><span class=n>a1</span> <span class=o>/</span> <span class=mi>2</span>  <span class=c1># Symmetric with respect to a0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>compute_chsh_value</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s_values_quantum</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;a1 = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1</span><span class=p>)</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>¬∞, S = </span><span class=si>{</span><span class=n>S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Graph</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_values</span><span class=p>),</span> <span class=n>s_values_quantum</span><span class=p>,</span> <span class=s1>&#39;b-o&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Quantum Simulation&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Classical Limit (|S| ‚â§ 2)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;g&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Tsirelson Bound (2‚àö2 ‚âà </span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;orange&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Optimal angle (45¬∞)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Angle a‚ÇÅ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;CHSH Value (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Bell Inequality Violation as Angle Varies&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_angle_variation.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Maximum violation at 45¬∞: S ‚âà </span><span class=si>{</span><span class=nb>max</span><span class=p>(</span><span class=n>s_values_quantum</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Theoretical limit: 2‚àö2 ‚âà </span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></div></div><p><strong>Expected result</strong>: The graph shows that maximum violation occurs precisely at 45¬∞, where S reaches about 2.828.</p><h3 id=672-quantum-vs-classical-comparison-correlation-heatmap>6.7.2. Quantum vs classical comparison: correlation heatmap</h3><p>This experiment visualizes quantum and classical correlations as heatmaps, allowing us to clearly see the difference.</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_quantum_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate quantum correlation for two angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_classical_correlation</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Maximum classical correlation possible for an angular difference.
</span></span></span><span class=line><span class=cl><span class=s2>    With local hidden variables, maximum correlation is limited.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Classical model: linearly decreasing correlation</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=nb>abs</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Angle grid</span>
</span></span><span class=line><span class=cl><span class=n>angles</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>angles_deg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>angles</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Matrices for correlations</span>
</span></span><span class=line><span class=cl><span class=n>quantum_corr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>classical_corr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Calculating quantum and classical correlations...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>theta_a</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>theta_b</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Quantum correlation</span>
</span></span><span class=line><span class=cl>        <span class=n>quantum_corr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>compute_quantum_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Theoretical classical correlation</span>
</span></span><span class=line><span class=cl>        <span class=n>theta_diff</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>theta_a</span> <span class=o>-</span> <span class=n>theta_b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>classical_corr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>compute_classical_correlation</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Progress: </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Visualization</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>,</span> <span class=n>ax3</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Quantum heatmap</span>
</span></span><span class=line><span class=cl><span class=n>im1</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>quantum_corr</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdBu_r&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Bob Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Alice Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Quantum Correlations</span><span class=se>\n</span><span class=s1>(Simulation)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im1</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax1</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Correlation E(a,b)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Classical heatmap</span>
</span></span><span class=line><span class=cl><span class=n>im2</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>classical_corr</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdBu_r&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Bob Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Alice Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Classical Correlations</span><span class=se>\n</span><span class=s1>(Local Hidden Variables)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im2</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Correlation E(a,b)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Difference</span>
</span></span><span class=line><span class=cl><span class=n>difference</span> <span class=o>=</span> <span class=n>quantum_corr</span> <span class=o>-</span> <span class=n>classical_corr</span>
</span></span><span class=line><span class=cl><span class=n>im3</span> <span class=o>=</span> <span class=n>ax3</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>difference</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;seismic&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Bob Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Alice Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Difference</span><span class=se>\n</span><span class=s1>(Quantum - Classical)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im3</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax3</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Difference&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;correlation_heatmaps.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Red zones in the difference map show where&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;quantum correlations exceed classical ones!&#34;</span><span class=p>)</span></span></span></code></pre></div></div><p><a href=/images/2025/bell/image-16.png><img src=/images/2025/bell/image-16.png alt="Heatmaps comparison">
</a><strong>Interpretation</strong>: The heatmaps show how quantum correlations (which follow $\cos(2\theta)$) differ significantly from classical ones, especially for intermediate angles.</p><h3 id=673-interactive-exploration-of-chsh-parameters>6.7.3. Interactive exploration of CHSH parameters</h3><p>This experiment creates a complete parametric analysis of the CHSH angle space.</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib.widgets</span> <span class=kn>import</span> <span class=n>Slider</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_single_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate a single correlation&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2D analysis: simultaneous variation of a1 and b0</span>
</span></span><span class=line><span class=cl><span class=n>a1_range</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b0_range</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>S_matrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>b0_range</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Exploring CHSH parameter space...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;This may take a few minutes...</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>a1</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>a1_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>b0</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>b0_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a0</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>b1</span> <span class=o>=</span> <span class=o>-</span><span class=n>b0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>        <span class=n>S_matrix</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>S</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>5</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Progress: </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>a1_range</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3D visualization</span>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 1: 2D Heatmap</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>(</span><span class=mi>121</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>im</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>contourf</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=n>S_matrix</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=n>levels</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdYlGn&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>contour</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=n>S_matrix</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>levels</span><span class=o>=</span><span class=p>[</span><span class=mf>2.0</span><span class=p>],</span> <span class=n>colors</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>linestyles</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=mf>22.5</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=s1>&#39;b*&#39;</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Optimal configuration&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angle b‚ÇÄ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angle a‚ÇÅ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CHSH Value in Parameter Space&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax1</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;Classical limit&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 2: 3D Surface</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>(</span><span class=mi>122</span><span class=p>,</span> <span class=n>projection</span><span class=o>=</span><span class=s1>&#39;3d&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>B0</span><span class=p>,</span> <span class=n>A1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>surf</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>plot_surface</span><span class=p>(</span><span class=n>B0</span><span class=p>,</span> <span class=n>A1</span><span class=p>,</span> <span class=n>S_matrix</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdYlGn&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.9</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Classical limit plane</span>
</span></span><span class=line><span class=cl><span class=n>xx</span><span class=p>,</span> <span class=n>yy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>zz</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>xx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>plot_surface</span><span class=p>(</span><span class=n>xx</span><span class=p>,</span> <span class=n>yy</span><span class=p>,</span> <span class=n>zz</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angle b‚ÇÄ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angle a‚ÇÅ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_zlabel</span><span class=p>(</span><span class=s1>&#39;CHSH Value (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;3D CHSH Surface&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>view_init</span><span class=p>(</span><span class=n>elev</span><span class=o>=</span><span class=mi>25</span><span class=p>,</span> <span class=n>azim</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>surf</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax2</span><span class=p>,</span> <span class=n>shrink</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_parameter_space.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Find maximum</span>
</span></span><span class=line><span class=cl><span class=n>max_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unravel_index</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>S_matrix</span><span class=p>),</span> <span class=n>S_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>max_a1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>[</span><span class=n>max_idx</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>max_b0</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>[</span><span class=n>max_idx</span><span class=p>[</span><span class=mi>1</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>max_S</span> <span class=o>=</span> <span class=n>S_matrix</span><span class=p>[</span><span class=n>max_idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Optimal configuration found:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  a‚ÇÅ = </span><span class=si>{</span><span class=n>max_a1</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>¬∞&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  b‚ÇÄ = </span><span class=si>{</span><span class=n>max_b0</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>¬∞&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  S = </span><span class=si>{</span><span class=n>max_S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Optimal theoretical value: a‚ÇÅ=45¬∞, b‚ÇÄ=22.5¬∞, S=2‚àö2‚âà2.828&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></div></div><p><a href=/images/2025/bell/image-17.png><img src=/images/2025/bell/image-17.png alt="Parameter space exploration">
</a><strong>Result</strong>: This graph shows the &ldquo;mountain&rdquo; of the CHSH value in parameter space, with the peak precisely at the optimal configuration (45¬∞, 22.5¬∞).</p><h3 id=674-simulation-with-realistic-noise>6.7.4. Simulation with realistic noise</h3><p>In the last experiment, we add noise to simulate imperfections of real quantum computers.</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer.noise</span> <span class=kn>import</span> <span class=n>NoiseModel</span><span class=p>,</span> <span class=n>depolarizing_error</span><span class=p>,</span> <span class=n>thermal_relaxation_error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_noisy_simulator</span><span class=p>(</span><span class=n>error_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>t1</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>t2</span><span class=o>=</span><span class=mi>70</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Create a simulator with realistic noise.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        error_rate: probability of error per gate (depolarizing)
</span></span></span><span class=line><span class=cl><span class=s2>        t1: relaxation time T1 (microseconds)
</span></span></span><span class=line><span class=cl><span class=s2>        t2: decoherence time T2 (microseconds)
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span> <span class=o>=</span> <span class=n>NoiseModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Depolarizing error on gates</span>
</span></span><span class=line><span class=cl>    <span class=n>error_gate1</span> <span class=o>=</span> <span class=n>depolarizing_error</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>error_gate2</span> <span class=o>=</span> <span class=n>depolarizing_error</span><span class=p>(</span><span class=n>error_rate</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add errors to gates</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span><span class=o>.</span><span class=n>add_all_qubit_quantum_error</span><span class=p>(</span><span class=n>error_gate1</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;h&#39;</span><span class=p>,</span> <span class=s1>&#39;ry&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span><span class=o>.</span><span class=n>add_all_qubit_quantum_error</span><span class=p>(</span><span class=n>error_gate2</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;cx&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Thermal relaxation error</span>
</span></span><span class=line><span class=cl>    <span class=c1># gate_times = {&#39;h&#39;: 50, &#39;ry&#39;: 50, &#39;cx&#39;: 200, &#39;measure&#39;: 1000}  # in nanoseconds</span>
</span></span><span class=line><span class=cl>    <span class=c1># thermal_error = thermal_relaxation_error(t1*1000, t2*1000, gate_times[&#39;cx&#39;])</span>
</span></span><span class=line><span class=cl>    <span class=c1># noise_model.add_all_qubit_quantum_error(thermal_error, [&#39;cx&#39;])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>noise_model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_chsh_with_noise</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Execute CHSH test with a given noise level&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span> <span class=o>=</span> <span class=n>create_noisy_simulator</span><span class=p>(</span><span class=n>error_rate</span><span class=o>=</span><span class=n>error_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>(</span><span class=n>noise_model</span><span class=o>=</span><span class=n>noise_model</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Optimal angles</span>
</span></span><span class=line><span class=cl>    <span class=n>a0</span><span class=p>,</span> <span class=n>a1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span><span class=p>,</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>S</span><span class=p>,</span> <span class=p>(</span><span class=n>E_a0_b0</span><span class=p>,</span> <span class=n>E_a0_b1</span><span class=p>,</span> <span class=n>E_a1_b0</span><span class=p>,</span> <span class=n>E_a1_b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test with different noise levels</span>
</span></span><span class=line><span class=cl><span class=n>error_rates</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_values_noisy</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>s_std</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Simulation with realistic noise...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;This simulates imperfections of real quantum computers.</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>error_rate</span> <span class=ow>in</span> <span class=n>error_rates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Run multiple times to estimate variance</span>
</span></span><span class=line><span class=cl>    <span class=n>s_trials</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>S</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>run_chsh_with_noise</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>s_trials</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>s_values_noisy</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>s_trials</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>s_std</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>s_trials</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error rate: </span><span class=si>{</span><span class=n>error_rate</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% ‚Üí S = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>s_trials</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ¬± </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>s_trials</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Visualization</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 1: S vs Error Rate</span>
</span></span><span class=line><span class=cl><span class=n>s_values_noisy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_std</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>s_std</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>errorbar</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>s_values_noisy</span><span class=p>,</span> <span class=n>yerr</span><span class=o>=</span><span class=n>s_std</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;o-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>color</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Simulation with noise&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Classical limit (S=2)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Ideal limit (S=2‚àö2‚âà</span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>fill_between</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>s_values_noisy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>where</span><span class=o>=</span><span class=p>(</span><span class=n>s_values_noisy</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>),</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Violation zone&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Error rate per gate (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;CHSH Value (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Effect of Noise on Bell Violation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>([</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 2: Violation vs Error Rate</span>
</span></span><span class=line><span class=cl><span class=n>violation</span> <span class=o>=</span> <span class=n>s_values_noisy</span> <span class=o>-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>violation</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;green&#39;</span> <span class=k>if</span> <span class=n>v</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s1>&#39;red&#39;</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>violation</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Error rate per gate (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Violation (S - 2)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Margin of Bell Inequality Violation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Find critical point where S drops below 2</span>
</span></span><span class=line><span class=cl><span class=n>critical_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>s_values_noisy</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>critical_idx</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>critical_error</span> <span class=o>=</span> <span class=n>error_rates</span><span class=p>[</span><span class=n>critical_idx</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>critical_error</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>critical_error</span><span class=p>,</span> <span class=n>ax2</span><span class=o>.</span><span class=n>get_ylim</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s1>&#39;Critical point</span><span class=se>\n</span><span class=s1>~</span><span class=si>{</span><span class=n>critical_error</span><span class=si>:</span><span class=s1>.1f</span><span class=si>}</span><span class=s1>%&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>bbox</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>boxstyle</span><span class=o>=</span><span class=s1>&#39;round&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>facecolor</span><span class=o>=</span><span class=s1>&#39;wheat&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_with_noise.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>60</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;RESULTS:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - With 0% noise: S ‚âà </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> (ideal)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - With 1% noise: S ‚âà </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span><span class=o>*</span><span class=mf>0.2</span><span class=p>)]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - With 3% noise: S ‚âà </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span><span class=o>*</span><span class=mf>0.6</span><span class=p>)]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>critical_idx</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Critical limit: ~</span><span class=si>{</span><span class=n>critical_error</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% (S drops below 2)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Violation persists up to </span><span class=si>{</span><span class=n>error_rates</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>60</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></div></div><p><a href=/images/2025/bell/image-18.png><img src=/images/2025/bell/image-18.png alt="Noise effects">
</a><strong>Interpretation</strong>: This graph shows how delicate quantum computers are. Even small errors reduce Bell violation, but fortunately it takes a fairly high error (>8%) before the violation completely disappears.</p><h1 id=7-conclusions-and-philosophical-reflections>7. Conclusions and philosophical reflections</h1><h2 id=71-who-was-right>7.1. Who was right?</h2><p>The Einstein-Bohr debate was one of the most fascinating in the history of physics. From a purely scientific point of view, we can say that <strong>Bohr was right</strong>: quantum mechanics is a complete and correct theory, and quantum phenomena cannot be explained with local hidden variable theories.</p><p>Einstein&rsquo;s fate was somewhat paradoxical: despite being recognized as one of the greatest physicists of all time, he was often misunderstood and isolated by the &ldquo;mainstream&rdquo; scientific community, both in the early phases of his career (with relativity) and in the final ones (with quantum mechanics).</p><p>In any case, I believe that the very formulation of the EPR problem, which then led to Bell&rsquo;s studies, Aspect&rsquo;s experiments, and those of many others, was once again an enormous contribution to physics and human knowledge.</p><h2 id=72-the-nature-of-reality>7.2. The nature of reality</h2><p>From a philosophical point of view, Bell&rsquo;s experiments teach us something profound about the nature of reality:</p><ol><li><strong>The world is not made of &ldquo;things&rdquo; with defined properties</strong> that exist independently of observation</li><li><strong>Reality emerges from interaction</strong> between observed system and measurement apparatus</li><li><strong>We cannot completely separate the observer from the observed</strong></li></ol><p>This doesn&rsquo;t mean that reality &ldquo;doesn&rsquo;t exist&rdquo; or that it&rsquo;s purely subjective, but rather that our classical intuition about what it means to &ldquo;exist&rdquo; must be profoundly revised in light of quantum phenomena.</p><p>In a certain sense, what we identify as &ldquo;reality&rdquo; is an emergent construct and doesn&rsquo;t transcend our interactions with the world.</p><hr><h2 id=references>References</h2><ul><li>Bell&rsquo;s original article (1964) &ldquo;<a href=https://cds.cern.ch/record/111654/files/vol1p195-200_001.pdf target=_blank rel="noopener noreffer">ON THE EINSTEIN PODOLSKY ROSEN PARADOX</a>&rdquo;</li><li><a href=https://www.nobelprize.org/prizes/physics/2022/summary/ target=_blank rel="noopener noreffer">Nobel Prize 2022 - Announcement</a></li><li><a href=https://qiskit.org/documentation/ target=_blank rel="noopener noreffer">Qiskit Documentation</a></li><li><a href=https://quantum-computing.ibm.com/ target=_blank rel="noopener noreffer">IBM Quantum Experience</a></li><li><a href=https://physics.aps.org/articles/v8/123 target=_blank rel="noopener noreffer">Closing the Door on Einstein and Bohr&rsquo;s Quantum Debate</a></li><li><a href=https://arxiv.org/html/2501.01434v1 target=_blank rel="noopener noreffer">Simulating Bell&rsquo;s inequalities with Qibo</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on October 12, 2025</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on X" data-sharer=x data-url=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/ data-title="Bell's Inequalities: A quantum computing experiment with Qiskit" data-hashtags="Einstein,Bell,Quantum Mechanics,Entanglement"><i class="fab fa-x-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Threads" data-sharer=threads data-url=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/ data-title="Bell's Inequalities: A quantum computing experiment with Qiskit"><i class="fab fa-threads fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/ data-hashtag=Einstein><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/ data-title="Bell's Inequalities: A quantum computing experiment with Qiskit"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/ data-title="Bell's Inequalities: A quantum computing experiment with Qiskit"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@15.14.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on ÂæÆÂçö" data-sharer=weibo data-url=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/ data-title="Bell's Inequalities: A quantum computing experiment with Qiskit"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Diaspora" data-sharer=diaspora data-url=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/ data-title="Bell's Inequalities: A quantum computing experiment with Qiskit" data-description><i class="fab fa-diaspora fa-fw" aria-hidden=true></i></a><a href="https://t.me/share/url?url=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f&amp;text=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit" target=_blank title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/en/tags/einstein/>Einstein</a>,&nbsp;<a href=/en/tags/bell/>Bell</a>,&nbsp;<a href=/en/tags/quantum-mechanics/>Quantum Mechanics</a>,&nbsp;<a href=/en/tags/entanglement/>Entanglement</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/en/>Home</a></span></section></div><div class=post-nav><a href=/en/posts/2025-08-31-alphaagents-a2a/ class=prev rel=prev title="AlphaAgents: Multi-Agent A2A Implementation for Collaborative Financial Analysis"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>AlphaAgents: Multi-Agent A2A Implementation for Collaborative Financial Analysis</a>
<a href=/en/posts/2025-11-10-genai-frameworks-update/ class=next rel=next title="Why LangChain Is Still the Best Framework for GenAI">Why LangChain Is Still the Best Framework for GenAI<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a></div><div id=fixed-buttons-hidden><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js></script><script>window.config={comment:{},search:{highlightTag:"em",lunrIndexURL:"/en/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script src=/js/theme.min.js></script><script>var dnt,doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8NZQZ3Z1RN")}</script><script src="https://www.googletagmanager.com/gtag/js?id=G-8NZQZ3Z1RN" async></script></body></html>