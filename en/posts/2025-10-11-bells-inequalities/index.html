<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Bell's Inequalities: A quantum computing experiment with Qiskit | Cdani's Blog</title><meta name=keywords content="Einstein,Bell,Quantum Mechanics,Entanglement"><meta name=description content="1. Introduction 1.1. Intro to the intro I&rsquo;m not quite sure what this article is—a mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.
I&rsquo;ve had this in my drawer for a while, since I read this article by some CERN researchers that explains how you can simulate an experiment on Bell&rsquo;s inequalities using the Qibo framework."><meta name=author content="Me"><link rel=canonical href=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3598bbf45621a4ad34d093926efeb15d6df27175e085d2f069483f14ad39d7fa.css integrity="sha256-NZi79FYhpK000JOSbv6xXW3ycXXghdLwaUg/FK051/o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=it href=https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/><link rel=alternate hreflang=en href=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-8NZQZ3Z1RN"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8NZQZ3Z1RN",{anonymize_ip:!1})}</script><meta property="og:title" content="Bell's Inequalities: A quantum computing experiment with Qiskit"><meta property="og:description" content="1. Introduction 1.1. Intro to the intro I&rsquo;m not quite sure what this article is—a mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.
I&rsquo;ve had this in my drawer for a while, since I read this article by some CERN researchers that explains how you can simulate an experiment on Bell&rsquo;s inequalities using the Qibo framework."><meta property="og:type" content="article"><meta property="og:url" content="https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/"><meta property="og:image" content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-12T00:00:00+02:00"><meta property="article:modified_time" content="2025-10-12T00:00:00+02:00"><meta property="og:site_name" content="Cdani's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Bell's Inequalities: A quantum computing experiment with Qiskit"><meta name=twitter:description content="1. Introduction 1.1. Intro to the intro I&rsquo;m not quite sure what this article is—a mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.
I&rsquo;ve had this in my drawer for a while, since I read this article by some CERN researchers that explains how you can simulate an experiment on Bell&rsquo;s inequalities using the Qibo framework."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"Bell's Inequalities: A quantum computing experiment with Qiskit","item":"https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Bell's Inequalities: A quantum computing experiment with Qiskit","name":"Bell\u0027s Inequalities: A quantum computing experiment with Qiskit","description":"1. Introduction 1.1. Intro to the intro I\u0026rsquo;m not quite sure what this article is—a mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.\nI\u0026rsquo;ve had this in my drawer for a while, since I read this article by some CERN researchers that explains how you can simulate an experiment on Bell\u0026rsquo;s inequalities using the Qibo framework.","keywords":["Einstein","Bell","Quantum Mechanics","Entanglement"],"articleBody":"1. Introduction 1.1. Intro to the intro I’m not quite sure what this article is—a mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.\nI’ve had this in my drawer for a while, since I read this article by some CERN researchers that explains how you can simulate an experiment on Bell’s inequalities using the Qibo framework.\nReading that article led me to a realization that, at least for me, is super fascinating: today in 2025, anyone with even basic programming knowledge and a couple of foundational concepts can run (or at least simulate) a quantum mechanics experiment that 20 or 30 years ago would only have been possible in a physics lab with extremely expensive equipment.\nHowever, just copy-pasting code and running it doesn’t seem particularly interesting to me, at least not without really understanding what we’re talking about. That’s why I started studying a bit of the history and some basic principles.\nThis little deep-dive exercise, which spans more than a century of history—from the origins (1905) to the 2022 Nobel Prize (in my opinion, it deserves a movie or a novel)—and touches on some of the deepest epistemological problems humanity has ever faced, has given meaning to the final exercise, which still remains little more than copy-paste from the CERN article and some suggestions from Claude 😃\n1.2. The real intro Many people wonder if/when quantum computing will become a reality. To be honest, after strong market expansion in the post-COVID period, there was a moderate growth trend between 2022 and 2024, probably due to the global economic crisis and attention shifting to generative artificial intelligence.\nYear Global Market Revenues 2020 ████████ $412M 2021 ████████ $391M 2022 ██████████████ $713M 2023 █████████████████ $885M 2024 ███████████████████████ $1,107M Sources:\nFortune Business Insights SRI In particular, in 2024 the main players operating in the Quantum Computing sector slowed down a bit in the race for more qubits, focusing on developing new architectures to reduce the so-called quantum decoherence phenomenon, which is one of the main obstacles to the scalability of current systems. However, in 2025 there’s been a resurgence, with announcements of new prototypes from IBM, Google, and Microsoft, and in the last 6 months, Rigetti’s stock (another player that, unlike the previous ones, operates exclusively in the quantum computing sector) has grown by 380% on the stock market!\nIn any case, we haven’t yet seen any real revolution, and almost everyone agrees that QC will probably never replace the classical computing model but, at best, will complement it, allowing for efficient solutions to complex problems.\nAn example of a problem that could be efficiently solved with a quantum computer is the factorization of very large integers into prime factors, using Shor’s algorithm to evolve (or break) currently used cryptographic systems.\nHowever, current limitations of quantum computers don’t yet allow for the efficient execution of this algorithm on numbers large enough to undermine the security of current cryptographic systems. Apart from this potential use case and some other special cases limited to very specific fields—such as Grover’s algorithm for searching in unsorted lists—we still don’t see practical applications of quantum computing. While we wait for practical applications to arrive, we can already today use it to conduct real quantum mechanics experiments. These experiments, which for me are little more than a game, refer to much more serious work that lasted several decades and led John Clauser, Alain Aspect, and Anton Zeilinger to win the 2022 Nobel Prize in Physics: experiments on Bell’s Inequalities.\nNeedless to say, what’s reported here isn’t even a real “experiment,” since I used a simulator (not a real quantum computer). Moreover, the circuit I implemented is based on an extreme simplification of the original experiment, but the theoretical principles are the same, and it could be ported to a real commercial Quantum Computer with little effort. So it’s an interesting exercise to understand what “non-locality” really means in quantum mechanics and how the same principles underlie the functioning of Quantum Computing.\nTo do this, we need a few ingredients:\nA bit of history Some notions of quantum mechanics A deep dive into Bell’s inequalities The basics of Quantum Computing 2. A bit of history 2.1. Einstein and quantum mechanics Perhaps not everyone knows that Albert Einstein didn’t win the Nobel Prize for his theories on relativity, but rather for his explanation of the photoelectric effect, drawing from an idea by Max Planck. Like his studies on relativity, that work by Einstein was enormously important for 20th-century physics because it kicked off the other great branch of physics: quantum mechanics. A noteworthy fact is that no Nobel Prize has ever been awarded for discoveries directly connected to the theory of relativity, while since 1920, at least 16 Nobels have been awarded for studies or discoveries directly connected to quantum mechanics.\nAt the beginning of the twentieth century, the idea of light as a “corpuscle” was in contrast with the wave representation of light, which was well established and dated back to the works of Christiaan Huygens from around the mid-1600s. Over the centuries, the wave nature was questioned several times, but interference experiments and the solid theoretical foundations introduced by Thomas Young in 1801, and later by James Clerk Maxwell with his electromagnetic theory of light, seemed to have definitively closed the question. Consequently, Planck himself, when he introduced the idea of quanta in 1900, didn’t really believe in the corpuscular nature of light. From his point of view, it was just a theoretical abstraction that served to explain the problem of black body radiation, but had no real physical correspondence.\nEinstein’s great merit was taking Planck’s intuition seriously—that energy couldn’t be exchanged continuously but rather in discrete “packets” that Planck called “quanta” (hence the name “quantum mechanics”). In 1905, Einstein applied this idea to explain the photoelectric effect, hypothesizing that light was composed of “light quanta,” which we now call photons, and this earned him the Nobel Prize in Physics in 1921.\nHowever, initially no one believed Einstein, not even Max Planck, who had provided the initial intuition. It was only thanks to the work of Robert Millikan—who, with the objective of discrediting Einstein’s thesis, conducted numerous experiments and took several years to surrender to the fact that Einstein’s explanation of the photoelectric effect was correct and thus the hypothesis of quanta was anything but a simple theoretical abstraction.\nFrom here on, it’s a succession of studies and discoveries that make quantum mechanics the most accurate and precise physical theory ever developed, leading in just a few years to an incredible sequence of Nobel Prizes, among which the most important are:\n1922 - Niels Bohr for his studies on atomic structure 1923 - Millikan for his experimental work on the photoelectric effect and the measurement of electron charge 1927 - Arthur Compton for the discovery of the Compton effect 1929 - Louis de Broglie for the discovery of the wave nature of the electron 1932 - Werner Heisenberg for the formulation of quantum mechanics 1933 - Erwin Schrödinger and Paul Dirac for the formulation of wave mechanics 1945 - Wolfgang Pauli for the discovery of the exclusion principle 1954 - Max Born for the formulation of quantum mechanics in probabilistic terms 1965 - Richard Feynman, Julian Schwinger, and Sin-itiro Tomonaga for the development of quantum electrodynamics Ironically, Einstein himself—who had started that revolution—became increasingly skeptical of the theory as it developed, to the point of isolating himself from the scientific community that had meanwhile fully embraced it.\nBut why was Einstein so skeptical about the representation of reality according to quantum mechanics? The answer to this question has to do with the very concept of Reality itself and requires a deeper look to understand Einstein’s point of view.\n2.2. What is reality? In a certain sense, Einstein’s approach to the problems raised by quantum mechanics was similar to what had characterized his approach to Relativity. When he faced an apparently unsolvable problem (such as the constancy of the speed of light across all inertial reference frames), he didn’t try at all costs to adapt the theory, but rather began to question and define a new formalism for concepts that seemed well established, such as the concept of simultaneity, time, and space.\nSomething similar happened with the concept of Reality, through which Einstein, Podolsky, and Rosen formulated the famous EPR paradox, which questioned the completeness of quantum mechanics.\nFrom Einstein’s point of view, the description of the physical world had to obey 2 fundamental principles:\nLocality: an object can only be influenced by its immediate surroundings, and not by events occurring at arbitrarily large distances. In other words, there cannot be “action at a distance” (spooky action at a distance). Realism: objects have defined properties independent of observation. In other words, reality exists independently of whether we observe it or not. The EPR Paradox describes some thought experiments through which the authors try to demonstrate that quantum mechanics cannot be a complete theory because it violates at least one of the principles listed above.\nIn other words, if quantum mechanics is correct, then at least one of the following statements holds:\nℹ️ Note the principle of locality is false, and therefore there exist actions at a distance that violate the speed of light limit the principle of realism is false, and therefore objects don’t have defined properties independent of observation, but rather physical properties manifest only at the moment they are measured From a technical point of view, the EPR paradox is based on the concept of entanglement which, besides being one of the strangest and most fascinating concepts in quantum mechanics (often misunderstood and misinterpreted), is also at the basis of how quantum computers work.\n2.3 The scientific world’s interest in the question For decades, the entire question of the EPR paradox and the epistemological interpretation of quantum mechanics remained confined to philosophical discussions among a few experts, and already after the 1930s, quantum mechanics was so well established that no one worried about these aspects anymore. Bell himself worked as a particle physicist at various research institutions in the UK and then at CERN and devoted himself to this topic only in his spare time. In 1964, during a sabbatical year in the United States, Bell published the famous article “On the Einstein Podolsky Rosen paradox” in which he proposed a way to experimentally verify whether Einstein was right or not. The article aroused some interest, but nevertheless, even after Bell’s publication, only a few daring souls were interested in a potential experiment to verify Bell’s inequalities, also because shortly after, the very journal in which Bell had published the article went bankrupt, and this certainly didn’t help spread the idea.\nJohn Clauser himself, one of the three 2022 Nobel Prize winners, was initially not very convinced about tackling the question and recounts that when he asked the legendary Richard Feynman for advice about doing his first experiment to test Bell’s inequalities, he was told it was a “waste of time” because quantum mechanics had already been extensively verified and no one expected Einstein to be right.\n3. Some notions of quantum mechanics 3.1. Quantum superposition In quantum mechanics, a system can be in a state of superposition, that is, in a combination of multiple states simultaneously.\nIn the world of quantum computing, the superposition state can be implemented through the application of some operators (quantum gates) on qubits, the quantum analog of the classical bit. While a classical bit can only take values 0 or 1, a qubit can be in a superposition of the two states, represented mathematically as:\n$$|\\psi\\rangle = \\alpha|0\\rangle + \\beta|1\\rangle$$\nwhere $\\alpha$ and $\\beta$ are complex numbers that satisfy the condition $|\\alpha|^2 + |\\beta|^2 = 1$.\n3.2. Quantum measurement When we measure a qubit, the superposition “collapses” into one of the two basis states (0 or 1), with probabilities $|\\alpha|^2$ and $|\\beta|^2$ respectively.\nThis is one of the most controversial aspects of quantum mechanics: before measurement, the system is effectively in both states simultaneously (according to the Copenhagen interpretation), but the moment we measure it, reality “chooses” one of the two states probabilistically.\nEinstein never accepted this interpretation. At first, he tried to demonstrate that quantum mechanics was incorrect. His criticisms of Bohr during the Solvay Conferences and the thought experiments that tried to challenge the theoretical framework of quantum mechanics that we can now call “orthodox” are now legendary. However, Bohr and Heisenberg always managed to find an answer to Einstein’s challenge, supported by the theory itself. In the end, Einstein surrendered to the evidence: quantum mechanics was correct.\nHowever, he continued to maintain that it was an incomplete theory and that there had to be a more complete description of reality that included “hidden variables” that would allow predicting the measurement result deterministically.\nBeyond the philosophical implications, the concept of “measurement” also has practical implications in quantum programming since, for example, we can’t simply “read” the state of a qubit in a superposition state without altering it. In the Copenhagen interpretation, this alteration (that is, this “measurement”) is equivalent to the concept of wave function collapse.\n3.3. Entanglement Entanglement (quantum correlation) is perhaps the strangest and most counterintuitive phenomenon in quantum mechanics. When two particles are entangled, they form a single quantum system, even if they are separated by arbitrarily large distances.\nThis correlation leads to phenomena that Einstein called “spooky actions at a distance” and led him to believe that quantum mechanics must be an incomplete theory.\nNevertheless, as strange and counterintuitive as it is (in fact, perhaps precisely because of this aspect), the phenomenon of entanglement has been experimented and verified countless times in laboratories.\nIn the vast majority of cases, tests refer to individual particles, but there are also cases where the entangled state of macroscopic systems like molecules has been verified.\nThe most extreme and famous example is the thought experiment of Schrödinger’s cat, which is simultaneously alive and dead until it’s observed.\n3.3.1. Entanglement and Quantum Computing From the Quantum Computing perspective, a classic example is that of two qubits in a Bell state:\n$$|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$$\nThis state represents a superposition in which the two qubits are both 0 or both 1 with 50% probability. The extraordinary thing is that when we measure the first qubit and obtain (for example) 0, instantly the second qubit also collapses to state 0, regardless of the distance separating them.\n3.4 Hidden variable theories According to Einstein, quantum mechanics was an incomplete theory: the probabilities we observe in quantum measurements wouldn’t reflect a real indeterminacy of nature, but simply our ignorance of some hidden variables that in theory could be used to precisely determine the measurement result.\nTo better understand this concept, we can make an analogy with flipping a coin:\nFrom a practical point of view, the result (heads or tails) seems random with 50% probability But we know that in reality the result is completely determined by initial conditions: speed, launch angle, force, air resistance, etc. If we perfectly knew all these “hidden variables,” we could predict the result with certainty Einstein believed something similar happened in quantum mechanics. When we prepare an electron in a superposition state and then measure it, according to Einstein:\nThe electron already possesses a defined property before the measurement This property is determined by variables that the current theory doesn’t include (hidden variables) The probabilistic nature of quantum mechanics derives only from our ignorance of these variables A more complete theory that included these variables would be completely deterministic This point of view is called local realism with hidden variables:\nLocal: hidden variables are intrinsic properties of the system, not influenced by distant events Realist: physical properties exist independently of observation Deterministic: knowing the hidden variables, the measurement result would be predetermined The EPR paradox was precisely an attempt by Einstein, Podolsky, and Rosen to demonstrate that such hidden variables must necessarily exist to maintain the principles of locality and realism.\n4. A deep dive into Bell’s inequalities 4.1. John Bell’s work In 1964, Irish physicist John Stewart Bell proposed a way to experimentally verify whether Einstein was right. Bell formulated a series of mathematical inequalities that must be satisfied if the principle of local realism holds (that is, if both the principle of locality and that of realism hold together).\nBell’s brilliant idea was to find a measurable quantity that:\nIf quantum mechanics is correct, violates the inequalities If there exists a “local hidden variables” theory (as Einstein maintained), respects the inequalities This work, however, was entirely mathematical in nature. The brilliance of the physicists who came after (and for which the 2022 Nobel was ultimately recognized) was to design and carry out experiments to implement it in the real world.\n4.2. The CHSH test One of the most used formulations of Bell’s inequalities is the CHSH test (from Clauser, Horne, Shimony, and Holt), which takes its name from the four physicists who proposed it in 1969.\nThe experiment involves:\nA source that produces entangled particle pairs (for example, polarized photons) The usual “Alice” and “Bob” from all physics experiments, who can choose between two possible measurements to perform Measuring the correlations between the results obtained by Alice and Bob More formally:\nAlice can choose to measure according to angle $a_0$ or $a_1$ Bob can choose to measure according to angle $b_0$ or $b_1$ Each measurement produces a result +1 or -1 The CHSH quantity is then defined:\n$$S = E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)$$\nwhere $E(a_i, b_j)$ is the correlation between Alice’s and Bob’s measurements.\n4.2.1. Non-commutative quantities In the CHSH test, Alice and Bob measure photon polarization according to different angles, but similar experiments can be done with other physical quantities, such as the spin of electrons (also in an entangled state).\nIn any case, the experiment only works if the measured quantities are of a non-commutative nature.\nIn classical physics, if we want to measure two properties of an object (for example, its position and its velocity), we can do so in any order and always get the same results. The order of measurements doesn’t matter.\nIn quantum mechanics, however, there exist pairs of physical quantities for which the order of measurements is important. When we measure A first and then B, we get different results compared to when we measure B first and then A. Mathematically, this is expressed by saying that the corresponding operators don’t commute:\n$$\\hat{A}\\hat{B} \\neq \\hat{B}\\hat{A}$$\nNon-commutativity is closely linked to Heisenberg’s uncertainty principle.\nThe most famous examples of non-commutative quantities are:\nPosition and momentum: Heisenberg’s uncertainty principle derives precisely from the non-commutativity of these two quantities Spin components along different axes: measuring spin along the x-axis and then along the y-axis gives different results compared to the inverse order Photon polarization according to different angles: precisely what we measure in the CHSH test In our experiment, when Alice measures polarization according to angle $a_0 = 0°$ and Bob according to $b_0 = 45°$, they are measuring non-commutative quantities because they’re associated with the same entangled system.\nTypical configuration of a CHSH experiment. A source produces entangled particle pairs that are sent to two spatially separated observers (Alice and Bob). Each observer can choose between two possible measurement angles (for example, polarizers oriented at 0° or 45° for Alice and 22.5° or 67.5° for Bob). The measurement results (+1 or -1) received by the 4 detectors are then used to calculate the CHSH quantity $S$.\nSource: wikipedia According to “orthodox” quantum mechanics, we can summarize that:\nWe cannot simultaneously know both polarizations with absolute certainty The first measurement influences the second: if Alice measures first, Bob’s result will be influenced by the wave function collapse caused by Alice’s measurement There are no “pre-existing values” for both polarizations: properties manifest only at the moment of measurement Conversely, hidden variable theories assume that each particle carries a “hidden instruction” that predetermines the result for every possible measurement angle. But if quantities don’t commute, there cannot simultaneously exist predetermined values for all possible measurements.\nBell’s genius was realizing that this difference between the classical world (where all quantities commute) and the quantum one (where some quantities don’t commute) translates into a measurable difference in statistical correlations over a sufficiently large sample of measurements.\nAccording to local realism: $|S| \\leq 2$ According to quantum mechanics: $|S|$ can reach up to $2\\sqrt{2} \\approx 2.828$ But why these limits? Let’s try to understand with an intuitive analogy.\n4.2.1.1. The local realism reasoning (the limit of 2) Imagine that each pair of entangled particles carries a hidden “instruction sheet” that predetermines the result for every possible measurement angle. This sheet contains 4 predetermined values:\n$A_0$: Alice’s result if measuring according to $a_0$ (can be +1 or -1) $A_1$: Alice’s result if measuring according to $a_1$ (can be +1 or -1) $B_0$: Bob’s result if measuring according to $b_0$ (can be +1 or -1) $B_1$: Bob’s result if measuring according to $b_1$ (can be +1 or -1) For each single pair of particles, we can calculate:\n$$S_{\\text{single}} = A_0 B_0 + A_0 B_1 + A_1 B_0 - A_1 B_1$$\nLet’s do a concrete example. Suppose a particular pair has:\n$A_0 = +1$, $A_1 = -1$, $B_0 = +1$, $B_1 = +1$ Then: $$S = (+1)(+1) + (+1)(+1) + (-1)(+1) - (-1)(+1) = 1 + 1 - 1 + 1 = 2$$\nLet’s try another combination:\n$A_0 = +1$, $A_1 = +1$, $B_0 = +1$, $B_1 = -1$ $$S = (+1)(+1) + (+1)(-1) + (+1)(+1) - (+1)(-1) = 1 - 1 + 1 + 1 = 2$$\nWe can rewrite $S$ as: $$S = A_0(B_0 + B_1) + A_1(B_0 - B_1)$$\nNow observe that:\nIf $B_0 = B_1$, then $(B_0 + B_1) = \\pm 2$ and $(B_0 - B_1) = 0$, so $S = \\pm 2A_0$, i.e., $|S| = 2$ If $B_0 = -B_1$, then $(B_0 + B_1) = 0$ and $(B_0 - B_1) = \\pm 2$, so $S = \\pm 2A_1$, i.e., $|S| = 2$ In both cases, for a single pair with predetermined values, we always get $|S| = 2$\nWhen we make many measurements and calculate the average of the correlations $E(a_i, b_j)$, we’re averaging over all possible combinations of hidden instructions. But since each single pair gives $|S| = 2$, the average can never exceed this value:\n$$|S| = |E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)| \\leq 2$$\nThis is therefore the classical limit and is valid for any local hidden variable theory.\n4.2.1.2. The quantum reasoning (the limit of 2√2) In quantum mechanics, instead, predetermined values don’t exist. The particles are in an entangled Bell state:\n$$|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$$\nWhen Alice and Bob measure according to different angles, the correlations depend on the angular difference $\\theta$ between their measurement directions according to the formula:\n$$E(\\theta) = \\cos(2\\theta)$$\nFor the optimal angles of the CHSH test:\n$a_0 = 0°$, $a_1 = 45°$ $b_0 = 22.5°$, $b_1 = -22.5°$ With these angles:\n$E(a_0, b_0) = \\cos(2 \\times 22.5°) = \\cos(45°) = \\frac{1}{\\sqrt{2}}$ $E(a_0, b_1) = \\cos(2 \\times 22.5°) = \\cos(45°) = \\frac{1}{\\sqrt{2}}$ $E(a_1, b_0) = \\cos(2 \\times 22.5°) = \\cos(45°) = \\frac{1}{\\sqrt{2}}$ $E(a_1, b_1) = \\cos(2 \\times 67.5°) = \\cos(135°) = -\\frac{1}{\\sqrt{2}}$ Therefore: $$S = \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} - \\left(-\\frac{1}{\\sqrt{2}}\\right) = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2} \\approx 2.828$$\nThis instead is Tsirelson’s bound and is the maximum theoretical value predicted by quantum mechanics.\nℹ️ Note to better understand what we mean by “measurement angles” and how correlations are calculated in quantum mechanics, I did a little deep-dive in section 6.5. 4.2.1.3. Where does this difference come from? The fundamental difference is this:\nLocal realism: assumes that each particle has 4 defined properties simultaneously ($A_0, A_1, B_0, B_1$), even if we only measure one. This assumption limits the possible correlations.\nQuantum mechanics: properties don’t exist before measurement. Particles are in superposition and the measurement angle determines the “basis” onto which we project the state. This allows stronger correlations.\nAn analogy: it’s as if in the classical case each particle carried with it 4 already-flipped coins (but covered), while in the quantum case the coins are flipped only when we uncover them, and the way we uncover Alice’s instantly influences the probabilities for Bob’s, even if they’re far apart.\n4.3. The experiments that earned the 2022 Nobel Starting from the 1970s, a series of experiments based on Bell’s theoretical framework and particularly on the CHSH test unequivocally demonstrated that Bell’s inequalities are violated exactly as predicted by the theoretical framework of quantum mechanics, confirming that local realism cannot be maintained:\n1972 - John Clauser: first experiment that violated Bell’s inequalities using polarized photons 1982 - Alain Aspect: more refined experiments that eliminated various possible “loopholes” 1998-2015 - Anton Zeilinger: experiments with entanglement over increasingly greater distances, eventually demonstrating quantum teleportation In 2022, these three physicists received the Nobel Prize in Physics precisely for these pioneering experiments.\n4.3.1. The “loopholes” and how they were eliminated Despite Clauser’s first experiments in the 1970s having violated Bell’s inequalities, some possible technical objections remained that could have allowed a supporter of local realism to doubt the results. These objections are called loopholes, and much of the subsequent experimental work focused on eliminating them one by one.\n4.3.1.1. Locality Loophole The problem: In the first experiments, Alice’s and Bob’s measurements weren’t sufficiently separated in spacetime. In theory, a classical signal (traveling at or below the speed of light) could have traveled from one detector to the other, influencing the result without the experimental apparatus being able to detect it.\nAlain Aspect’s solution (1982): Aspect introduced a system of ultrafast switching of measurement angles:\nMeasurement angles were randomly changed during photon flight The change occurred so quickly that no subluminal signal could travel from one detector to the other This guaranteed the spacelike separation of measurements These modifications were implemented so that the time interval between production and detection was 20 ns, while the channel switches inverted orientation asynchronously every 10 ns, keeping the various sections sufficiently far apart to guarantee spacelike distances between them. This ensures that Alice’s measurement event is causally disconnected from Bob’s.\n4.3.1.2. Fair Sampling Loophole The problem: No detector is 100% perfect. In early photon experiments, only a small fraction of produced particle pairs was actually detected and measured. In Clauser’s experiments, for example, detection efficiency was less than 5%.\nThis opens up a possible objection: how can we be sure that the particle pairs actually detected are a representative sample of all pairs produced?\nA supporter of local realism could argue that:\nParticles carry “hidden instructions” that determine both the measurement result and the probability of being detected Particles with certain combinations of hidden instructions have a higher probability of being detected than others The observed sample is therefore biased, and measured correlations don’t reflect the true correlations of the complete set In other words, it’s as if we did a political poll by only interviewing people who answer the phone: the sample might not be representative of the general population.\nMathematically, this objection works because the proof of Bell’s Inequalities assumes all produced pairs are measured. If we can only measure a subset, and this subset isn’t randomly chosen but depends on hidden variables, then the inequalities could be violated even in a local hidden variable theory.\nThe fair sampling assumption: For many years, experiments relied on the fair sampling assumption, which assumes that detected particles are a representative random sample. This assumption is reasonable from a physics standpoint, but it’s not a rigorous proof.\nThe solution: To completely eliminate this loophole, you need to achieve detection efficiency above a critical threshold. For the CHSH test, this threshold is about 82.8% (more precisely, $\\eta \u003e 2/3 \\approx 66.7%$ for optimal configurations, but in practice you need higher efficiency to account for other factors).\nThis goal was very difficult to achieve and required decades of technological progress:\nFirst solution - Trapped ions (2000s):\nIons (charged atoms trapped in electromagnetic fields) are much more controllable than photons They can be kept in precise positions and measured with very high efficiency (\u003e90%) Pioneering experiments by Rowe et al. (2001) and Matsukevich et al. (2008) achieved efficiencies above the critical threshold Disadvantage: ions are difficult to spatially separate, making it more complicated to simultaneously close the locality loophole Second solution - Superconducting detectors for photons (2010s):\nSuperconducting nanowire single-photon detectors (SNSPDs) revolutionized photon detection They operate at cryogenic temperatures (near absolute zero) They achieve 75-98% efficiency in the infrared band They allow using photons (easily separable over large distances) while maintaining high detection efficiency Third solution - Neutral atoms and color centers:\nColor centers in diamond (like NV centers - nitrogen-vacancy): defects in the diamond crystal structure that behave like single quantum systems Trapped neutral atoms: atoms cooled with lasers and trapped in optical tweezers Combine the advantages of both approaches: high efficiency and possibility of spatial separation ℹ️ Note Why this 82.8% threshold?: This percentage derives from mathematical analysis of the CHSH test. With lower efficiency, it’s possible to construct a local hidden variable model that reproduces the observed statistics by precisely exploiting unfair sampling. Above this threshold, instead, it becomes mathematically impossible to explain the results with local realism, even assuming the worst possible case of sampling bias. 4.3.1.3. Freedom-of-Choice Loophole The problem: How are measurement angles chosen for Alice and Bob? If the choice isn’t truly random but is somehow correlated with the particles’ “hidden instructions,” then the results could be explained with local realism.\nThis objection may seem strange, but from a logical point of view it’s valid: if the universe is deterministic, then even the “random” choice of angle could be predetermined by the same hidden variables that determine the measurement result!\nThe solution: Use sources of randomness that are as “free” as possible:\nQuantum random number generators (QRNG): exploit intrinsically random quantum processes\nLight from distant stars (Zeilinger’s experiments, 2017): they used light coming from stars thousands of light-years away to decide measurement angles. This way, the “hidden instructions” would have had to be correlated with events that, at least as a first approximation, we can assume to be causally disconnected from the entangled particles.\nHuman participation: in an experiment called “The BIG Bell Test” (2016), thousands of people around the world chose measurement angles through an online video game\n4.3.1.4. Memory Loophole The problem: If particle pairs are measured in sequence and results are accumulated over time, there could be spurious correlations due to variations in the experimental apparatus.\nThe solution: Ensure the apparatus is stable over time or, even better, complete the experiment in such a short time as to exclude instrumental drift.\n4.3.1.5. “Loophole-free” experiments The real milestone was reached in 2015, when three independent groups succeeded in carrying out experiments that closed simultaneously all the main loopholes:\nDelft (Netherlands) - Hensen et al.: used two color centers in diamond (defects in the crystal structure) separated by 1.3 km, connected via entanglement\n✓ Locality loophole closed (distance 1.3 km) ✓ Detection loophole closed (efficiency \u003e 90%) Vienna (Austria) - Giustina et al.: used entangled photons with superconducting detectors\n✓ Locality loophole closed ✓ Detection loophole closed (75% efficiency) Boulder, Colorado (USA) - Shalm et al.: used entangled photons separated by 185 meters\n✓ Locality loophole closed ✓ Detection loophole closed (75% efficiency) These experiments definitively demonstrated that it’s not possible to save local realism: nature truly violates Bell’s inequalities, and it’s not an experimental artifact.\n4.3.1.6. Are there still open loopholes? From a practical point of view, no: modern experiments are convincing beyond any reasonable doubt. However, from a philosophical point of view, there still exists an extremely speculative theoretical “loophole”:\nThis is the so-called Superdeterminism: the hypothesis that everything in the universe is predetermined from the Big Bang, including experimenters’ choices and measurement results. In this extreme scenario, free will wouldn’t exist even in an operational sense. This position is considered by most physicists to be a non-falsifiable hypothesis and therefore not scientific.\nIn conclusion, scientific consensus is unanimous: Bell’s inequalities are violated, local realism is incompatible with nature, and the experiments that demonstrated it fully deserved the 2022 Nobel Prize.\n5. The basics of Quantum Computing 5.1. Qubits and quantum gates In quantum computing, information is encoded in qubits instead of classical bits. Qubits can be physically implemented in various ways: electron spin, polarized photons, energy states of trapped atoms, etc.\nOperations on qubits are performed through quantum gates, which are the analog of classical logic gates (AND, OR, NOT, etc.). The most common quantum gates are:\nX gate: similar to classical NOT, swaps states |0⟩ and |1⟩ H gate (Hadamard): creates an equiprobable superposition between |0⟩ and |1⟩ CNOT gate: two-qubit gate that inverts the second qubit if the first is |1⟩ Rotation gates: allow manipulating the qubit state with precision 5.2. Quantum circuits A quantum program is represented as a quantum circuit, a sequence of quantum gates applied to one or more qubits. Unlike classical circuits, quantum circuits are reversible (except for measurement, which is irreversible).\nTo create entanglement between two qubits, typically a combination of Hadamard and CNOT gates is used:\nApply an H gate to the first qubit to create superposition Apply a CNOT gate using the first qubit as control and the second as target This creates a Bell state, completely entangled.\nq0: ──H──■── │ q1: ─────X── 5.3. Quantum Computing platforms Today there are several platforms that allow running real programs on actual quantum computers, including for example:\nIBM Quantum Experience: allows free access to IBM’s real quantum computers Amazon Braket: AWS’s quantum computing service Google Quantum AI: Google’s quantum computing platform Local simulators: libraries like Qiskit, Cirq, Q# allow simulating quantum circuits on your own computer 6. Let’s do the experiment 6.1. Experiment setup We can reproduce the CHSH test using a real quantum computer or a simulator. We’ll use two qubits in an entangled state and measure correlations according to different configurations.\nNecessary ingredients: A quantum computing platform (Qiskit, IBM Quantum, etc.) Two qubits Quantum circuits to create entanglement and perform rotations 6.2. The quantum circuit The basic circuit for the CHSH test is as follows:\nfrom qiskit import QuantumCircuit, QuantumRegister, ClassicalRegister # Create 2 qubits and 2 classical bits for measurements qr = QuantumRegister(2, 'q') cr = ClassicalRegister(2, 'c') qc = QuantumCircuit(qr, cr) # Step 1: Create an entangled Bell state qc.h(qr[0]) # Hadamard on first qubit qc.cx(qr[0], qr[1]) # CNOT to create entanglement # Step 2: Apply rotations for Alice and Bob # (angles depend on which configuration we want to test) qc.ry(theta_a, qr[0]) # Rotation for Alice qc.ry(theta_b, qr[1]) # Rotation for Bob # Step 3: Measure qc.measure(qr, cr) For the optimal CHSH test, the angles must be:\n$a_0 = 0°$, $a_1 = 45°$ (for Alice) $b_0 = 22.5°$, $b_1 = -22.5°$ (for Bob) ℹ️ Note obviously, the measurement must be repeated a certain number of times (shots) to obtain statistically significant samples on which to apply the CHSH formula. 6.3. Complete code from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator import numpy as np def create_chsh_circuit(theta_a, theta_b): \"\"\"Create a circuit for the CHSH test with specific angles\"\"\" qc = QuantumCircuit(2, 2) # Create entangled state qc.h(0) qc.cx(0, 1) # Rotations for Alice and Bob qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) # Measure qc.measure([0, 1], [0, 1]) return qc def compute_correlation(theta_a, theta_b, shots=8192): \"\"\"Calculate the correlation E(a,b) for given angles\"\"\" qc = create_chsh_circuit(theta_a, theta_b) # Execute the circuit simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() # Calculate correlation correlation = 0 for outcome, count in counts.items(): # +1 if bits are equal, -1 if different parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation # Optimal angles for CHSH test (in radians) a0, a1 = 0, np.pi/4 b0, b1 = np.pi/8, -np.pi/8 # Calculate the 4 correlations E_a0_b0 = compute_correlation(a0, b0) E_a0_b1 = compute_correlation(a0, b1) E_a1_b0 = compute_correlation(a1, b0) E_a1_b1 = compute_correlation(a1, b1) # Calculate the CHSH value S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 print(f\"E(a0, b0) = {E_a0_b0:.3f}\") print(f\"E(a0, b1) = {E_a0_b1:.3f}\") print(f\"E(a1, b0) = {E_a1_b0:.3f}\") print(f\"E(a1, b1) = {E_a1_b1:.3f}\") print(f\"\\nCHSH value S = {S:.3f}\") print(f\"Classical limit: |S| ≤ 2\") print(f\"Quantum limit: |S| ≤ 2√2 ≈ 2.828\") if abs(S) \u003e 2: print(f\"\\n✓ Bell's inequalities are VIOLATED!\") print(f\" Einstein was wrong: local realism is incompatible with the results.\") else: print(f\"\\n✗ Bell's inequalities are respected.\") 6.4. Expected results Running the code above, we should get an S value close to $2\\sqrt{2} \\approx 2.828$, thus violating Bell’s inequalities.\nIn practice, due to noise and imperfections of real quantum computers, we might get slightly lower values, but still above 2, demonstrating the violation of local realism.\n6.5. Meaning of angles and Bloch sphere To really understand what we’re doing when we choose these specific angles in the CHSH test, we can introduce a fairly intuitive tool often used in quantum mechanics: the Bloch sphere.\n6.5.1. The Bloch sphere The Bloch sphere is a geometric representation of the state of a single qubit. Each point on the sphere’s surface represents a pure quantum state. The two poles of the sphere represent the basis states:\nNorth pole: state $|0\\rangle$ South pole: state $|1\\rangle$ The general state of a qubit can be written as: $$|\\psi\\rangle = \\cos(\\theta/2)|0\\rangle + e^{i\\phi}\\sin(\\theta/2)|1\\rangle$$\nwhere:\n$\\theta$ is the polar angle (from 0° at the north pole to 180° at the south pole) $\\phi$ is the azimuthal angle (rotation around the z-axis) What does “measuring according to an angle” mean? Imagine the polarizer as an orientable filter: you can decide in which direction to orient it to measure the photon’s polarization.\nPhysical example with polarizers:\nAlice orients her polarizer to $a_0 = 0°$ (vertical): she’s asking “is the photon polarized vertically or horizontally?” Alice orients her polarizer to $a_1 = 45°$ (diagonal): she’s asking “is the photon polarized at 45° or at 135°?” Each polarizer orientation angle corresponds to a different question we ask the photon.\nIn quantum computing: Since quantum computers can only measure in the standard basis (called Z basis: $|0\\rangle$ and $|1\\rangle$), to measure according to a different angle we must:\nRotate the qubit’s state by the desired angle Measure in the standard basis The result is equivalent to having measured in the rotated basis In practice, in the code we use the gate ry(2*θ) before measurement. The factor 2 is a mathematical convention of the Bloch sphere (physical angles are doubled in the mathematical representation).\n6.5.2. The optimal angles of the CHSH test The optimal angles to maximize Bell inequality violation are:\nAlice: $a_0 = 0°$ and $a_1 = 45°$ Bob: $b_0 = 22.5°$ and $b_1 = -22.5°$ These angles are arranged symmetrically and form a specific pattern on the Bloch sphere. The key is that:\nAlice’s measurement directions ($a_0$ and $a_1$) are separated by 45° Bob’s measurement directions ($b_0$ and $b_1$) are separated by 45° (from -22.5° to +22.5°) $b_0 = 22.5°$ is exactly halfway between $a_0$ and $a_1$ $b_1 = -22.5°$ is symmetric to $b_0$ with respect to the a₀ axis The configuration creates a symmetric arrangement where:\nThe angular difference between $a_0$ and $b_0$ is 22.5° The angular difference between $a_0$ and $b_1$ is 22.5° (in absolute value) The angular difference between $a_1$ and $b_0$ is 22.5° The angular difference between $a_1$ and $b_1$ is 67.5° This symmetry, with three differences of 22.5° and one of 67.5°, maximizes the quantum correlations that violate Bell’s inequalities.\n6.5.3. Visualization of optimal angles 6.5.3.1. Interactive version (Plotly - for Jupyter Notebook) For an interactive visualization of optimal angles within the Bloch sphere, you can use this code based on Plotly (ideal for Jupyter Notebook):\nimport numpy as np import plotly.graph_objects as go def angle_to_bloch_vector(theta, phi=0): \"\"\"Convert angles (theta, phi) to a vector on the Bloch sphere\"\"\" theta_rad = np.radians(theta) phi_rad = np.radians(phi) x = np.sin(theta_rad) * np.cos(phi_rad) y = np.sin(theta_rad) * np.sin(phi_rad) z = np.cos(theta_rad) return x, y, z def create_sphere_mesh(): \"\"\"Create mesh for Bloch sphere\"\"\" u = np.linspace(0, 2 * np.pi, 50) v = np.linspace(0, np.pi, 50) x = np.outer(np.cos(u), np.sin(v)) y = np.outer(np.sin(u), np.sin(v)) z = np.outer(np.ones(np.size(u)), np.cos(v)) return x, y, z def plot_interactive_bloch_sphere(): \"\"\"Create an interactive visualization of the Bloch sphere with CHSH angles\"\"\" fig = go.Figure() # Add Bloch sphere x_sphere, y_sphere, z_sphere = create_sphere_mesh() fig.add_trace(go.Surface( x=x_sphere, y=y_sphere, z=z_sphere, opacity=0.15, colorscale=[[0, 'lightgray'], [1, 'lightgray']], showscale=False, hoverinfo='skip' )) # Add coordinate axes axis_length = 1.3 # X axis fig.add_trace(go.Scatter3d( x=[-axis_length, axis_length], y=[0, 0], z=[0, 0], mode='lines', line=dict(color='darkgray', width=3, dash='dash'), showlegend=False, hoverinfo='skip' )) fig.add_trace(go.Scatter3d( x=[axis_length*1.05], y=[0], z=[0], mode='text', text=['X'], textfont=dict(size=18, color='darkgray'), showlegend=False, hoverinfo='skip' )) # Y axis fig.add_trace(go.Scatter3d( x=[0, 0], y=[-axis_length, axis_length], z=[0, 0], mode='lines', line=dict(color='darkgray', width=3, dash='dash'), showlegend=False, hoverinfo='skip' )) fig.add_trace(go.Scatter3d( x=[0], y=[axis_length*1.05], z=[0], mode='text', text=['Y'], textfont=dict(size=18, color='darkgray'), showlegend=False, hoverinfo='skip' )) # Z axis fig.add_trace(go.Scatter3d( x=[0, 0], y=[0, 0], z=[-axis_length, axis_length], mode='lines', line=dict(color='black', width=3, dash='dash'), showlegend=False, hoverinfo='skip' )) # Labels |0⟩ and |1⟩ for z_pos, label in [(axis_length*1.05, '|0⟩'), (-axis_length*1.05, '|1⟩')]: fig.add_trace(go.Scatter3d( x=[0], y=[0], z=[z_pos], mode='text', text=[label], textfont=dict(size=20, color='black'), showlegend=False )) # Optimal CHSH angles alice_angles = [0, 45] bob_angles = [22.5, -22.5] colors_alice = ['red', 'darkred'] colors_bob = ['blue', 'darkblue'] labels_alice = ['a₀ (0°)', 'a₁ (45°)'] labels_bob = ['b₀ (22.5°)', 'b₁ (-22.5°)'] # Add Alice's vectors for i, angle in enumerate(alice_angles): x, y, z = angle_to_bloch_vector(angle, phi=0) fig.add_trace(go.Scatter3d( x=[0, x], y=[0, y], z=[0, z], mode='lines+markers', line=dict(color=colors_alice[i], width=8), marker=dict(size=[0, 10]), name=labels_alice[i], hovertemplate=f'{labels_alice[i]}' )) fig.add_trace(go.Scatter3d( x=[x*1.25], y=[y*1.25], z=[z*1.25], mode='text', text=[labels_alice[i]], textfont=dict(size=14, color=colors_alice[i]), showlegend=False )) # Add Bob's vectors for i, angle in enumerate(bob_angles): x, y, z = angle_to_bloch_vector(angle, phi=0) fig.add_trace(go.Scatter3d( x=[0, x], y=[0, y], z=[0, z], mode='lines+markers', line=dict(color=colors_bob[i], width=8), marker=dict(size=[0, 10]), name=labels_bob[i], hovertemplate=f'{labels_bob[i]}' )) fig.add_trace(go.Scatter3d( x=[x*1.25], y=[y*1.25], z=[z*1.25], mode='text', text=[labels_bob[i]], textfont=dict(size=14, color=colors_bob[i]), showlegend=False )) # Layout fig.update_layout( title='Interactive Bloch Sphere: Optimal CHSH Angles\n' + 'Rotate with mouse • Zoom with wheel • Pan with Shift+drag', scene=dict( xaxis=dict(showbackground=False, showticklabels=False, title=''), yaxis=dict(showbackground=False, showticklabels=False, title=''), zaxis=dict(showbackground=False, showticklabels=False, title=''), aspectmode='cube', camera=dict(eye=dict(x=1.5, y=1.5, z=1.2)) ), height=700, showlegend=True ) return fig # Create and show interactive graph fig = plot_interactive_bloch_sphere() fig.show() # Optional: save as interactive HTML # fig.write_html(\"bloch_sphere_interactive.html\") 6.5.4. Graph interpretation Bloch Sphere (3D and 2D): The geometric arrangement of measurement angles. Note the symmetry of the configuration: $b_0$ (22.5°) is positioned exactly halfway between $a_0$ (0°) and $a_1$ (45°), while $b_1$ (-22.5°) is symmetric with respect to the origin.\nCorrelation vs Angular Difference: Shows how quantum correlation $E(\\theta) = \\cos(2\\theta)$ depends on angular difference. CHSH angles are chosen to obtain specific correlation values that maximize S. CHSH value optimization: Visually demonstrates that the configuration with $a_1 = 45°$ (and consequently $b_0 = 22.5°$, $b_1 = -22.5°$) effectively maximizes the violation of Bell’s inequalities. In the CHSH experiment, measurement directions are symmetrically arranged to maximally exploit quantum correlations allowed by entanglement, exceeding the classical limit of 2 and reaching Tsirelson’s bound of $2\\sqrt{2}$.\n6.6. What does this result mean? Bell inequality violation tells us that:\nThere cannot exist a description of the physical world that satisfies the principles of locality and realism.\nIn other words:\nEither “actions at a distance” exist that allow entangled particles to “communicate” instantaneously (violation of locality) Or physical properties don’t exist before measurement but are created by the act of observation itself (violation of realism) Most physicists today accept the interpretation that it’s realism that’s violated, while locality is preserved (although in a subtle way).\n6.7. Other interactive experiments Now that we’ve seen the basic CHSH test, let’s explore some additional experiments that help us better understand Bell inequality violation and the differences between quantum mechanics and local realism.\n6.7.1. Variation of CHSH value with angles This experiment shows how the CHSH value varies as Alice’s angle $a_1$ varies, keeping other angles fixed. It allows us to graphically see why 45° is the optimal angle.\nimport numpy as np import matplotlib.pyplot as plt from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator def compute_chsh_value(a0, a1, b0, b1, shots=8192): \"\"\"Calculate CHSH value for a given angle configuration\"\"\" def compute_correlation(theta_a, theta_b): qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation E_a0_b0 = compute_correlation(a0, b0) E_a0_b1 = compute_correlation(a0, b1) E_a1_b0 = compute_correlation(a1, b0) E_a1_b1 = compute_correlation(a1, b1) S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 return S, (E_a0_b0, E_a0_b1, E_a1_b0, E_a1_b1) # Vary angle a1 from 0 to 90 degrees a1_values = np.linspace(0, np.pi/2, 20) s_values_quantum = [] s_values_classical = 2 * np.ones_like(a1_values) # Classical limit print(\"Calculating CHSH values for different angles...\") for a1 in a1_values: # Fixed angles a0 = 0 b0 = a1 / 2 # Optimal: halfway between a0 and a1 b1 = -a1 / 2 # Symmetric with respect to a0 S, _ = compute_chsh_value(a0, a1, b0, b1, shots=4096) s_values_quantum.append(S) print(f\"a1 = {np.degrees(a1):.1f}°, S = {S:.3f}\") # Graph plt.figure(figsize=(12, 6)) plt.plot(np.degrees(a1_values), s_values_quantum, 'b-o', linewidth=2, markersize=6, label='Quantum Simulation') plt.axhline(y=2, color='r', linestyle='--', linewidth=2, label='Classical Limit (|S| ≤ 2)') plt.axhline(y=2*np.sqrt(2), color='g', linestyle='--', linewidth=2, label=f'Tsirelson Bound (2√2 ≈ {2*np.sqrt(2):.3f})') plt.axvline(x=45, color='orange', linestyle=':', linewidth=2, label='Optimal angle (45°)') plt.xlabel('Angle a₁ (degrees)', fontsize=12) plt.ylabel('CHSH Value (S)', fontsize=12) plt.title('Bell Inequality Violation as Angle Varies', fontsize=14, fontweight='bold') plt.legend(fontsize=10) plt.grid(True, alpha=0.3) plt.ylim([0, 3]) plt.tight_layout() plt.savefig('chsh_angle_variation.png', dpi=300, bbox_inches='tight') plt.show() print(f\"\\n{'='*50}\") print(f\"Maximum violation at 45°: S ≈ {max(s_values_quantum):.3f}\") print(f\"Theoretical limit: 2√2 ≈ {2*np.sqrt(2):.3f}\") print(f\"{'='*50}\") Expected result: The graph shows that maximum violation occurs precisely at 45°, where S reaches about 2.828.\n6.7.2. Quantum vs classical comparison: correlation heatmap This experiment visualizes quantum and classical correlations as heatmaps, allowing us to clearly see the difference.\nimport numpy as np import matplotlib.pyplot as plt from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator def compute_quantum_correlation(theta_a, theta_b, shots=8192): \"\"\"Calculate quantum correlation for two angles\"\"\" qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation def compute_classical_correlation(theta_diff): \"\"\" Maximum classical correlation possible for an angular difference. With local hidden variables, maximum correlation is limited. \"\"\" # Classical model: linearly decreasing correlation return 1 - 2 * abs(theta_diff) / (np.pi/2) # Angle grid angles = np.linspace(0, np.pi/2, 12) angles_deg = np.degrees(angles) # Matrices for correlations quantum_corr = np.zeros((len(angles), len(angles))) classical_corr = np.zeros((len(angles), len(angles))) print(\"Calculating quantum and classical correlations...\") for i, theta_a in enumerate(angles): for j, theta_b in enumerate(angles): # Quantum correlation quantum_corr[i, j] = compute_quantum_correlation(theta_a, theta_b, shots=2048) # Theoretical classical correlation theta_diff = abs(theta_a - theta_b) classical_corr[i, j] = compute_classical_correlation(theta_diff) print(f\"Progress: {i+1}/{len(angles)}\") # Visualization fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(18, 5)) # Quantum heatmap im1 = ax1.imshow(quantum_corr, cmap='RdBu_r', aspect='auto', vmin=-1, vmax=1, origin='lower') ax1.set_xlabel('Bob Angle (degrees)', fontsize=11) ax1.set_ylabel('Alice Angle (degrees)', fontsize=11) ax1.set_title('Quantum Correlations\\n(Simulation)', fontsize=12, fontweight='bold') ax1.set_xticks(range(len(angles_deg))) ax1.set_yticks(range(len(angles_deg))) ax1.set_xticklabels([f'{a:.0f}' for a in angles_deg], rotation=45) ax1.set_yticklabels([f'{a:.0f}' for a in angles_deg]) plt.colorbar(im1, ax=ax1, label='Correlation E(a,b)') # Classical heatmap im2 = ax2.imshow(classical_corr, cmap='RdBu_r', aspect='auto', vmin=-1, vmax=1, origin='lower') ax2.set_xlabel('Bob Angle (degrees)', fontsize=11) ax2.set_ylabel('Alice Angle (degrees)', fontsize=11) ax2.set_title('Classical Correlations\\n(Local Hidden Variables)', fontsize=12, fontweight='bold') ax2.set_xticks(range(len(angles_deg))) ax2.set_yticks(range(len(angles_deg))) ax2.set_xticklabels([f'{a:.0f}' for a in angles_deg], rotation=45) ax2.set_yticklabels([f'{a:.0f}' for a in angles_deg]) plt.colorbar(im2, ax=ax2, label='Correlation E(a,b)') # Difference difference = quantum_corr - classical_corr im3 = ax3.imshow(difference, cmap='seismic', aspect='auto', vmin=-0.5, vmax=0.5, origin='lower') ax3.set_xlabel('Bob Angle (degrees)', fontsize=11) ax3.set_ylabel('Alice Angle (degrees)', fontsize=11) ax3.set_title('Difference\\n(Quantum - Classical)', fontsize=12, fontweight='bold') ax3.set_xticks(range(len(angles_deg))) ax3.set_yticks(range(len(angles_deg))) ax3.set_xticklabels([f'{a:.0f}' for a in angles_deg], rotation=45) ax3.set_yticklabels([f'{a:.0f}' for a in angles_deg]) plt.colorbar(im3, ax=ax3, label='Difference') plt.tight_layout() plt.savefig('correlation_heatmaps.png', dpi=300, bbox_inches='tight') plt.show() print(\"\\nRed zones in the difference map show where\") print(\"quantum correlations exceed classical ones!\") Interpretation: The heatmaps show how quantum correlations (which follow $\\cos(2\\theta)$) differ significantly from classical ones, especially for intermediate angles.\n6.7.3. Interactive exploration of CHSH parameters This experiment creates a complete parametric analysis of the CHSH angle space.\nimport numpy as np import matplotlib.pyplot as plt from matplotlib.widgets import Slider from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator def compute_single_correlation(theta_a, theta_b, shots=4096): \"\"\"Calculate a single correlation\"\"\" qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation # 2D analysis: simultaneous variation of a1 and b0 a1_range = np.linspace(0, np.pi/2, 25) b0_range = np.linspace(0, np.pi/2, 25) S_matrix = np.zeros((len(a1_range), len(b0_range))) print(\"Exploring CHSH parameter space...\") print(\"This may take a few minutes...\\n\") for i, a1 in enumerate(a1_range): for j, b0 in enumerate(b0_range): a0 = 0 b1 = -b0 E_a0_b0 = compute_single_correlation(a0, b0, shots=2048) E_a0_b1 = compute_single_correlation(a0, b1, shots=2048) E_a1_b0 = compute_single_correlation(a1, b0, shots=2048) E_a1_b1 = compute_single_correlation(a1, b1, shots=2048) S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 S_matrix[i, j] = S if (i + 1) % 5 == 0: print(f\"Progress: {i+1}/{len(a1_range)}\") # 3D visualization fig = plt.figure(figsize=(16, 6)) # Subplot 1: 2D Heatmap ax1 = fig.add_subplot(121) im = ax1.contourf(np.degrees(b0_range), np.degrees(a1_range), S_matrix, levels=20, cmap='RdYlGn') ax1.contour(np.degrees(b0_range), np.degrees(a1_range), S_matrix, levels=[2.0], colors='red', linewidths=3, linestyles='--') ax1.plot(22.5, 45, 'b*', markersize=20, label='Optimal configuration') ax1.set_xlabel('Angle b₀ (degrees)', fontsize=12) ax1.set_ylabel('Angle a₁ (degrees)', fontsize=12) ax1.set_title('CHSH Value in Parameter Space', fontsize=13, fontweight='bold') ax1.legend(fontsize=10) ax1.grid(True, alpha=0.3) cbar = plt.colorbar(im, ax=ax1, label='S') cbar.ax.axhline(y=2, color='red', linewidth=2, linestyle='--') cbar.ax.text(1.5, 2, 'Classical limit', rotation=0, va='center', fontsize=9) # Subplot 2: 3D Surface ax2 = fig.add_subplot(122, projection='3d') B0, A1 = np.meshgrid(np.degrees(b0_range), np.degrees(a1_range)) surf = ax2.plot_surface(B0, A1, S_matrix, cmap='RdYlGn', alpha=0.9, edgecolor='none') # Classical limit plane xx, yy = np.meshgrid(np.degrees(b0_range), np.degrees(a1_range)) zz = 2 * np.ones_like(xx) ax2.plot_surface(xx, yy, zz, alpha=0.3, color='red') ax2.set_xlabel('Angle b₀ (degrees)', fontsize=10) ax2.set_ylabel('Angle a₁ (degrees)', fontsize=10) ax2.set_zlabel('CHSH Value (S)', fontsize=10) ax2.set_title('3D CHSH Surface', fontsize=13, fontweight='bold') ax2.view_init(elev=25, azim=45) fig.colorbar(surf, ax=ax2, shrink=0.5, aspect=5, label='S') plt.tight_layout() plt.savefig('chsh_parameter_space.png', dpi=300, bbox_inches='tight') plt.show() # Find maximum max_idx = np.unravel_index(np.argmax(S_matrix), S_matrix.shape) max_a1 = np.degrees(a1_range[max_idx[0]]) max_b0 = np.degrees(b0_range[max_idx[1]]) max_S = S_matrix[max_idx] print(f\"\\n{'='*50}\") print(f\"Optimal configuration found:\") print(f\" a₁ = {max_a1:.1f}°\") print(f\" b₀ = {max_b0:.1f}°\") print(f\" S = {max_S:.3f}\") print(f\"\\nOptimal theoretical value: a₁=45°, b₀=22.5°, S=2√2≈2.828\") print(f\"{'='*50}\") Result: This graph shows the “mountain” of the CHSH value in parameter space, with the peak precisely at the optimal configuration (45°, 22.5°).\n6.7.4. Simulation with realistic noise In the last experiment, we add noise to simulate imperfections of real quantum computers.\nimport numpy as np import matplotlib.pyplot as plt from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator from qiskit_aer.noise import NoiseModel, depolarizing_error, thermal_relaxation_error def create_noisy_simulator(error_rate=0.01, t1=50, t2=70): \"\"\" Create a simulator with realistic noise. Args: error_rate: probability of error per gate (depolarizing) t1: relaxation time T1 (microseconds) t2: decoherence time T2 (microseconds) \"\"\" noise_model = NoiseModel() # Depolarizing error on gates error_gate1 = depolarizing_error(error_rate, 1) error_gate2 = depolarizing_error(error_rate * 2, 2) # Add errors to gates noise_model.add_all_qubit_quantum_error(error_gate1, ['h', 'ry']) noise_model.add_all_qubit_quantum_error(error_gate2, ['cx']) # Thermal relaxation error # gate_times = {'h': 50, 'ry': 50, 'cx': 200, 'measure': 1000} # in nanoseconds # thermal_error = thermal_relaxation_error(t1*1000, t2*1000, gate_times['cx']) # noise_model.add_all_qubit_quantum_error(thermal_error, ['cx']) return noise_model def run_chsh_with_noise(error_rate, shots=8192): \"\"\"Execute CHSH test with a given noise level\"\"\" noise_model = create_noisy_simulator(error_rate=error_rate) simulator = AerSimulator(noise_model=noise_model) # Optimal angles a0, a1 = 0, np.pi/4 b0, b1 = np.pi/8, -np.pi/8 def compute_correlation(theta_a, theta_b): qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation E_a0_b0 = compute_correlation(a0, b0) E_a0_b1 = compute_correlation(a0, b1) E_a1_b0 = compute_correlation(a1, b0) E_a1_b1 = compute_correlation(a1, b1) S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 return S, (E_a0_b0, E_a0_b1, E_a1_b0, E_a1_b1) # Test with different noise levels error_rates = np.linspace(0, 0.10, 20) s_values_noisy = [] s_std = [] print(\"Simulation with realistic noise...\") print(\"This simulates imperfections of real quantum computers.\\n\") for error_rate in error_rates: # Run multiple times to estimate variance s_trials = [] for _ in range(5): S, _ = run_chsh_with_noise(error_rate, shots=4096) s_trials.append(S) s_values_noisy.append(np.mean(s_trials)) s_std.append(np.std(s_trials)) print(f\"Error rate: {error_rate*100:.1f}% → S = {np.mean(s_trials):.3f} ± {np.std(s_trials):.3f}\") # Visualization fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 6)) # Subplot 1: S vs Error Rate s_values_noisy = np.array(s_values_noisy) s_std = np.array(s_std) ax1.errorbar(error_rates * 100, s_values_noisy, yerr=s_std, fmt='o-', linewidth=2, markersize=8, capsize=5, color='blue', label='Simulation with noise') ax1.axhline(y=2, color='red', linestyle='--', linewidth=2, label='Classical limit (S=2)') ax1.axhline(y=2*np.sqrt(2), color='green', linestyle='--', linewidth=2, label=f'Ideal limit (S=2√2≈{2*np.sqrt(2):.3f})') ax1.fill_between(error_rates * 100, 2, s_values_noisy, where=(s_values_noisy \u003e 2), alpha=0.3, color='green', label='Violation zone') ax1.set_xlabel('Error rate per gate (%)', fontsize=12) ax1.set_ylabel('CHSH Value (S)', fontsize=12) ax1.set_title('Effect of Noise on Bell Violation', fontsize=13, fontweight='bold') ax1.legend(fontsize=10) ax1.grid(True, alpha=0.3) ax1.set_ylim([1.5, 3]) # Subplot 2: Violation vs Error Rate violation = s_values_noisy - 2 ax2.bar(error_rates * 100, violation, width=0.25, color=['green' if v \u003e 0 else 'red' for v in violation], alpha=0.7, edgecolor='black') ax2.axhline(y=0, color='black', linestyle='-', linewidth=1) ax2.set_xlabel('Error rate per gate (%)', fontsize=12) ax2.set_ylabel('Violation (S - 2)', fontsize=12) ax2.set_title('Margin of Bell Inequality Violation', fontsize=13, fontweight='bold') ax2.grid(True, alpha=0.3, axis='y') # Find critical point where S drops below 2 critical_idx = np.where(s_values_noisy \u003c 2)[0] if len(critical_idx) \u003e 0: critical_error = error_rates[critical_idx[0]] * 100 ax2.axvline(x=critical_error, color='red', linestyle=':', linewidth=2) ax2.text(critical_error, ax2.get_ylim()[1] * 0.8, f'Critical point\\n~{critical_error:.1f}%', ha='center', fontsize=10, bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5)) plt.tight_layout() plt.savefig('chsh_with_noise.png', dpi=300, bbox_inches='tight') plt.show() print(f\"\\n{'='*60}\") print(\"RESULTS:\") print(f\" - With 0% noise: S ≈ {s_values_noisy[0]:.3f} (ideal)\") print(f\" - With 1% noise: S ≈ {s_values_noisy[int(len(s_values_noisy)*0.2)]:.3f}\") print(f\" - With 3% noise: S ≈ {s_values_noisy[int(len(s_values_noisy)*0.6)]:.3f}\") if len(critical_idx) \u003e 0: print(f\" - Critical limit: ~{critical_error:.1f}% (S drops below 2)\") else: print(f\" - Violation persists up to {error_rates[-1]*100:.1f}%\") print(f\"{'='*60}\") Interpretation: This graph shows how delicate quantum computers are. Even small errors reduce Bell violation, but fortunately it takes a fairly high error (\u003e8%) before the violation completely disappears.\n7. Conclusions and philosophical reflections 7.1. Who was right? The Einstein-Bohr debate was one of the most fascinating in the history of physics. From a purely scientific point of view, we can say that Bohr was right: quantum mechanics is a complete and correct theory, and quantum phenomena cannot be explained with local hidden variable theories.\nEinstein’s fate was somewhat paradoxical: despite being recognized as one of the greatest physicists of all time, he was often misunderstood and isolated by the “mainstream” scientific community, both in the early phases of his career (with relativity) and in the final ones (with quantum mechanics).\nIn any case, I believe that the very formulation of the EPR problem, which then led to Bell’s studies, Aspect’s experiments, and those of many others, was once again an enormous contribution to physics and human knowledge.\n7.2. The nature of reality From a philosophical point of view, Bell’s experiments teach us something profound about the nature of reality:\nThe world is not made of “things” with defined properties that exist independently of observation Reality emerges from interaction between observed system and measurement apparatus We cannot completely separate the observer from the observed This doesn’t mean that reality “doesn’t exist” or that it’s purely subjective, but rather that our classical intuition about what it means to “exist” must be profoundly revised in light of quantum phenomena.\nIn a certain sense, what we identify as “reality” is an emergent construct and doesn’t transcend our interactions with the world.\nReferences Bell’s original article (1964) “ON THE EINSTEIN PODOLSKY ROSEN PARADOX” Nobel Prize 2022 - Announcement Qiskit Documentation IBM Quantum Experience Closing the Door on Einstein and Bohr’s Quantum Debate Simulating Bell’s inequalities with Qibo ","wordCount":"9252","inLanguage":"en","datePublished":"2025-10-12T00:00:00+02:00","dateModified":"2025-10-12T00:00:00+02:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/"},"publisher":{"@type":"Organization","name":"Cdani's Blog","logo":{"@type":"ImageObject","url":"https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://c-daniele.github.io/en/ accesskey=h title="Home (Alt + H)"><img src=https://c-daniele.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://c-daniele.github.io/it/ title=Italiano aria-label=Italiano>It</a></li></ul></div></div><ul id=menu><li><a href=https://c-daniele.github.io/en/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://c-daniele.github.io/en/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://c-daniele.github.io/en/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://c-daniele.github.io/en/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://c-daniele.github.io/en/>Home</a></div><h1 class=post-title>Bell's Inequalities: A quantum computing experiment with Qiskit</h1><div class=post-meta><span title='2025-10-12 00:00:00 +0200 +0200'>October 12, 2025</span>&nbsp;·&nbsp;44 min&nbsp;·&nbsp;9252 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/>It</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#11-intro-to-the-intro>1.1. Intro to the intro</a></li><li><a href=#12-the-real-intro>1.2. The real intro</a></li></ul><ul><li><a href=#21-einstein-and-quantum-mechanics>2.1. Einstein and quantum mechanics</a></li><li><a href=#22-what-is-reality>2.2. What is reality?</a></li><li><a href=#23-the-scientific-worlds-interest-in-the-question>2.3 The scientific world&rsquo;s interest in the question</a></li></ul><ul><li><a href=#31-quantum-superposition>3.1. Quantum superposition</a></li><li><a href=#32-quantum-measurement>3.2. Quantum measurement</a></li><li><a href=#33-entanglement>3.3. Entanglement</a><ul><li><a href=#331-entanglement-and-quantum-computing>3.3.1. Entanglement and Quantum Computing</a></li></ul></li><li><a href=#34-hidden-variable-theories>3.4 Hidden variable theories</a></li></ul><ul><li><a href=#41-john-bells-work>4.1. John Bell&rsquo;s work</a></li><li><a href=#42-the-chsh-test>4.2. The CHSH test</a><ul><li><a href=#421-non-commutative-quantities>4.2.1. Non-commutative quantities</a></li></ul></li><li><a href=#43-the-experiments-that-earned-the-2022-nobel>4.3. The experiments that earned the 2022 Nobel</a><ul><li><a href=#431-the-loopholes-and-how-they-were-eliminated>4.3.1. The &ldquo;loopholes&rdquo; and how they were eliminated</a></li></ul></li></ul><ul><li><a href=#51-qubits-and-quantum-gates>5.1. Qubits and quantum gates</a></li><li><a href=#52-quantum-circuits>5.2. Quantum circuits</a></li><li><a href=#53-quantum-computing-platforms>5.3. Quantum Computing platforms</a></li></ul><ul><li><a href=#61-experiment-setup>6.1. Experiment setup</a><ul><li><a href=#necessary-ingredients>Necessary ingredients:</a></li></ul></li><li><a href=#62-the-quantum-circuit>6.2. The quantum circuit</a></li><li><a href=#63-complete-code>6.3. Complete code</a></li><li><a href=#64-expected-results>6.4. Expected results</a></li><li><a href=#65-meaning-of-angles-and-bloch-sphere>6.5. Meaning of angles and Bloch sphere</a><ul><li><a href=#651-the-bloch-sphere>6.5.1. The Bloch sphere</a></li><li><a href=#what-does-measuring-according-to-an-angle-mean>What does &ldquo;measuring according to an angle&rdquo; mean?</a></li><li><a href=#652-the-optimal-angles-of-the-chsh-test>6.5.2. The optimal angles of the CHSH test</a></li><li><a href=#653-visualization-of-optimal-angles>6.5.3. Visualization of optimal angles</a></li><li><a href=#654-graph-interpretation>6.5.4. Graph interpretation</a></li></ul></li><li><a href=#66-what-does-this-result-mean>6.6. What does this result mean?</a></li><li><a href=#67-other-interactive-experiments>6.7. Other interactive experiments</a><ul><li><a href=#671-variation-of-chsh-value-with-angles>6.7.1. Variation of CHSH value with angles</a></li><li><a href=#672-quantum-vs-classical-comparison-correlation-heatmap>6.7.2. Quantum vs classical comparison: correlation heatmap</a></li><li><a href=#673-interactive-exploration-of-chsh-parameters>6.7.3. Interactive exploration of CHSH parameters</a></li><li><a href=#674-simulation-with-realistic-noise>6.7.4. Simulation with realistic noise</a></li></ul></li></ul><ul><li><a href=#71-who-was-right>7.1. Who was right?</a></li><li><a href=#72-the-nature-of-reality>7.2. The nature of reality</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h1 id=1-introduction>1. Introduction<a hidden class=anchor aria-hidden=true href=#1-introduction>#</a></h1><h2 id=11-intro-to-the-intro>1.1. Intro to the intro<a hidden class=anchor aria-hidden=true href=#11-intro-to-the-intro>#</a></h2><p>I&rsquo;m not quite sure what this article is—a mix of coding experiment, science communication, and maybe just a fun project for someone who in another life would have wanted to be a physicist.</p><p>I&rsquo;ve had this in my drawer for a while, since I read <a href=https://arxiv.org/html/2501.01434v1#abstract>this article</a> by some CERN researchers that explains how you can simulate an experiment on Bell&rsquo;s inequalities using the Qibo framework.</p><p>Reading that article led me to a realization that, at least for me, is super fascinating: today in 2025, anyone with even basic programming knowledge and a couple of foundational concepts can run (or at least <strong>simulate</strong>) a quantum mechanics experiment that 20 or 30 years ago would only have been possible in a physics lab with extremely expensive equipment.</p><p>However, just copy-pasting code and running it doesn&rsquo;t seem particularly interesting to me, at least not without really understanding what we&rsquo;re talking about. That&rsquo;s why I started studying a bit of the history and some basic principles.</p><p>This little deep-dive exercise, which spans more than a century of history—from the origins (1905) to the 2022 Nobel Prize (in my opinion, it deserves a movie or a novel)—and touches on some of the deepest epistemological problems humanity has ever faced, has given meaning to the final exercise, which still remains little more than copy-paste from the CERN article and some suggestions from Claude 😃</p><h2 id=12-the-real-intro>1.2. The real intro<a hidden class=anchor aria-hidden=true href=#12-the-real-intro>#</a></h2><p>Many people wonder if/when quantum computing will become a reality. To be honest, after strong market expansion in the post-COVID period, there was a moderate growth trend between 2022 and 2024, probably due to the global economic crisis and attention shifting to generative artificial intelligence.</p><table><thead><tr><th>Year</th><th>Global Market Revenues</th></tr></thead><tbody><tr><td>2020</td><td>████████ $412M</td></tr><tr><td>2021</td><td>████████ $391M</td></tr><tr><td>2022</td><td>██████████████ $713M</td></tr><tr><td>2023</td><td>█████████████████ $885M</td></tr><tr><td>2024</td><td>███████████████████████ $1,107M</td></tr></tbody></table><p>Sources:</p><ul><li><a href=https://www.fortunebusinessinsights.com/quantum-computing-market-104855>Fortune Business Insights</a></li><li><a href=https://www.sri.com/press/story/new-data-on-the-growing-quantum-industry/>SRI</a></li></ul><p>In particular, in 2024 the main players operating in the Quantum Computing sector slowed down a bit in the race for more qubits, focusing on developing new architectures to reduce the so-called <a href=https://en.wikipedia.org/wiki/Quantum_decoherence>quantum decoherence</a> phenomenon, which is one of the main obstacles to the scalability of current systems.
However, in 2025 there&rsquo;s been a resurgence, with announcements of new prototypes from IBM, Google, and Microsoft, and in the last 6 months, Rigetti&rsquo;s stock (another player that, unlike the previous ones, operates exclusively in the quantum computing sector) has grown by 380% on the stock market!</p><p>In any case, we haven&rsquo;t yet seen any real revolution, and almost everyone agrees that QC will probably never replace the classical computing model but, at best, will complement it, allowing for efficient solutions to complex problems.</p><p>An example of a problem that could be efficiently solved with a quantum computer is the factorization of very large integers into prime factors, using <a href=https://en.wikipedia.org/wiki/Shor%27s_algorithm>Shor&rsquo;s algorithm</a> to evolve (or break) currently used cryptographic systems.</p><p>However, current limitations of quantum computers don&rsquo;t yet allow for the efficient execution of this algorithm on numbers large enough to undermine the security of current cryptographic systems.
Apart from this potential use case and some other special cases limited to very specific fields—such as <a href=https://arxiv.org/pdf/quant-ph/9605043>Grover&rsquo;s algorithm</a> for searching in unsorted lists—we still don&rsquo;t see practical applications of quantum computing.
While we wait for practical applications to arrive, we can already today use it to conduct real quantum mechanics experiments.
These experiments, which for me are little more than a game, refer to much more serious work that lasted several decades and led John Clauser, Alain Aspect, and Anton Zeilinger to win the 2022 Nobel Prize in Physics: <a href=https://it.wikipedia.org/wiki/Esperimento_sulla_correlazione_quantistica_di_Aspect>experiments on Bell&rsquo;s Inequalities</a>.</p><p>Needless to say, what&rsquo;s reported here isn&rsquo;t even a real &ldquo;experiment,&rdquo; since I used a simulator (not a real quantum computer). Moreover, the circuit I implemented is based on an <strong>extreme simplification of the original experiment</strong>, but the theoretical principles are the same, and it could be ported to a real commercial Quantum Computer with little effort. So it&rsquo;s an interesting exercise to understand what &ldquo;non-locality&rdquo; really means in quantum mechanics and how the same principles underlie the functioning of Quantum Computing.</p><p>To do this, we need a few ingredients:</p><ol><li>A bit of history</li><li>Some notions of quantum mechanics</li><li>A deep dive into Bell&rsquo;s inequalities</li><li>The basics of Quantum Computing</li></ol><h1 id=2-a-bit-of-history>2. A bit of history<a hidden class=anchor aria-hidden=true href=#2-a-bit-of-history>#</a></h1><h2 id=21-einstein-and-quantum-mechanics>2.1. Einstein and quantum mechanics<a hidden class=anchor aria-hidden=true href=#21-einstein-and-quantum-mechanics>#</a></h2><p>Perhaps not everyone knows that Albert Einstein didn&rsquo;t win the Nobel Prize for his theories on relativity, but rather for his explanation of the <a href=https://en.wikipedia.org/wiki/Photoelectric_effect>photoelectric effect</a>, drawing from an idea by Max Planck.
Like his studies on relativity, that work by Einstein was enormously important for 20th-century physics because it kicked off the other great branch of physics: quantum mechanics. A noteworthy fact is that no Nobel Prize has ever been awarded for discoveries directly connected to the theory of relativity, while since 1920, at least 16 Nobels have been awarded for studies or discoveries directly connected to quantum mechanics.</p><p>At the beginning of the twentieth century, the idea of light as a &ldquo;corpuscle&rdquo; was in contrast with the wave representation of light, which was well established and dated back to the works of <a href=https://en.wikipedia.org/wiki/Christiaan_Huygens>Christiaan Huygens</a> from around the mid-1600s. Over the centuries, the wave nature was questioned several times, but interference experiments and the solid theoretical foundations introduced by Thomas Young in 1801, and later by James Clerk Maxwell with his electromagnetic theory of light, seemed to have definitively closed the question.
Consequently, Planck himself, when he introduced the idea of quanta in 1900, didn&rsquo;t really believe in the corpuscular nature of light. From his point of view, it was just a theoretical abstraction that served to explain the problem of <a href=https://en.wikipedia.org/wiki/Ultraviolet_catastrophe>black body radiation</a>, but had no real physical correspondence.</p><p>Einstein&rsquo;s great merit was taking Planck&rsquo;s intuition seriously—that energy couldn&rsquo;t be exchanged continuously but rather in discrete &ldquo;packets&rdquo; that Planck called &ldquo;quanta&rdquo; (hence the name &ldquo;quantum mechanics&rdquo;).
In 1905, Einstein applied this idea to explain the photoelectric effect, hypothesizing that light was composed of &ldquo;light quanta,&rdquo; which we now call photons, and this earned him the Nobel Prize in Physics in 1921.</p><p>However, initially no one believed Einstein, not even Max Planck, who had provided the initial intuition. It was only thanks to <a href=https://en.wikipedia.org/wiki/Robert_Millikan#Photoelectric_effect>the work of Robert Millikan</a>—who, with the objective of discrediting Einstein&rsquo;s thesis, conducted numerous experiments and took several years to surrender to the fact that Einstein&rsquo;s explanation of the photoelectric effect was correct and thus the hypothesis of quanta was anything but a simple theoretical abstraction.</p><p>From here on, it&rsquo;s a succession of studies and discoveries that make quantum mechanics the most accurate and precise physical theory ever developed, leading in just a few years to an incredible sequence of Nobel Prizes, among which the most important are:</p><ul><li>1922 - Niels Bohr for his studies on atomic structure</li><li>1923 - Millikan for his experimental work on the photoelectric effect and the measurement of electron charge</li><li>1927 - Arthur Compton for the discovery of the Compton effect</li><li>1929 - Louis de Broglie for the discovery of the wave nature of the electron</li><li>1932 - Werner Heisenberg for the formulation of quantum mechanics</li><li>1933 - Erwin Schrödinger and Paul Dirac for the formulation of wave mechanics</li><li>1945 - Wolfgang Pauli for the discovery of the exclusion principle</li><li>1954 - Max Born for the formulation of quantum mechanics in probabilistic terms</li><li>1965 - Richard Feynman, Julian Schwinger, and Sin-itiro Tomonaga for the development of quantum electrodynamics</li></ul><p>Ironically, Einstein himself—who had started that revolution—became increasingly skeptical of the theory as it developed, to the point of isolating himself from the scientific community that had meanwhile fully embraced it.</p><p>But why was Einstein so skeptical about the representation of reality according to quantum mechanics?
The answer to this question has to do with the very concept of Reality itself and requires a deeper look to understand Einstein&rsquo;s point of view.</p><h2 id=22-what-is-reality>2.2. What is reality?<a hidden class=anchor aria-hidden=true href=#22-what-is-reality>#</a></h2><p>In a certain sense, Einstein&rsquo;s approach to the problems raised by quantum mechanics was similar to what had characterized his approach to Relativity. When he faced an apparently unsolvable problem (such as the constancy of the speed of light across all inertial reference frames), he didn&rsquo;t try at all costs to adapt the theory, but rather began to question and define a new formalism for concepts that seemed well established, such as the concept of simultaneity, time, and space.</p><p>Something similar happened with the concept of Reality, through which Einstein, Podolsky, and Rosen formulated the famous EPR paradox, which questioned the completeness of quantum mechanics.</p><p>From Einstein&rsquo;s point of view, the description of the physical world had to obey 2 fundamental principles:</p><ul><li><strong>Locality</strong>: an object can only be influenced by its <strong>immediate surroundings</strong>, and not by events occurring at arbitrarily large distances. In other words, there cannot be &ldquo;action at a distance&rdquo; (<em>spooky action at a distance</em>).</li><li><strong>Realism</strong>: objects have <strong>defined properties</strong> independent of observation. In other words, reality exists independently of whether we observe it or not.</li></ul><p>The <a href=https://en.wikipedia.org/wiki/Einstein%E2%80%93Podolsky%E2%80%93Rosen_paradox>EPR Paradox</a> describes some thought experiments through which the authors try to demonstrate that quantum mechanics cannot be a complete theory because it violates at least one of the principles listed above.</p><p>In other words, if quantum mechanics is correct, then at least one of the following statements holds:</p><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content><ul><li><em>the principle of locality is false, and therefore there exist actions at a distance that violate the speed of light limit</em></li><li><em>the principle of realism is false, and therefore objects don&rsquo;t have defined properties independent of observation, but rather physical properties manifest only at the moment they are measured</em></li></ul></div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><p>From a technical point of view, the EPR paradox is based on the concept of <strong>entanglement</strong> which, besides being one of the strangest and most fascinating concepts in quantum mechanics (often misunderstood and misinterpreted), is also at the basis of how quantum computers work.</p><h2 id=23-the-scientific-worlds-interest-in-the-question>2.3 The scientific world&rsquo;s interest in the question<a hidden class=anchor aria-hidden=true href=#23-the-scientific-worlds-interest-in-the-question>#</a></h2><p>For decades, the entire question of the EPR paradox and the epistemological interpretation of quantum mechanics remained confined to philosophical discussions among a few experts, and already after the 1930s, quantum mechanics was so well established that no one worried about these aspects anymore.
Bell himself worked as a particle physicist at various research institutions in the UK and then at CERN and devoted himself to this topic only in his spare time.
In 1964, during a sabbatical year in the United States, Bell published the famous article &ldquo;<em>On the Einstein Podolsky Rosen paradox</em>&rdquo; in which he proposed a way to experimentally verify whether Einstein was right or not.
The article aroused some interest, but nevertheless, even after Bell&rsquo;s publication, only a few daring souls were interested in a potential experiment to verify Bell&rsquo;s inequalities, also because shortly after, the very journal in which Bell had published the article went bankrupt, and this certainly didn&rsquo;t help spread the idea.</p><p>John Clauser himself, one of the three 2022 Nobel Prize winners, was initially not very convinced about tackling the question and recounts that when he asked the legendary Richard Feynman for advice about doing his first experiment to test Bell&rsquo;s inequalities, he was told it was a &ldquo;waste of time&rdquo; because quantum mechanics had already been extensively verified and no one expected Einstein to be right.</p><h1 id=3-some-notions-of-quantum-mechanics>3. Some notions of quantum mechanics<a hidden class=anchor aria-hidden=true href=#3-some-notions-of-quantum-mechanics>#</a></h1><h2 id=31-quantum-superposition>3.1. Quantum superposition<a hidden class=anchor aria-hidden=true href=#31-quantum-superposition>#</a></h2><p>In quantum mechanics, a system can be in a state of <strong>superposition</strong>, that is, in a combination of multiple states simultaneously.</p><p>In the world of quantum computing, the superposition state can be implemented through the application of some operators (<em>quantum gates</em>) on <strong>qubits</strong>, the quantum analog of the classical bit. While a classical bit can only take values 0 or 1, a qubit can be in a superposition of the two states, represented mathematically as:</p><p>$$|\psi\rangle = \alpha|0\rangle + \beta|1\rangle$$</p><p>where $\alpha$ and $\beta$ are complex numbers that satisfy the condition $|\alpha|^2 + |\beta|^2 = 1$.</p><h2 id=32-quantum-measurement>3.2. Quantum measurement<a hidden class=anchor aria-hidden=true href=#32-quantum-measurement>#</a></h2><p>When we measure a qubit, the superposition &ldquo;collapses&rdquo; into one of the two basis states (0 or 1), with probabilities $|\alpha|^2$ and $|\beta|^2$ respectively.</p><p>This is one of the most controversial aspects of quantum mechanics: before measurement, the system is effectively in both states simultaneously (according to the <a href=https://en.wikipedia.org/wiki/Copenhagen_interpretation>Copenhagen interpretation</a>), but the moment we measure it, reality &ldquo;<em>chooses</em>&rdquo; one of the two states probabilistically.</p><p>Einstein never accepted this interpretation. At first, he tried to demonstrate that quantum mechanics was incorrect. His criticisms of Bohr during <a href=https://en.wikipedia.org/wiki/Solvay_Conference>the Solvay Conferences</a> and the thought experiments that tried to challenge the theoretical framework of quantum mechanics that we can now call &ldquo;orthodox&rdquo; are now legendary.
However, Bohr and Heisenberg always managed to find an answer to Einstein&rsquo;s challenge, supported by the theory itself.
In the end, Einstein surrendered to the evidence: <strong>quantum mechanics was correct</strong>.</p><p>However, he continued to maintain that it was an incomplete theory and that there had to be a more complete description of reality that included &ldquo;hidden variables&rdquo; that would allow predicting the measurement result deterministically.</p><p>Beyond the philosophical implications, the concept of &ldquo;measurement&rdquo; also has practical implications in quantum programming since, for example, we can&rsquo;t simply &ldquo;read&rdquo; the state of a qubit in a superposition state without altering it. In the Copenhagen interpretation, this alteration (that is, this &ldquo;measurement&rdquo;) is equivalent to the concept of <strong>wave function collapse</strong>.</p><h2 id=33-entanglement>3.3. Entanglement<a hidden class=anchor aria-hidden=true href=#33-entanglement>#</a></h2><p><strong>Entanglement</strong> (quantum correlation) is perhaps the strangest and most counterintuitive phenomenon in quantum mechanics. When two particles are entangled, they form a single quantum system, even if they are separated by arbitrarily large distances.</p><p>This correlation leads to phenomena that Einstein called &ldquo;spooky actions at a distance&rdquo; and led him to believe that quantum mechanics must be an incomplete theory.</p><p>Nevertheless, as strange and counterintuitive as it is (in fact, perhaps precisely because of this aspect), the phenomenon of entanglement has been experimented and verified countless times in laboratories.</p><p>In the vast majority of cases, tests refer to individual particles, but there are also cases where the <a href=https://research.princeton.edu/news/physicists-%E2%80%98entangle%E2%80%99-individual-molecules-first-time-bringing-about-new-platform-quantum>entangled state of macroscopic systems like molecules</a> has been verified.</p><p>The most extreme and famous example is the thought experiment of <a href=https://en.wikipedia.org/wiki/Schr%C3%B6dinger%27s_cat>Schrödinger&rsquo;s cat</a>, which is simultaneously alive and dead until it&rsquo;s observed.</p><h3 id=331-entanglement-and-quantum-computing>3.3.1. Entanglement and Quantum Computing<a hidden class=anchor aria-hidden=true href=#331-entanglement-and-quantum-computing>#</a></h3><p>From the Quantum Computing perspective, a classic example is that of two qubits in a Bell state:</p><p>$$|\Phi^+\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle)$$</p><p>This state represents a <strong>superposition</strong> in which the two qubits are both 0 or both 1 with 50% probability. The extraordinary thing is that when we measure the first qubit and obtain (for example) 0, instantly the second qubit also collapses to state 0, regardless of the distance separating them.</p><h2 id=34-hidden-variable-theories>3.4 Hidden variable theories<a hidden class=anchor aria-hidden=true href=#34-hidden-variable-theories>#</a></h2><p>According to Einstein, quantum mechanics was an <strong>incomplete</strong> theory: the probabilities we observe in quantum measurements wouldn&rsquo;t reflect a real indeterminacy of nature, but simply our ignorance of some <strong>hidden variables</strong> that in theory could be used to precisely determine the measurement result.</p><p>To better understand this concept, we can make an analogy with flipping a coin:</p><ul><li>From a practical point of view, the result (heads or tails) seems random with 50% probability</li><li>But we know that in reality the result is completely determined by initial conditions: speed, launch angle, force, air resistance, etc.</li><li>If we perfectly knew all these &ldquo;hidden variables,&rdquo; we could predict the result with certainty</li></ul><p>Einstein believed something similar happened in quantum mechanics. When we prepare an electron in a superposition state and then measure it, according to Einstein:</p><ol><li>The electron already possesses a defined property <strong>before</strong> the measurement</li><li>This property is determined by variables that the current theory doesn&rsquo;t include (hidden variables)</li><li>The probabilistic nature of quantum mechanics derives only from our ignorance of these variables</li><li>A more complete theory that included these variables would be completely deterministic</li></ol><p>This point of view is called <strong>local realism with hidden variables</strong>:</p><ul><li><strong>Local</strong>: hidden variables are intrinsic properties of the system, not influenced by distant events</li><li><strong>Realist</strong>: physical properties exist independently of observation</li><li><strong>Deterministic</strong>: knowing the hidden variables, the measurement result would be predetermined</li></ul><p>The EPR paradox was precisely an attempt by Einstein, Podolsky, and Rosen to demonstrate that such hidden variables must necessarily exist to maintain the principles of locality and realism.</p><h1 id=4-a-deep-dive-into-bells-inequalities>4. A deep dive into Bell&rsquo;s inequalities<a hidden class=anchor aria-hidden=true href=#4-a-deep-dive-into-bells-inequalities>#</a></h1><h2 id=41-john-bells-work>4.1. John Bell&rsquo;s work<a hidden class=anchor aria-hidden=true href=#41-john-bells-work>#</a></h2><p>In 1964, Irish physicist John Stewart Bell proposed a way to experimentally verify whether Einstein was right. Bell formulated a series of mathematical inequalities that must be satisfied if the principle of <strong>local realism</strong> holds (that is, if both the principle of locality and that of realism hold together).</p><p>Bell&rsquo;s brilliant idea was to find a measurable quantity that:</p><ul><li>If quantum mechanics is correct, violates the inequalities</li><li>If there exists a &ldquo;local hidden variables&rdquo; theory (as Einstein maintained), respects the inequalities</li></ul><p>This work, however, was entirely mathematical in nature. The brilliance of the physicists who came after (and for which the 2022 Nobel was ultimately recognized) was to design and carry out experiments to implement it in the real world.</p><h2 id=42-the-chsh-test>4.2. The CHSH test<a hidden class=anchor aria-hidden=true href=#42-the-chsh-test>#</a></h2><p>One of the most used formulations of Bell&rsquo;s inequalities is the CHSH test (from Clauser, Horne, Shimony, and Holt), which takes its name from the four physicists who proposed it in 1969.</p><p>The experiment involves:</p><ol><li>A source that produces entangled particle pairs (for example, polarized photons)</li><li>The usual &ldquo;Alice&rdquo; and &ldquo;Bob&rdquo; from all physics experiments, who can choose between two possible measurements to perform</li><li>Measuring the <strong>correlations</strong> between the results obtained by Alice and Bob</li></ol><p>More formally:</p><ul><li>Alice can choose to measure according to angle $a_0$ or $a_1$</li><li>Bob can choose to measure according to angle $b_0$ or $b_1$</li><li>Each measurement produces a result +1 or -1</li></ul><p>The CHSH quantity is then defined:</p><p>$$S = E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)$$</p><p>where $E(a_i, b_j)$ is the correlation between Alice&rsquo;s and Bob&rsquo;s measurements.</p><h3 id=421-non-commutative-quantities>4.2.1. Non-commutative quantities<a hidden class=anchor aria-hidden=true href=#421-non-commutative-quantities>#</a></h3><p>In the CHSH test, Alice and Bob measure <strong>photon polarization according to different angles</strong>, but similar experiments can be done with other physical quantities, such as the spin of electrons (also in an entangled state).</p><p>In any case, the experiment only works if the measured quantities are of a <strong>non-commutative</strong> nature.</p><p>In classical physics, if we want to measure two properties of an object (for example, its position and its velocity), we can do so in any order and always get the same results. The order of measurements doesn&rsquo;t matter.</p><p>In quantum mechanics, however, there exist pairs of physical quantities for which <strong>the order of measurements is important</strong>. When we measure A first and then B, we get different results compared to when we measure B first and then A. Mathematically, this is expressed by saying that the corresponding operators don&rsquo;t commute:</p><p>$$\hat{A}\hat{B} \neq \hat{B}\hat{A}$$</p><p>Non-commutativity is closely linked to Heisenberg&rsquo;s uncertainty principle.</p><p>The most famous examples of non-commutative quantities are:</p><ul><li><strong>Position and momentum</strong>: Heisenberg&rsquo;s uncertainty principle derives precisely from the non-commutativity of these two quantities</li><li><strong>Spin components along different axes</strong>: measuring spin along the x-axis and then along the y-axis gives different results compared to the inverse order</li><li><strong>Photon polarization according to different angles</strong>: precisely what we measure in the CHSH test</li></ul><p>In our experiment, when Alice measures polarization according to angle $a_0 = 0°$ and Bob according to $b_0 = 45°$, they are measuring non-commutative quantities because they&rsquo;re <strong>associated with the same entangled system</strong>.</p><figure><img src=/images/2025/bell/image-11.png alt="Diagram of a 2-channel Bell inequality test" style=max-width:100%;margin:auto;display:block><figcaption>Typical configuration of a CHSH experiment. A source produces entangled particle pairs that are sent to two spatially separated observers (Alice and Bob). Each observer can choose between two possible measurement angles (for example, polarizers oriented at 0° or 45° for Alice and 22.5° or 67.5° for Bob). The measurement results (+1 or -1) received by the 4 detectors are then used to calculate the CHSH quantity $S$.<br>Source: wikipedia</figcaption></figure><p>According to &ldquo;orthodox&rdquo; quantum mechanics, we can summarize that:</p><ol><li><strong>We cannot simultaneously know</strong> both polarizations with absolute certainty</li><li><strong>The first measurement influences the second</strong>: if Alice measures first, Bob&rsquo;s result will be influenced by the wave function collapse caused by Alice&rsquo;s measurement</li><li><strong>There are no &ldquo;pre-existing values&rdquo;</strong> for both polarizations: properties manifest only at the moment of measurement</li></ol><p>Conversely, hidden variable theories assume that each particle carries a &ldquo;hidden instruction&rdquo; that predetermines the result for every possible measurement angle. But if quantities don&rsquo;t commute, there cannot simultaneously exist predetermined values for all possible measurements.</p><p>Bell&rsquo;s genius was realizing that this difference between the classical world (where all quantities commute) and the quantum one (where some quantities don&rsquo;t commute) translates into a <strong>measurable</strong> difference in statistical correlations over a sufficiently large sample of measurements.</p><ul><li><strong>According to local realism</strong>: $|S| \leq 2$</li><li><strong>According to quantum mechanics</strong>: $|S|$ can reach up to $2\sqrt{2} \approx 2.828$</li></ul><p>But why these limits? Let&rsquo;s try to understand with an intuitive analogy.</p><h4 id=4211-the-local-realism-reasoning-the-limit-of-2>4.2.1.1. The local realism reasoning (the limit of 2)<a hidden class=anchor aria-hidden=true href=#4211-the-local-realism-reasoning-the-limit-of-2>#</a></h4><p>Imagine that each pair of entangled particles carries a hidden &ldquo;instruction sheet&rdquo; that predetermines the result for every possible measurement angle. This sheet contains 4 predetermined values:</p><ul><li>$A_0$: Alice&rsquo;s result if measuring according to $a_0$ (can be +1 or -1)</li><li>$A_1$: Alice&rsquo;s result if measuring according to $a_1$ (can be +1 or -1)</li><li>$B_0$: Bob&rsquo;s result if measuring according to $b_0$ (can be +1 or -1)</li><li>$B_1$: Bob&rsquo;s result if measuring according to $b_1$ (can be +1 or -1)</li></ul><p>For each single pair of particles, we can calculate:</p><p>$$S_{\text{single}} = A_0 B_0 + A_0 B_1 + A_1 B_0 - A_1 B_1$$</p><p>Let&rsquo;s do a concrete example. Suppose a particular pair has:</p><ul><li>$A_0 = +1$, $A_1 = -1$, $B_0 = +1$, $B_1 = +1$</li></ul><p>Then:
$$S = (+1)(+1) + (+1)(+1) + (-1)(+1) - (-1)(+1) = 1 + 1 - 1 + 1 = 2$$</p><p>Let&rsquo;s try another combination:</p><ul><li>$A_0 = +1$, $A_1 = +1$, $B_0 = +1$, $B_1 = -1$</li></ul><p>$$S = (+1)(+1) + (+1)(-1) + (+1)(+1) - (+1)(-1) = 1 - 1 + 1 + 1 = 2$$</p><p>We can rewrite $S$ as:
$$S = A_0(B_0 + B_1) + A_1(B_0 - B_1)$$</p><p>Now observe that:</p><ul><li>If $B_0 = B_1$, then $(B_0 + B_1) = \pm 2$ and $(B_0 - B_1) = 0$, so $S = \pm 2A_0$, i.e., $|S| = 2$</li><li>If $B_0 = -B_1$, then $(B_0 + B_1) = 0$ and $(B_0 - B_1) = \pm 2$, so $S = \pm 2A_1$, i.e., $|S| = 2$</li></ul><p>In both cases, for a single pair with predetermined values, we always get $|S| = 2$</p><p>When we make many measurements and calculate the average of the correlations $E(a_i, b_j)$, we&rsquo;re averaging over all possible combinations of hidden instructions. But since each single pair gives $|S| = 2$, the average can never exceed this value:</p><p>$$|S| = |E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)| \leq 2$$</p><p>This is therefore the <strong>classical limit</strong> and is valid for any local hidden variable theory.</p><h4 id=4212-the-quantum-reasoning-the-limit-of-22>4.2.1.2. The quantum reasoning (the limit of 2√2)<a hidden class=anchor aria-hidden=true href=#4212-the-quantum-reasoning-the-limit-of-22>#</a></h4><p>In quantum mechanics, instead, predetermined values don&rsquo;t exist. The particles are in an entangled Bell state:</p><p>$$|\Phi^+\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle)$$</p><p>When Alice and Bob measure according to different angles, the correlations depend on the angular difference $\theta$ between their measurement directions according to the formula:</p><p>$$E(\theta) = \cos(2\theta)$$</p><p>For the optimal angles of the CHSH test:</p><ul><li>$a_0 = 0°$, $a_1 = 45°$</li><li>$b_0 = 22.5°$, $b_1 = -22.5°$</li></ul><p>With these angles:</p><ul><li>$E(a_0, b_0) = \cos(2 \times 22.5°) = \cos(45°) = \frac{1}{\sqrt{2}}$</li><li>$E(a_0, b_1) = \cos(2 \times 22.5°) = \cos(45°) = \frac{1}{\sqrt{2}}$</li><li>$E(a_1, b_0) = \cos(2 \times 22.5°) = \cos(45°) = \frac{1}{\sqrt{2}}$</li><li>$E(a_1, b_1) = \cos(2 \times 67.5°) = \cos(135°) = -\frac{1}{\sqrt{2}}$</li></ul><p>Therefore:
$$S = \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} - \left(-\frac{1}{\sqrt{2}}\right) = \frac{4}{\sqrt{2}} = 2\sqrt{2} \approx 2.828$$</p><p>This instead is <strong>Tsirelson&rsquo;s bound</strong> and is the maximum theoretical value predicted by quantum mechanics.</p><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content>to better understand what we mean by &ldquo;measurement angles&rdquo; and how correlations are calculated in quantum mechanics, I did a little deep-dive in section 6.5.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h4 id=4213-where-does-this-difference-come-from>4.2.1.3. Where does this difference come from?<a hidden class=anchor aria-hidden=true href=#4213-where-does-this-difference-come-from>#</a></h4><p>The fundamental difference is this:</p><ul><li><p><strong>Local realism</strong>: assumes that each particle has 4 defined properties simultaneously ($A_0, A_1, B_0, B_1$), even if we only measure one. This assumption limits the possible correlations.</p></li><li><p><strong>Quantum mechanics</strong>: properties don&rsquo;t exist before measurement. Particles are in superposition and the measurement angle determines the &ldquo;basis&rdquo; onto which we project the state. This allows stronger correlations.</p></li></ul><p>An analogy: it&rsquo;s as if in the classical case each particle carried with it 4 already-flipped coins (but covered), while in the quantum case the coins are flipped only when we uncover them, and the way we uncover Alice&rsquo;s <strong>instantly influences the probabilities</strong> for Bob&rsquo;s, even if they&rsquo;re far apart.</p><h2 id=43-the-experiments-that-earned-the-2022-nobel>4.3. The experiments that earned the 2022 Nobel<a hidden class=anchor aria-hidden=true href=#43-the-experiments-that-earned-the-2022-nobel>#</a></h2><p>Starting from the 1970s, a series of experiments based on Bell&rsquo;s theoretical framework and particularly on the CHSH test unequivocally demonstrated that Bell&rsquo;s inequalities are violated exactly as predicted by the theoretical framework of quantum mechanics, confirming that local realism cannot be maintained:</p><ol><li><strong>1972 - John Clauser</strong>: first experiment that violated Bell&rsquo;s inequalities using polarized photons</li><li><strong>1982 - Alain Aspect</strong>: more refined experiments that eliminated various possible &ldquo;loopholes&rdquo;</li><li><strong>1998-2015 - Anton Zeilinger</strong>: experiments with entanglement over increasingly greater distances, eventually demonstrating quantum teleportation</li></ol><p>In 2022, these three physicists received the Nobel Prize in Physics precisely for these pioneering experiments.</p><h3 id=431-the-loopholes-and-how-they-were-eliminated>4.3.1. The &ldquo;loopholes&rdquo; and how they were eliminated<a hidden class=anchor aria-hidden=true href=#431-the-loopholes-and-how-they-were-eliminated>#</a></h3><p>Despite Clauser&rsquo;s first experiments in the 1970s having violated Bell&rsquo;s inequalities, some possible technical objections remained that could have allowed a supporter of local realism to doubt the results. These objections are called <strong>loopholes</strong>, and much of the subsequent experimental work focused on eliminating them one by one.</p><h4 id=4311-locality-loophole>4.3.1.1. Locality Loophole<a hidden class=anchor aria-hidden=true href=#4311-locality-loophole>#</a></h4><p><strong>The problem</strong>: In the first experiments, Alice&rsquo;s and Bob&rsquo;s measurements weren&rsquo;t sufficiently separated in spacetime. In theory, a classical signal (traveling at or below the speed of light) could have traveled from one detector to the other, influencing the result without the experimental apparatus being able to detect it.</p><p><strong>Alain Aspect&rsquo;s solution (1982)</strong>: Aspect introduced a system of <strong>ultrafast switching</strong> of measurement angles:</p><ul><li>Measurement angles were randomly changed during photon flight</li><li>The change occurred so quickly that no subluminal signal could travel from one detector to the other</li><li>This guaranteed the <strong>spacelike separation</strong> of measurements</li></ul><p>These modifications were implemented so that the time interval between production and detection was 20 ns, while the channel switches inverted orientation asynchronously every 10 ns, keeping the various sections sufficiently far apart to guarantee spacelike distances between them.
This ensures that Alice&rsquo;s measurement event is causally disconnected from Bob&rsquo;s.</p><h4 id=4312-fair-sampling-loophole>4.3.1.2. Fair Sampling Loophole<a hidden class=anchor aria-hidden=true href=#4312-fair-sampling-loophole>#</a></h4><p><strong>The problem</strong>: No detector is 100% perfect. In early photon experiments, only a small fraction of produced particle pairs was actually detected and measured. In Clauser&rsquo;s experiments, for example, detection efficiency was less than 5%.</p><p>This opens up a possible objection: how can we be sure that the particle pairs <strong>actually detected</strong> are a representative sample of all pairs produced?</p><p>A supporter of local realism could argue that:</p><ul><li>Particles carry &ldquo;hidden instructions&rdquo; that determine both the measurement result and the probability of being detected</li><li>Particles with certain combinations of hidden instructions have a higher probability of being detected than others</li><li>The observed sample is therefore <strong>biased</strong>, and measured correlations don&rsquo;t reflect the true correlations of the complete set</li></ul><p>In other words, it&rsquo;s as if we did a political poll by only interviewing people who answer the phone: the sample might not be representative of the general population.</p><p>Mathematically, this objection works because the proof of Bell&rsquo;s Inequalities assumes all produced pairs are measured. If we can only measure a subset, and this subset isn&rsquo;t randomly chosen but depends on hidden variables, then the inequalities could be violated even in a local hidden variable theory.</p><p><strong>The fair sampling assumption</strong>: For many years, experiments relied on the <strong>fair sampling assumption</strong>, which assumes that detected particles are a representative random sample. This assumption is reasonable from a physics standpoint, but it&rsquo;s not a rigorous proof.</p><p><strong>The solution</strong>: To completely eliminate this loophole, you need to achieve <strong>detection efficiency</strong> above a critical threshold. For the CHSH test, this threshold is about <strong>82.8%</strong> (more precisely, $\eta > 2/3 \approx 66.7%$ for optimal configurations, but in practice you need higher efficiency to account for other factors).</p><p>This goal was very difficult to achieve and required decades of technological progress:</p><p><strong>First solution - Trapped ions (2000s)</strong>:</p><ul><li><strong>Ions</strong> (charged atoms trapped in electromagnetic fields) are much more controllable than photons</li><li>They can be kept in precise positions and measured with very high efficiency (>90%)</li><li>Pioneering experiments by Rowe et al. (2001) and Matsukevich et al. (2008) achieved efficiencies above the critical threshold</li><li><strong>Disadvantage</strong>: ions are difficult to spatially separate, making it more complicated to simultaneously close the locality loophole</li></ul><p><strong>Second solution - Superconducting detectors for photons (2010s)</strong>:</p><ul><li><strong>Superconducting nanowire single-photon detectors</strong> (SNSPDs) revolutionized photon detection</li><li>They operate at cryogenic temperatures (near absolute zero)</li><li>They achieve 75-98% efficiency in the infrared band</li><li>They allow using photons (easily separable over large distances) while maintaining high detection efficiency</li></ul><p><strong>Third solution - Neutral atoms and color centers</strong>:</p><ul><li><strong>Color centers in diamond</strong> (like NV centers - nitrogen-vacancy): defects in the diamond crystal structure that behave like single quantum systems</li><li><strong>Trapped neutral atoms</strong>: atoms cooled with lasers and trapped in optical tweezers</li><li>Combine the advantages of both approaches: high efficiency and possibility of spatial separation</li></ul><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content><strong>Why this 82.8% threshold?</strong>: This percentage derives from mathematical analysis of the CHSH test. With lower efficiency, it&rsquo;s possible to construct a local hidden variable model that reproduces the observed statistics by precisely exploiting unfair sampling. Above this threshold, instead, it becomes mathematically impossible to explain the results with local realism, even assuming the worst possible case of sampling bias.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h4 id=4313-freedom-of-choice-loophole>4.3.1.3. Freedom-of-Choice Loophole<a hidden class=anchor aria-hidden=true href=#4313-freedom-of-choice-loophole>#</a></h4><p><strong>The problem</strong>: How are measurement angles chosen for Alice and Bob? If the choice isn&rsquo;t truly random but is somehow correlated with the particles&rsquo; &ldquo;hidden instructions,&rdquo; then the results could be explained with local realism.</p><p>This objection may seem strange, but from a logical point of view it&rsquo;s valid: if the universe is deterministic, then even the &ldquo;random&rdquo; choice of angle could be predetermined by the same hidden variables that determine the measurement result!</p><p><strong>The solution</strong>: Use sources of randomness that are as &ldquo;free&rdquo; as possible:</p><ul><li><p><strong>Quantum random number generators</strong> (QRNG): exploit intrinsically random quantum processes</p></li><li><p><strong>Light from distant stars</strong> (Zeilinger&rsquo;s experiments, 2017): they used light coming from stars thousands of light-years away to decide measurement angles. This way, the &ldquo;hidden instructions&rdquo; would have had to be correlated with events that, at least as a first approximation, we can assume to be causally disconnected from the entangled particles.</p></li><li><p><strong>Human participation</strong>: in an experiment called &ldquo;The BIG Bell Test&rdquo; (2016), thousands of people around the world chose measurement angles through an online video game</p></li></ul><h4 id=4314-memory-loophole>4.3.1.4. Memory Loophole<a hidden class=anchor aria-hidden=true href=#4314-memory-loophole>#</a></h4><p><strong>The problem</strong>: If particle pairs are measured in sequence and results are accumulated over time, there could be spurious correlations due to variations in the experimental apparatus.</p><p><strong>The solution</strong>: Ensure the apparatus is stable over time or, even better, complete the experiment in such a short time as to exclude instrumental drift.</p><h4 id=4315-loophole-free-experiments>4.3.1.5. &ldquo;Loophole-free&rdquo; experiments<a hidden class=anchor aria-hidden=true href=#4315-loophole-free-experiments>#</a></h4><p>The real milestone was reached in <strong>2015</strong>, when three independent groups succeeded in carrying out experiments that closed <strong>simultaneously</strong> all the main loopholes:</p><ol><li><p><strong><a href=https://www.nature.com/articles/nature15759>Delft (Netherlands) - Hensen et al</a>.</strong>: used two <strong>color centers in diamond</strong> (defects in the crystal structure) separated by 1.3 km, connected via entanglement</p><ul><li>✓ Locality loophole closed (distance 1.3 km)</li><li>✓ Detection loophole closed (efficiency > 90%)</li></ul></li><li><p><strong><a href=https://arxiv.org/abs/1511.03190>Vienna (Austria) - Giustina et al</a>.</strong>: used <strong>entangled photons</strong> with superconducting detectors</p><ul><li>✓ Locality loophole closed</li><li>✓ Detection loophole closed (75% efficiency)</li></ul></li><li><p><strong><a href=https://www.nist.gov/news-events/news/2025/06/nist-and-partners-use-quantum-mechanics-make-factory-random-numbers>Boulder, Colorado (USA) - Shalm et al</a>.</strong>: used <strong>entangled photons</strong> separated by 185 meters</p><ul><li>✓ Locality loophole closed</li><li>✓ Detection loophole closed (75% efficiency)</li></ul></li></ol><p>These experiments definitively demonstrated that <strong>it&rsquo;s not possible to save local realism</strong>: nature truly violates Bell&rsquo;s inequalities, and it&rsquo;s not an experimental artifact.</p><h4 id=4316-are-there-still-open-loopholes>4.3.1.6. Are there still open loopholes?<a hidden class=anchor aria-hidden=true href=#4316-are-there-still-open-loopholes>#</a></h4><p>From a practical point of view, <strong>no</strong>: modern experiments are convincing beyond any reasonable doubt. However, from a philosophical point of view, there still exists an extremely speculative theoretical &ldquo;loophole&rdquo;:</p><p>This is the so-called <strong>Superdeterminism</strong>: the hypothesis that <em>everything</em> in the universe is predetermined from the Big Bang, including experimenters&rsquo; choices and measurement results. In this extreme scenario, free will wouldn&rsquo;t exist even in an operational sense. This position is considered by most physicists to be a non-falsifiable hypothesis and therefore not scientific.</p><p>In conclusion, scientific consensus is unanimous: Bell&rsquo;s inequalities are violated, local realism is incompatible with nature, and the experiments that demonstrated it fully deserved the 2022 Nobel Prize.</p><h1 id=5-the-basics-of-quantum-computing>5. The basics of Quantum Computing<a hidden class=anchor aria-hidden=true href=#5-the-basics-of-quantum-computing>#</a></h1><h2 id=51-qubits-and-quantum-gates>5.1. Qubits and quantum gates<a hidden class=anchor aria-hidden=true href=#51-qubits-and-quantum-gates>#</a></h2><p>In quantum computing, information is encoded in qubits instead of classical bits. Qubits can be physically implemented in various ways: electron spin, polarized photons, energy states of trapped atoms, etc.</p><p>Operations on qubits are performed through <strong>quantum gates</strong>, which are the analog of classical logic gates (AND, OR, NOT, etc.). The most common quantum gates are:</p><ul><li><strong>X gate</strong>: similar to classical NOT, swaps states |0⟩ and |1⟩</li><li><strong>H gate (Hadamard)</strong>: creates an equiprobable superposition between |0⟩ and |1⟩</li><li><strong>CNOT gate</strong>: two-qubit gate that inverts the second qubit if the first is |1⟩</li><li><strong>Rotation gates</strong>: allow manipulating the qubit state with precision</li></ul><h2 id=52-quantum-circuits>5.2. Quantum circuits<a hidden class=anchor aria-hidden=true href=#52-quantum-circuits>#</a></h2><p>A quantum program is represented as a <strong>quantum circuit</strong>, a sequence of quantum gates applied to one or more qubits. Unlike classical circuits, quantum circuits are reversible (except for measurement, which is irreversible).</p><p>To create entanglement between two qubits, typically a combination of Hadamard and CNOT gates is used:</p><ol><li>Apply an H gate to the first qubit to create superposition</li><li>Apply a CNOT gate using the first qubit as control and the second as target</li></ol><p>This creates a Bell state, completely entangled.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nf>q0</span><span class=o>:</span> ──<span class=n>H</span>──■──
</span></span><span class=line><span class=cl>         │
</span></span><span class=line><span class=cl><span class=nf>q1</span><span class=o>:</span> ─────<span class=n>X</span>──
</span></span></code></pre></div><h2 id=53-quantum-computing-platforms>5.3. Quantum Computing platforms<a hidden class=anchor aria-hidden=true href=#53-quantum-computing-platforms>#</a></h2><p>Today there are several platforms that allow running real programs on actual quantum computers, including for example:</p><ul><li><strong>IBM Quantum Experience</strong>: allows free access to IBM&rsquo;s real quantum computers</li><li><strong>Amazon Braket</strong>: AWS&rsquo;s quantum computing service</li><li><strong>Google Quantum AI</strong>: Google&rsquo;s quantum computing platform</li><li><strong>Local simulators</strong>: libraries like Qiskit, Cirq, Q# allow simulating quantum circuits on your own computer</li></ul><h1 id=6-lets-do-the-experiment>6. Let&rsquo;s do the experiment<a hidden class=anchor aria-hidden=true href=#6-lets-do-the-experiment>#</a></h1><h2 id=61-experiment-setup>6.1. Experiment setup<a hidden class=anchor aria-hidden=true href=#61-experiment-setup>#</a></h2><p>We can reproduce the CHSH test using a real quantum computer or a simulator. We&rsquo;ll use two qubits in an entangled state and measure correlations according to different configurations.</p><h3 id=necessary-ingredients>Necessary ingredients:<a hidden class=anchor aria-hidden=true href=#necessary-ingredients>#</a></h3><ol><li>A quantum computing platform (Qiskit, IBM Quantum, etc.)</li><li>Two qubits</li><li>Quantum circuits to create entanglement and perform rotations</li></ol><h2 id=62-the-quantum-circuit>6.2. The quantum circuit<a hidden class=anchor aria-hidden=true href=#62-the-quantum-circuit>#</a></h2><p>The basic circuit for the CHSH test is as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>QuantumRegister</span><span class=p>,</span> <span class=n>ClassicalRegister</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create 2 qubits and 2 classical bits for measurements</span>
</span></span><span class=line><span class=cl><span class=n>qr</span> <span class=o>=</span> <span class=n>QuantumRegister</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;q&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cr</span> <span class=o>=</span> <span class=n>ClassicalRegister</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=n>qr</span><span class=p>,</span> <span class=n>cr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 1: Create an entangled Bell state</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>        <span class=c1># Hadamard on first qubit</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=c1># CNOT to create entanglement</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: Apply rotations for Alice and Bob</span>
</span></span><span class=line><span class=cl><span class=c1># (angles depend on which configuration we want to test)</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># Rotation for Alice</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=n>theta_b</span><span class=p>,</span> <span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Rotation for Bob</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: Measure</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=n>qr</span><span class=p>,</span> <span class=n>cr</span><span class=p>)</span>
</span></span></code></pre></div><p>For the optimal CHSH test, the angles must be:</p><ul><li>$a_0 = 0°$, $a_1 = 45°$ (for Alice)</li><li>$b_0 = 22.5°$, $b_1 = -22.5°$ (for Bob)</li></ul><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content>obviously, the measurement must be repeated a certain number of times (shots) to obtain statistically significant samples on which to apply the CHSH formula.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h2 id=63-complete-code>6.3. Complete code<a hidden class=anchor aria-hidden=true href=#63-complete-code>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_chsh_circuit</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create a circuit for the CHSH test with specific angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Create entangled state</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Rotations for Alice and Bob</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Measure</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>qc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate the correlation E(a,b) for given angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>create_chsh_circuit</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Execute the circuit</span>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate correlation</span>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=c1># +1 if bits are equal, -1 if different</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Optimal angles for CHSH test (in radians)</span>
</span></span><span class=line><span class=cl><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>b0</span><span class=p>,</span> <span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span><span class=p>,</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Calculate the 4 correlations</span>
</span></span><span class=line><span class=cl><span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Calculate the CHSH value</span>
</span></span><span class=line><span class=cl><span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a0, b0) = </span><span class=si>{</span><span class=n>E_a0_b0</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a0, b1) = </span><span class=si>{</span><span class=n>E_a0_b1</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a1, b0) = </span><span class=si>{</span><span class=n>E_a1_b0</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a1, b1) = </span><span class=si>{</span><span class=n>E_a1_b1</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>CHSH value S = </span><span class=si>{</span><span class=n>S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Classical limit: |S| ≤ 2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Quantum limit: |S| ≤ 2√2 ≈ 2.828&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>S</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>✓ Bell&#39;s inequalities are VIOLATED!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Einstein was wrong: local realism is incompatible with the results.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>✗ Bell&#39;s inequalities are respected.&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=64-expected-results>6.4. Expected results<a hidden class=anchor aria-hidden=true href=#64-expected-results>#</a></h2><p>Running the code above, we should get an S value close to $2\sqrt{2} \approx 2.828$, thus violating Bell&rsquo;s inequalities.</p><p>In practice, due to noise and imperfections of real quantum computers, we might get slightly lower values, but still above 2, demonstrating the violation of local realism.</p><h2 id=65-meaning-of-angles-and-bloch-sphere>6.5. Meaning of angles and Bloch sphere<a hidden class=anchor aria-hidden=true href=#65-meaning-of-angles-and-bloch-sphere>#</a></h2><p>To really understand what we&rsquo;re doing when we choose these specific angles in the CHSH test, we can introduce a fairly intuitive tool often used in quantum mechanics: the <strong>Bloch sphere</strong>.</p><h3 id=651-the-bloch-sphere>6.5.1. The Bloch sphere<a hidden class=anchor aria-hidden=true href=#651-the-bloch-sphere>#</a></h3><p>The Bloch sphere is a geometric representation of the state of a single qubit. Each point on the sphere&rsquo;s surface represents a pure quantum state. The two poles of the sphere represent the basis states:</p><ul><li>North pole: state $|0\rangle$</li><li>South pole: state $|1\rangle$</li></ul><p>The general state of a qubit can be written as:
$$|\psi\rangle = \cos(\theta/2)|0\rangle + e^{i\phi}\sin(\theta/2)|1\rangle$$</p><p>where:</p><ul><li>$\theta$ is the polar angle (from 0° at the north pole to 180° at the south pole)</li><li>$\phi$ is the azimuthal angle (rotation around the z-axis)</li></ul><h3 id=what-does-measuring-according-to-an-angle-mean>What does &ldquo;measuring according to an angle&rdquo; mean?<a hidden class=anchor aria-hidden=true href=#what-does-measuring-according-to-an-angle-mean>#</a></h3><p>Imagine the polarizer as an orientable filter: you can decide in which direction to orient it to measure the photon&rsquo;s polarization.</p><p><strong>Physical example with polarizers:</strong></p><ul><li>Alice orients her polarizer to $a_0 = 0°$ (vertical): she&rsquo;s asking &ldquo;is the photon polarized vertically or horizontally?&rdquo;</li><li>Alice orients her polarizer to $a_1 = 45°$ (diagonal): she&rsquo;s asking &ldquo;is the photon polarized at 45° or at 135°?&rdquo;</li></ul><p>Each polarizer orientation angle corresponds to a <strong>different question</strong> we ask the photon.</p><p><strong>In quantum computing:</strong>
Since quantum computers can only measure in the standard basis (called Z basis: $|0\rangle$ and $|1\rangle$), to measure according to a different angle we must:</p><ol><li><strong>Rotate</strong> the qubit&rsquo;s state by the desired angle</li><li><strong>Measure</strong> in the standard basis</li><li>The result is equivalent to having measured in the rotated basis</li></ol><p>In practice, in the code we use the gate <code>ry(2*θ)</code> before measurement. The factor 2 is a mathematical convention of the Bloch sphere (physical angles are doubled in the mathematical representation).</p><h3 id=652-the-optimal-angles-of-the-chsh-test>6.5.2. The optimal angles of the CHSH test<a hidden class=anchor aria-hidden=true href=#652-the-optimal-angles-of-the-chsh-test>#</a></h3><p>The optimal angles to maximize Bell inequality violation are:</p><ul><li>Alice: $a_0 = 0°$ and $a_1 = 45°$</li><li>Bob: $b_0 = 22.5°$ and $b_1 = -22.5°$</li></ul><p>These angles are arranged symmetrically and form a specific pattern on the Bloch sphere. The key is that:</p><ul><li>Alice&rsquo;s measurement directions ($a_0$ and $a_1$) are separated by 45°</li><li>Bob&rsquo;s measurement directions ($b_0$ and $b_1$) are separated by 45° (from -22.5° to +22.5°)</li><li>$b_0 = 22.5°$ is exactly halfway between $a_0$ and $a_1$</li><li>$b_1 = -22.5°$ is symmetric to $b_0$ with respect to the a₀ axis</li></ul><p>The configuration creates a symmetric arrangement where:</p><ul><li>The angular difference between $a_0$ and $b_0$ is 22.5°</li><li>The angular difference between $a_0$ and $b_1$ is 22.5° (in absolute value)</li><li>The angular difference between $a_1$ and $b_0$ is 22.5°</li><li>The angular difference between $a_1$ and $b_1$ is 67.5°</li></ul><p>This symmetry, with three differences of 22.5° and one of 67.5°, maximizes the quantum correlations that violate Bell&rsquo;s inequalities.</p><h3 id=653-visualization-of-optimal-angles>6.5.3. Visualization of optimal angles<a hidden class=anchor aria-hidden=true href=#653-visualization-of-optimal-angles>#</a></h3><h4 id=6531-interactive-version-plotly---for-jupyter-notebook>6.5.3.1. Interactive version (Plotly - for Jupyter Notebook)<a hidden class=anchor aria-hidden=true href=#6531-interactive-version-plotly---for-jupyter-notebook>#</a></h4><p>For an <strong>interactive</strong> visualization of optimal angles within the Bloch sphere, you can use this code based on Plotly (ideal for Jupyter Notebook):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>plotly.graph_objects</span> <span class=k>as</span> <span class=nn>go</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>angle_to_bloch_vector</span><span class=p>(</span><span class=n>theta</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Convert angles (theta, phi) to a vector on the Bloch sphere&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>theta_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>theta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>phi_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>phi_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>phi_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_sphere_mesh</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create mesh for Bloch sphere&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>size</span><span class=p>(</span><span class=n>u</span><span class=p>)),</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>plot_interactive_bloch_sphere</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create an interactive visualization of the Bloch sphere with CHSH angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fig</span> <span class=o>=</span> <span class=n>go</span><span class=o>.</span><span class=n>Figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add Bloch sphere</span>
</span></span><span class=line><span class=cl>    <span class=n>x_sphere</span><span class=p>,</span> <span class=n>y_sphere</span><span class=p>,</span> <span class=n>z_sphere</span> <span class=o>=</span> <span class=n>create_sphere_mesh</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Surface</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=n>x_sphere</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_sphere</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=n>z_sphere</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>opacity</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>colorscale</span><span class=o>=</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;lightgray&#39;</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;lightgray&#39;</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>        <span class=n>showscale</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add coordinate axes</span>
</span></span><span class=line><span class=cl>    <span class=n>axis_length</span> <span class=o>=</span> <span class=mf>1.3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># X axis</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;&lt;b&gt;X&lt;/b&gt;&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Y axis</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;&lt;b&gt;Y&lt;/b&gt;&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Z axis</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Labels |0⟩ and |1⟩</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>z_pos</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=p>[(</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>,</span> <span class=s1>&#39;&lt;b&gt;|0⟩&lt;/b&gt;&#39;</span><span class=p>),</span> <span class=p>(</span><span class=o>-</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>,</span> <span class=s1>&#39;&lt;b&gt;|1⟩&lt;/b&gt;&#39;</span><span class=p>)]:</span>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z_pos</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>label</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Optimal CHSH angles</span>
</span></span><span class=line><span class=cl>    <span class=n>alice_angles</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>45</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>bob_angles</span> <span class=o>=</span> <span class=p>[</span><span class=mf>22.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>22.5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>colors_alice</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;darkred&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>colors_bob</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;darkblue&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>labels_alice</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;a₀ (0°)&#39;</span><span class=p>,</span> <span class=s1>&#39;a₁ (45°)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>labels_bob</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;b₀ (22.5°)&#39;</span><span class=p>,</span> <span class=s1>&#39;b₁ (-22.5°)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add Alice&#39;s vectors</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>angle</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>alice_angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span> <span class=o>=</span> <span class=n>angle_to_bloch_vector</span><span class=p>(</span><span class=n>angle</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>y</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines+markers&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors_alice</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>8</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>marker</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>hovertemplate</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>}</span><span class=s1>&lt;extra&gt;&lt;/extra&gt;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>x</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>y</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add Bob&#39;s vectors</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>angle</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>bob_angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span> <span class=o>=</span> <span class=n>angle_to_bloch_vector</span><span class=p>(</span><span class=n>angle</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>y</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines+markers&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors_bob</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>8</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>marker</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>hovertemplate</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>}</span><span class=s1>&lt;extra&gt;&lt;/extra&gt;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>x</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>y</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Layout</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>update_layout</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>title</span><span class=o>=</span><span class=s1>&#39;Interactive Bloch Sphere: Optimal CHSH Angles&lt;br&gt;&#39;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s1>&#39;&lt;sub&gt;Rotate with mouse • Zoom with wheel • Pan with Shift+drag&lt;/sub&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>scene</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>xaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>yaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>zaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>aspectmode</span><span class=o>=</span><span class=s1>&#39;cube&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>camera</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>eye</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=mf>1.2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>height</span><span class=o>=</span><span class=mi>700</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fig</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create and show interactive graph</span>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plot_interactive_bloch_sphere</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Optional: save as interactive HTML</span>
</span></span><span class=line><span class=cl><span class=c1># fig.write_html(&#34;bloch_sphere_interactive.html&#34;)</span>
</span></span></code></pre></div><h3 id=654-graph-interpretation>6.5.4. Graph interpretation<a hidden class=anchor aria-hidden=true href=#654-graph-interpretation>#</a></h3><p><a href=/images/2025/bell/image-12.png><img src=/images/2025/bell/image-12.png alt="Visualization of optimal angles in the Bloch Sphere"></a></p><p><strong>Bloch Sphere (3D and 2D)</strong>: The geometric arrangement of measurement angles. Note the symmetry of the configuration: $b_0$ (22.5°) is positioned exactly halfway between $a_0$ (0°) and $a_1$ (45°), while $b_1$ (-22.5°) is symmetric with respect to the origin.</p><p><a href=/images/2025/bell/image-3.png><img src=/images/2025/bell/image-3.png alt="Correlation graphs"></a></p><ul><li><strong>Correlation vs Angular Difference</strong>: Shows how quantum correlation $E(\theta) = \cos(2\theta)$ depends on angular difference. CHSH angles are chosen to obtain specific correlation values that maximize S.</li><li><strong>CHSH value optimization</strong>: Visually demonstrates that the configuration with $a_1 = 45°$ (and consequently $b_0 = 22.5°$, $b_1 = -22.5°$) effectively maximizes the violation of Bell&rsquo;s inequalities.</li></ul><p>In the CHSH experiment, measurement directions are symmetrically arranged to maximally exploit quantum correlations allowed by entanglement, exceeding the classical limit of 2 and reaching Tsirelson&rsquo;s bound of $2\sqrt{2}$.</p><h2 id=66-what-does-this-result-mean>6.6. What does this result mean?<a hidden class=anchor aria-hidden=true href=#66-what-does-this-result-mean>#</a></h2><p>Bell inequality violation tells us that:</p><blockquote><p><strong>There cannot exist a description of the physical world that satisfies the principles of locality and realism.</strong></p></blockquote><p>In other words:</p><ul><li>Either &ldquo;actions at a distance&rdquo; exist that allow entangled particles to &ldquo;communicate&rdquo; instantaneously (violation of locality)</li><li>Or physical properties don&rsquo;t exist before measurement but are created by the act of observation itself (violation of realism)</li></ul><p>Most physicists today accept the interpretation that it&rsquo;s <strong>realism</strong> that&rsquo;s violated, while locality is preserved (although in a subtle way).</p><h2 id=67-other-interactive-experiments>6.7. Other interactive experiments<a hidden class=anchor aria-hidden=true href=#67-other-interactive-experiments>#</a></h2><p>Now that we&rsquo;ve seen the basic CHSH test, let&rsquo;s explore some additional experiments that help us better understand Bell inequality violation and the differences between quantum mechanics and local realism.</p><h3 id=671-variation-of-chsh-value-with-angles>6.7.1. Variation of CHSH value with angles<a hidden class=anchor aria-hidden=true href=#671-variation-of-chsh-value-with-angles>#</a></h3><p>This experiment shows how the CHSH value varies as Alice&rsquo;s angle $a_1$ varies, keeping other angles fixed. It allows us to graphically see why 45° is the optimal angle.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_chsh_value</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate CHSH value for a given angle configuration&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>S</span><span class=p>,</span> <span class=p>(</span><span class=n>E_a0_b0</span><span class=p>,</span> <span class=n>E_a0_b1</span><span class=p>,</span> <span class=n>E_a1_b0</span><span class=p>,</span> <span class=n>E_a1_b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vary angle a1 from 0 to 90 degrees</span>
</span></span><span class=line><span class=cl><span class=n>a1_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_values_quantum</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>s_values_classical</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>a1_values</span><span class=p>)</span>  <span class=c1># Classical limit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Calculating CHSH values for different angles...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a1</span> <span class=ow>in</span> <span class=n>a1_values</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Fixed angles</span>
</span></span><span class=line><span class=cl>    <span class=n>a0</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>b0</span> <span class=o>=</span> <span class=n>a1</span> <span class=o>/</span> <span class=mi>2</span>  <span class=c1># Optimal: halfway between a0 and a1</span>
</span></span><span class=line><span class=cl>    <span class=n>b1</span> <span class=o>=</span> <span class=o>-</span><span class=n>a1</span> <span class=o>/</span> <span class=mi>2</span>  <span class=c1># Symmetric with respect to a0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>compute_chsh_value</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s_values_quantum</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;a1 = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1</span><span class=p>)</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>°, S = </span><span class=si>{</span><span class=n>S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Graph</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_values</span><span class=p>),</span> <span class=n>s_values_quantum</span><span class=p>,</span> <span class=s1>&#39;b-o&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Quantum Simulation&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Classical Limit (|S| ≤ 2)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;g&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Tsirelson Bound (2√2 ≈ </span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;orange&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Optimal angle (45°)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Angle a₁ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;CHSH Value (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Bell Inequality Violation as Angle Varies&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_angle_variation.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Maximum violation at 45°: S ≈ </span><span class=si>{</span><span class=nb>max</span><span class=p>(</span><span class=n>s_values_quantum</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Theoretical limit: 2√2 ≈ </span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Expected result</strong>: The graph shows that maximum violation occurs precisely at 45°, where S reaches about 2.828.</p><h3 id=672-quantum-vs-classical-comparison-correlation-heatmap>6.7.2. Quantum vs classical comparison: correlation heatmap<a hidden class=anchor aria-hidden=true href=#672-quantum-vs-classical-comparison-correlation-heatmap>#</a></h3><p>This experiment visualizes quantum and classical correlations as heatmaps, allowing us to clearly see the difference.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_quantum_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate quantum correlation for two angles&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_classical_correlation</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Maximum classical correlation possible for an angular difference.
</span></span></span><span class=line><span class=cl><span class=s2>    With local hidden variables, maximum correlation is limited.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Classical model: linearly decreasing correlation</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=nb>abs</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Angle grid</span>
</span></span><span class=line><span class=cl><span class=n>angles</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>angles_deg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>angles</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Matrices for correlations</span>
</span></span><span class=line><span class=cl><span class=n>quantum_corr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>classical_corr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Calculating quantum and classical correlations...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>theta_a</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>theta_b</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Quantum correlation</span>
</span></span><span class=line><span class=cl>        <span class=n>quantum_corr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>compute_quantum_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Theoretical classical correlation</span>
</span></span><span class=line><span class=cl>        <span class=n>theta_diff</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>theta_a</span> <span class=o>-</span> <span class=n>theta_b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>classical_corr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>compute_classical_correlation</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Progress: </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Visualization</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>,</span> <span class=n>ax3</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Quantum heatmap</span>
</span></span><span class=line><span class=cl><span class=n>im1</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>quantum_corr</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdBu_r&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Bob Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Alice Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Quantum Correlations</span><span class=se>\n</span><span class=s1>(Simulation)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im1</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax1</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Correlation E(a,b)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Classical heatmap</span>
</span></span><span class=line><span class=cl><span class=n>im2</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>classical_corr</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdBu_r&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Bob Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Alice Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Classical Correlations</span><span class=se>\n</span><span class=s1>(Local Hidden Variables)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im2</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Correlation E(a,b)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Difference</span>
</span></span><span class=line><span class=cl><span class=n>difference</span> <span class=o>=</span> <span class=n>quantum_corr</span> <span class=o>-</span> <span class=n>classical_corr</span>
</span></span><span class=line><span class=cl><span class=n>im3</span> <span class=o>=</span> <span class=n>ax3</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>difference</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;seismic&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Bob Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Alice Angle (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Difference</span><span class=se>\n</span><span class=s1>(Quantum - Classical)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im3</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax3</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Difference&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;correlation_heatmaps.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Red zones in the difference map show where&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;quantum correlations exceed classical ones!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=/images/2025/bell/image-16.png><img src=/images/2025/bell/image-16.png alt="Heatmaps comparison"></a>
<strong>Interpretation</strong>: The heatmaps show how quantum correlations (which follow $\cos(2\theta)$) differ significantly from classical ones, especially for intermediate angles.</p><h3 id=673-interactive-exploration-of-chsh-parameters>6.7.3. Interactive exploration of CHSH parameters<a hidden class=anchor aria-hidden=true href=#673-interactive-exploration-of-chsh-parameters>#</a></h3><p>This experiment creates a complete parametric analysis of the CHSH angle space.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib.widgets</span> <span class=kn>import</span> <span class=n>Slider</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_single_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculate a single correlation&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2D analysis: simultaneous variation of a1 and b0</span>
</span></span><span class=line><span class=cl><span class=n>a1_range</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b0_range</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>S_matrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>b0_range</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Exploring CHSH parameter space...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;This may take a few minutes...</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>a1</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>a1_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>b0</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>b0_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a0</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>b1</span> <span class=o>=</span> <span class=o>-</span><span class=n>b0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>        <span class=n>S_matrix</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>S</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>5</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Progress: </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>a1_range</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3D visualization</span>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 1: 2D Heatmap</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>(</span><span class=mi>121</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>im</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>contourf</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=n>S_matrix</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=n>levels</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdYlGn&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>contour</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=n>S_matrix</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>levels</span><span class=o>=</span><span class=p>[</span><span class=mf>2.0</span><span class=p>],</span> <span class=n>colors</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>linestyles</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=mf>22.5</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=s1>&#39;b*&#39;</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Optimal configuration&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angle b₀ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angle a₁ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CHSH Value in Parameter Space&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax1</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;Classical limit&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 2: 3D Surface</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>(</span><span class=mi>122</span><span class=p>,</span> <span class=n>projection</span><span class=o>=</span><span class=s1>&#39;3d&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>B0</span><span class=p>,</span> <span class=n>A1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>surf</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>plot_surface</span><span class=p>(</span><span class=n>B0</span><span class=p>,</span> <span class=n>A1</span><span class=p>,</span> <span class=n>S_matrix</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdYlGn&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.9</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Classical limit plane</span>
</span></span><span class=line><span class=cl><span class=n>xx</span><span class=p>,</span> <span class=n>yy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>zz</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>xx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>plot_surface</span><span class=p>(</span><span class=n>xx</span><span class=p>,</span> <span class=n>yy</span><span class=p>,</span> <span class=n>zz</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angle b₀ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angle a₁ (degrees)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_zlabel</span><span class=p>(</span><span class=s1>&#39;CHSH Value (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;3D CHSH Surface&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>view_init</span><span class=p>(</span><span class=n>elev</span><span class=o>=</span><span class=mi>25</span><span class=p>,</span> <span class=n>azim</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>surf</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax2</span><span class=p>,</span> <span class=n>shrink</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_parameter_space.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Find maximum</span>
</span></span><span class=line><span class=cl><span class=n>max_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unravel_index</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>S_matrix</span><span class=p>),</span> <span class=n>S_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>max_a1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>[</span><span class=n>max_idx</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>max_b0</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>[</span><span class=n>max_idx</span><span class=p>[</span><span class=mi>1</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>max_S</span> <span class=o>=</span> <span class=n>S_matrix</span><span class=p>[</span><span class=n>max_idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Optimal configuration found:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  a₁ = </span><span class=si>{</span><span class=n>max_a1</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>°&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  b₀ = </span><span class=si>{</span><span class=n>max_b0</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>°&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  S = </span><span class=si>{</span><span class=n>max_S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Optimal theoretical value: a₁=45°, b₀=22.5°, S=2√2≈2.828&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=/images/2025/bell/image-17.png><img src=/images/2025/bell/image-17.png alt="Parameter space exploration"></a>
<strong>Result</strong>: This graph shows the &ldquo;mountain&rdquo; of the CHSH value in parameter space, with the peak precisely at the optimal configuration (45°, 22.5°).</p><h3 id=674-simulation-with-realistic-noise>6.7.4. Simulation with realistic noise<a hidden class=anchor aria-hidden=true href=#674-simulation-with-realistic-noise>#</a></h3><p>In the last experiment, we add noise to simulate imperfections of real quantum computers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer.noise</span> <span class=kn>import</span> <span class=n>NoiseModel</span><span class=p>,</span> <span class=n>depolarizing_error</span><span class=p>,</span> <span class=n>thermal_relaxation_error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_noisy_simulator</span><span class=p>(</span><span class=n>error_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>t1</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>t2</span><span class=o>=</span><span class=mi>70</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Create a simulator with realistic noise.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        error_rate: probability of error per gate (depolarizing)
</span></span></span><span class=line><span class=cl><span class=s2>        t1: relaxation time T1 (microseconds)
</span></span></span><span class=line><span class=cl><span class=s2>        t2: decoherence time T2 (microseconds)
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span> <span class=o>=</span> <span class=n>NoiseModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Depolarizing error on gates</span>
</span></span><span class=line><span class=cl>    <span class=n>error_gate1</span> <span class=o>=</span> <span class=n>depolarizing_error</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>error_gate2</span> <span class=o>=</span> <span class=n>depolarizing_error</span><span class=p>(</span><span class=n>error_rate</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Add errors to gates</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span><span class=o>.</span><span class=n>add_all_qubit_quantum_error</span><span class=p>(</span><span class=n>error_gate1</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;h&#39;</span><span class=p>,</span> <span class=s1>&#39;ry&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span><span class=o>.</span><span class=n>add_all_qubit_quantum_error</span><span class=p>(</span><span class=n>error_gate2</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;cx&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Thermal relaxation error</span>
</span></span><span class=line><span class=cl>    <span class=c1># gate_times = {&#39;h&#39;: 50, &#39;ry&#39;: 50, &#39;cx&#39;: 200, &#39;measure&#39;: 1000}  # in nanoseconds</span>
</span></span><span class=line><span class=cl>    <span class=c1># thermal_error = thermal_relaxation_error(t1*1000, t2*1000, gate_times[&#39;cx&#39;])</span>
</span></span><span class=line><span class=cl>    <span class=c1># noise_model.add_all_qubit_quantum_error(thermal_error, [&#39;cx&#39;])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>noise_model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_chsh_with_noise</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Execute CHSH test with a given noise level&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span> <span class=o>=</span> <span class=n>create_noisy_simulator</span><span class=p>(</span><span class=n>error_rate</span><span class=o>=</span><span class=n>error_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>(</span><span class=n>noise_model</span><span class=o>=</span><span class=n>noise_model</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Optimal angles</span>
</span></span><span class=line><span class=cl>    <span class=n>a0</span><span class=p>,</span> <span class=n>a1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span><span class=p>,</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>S</span><span class=p>,</span> <span class=p>(</span><span class=n>E_a0_b0</span><span class=p>,</span> <span class=n>E_a0_b1</span><span class=p>,</span> <span class=n>E_a1_b0</span><span class=p>,</span> <span class=n>E_a1_b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test with different noise levels</span>
</span></span><span class=line><span class=cl><span class=n>error_rates</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_values_noisy</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>s_std</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Simulation with realistic noise...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;This simulates imperfections of real quantum computers.</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>error_rate</span> <span class=ow>in</span> <span class=n>error_rates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Run multiple times to estimate variance</span>
</span></span><span class=line><span class=cl>    <span class=n>s_trials</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>S</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>run_chsh_with_noise</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>s_trials</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>s_values_noisy</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>s_trials</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>s_std</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>s_trials</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error rate: </span><span class=si>{</span><span class=n>error_rate</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% → S = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>s_trials</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ± </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>s_trials</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Visualization</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 1: S vs Error Rate</span>
</span></span><span class=line><span class=cl><span class=n>s_values_noisy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_std</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>s_std</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>errorbar</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>s_values_noisy</span><span class=p>,</span> <span class=n>yerr</span><span class=o>=</span><span class=n>s_std</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;o-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>color</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Simulation with noise&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Classical limit (S=2)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Ideal limit (S=2√2≈</span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>fill_between</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>s_values_noisy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>where</span><span class=o>=</span><span class=p>(</span><span class=n>s_values_noisy</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>),</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Violation zone&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Error rate per gate (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;CHSH Value (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Effect of Noise on Bell Violation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>([</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 2: Violation vs Error Rate</span>
</span></span><span class=line><span class=cl><span class=n>violation</span> <span class=o>=</span> <span class=n>s_values_noisy</span> <span class=o>-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>violation</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;green&#39;</span> <span class=k>if</span> <span class=n>v</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s1>&#39;red&#39;</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>violation</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Error rate per gate (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Violation (S - 2)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Margin of Bell Inequality Violation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Find critical point where S drops below 2</span>
</span></span><span class=line><span class=cl><span class=n>critical_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>s_values_noisy</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>critical_idx</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>critical_error</span> <span class=o>=</span> <span class=n>error_rates</span><span class=p>[</span><span class=n>critical_idx</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>critical_error</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>critical_error</span><span class=p>,</span> <span class=n>ax2</span><span class=o>.</span><span class=n>get_ylim</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s1>&#39;Critical point</span><span class=se>\n</span><span class=s1>~</span><span class=si>{</span><span class=n>critical_error</span><span class=si>:</span><span class=s1>.1f</span><span class=si>}</span><span class=s1>%&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>bbox</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>boxstyle</span><span class=o>=</span><span class=s1>&#39;round&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>facecolor</span><span class=o>=</span><span class=s1>&#39;wheat&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_with_noise.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>60</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;RESULTS:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - With 0% noise: S ≈ </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> (ideal)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - With 1% noise: S ≈ </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span><span class=o>*</span><span class=mf>0.2</span><span class=p>)]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - With 3% noise: S ≈ </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span><span class=o>*</span><span class=mf>0.6</span><span class=p>)]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>critical_idx</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Critical limit: ~</span><span class=si>{</span><span class=n>critical_error</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% (S drops below 2)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Violation persists up to </span><span class=si>{</span><span class=n>error_rates</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>60</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=/images/2025/bell/image-18.png><img src=/images/2025/bell/image-18.png alt="Noise effects"></a>
<strong>Interpretation</strong>: This graph shows how delicate quantum computers are. Even small errors reduce Bell violation, but fortunately it takes a fairly high error (>8%) before the violation completely disappears.</p><h1 id=7-conclusions-and-philosophical-reflections>7. Conclusions and philosophical reflections<a hidden class=anchor aria-hidden=true href=#7-conclusions-and-philosophical-reflections>#</a></h1><h2 id=71-who-was-right>7.1. Who was right?<a hidden class=anchor aria-hidden=true href=#71-who-was-right>#</a></h2><p>The Einstein-Bohr debate was one of the most fascinating in the history of physics. From a purely scientific point of view, we can say that <strong>Bohr was right</strong>: quantum mechanics is a complete and correct theory, and quantum phenomena cannot be explained with local hidden variable theories.</p><p>Einstein&rsquo;s fate was somewhat paradoxical: despite being recognized as one of the greatest physicists of all time, he was often misunderstood and isolated by the &ldquo;mainstream&rdquo; scientific community, both in the early phases of his career (with relativity) and in the final ones (with quantum mechanics).</p><p>In any case, I believe that the very formulation of the EPR problem, which then led to Bell&rsquo;s studies, Aspect&rsquo;s experiments, and those of many others, was once again an enormous contribution to physics and human knowledge.</p><h2 id=72-the-nature-of-reality>7.2. The nature of reality<a hidden class=anchor aria-hidden=true href=#72-the-nature-of-reality>#</a></h2><p>From a philosophical point of view, Bell&rsquo;s experiments teach us something profound about the nature of reality:</p><ol><li><strong>The world is not made of &ldquo;things&rdquo; with defined properties</strong> that exist independently of observation</li><li><strong>Reality emerges from interaction</strong> between observed system and measurement apparatus</li><li><strong>We cannot completely separate the observer from the observed</strong></li></ol><p>This doesn&rsquo;t mean that reality &ldquo;doesn&rsquo;t exist&rdquo; or that it&rsquo;s purely subjective, but rather that our classical intuition about what it means to &ldquo;exist&rdquo; must be profoundly revised in light of quantum phenomena.</p><p>In a certain sense, what we identify as &ldquo;reality&rdquo; is an emergent construct and doesn&rsquo;t transcend our interactions with the world.</p><hr><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li>Bell&rsquo;s original article (1964) &ldquo;<a href=https://cds.cern.ch/record/111654/files/vol1p195-200_001.pdf>ON THE EINSTEIN PODOLSKY ROSEN PARADOX</a>&rdquo;</li><li><a href=https://www.nobelprize.org/prizes/physics/2022/summary/>Nobel Prize 2022 - Announcement</a></li><li><a href=https://qiskit.org/documentation/>Qiskit Documentation</a></li><li><a href=https://quantum-computing.ibm.com/>IBM Quantum Experience</a></li><li><a href=https://physics.aps.org/articles/v8/123>Closing the Door on Einstein and Bohr&rsquo;s Quantum Debate</a></li><li><a href=https://arxiv.org/html/2501.01434v1>Simulating Bell&rsquo;s inequalities with Qibo</a></li></ul><section id=comments><script src=https://giscus.app/client.js data-repo=c-daniele/c-daniele.github.io data-repo-id=R_kgDOKIObxg data-category=Announcements data-category-id=DIC_kwDOKIObxs4Cu2th data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=it crossorigin=anonymous async></script></section></div><footer class=post-footer><ul class=post-tags><li><a href=https://c-daniele.github.io/en/tags/einstein/>Einstein</a></li><li><a href=https://c-daniele.github.io/en/tags/bell/>Bell</a></li><li><a href=https://c-daniele.github.io/en/tags/quantum-mechanics/>Quantum Mechanics</a></li><li><a href=https://c-daniele.github.io/en/tags/entanglement/>Entanglement</a></li></ul><nav class=paginav><a class=next href=https://c-daniele.github.io/en/posts/2025-08-31-alphaagents-a2a/><span class=title>Next »</span><br><span>AlphaAgents: Multi-Agent A2A Implementation for Collaborative Financial Analysis</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Bell's Inequalities: A quantum computing experiment with Qiskit on twitter" href="https://twitter.com/intent/tweet/?text=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit&amp;url=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f&amp;hashtags=Einstein%2cBell%2cQuantumMechanics%2cEntanglement"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bell's Inequalities: A quantum computing experiment with Qiskit on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f&amp;title=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit&amp;summary=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit&amp;source=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bell's Inequalities: A quantum computing experiment with Qiskit on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f&title=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bell's Inequalities: A quantum computing experiment with Qiskit on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bell's Inequalities: A quantum computing experiment with Qiskit on whatsapp" href="https://api.whatsapp.com/send?text=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit%20-%20https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bell's Inequalities: A quantum computing experiment with Qiskit on telegram" href="https://telegram.me/share/url?text=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit&amp;url=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bell's Inequalities: A quantum computing experiment with Qiskit on ycombinator" href="https://news.ycombinator.com/submitlink?t=Bell%27s%20Inequalities%3a%20A%20quantum%20computing%20experiment%20with%20Qiskit&u=https%3a%2f%2fc-daniele.github.io%2fen%2fposts%2f2025-10-11-bells-inequalities%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://c-daniele.github.io/en/>Cdani's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>