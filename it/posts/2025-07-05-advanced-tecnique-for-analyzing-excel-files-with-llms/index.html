<!doctype html><html lang=it dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM | Cdani's Blog</title><meta name=keywords content="ai,data,analysis,excel,langchain"><meta name=description content="Introduzione Come sviluppatori AI, cerchiamo sempre modi migliori per accedere ai dati e analizzarli in linguaggio naturale. Sebbene la Retrieval-Augmented Generation (RAG) abbia rivoluzionato il modo in cui interagiamo con documenti testuali non strutturati, essa mostra dei limiti quando si prova ad adottare le medesime tecniche sui dati strutturati.
D&rsquo;altro canto, l’approccio RAG si è dimostrato talmente efficace e versatile che utenti e sviluppatori AI alle prime armi possono cadere nell’illusione che sia applicabile a qualsiasi tipo di dato, inclusi i file strutturati o semistrutturati come gli Excel."><meta name=author content="Me"><link rel=canonical href=https://c-daniele.github.io/it/posts/2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3598bbf45621a4ad34d093926efeb15d6df27175e085d2f069483f14ad39d7fa.css integrity="sha256-NZi79FYhpK000JOSbv6xXW3ycXXghdLwaUg/FK051/o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=it href=https://c-daniele.github.io/it/posts/2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms/><link rel=alternate hreflang=en href=https://c-daniele.github.io/en/posts/2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0,theme:"default",securityLevel:"loose"})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-8NZQZ3Z1RN"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8NZQZ3Z1RN",{anonymize_ip:!1})}</script><meta property="og:title" content="Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM"><meta property="og:description" content="Introduzione Come sviluppatori AI, cerchiamo sempre modi migliori per accedere ai dati e analizzarli in linguaggio naturale. Sebbene la Retrieval-Augmented Generation (RAG) abbia rivoluzionato il modo in cui interagiamo con documenti testuali non strutturati, essa mostra dei limiti quando si prova ad adottare le medesime tecniche sui dati strutturati.
D&rsquo;altro canto, l’approccio RAG si è dimostrato talmente efficace e versatile che utenti e sviluppatori AI alle prime armi possono cadere nell’illusione che sia applicabile a qualsiasi tipo di dato, inclusi i file strutturati o semistrutturati come gli Excel."><meta property="og:type" content="article"><meta property="og:url" content="https://c-daniele.github.io/it/posts/2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms/"><meta property="og:image" content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-05T00:00:00+02:00"><meta property="article:modified_time" content="2025-07-05T00:00:00+02:00"><meta property="og:site_name" content="Cdani's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM"><meta name=twitter:description content="Introduzione Come sviluppatori AI, cerchiamo sempre modi migliori per accedere ai dati e analizzarli in linguaggio naturale. Sebbene la Retrieval-Augmented Generation (RAG) abbia rivoluzionato il modo in cui interagiamo con documenti testuali non strutturati, essa mostra dei limiti quando si prova ad adottare le medesime tecniche sui dati strutturati.
D&rsquo;altro canto, l’approccio RAG si è dimostrato talmente efficace e versatile che utenti e sviluppatori AI alle prime armi possono cadere nell’illusione che sia applicabile a qualsiasi tipo di dato, inclusi i file strutturati o semistrutturati come gli Excel."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM","item":"https://c-daniele.github.io/it/posts/2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM","name":"Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM","description":"Introduzione Come sviluppatori AI, cerchiamo sempre modi migliori per accedere ai dati e analizzarli in linguaggio naturale. Sebbene la Retrieval-Augmented Generation (RAG) abbia rivoluzionato il modo in cui interagiamo con documenti testuali non strutturati, essa mostra dei limiti quando si prova ad adottare le medesime tecniche sui dati strutturati.\nD\u0026rsquo;altro canto, l’approccio RAG si è dimostrato talmente efficace e versatile che utenti e sviluppatori AI alle prime armi possono cadere nell’illusione che sia applicabile a qualsiasi tipo di dato, inclusi i file strutturati o semistrutturati come gli Excel.","keywords":["ai","data","analysis","excel","langchain"],"articleBody":"Introduzione Come sviluppatori AI, cerchiamo sempre modi migliori per accedere ai dati e analizzarli in linguaggio naturale. Sebbene la Retrieval-Augmented Generation (RAG) abbia rivoluzionato il modo in cui interagiamo con documenti testuali non strutturati, essa mostra dei limiti quando si prova ad adottare le medesime tecniche sui dati strutturati.\nD’altro canto, l’approccio RAG si è dimostrato talmente efficace e versatile che utenti e sviluppatori AI alle prime armi possono cadere nell’illusione che sia applicabile a qualsiasi tipo di dato, inclusi i file strutturati o semistrutturati come gli Excel. Tuttavia, questa è una convinzione errata che può portare a frustrazione e inefficienza.\nUno dei formati di file più diffusi in tutte le organizzazioni è proprio l’Excel, che può essere considerato strutturato o almeno “semi-strutturato”. Chiunque abbia provato a processare un file Excel con il classico approccio RAG si sarà accorto rapidamente che applicare l’approccio RAG standard sui file Excel non porta praticamente da nessuna parte.\nIn questo post, spiego brevemente come ho costruito un sistema che combina alcune tecniche di prompting per creare uno strumento potente di analisi dei file Excel tramite l’utilizzo dell’SQL.\nTutto il codice è disponibile su GitHub\nPerché il RAG non funziona con i file Excel Il RAG è stato progettato per arricchire il prompt passato all’LLM con dati non strutturati provenienti da un ampio corpus documentale. Per identificare i chunk di testo rilevanti, viene utilizzata la similarità semantica ed ecco perché questo approccio fatica a mostrare risultati sensati con i dati Excel:\n1. L’architettura RAG L’architettura RAG è pensata per dati non strutturati dove la similarità semantica, utilizzata soprattutto nella fase di retrieval , è di fondamentale importanza. Tuttavia, l’analisi di dati su Excel richiede quasi sempre corrispondenze esatte, aggregazioni e relazioni complesse che non possono essere espresse semplicemente in termini di similarità. Il processo di suddivisione in chunk di RAG rompe la struttura intrinseca dei file Excel, portando alla perdita di informazioni essenziali come intestazioni di colonna, tipi di dato e relazioni tra le colonne. 2. La natura dei dati nei file Excel I file Excel sono spesso strutturati o semi-strutturati, con righe e colonne che definiscono chiare relazioni tra i dati. In molti casi, si tratta di vere e proprie estrazioni da database o report finanziari. Verosimilmente, l’intento dell’utente non è quello di estrarre informazioni in maniera “narrativa”, ma richiede invece l’applicazione di calcoli, aggregazioni e analisi statistiche. Nei dati strutturati, le intestazioni di colonna, i tipi di dato e le relazioni tra celle sono fondamentali e l’approccio RAG può completamente ignorare questi elementi chiave. La soluzione: Pipeline Excel-to-SQL potenziata da LLM Le capacità degli LLM stanno crescendo rapidamente e oggi una delle aree di applicazione più mature è senza dubbio la generazione di codice. In particolare, gli LLM sono molto bravi a generare codice SQL, che è un linguaggio di analisi potente e preciso per l’analisi dei dati strutturati. Quindi, anziché forzare l’architettura RAG sui dati strutturati (ad esempio con tecniche di chunking o augmentation creative), ho costruito una piccola soluzione di natura completamente diversa, che utilizza un LLM per convertire i dati letti da Excel in uno schema di database SQL e che dunque ci consente di sfruttare tutta la potenza espressiva del linguaggio SQL per interrogare e analizzare i dati.\nEcco l’architettura:\ngraph TD; A[Excel File Upload] --\u003e B[LLM Metadata Analysis]; B --\u003e C[Column Type Detection]; C --\u003e D[SQL Schema Generation]; D --\u003e E[Data Insertion]; E --\u003e F[Ready for Queries]; G[Natural Language Query] --\u003e H[LLM SQL Generation]; H --\u003e I[Query Execution]; I --\u003e J[Results \u0026 Visualization]; F --\u003e H; style A fill:#e1f5fe; style F fill:#e8f5e8; style J fill:#fff3e0; Per quanto riguarda il database, ho utilizzato SQLite per semplicità, ma questa architettura può essere adattata a qualsiasi database SQL. Per quanto riguarda l’LLM, ho utilizzato il modello gpt-4.1-mini di OpenAI, ma si può usare qualsiasi LLM comparabile.\nComponenti del sistema La pipeline è composta da quattro componenti principali:\n1. Metadata Analyzer Utilizza un LLM per analizzare i nomi degli sheet e le intestazioni delle colonne, deducendo la semantica del dato e la struttura dei dati:\nmetadata_prompt = PromptTemplate( input_variables=[\"sheet_name\", \"columns\"], partial_variables={ \"format_instructions\": metadata_parser.get_format_instructions() }, template=\"\"\" Analyze the following metadata of an Excel sheet: Sheet name: {sheet_name} Columns: {columns} Based on the column names, please return the following information: - suggested_table_name - description of the table content - primary_key_column_name_if_present - category (e.g., financial, sales, inventory, etc.) {format_instructions} Use table names in snake_case and in English. \"\"\" ) 2. Type Detection Engine Combina l’analisi LLM con un sampling dei dati per determinare i tipi di dato SQL corretti:\ngraph LR A[Sample Data] --\u003e B[LLM Analysis] A --\u003e C[Statistical Analysis] B --\u003e D[Final Type Decision] C --\u003e D D --\u003e E[SQL Schema] Al termine del processo, il sistema genera uno schema SQL che rappresenta la struttura dei dati e lo esegue per creare la tabella nel database.\n3. SQL Generator Converte le domande dell’utente espresse sotto forma di linguaggio naturale in query SQL, utilizzando lo schema del database come contesto di arricchimento del prompt:\nsql_prompt = PromptTemplate( input_variables=[\"question\", \"schema\", \"sample_data\"], template=\"\"\" Generate an SQL query to answer the following question: Question: {question} Database schema: {schema} Sample data: {sample_data} Generate ONLY the SQL query without any additional explanations. Use standard SQLite syntax. \"\"\" ) 4. Query Executor Esegue le query SQL generate e restituisce i risultati in un formato leggibile.\nReal-World Example: ETF Portfolio Analysis Vediamo ora un caso d’uso concreto, utilizzando come file di esempio la composizione delle holdings di un ETF XTrackers.\nIl file Excel è molto semplice e contiene il dettaglio delle posizioni dell’ETF “Xtrackers MSCI World ex USA UCITS”, con i relativi titoli sottostanti, il peso nel portafoglio e la classificazione settoriale. Di seguito sono riportati a titolo esemplificativo i primi record del file Excel:\nInput Excel File Structure ID Name ISIN Country Currency Exchange Type of Security Rating Industry Classification Weighting 1 SAP DE0007164600 Germany EUR XETRA Equity - Information Technology 1.47% 2 ASML HOLDING NV NL0010273215 Netherlands EUR Euronext Amsterdam Equity Baa2 Information Technology 1.46% 3 NESTLE SA CH0038863350 Switzerland CHF Scoach Switzerland Equity Aa2 Consumer Staples 1.22% 4 NOVARTIS AG CH0012005267 Switzerland CHF Scoach Switzerland Equity Aa3 Health Care 1.08% 5 ROCHE HOLDING PAR AG CH0012032048 Switzerland CHF Scoach Switzerland Equity A1 Health Care 1.06% 6 … ….. …. … … …… .. …. …% System Processing Steps Metadata Analysis\nL’LLM identifica la natura dei dati Suggerisce il nome della tabella: securities_list Identifica ID come candidato chiave primaria Type Detection\nID: NUMBER (sequence number) Name: TEXT (Company Name) ISIN: TEXT (Security Identifier) Country: TEXT (Country of origin) Currency: TEXT (Currency of the security) Exchange: TEXT (Trading exchange) Type of Security: TEXT (e.g., Equity, Bond) Rating: TEXT (Credit rating) Industry Classification: TEXT (Sector classification) Weighting: REAL (Percentage weight in the portfolio) SQL Schema Generation DDL della tabella generata automaticamene:\nCREATE TABLE securities_list ( id INTEGER NOT NULL, name TEXT NOT NULL, isin TEXT NOT NULL, country TEXT, currency TEXT NOT NULL, exchange TEXT, type_of_security TEXT NOT NULL, rating TEXT, industry_classification TEXT, weighting REAL ); Data Insertion Qui l’LLM genera automaticamente le istruzioni SQL INSERT per popolare la tabella con i dati del file Excel: Gestisce la conversione dei formati (B per miliardi, % per percentuali, etc…) Valida l’integrità dei dati Inserisce tutte le righe delle posizioni Query Examples Una volta processato il file, l’utente può fare domande in linguaggio naturale.\nIniziamo con una semplice domanda per verificare che il sistema funzioni correttamente:\nQuery: “How many rows are there in total?” Generated SQL SELECT COUNT(*) as N FROM securities_list; Output N 796 Ok, adesso vediamo una query più complessa che richiede aggregazione e comprensione della struttura dei dati:\nQuery: “Can you show me the weight of the portfolio for each Country and Sector?” Generated SQL SELECT country, industry_classification AS sector, SUM(weighting) AS total_weight FROM securities_list GROUP BY country, industry_classification; Output country industry_classification total_weight - unknown 0.00349444 Australia Communication Services 0.00139149 Australia Consumer Discretionary 0.00439915 Australia Consumer Staples 0.00200737 Australia Energy 0.00214571 Australia Financials 0.0250382 Australia Health Care 0.00195356 Australia Industrials 0.00295084 Australia Information Technology 0.000675708 …. …. …. Adesso facciamo un passo avanti e applichiamo alcune “where” conditions:\nQuery: “Show me the top 5 Non-European holdings by weight” Generated SQL SELECT name, country, weighting FROM securities_list WHERE country NOT IN ('Austria', 'Belgium', 'Bulgaria', 'Croatia', 'Cyprus', 'Czech Republic', 'Denmark', 'Estonia', 'Finland', 'France', 'Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Italy', 'Latvia', 'Lithuania', 'Luxembourg', 'Malta', 'Netherlands', 'Norway', 'Poland', 'Portugal', 'Romania', 'Slovakia', 'Slovenia', 'Spain', 'Sweden', 'Switzerland', 'United Kingdom') ORDER BY weighting DESC LIMIT 5; Output name Country weighting COMMONWEALTH BANK OF AUSTRALIA Australia 0.00917773 ROYAL BANK OF CANADA Canada 0.00869856 TOYOTA MOTOR CORP Japan 0.00762924 MITSUBISHI UFJ FINANCIAL GROUP INC Japan 0.00730266 SONY GROUP CORP Japan 0.00721053 Davvero non male!\nRisultati Premettendo che non ho fatto un’analisi esaustiva, ho comunque fatto qualche verifica a campione e i risultati sono stati quasi sempre corretti. Considerando che ho sviluppato il tutto in poche ore, il sistema ha dimostrato di essere molto efficace e preciso:\nHa processato tutte le righe dell’Excel già al primo tentativo Ha identificato e convertito correttamente i tipi di dato Ha generato SQL accurato anche per query complesse Ha fornito risposte immediate alle domande di analisi del portafoglio Implementation Highlights Smart Type Detection Il sistema utilizza un approccio a 2 stadi:\nLLM Analysis: Comprende il conteso e il significato di Business Statistical Validation: Conferma i pattern di validazione dei dati tramite le primitive di pandas, come pd.is_integer_dtype, pd.is_float_dtype, etc. Conversione robusta del formato per i casi più comuni Gestisce i problemi comuni di formattazione Excel:\nSimboli di valuta e abbreviazioni (K, M, B) Formattazione delle percentuali Variazioni nei formati data Celle vuote e validazione dei dati Context-Aware SQL Generation All’interno del prompt, l’LLM riceve:\nlo schema completo del database Alcuni dati di esempio le relazioni tra le colonne le domande precedenti per apprendere e migliorare le risposte Limitazioni Sebbene questo approccio sia potente, presenta alcune limitazioni:\nEfficacia: la qualità del file Excel è fondamentale. L’esempio utilizzato in questo post è un file “tabellare” piuttosto standard, ma spesso si incontrano strutture più complesse, come tabelle pivot, celle unite o formule articolate che possono risultare difficili da interpretare. Per ottenere i migliori risultati, il file Excel dovrebbe dunque sempre essere ripulito prima dell’analisi. Limiti degli LLM: la capacità dell’LLM di comprendere query complesse è ancora in evoluzione. Potrebbe avere difficoltà con domande molto tecniche o specifiche di un dominio. Performance: con file Excel molto grandi, l’analisi iniziale e la generazione dello schema SQL potrebbero richiedere molto tempo. Tuttavia, una volta creato lo schema, le query consentono dei tempi di analisi rapidissimi. Integrità dei dati: il sistema presuppone che i dati Excel siano puliti e ben strutturati. Se il file contiene errori o incongruenze, si rischia di generare SQL statement non ottimali (per esempio, con join non necessari o condizioni di filtro errate). Conclusioni e sviluppi futuri Questo approccio risolve il problema di come sfruttare efficacemente la Generative AI per analizzare i dati su file Excel, combinando la potenza degli LLM con la precisione del linguaggio SQL. I vantaggi principali sono:\nConservazione delle relazioni e della struttura dei dati Possibilità di eseguire query analitiche complesse Restituzione di risultati esatti e verificabili Mantenimento dell’integrità e dei tipi di dato Potenziali sviluppi futuri 1. Multi-Table Relationships Per gestire file Excel più complessi con più fogli e relazioni tra tabelle, il sistema potrebbe essere esteso per gestire relazioni tra più tabelle. Ad esempio, se il file Excel contiene un foglio con le holdings e un altro con la mappatura dei settori, il sistema potrebbe generare automaticamente le JOIN necessarie per analizzare i dati in modo più complesso.\ngraph TD A[Holdings Table] --\u003e C[JOIN Operations] B[Sector Mapping] --\u003e C C --\u003e D[Complex Analytics] 2. Advanced Analytics Funzioni statistiche (correlazione, regressione) Analisi delle serie temporali su dati storici Integrazione di modelli di machine learning 3. Visualization Pipeline # Future enhancement: Auto-generate charts def generate_visualization(query_result, question): # Analyze result structure # Choose appropriate chart type # Generate visualization code pass 4. Multi-Format Support Google Sheets integration CSV batch processing Database export 5. Query Optimization Query caching and reuse Index suggestions Performance monitoring Business Applications Questo sistema apre numerosi casi d’uso:\nAnalisi finanziaria: composizione del portafoglio, valutazione del rischio Sales Analytics: monitoraggio delle performance, analisi dei trend Gestione dell’inventario: livelli di stock, previsione della domanda HR Analytics: composizione della forza lavoro, metriche di performance Marketing Analytics: performance delle campagne, segmentazione dei clienti L’aspetto chiave è che i dati strutturati richiedono soluzioni strutturate. Combinando la comprensione del linguaggio naturale degli LLM con la potente capacità espressiva di SQL, possiamo creare strumenti potenti che rendono l’analisi di dati complessi accessibile a tutti.\n","wordCount":"2095","inLanguage":"it","datePublished":"2025-07-05T00:00:00+02:00","dateModified":"2025-07-05T00:00:00+02:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://c-daniele.github.io/it/posts/2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms/"},"publisher":{"@type":"Organization","name":"Cdani's Blog","logo":{"@type":"ImageObject","url":"https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://c-daniele.github.io/it/ accesskey=h title="Home (Alt + H)"><img src=https://c-daniele.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://c-daniele.github.io/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://c-daniele.github.io/it/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://c-daniele.github.io/it/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://c-daniele.github.io/it/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://c-daniele.github.io/it/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://c-daniele.github.io/it/>Home</a></div><h1 class=post-title>Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM</h1><div class=post-meta><span title='2025-07-05 00:00:00 +0200 +0200'>luglio 5, 2025</span>&nbsp;·&nbsp;10 minuti&nbsp;·&nbsp;2095 parole&nbsp;·&nbsp;Me&nbsp;|&nbsp;Traduzioni:<ul class=i18n_list><li><a href=https://c-daniele.github.io/en/posts/2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms/>En</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Indice contenuti</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-larchitettura-rag>1. <strong>L’architettura RAG</strong></a></li><li><a href=#2-la-natura-dei-dati-nei-file-excel>2. <strong>La natura dei dati nei file Excel</strong></a></li></ul><ul><li><a href=#componenti-del-sistema>Componenti del sistema</a><ul><li><a href=#1-metadata-analyzer>1. <strong>Metadata Analyzer</strong></a></li><li><a href=#2-type-detection-engine>2. <strong>Type Detection Engine</strong></a></li><li><a href=#3-sql-generator>3. <strong>SQL Generator</strong></a></li><li><a href=#4-query-executor>4. <strong>Query Executor</strong></a></li></ul></li></ul><ul><li><a href=#input-excel-file-structure>Input Excel File Structure</a></li><li><a href=#system-processing-steps>System Processing Steps</a></li><li><a href=#query-examples>Query Examples</a><ul><li></li></ul></li><li><a href=#risultati>Risultati</a></li></ul><ul><li><a href=#smart-type-detection>Smart Type Detection</a></li><li><a href=#conversione-robusta-del-formato-per-i-casi-più-comuni>Conversione robusta del formato per i casi più comuni</a></li><li><a href=#context-aware-sql-generation>Context-Aware SQL Generation</a></li></ul><ul><li><a href=#potenziali-sviluppi-futuri>Potenziali sviluppi futuri</a><ul><li><a href=#1-multi-table-relationships>1. <strong>Multi-Table Relationships</strong></a></li><li><a href=#2-advanced-analytics>2. <strong>Advanced Analytics</strong></a></li><li><a href=#3-visualization-pipeline>3. <strong>Visualization Pipeline</strong></a></li><li><a href=#4-multi-format-support>4. <strong>Multi-Format Support</strong></a></li><li><a href=#5-query-optimization>5. <strong>Query Optimization</strong></a></li></ul></li><li><a href=#business-applications>Business Applications</a></li></ul></nav></div></details></div><div class=post-content><h1 id=introduzione>Introduzione<a hidden class=anchor aria-hidden=true href=#introduzione>#</a></h1><p>Come sviluppatori AI, cerchiamo sempre modi migliori per accedere ai dati e analizzarli in linguaggio naturale. Sebbene la Retrieval-Augmented Generation (RAG) abbia rivoluzionato il modo in cui interagiamo con documenti testuali non strutturati, <strong>essa mostra dei limiti</strong> quando si prova ad adottare le medesime tecniche sui dati strutturati.</p><p>D&rsquo;altro canto, l’approccio RAG si è dimostrato talmente efficace e versatile che utenti e sviluppatori AI alle prime armi possono cadere <strong>nell’illusione che sia applicabile a qualsiasi tipo di dato</strong>, inclusi i file strutturati o semistrutturati come gli Excel. Tuttavia, questa è una convinzione errata che può portare a frustrazione e inefficienza.</p><p>Uno dei formati di file più diffusi in tutte le organizzazioni è proprio l’Excel, che può essere considerato strutturato o almeno &ldquo;semi-strutturato&rdquo;. Chiunque abbia provato a processare un file Excel con il classico approccio RAG si sarà accorto rapidamente che applicare l&rsquo;approccio RAG standard sui file Excel non porta praticamente da nessuna parte.</p><p>In questo post, spiego brevemente come ho costruito un sistema che combina alcune tecniche di prompting per creare uno strumento potente di analisi dei file Excel tramite l&rsquo;utilizzo dell&rsquo;SQL.</p><p>Tutto il codice è disponibile su <a href=https://github.com/c-daniele/llm-excel-analysis>GitHub</a></p><h1 id=perché-il-rag-non-funziona-con-i-file-excel>Perché il RAG non funziona con i file Excel<a hidden class=anchor aria-hidden=true href=#perché-il-rag-non-funziona-con-i-file-excel>#</a></h1><p>Il RAG è stato progettato per arricchire il prompt passato all’LLM con dati non strutturati provenienti da un ampio corpus documentale. Per identificare i chunk di testo rilevanti, viene utilizzata la similarità semantica ed ecco perché questo approccio fatica a mostrare risultati sensati con i dati Excel:</p><h2 id=1-larchitettura-rag>1. <strong>L’architettura RAG</strong><a hidden class=anchor aria-hidden=true href=#1-larchitettura-rag>#</a></h2><ul><li><strong>L’architettura RAG è pensata per dati non strutturati</strong> dove la <em>similarità semantica</em>, utilizzata soprattutto nella fase di <em>retrieval</em> , è di fondamentale importanza. Tuttavia, l&rsquo;analisi di dati su Excel richiede quasi sempre corrispondenze esatte, aggregazioni e relazioni complesse che non possono essere espresse semplicemente in termini di similarità.</li><li><strong>Il processo di suddivisione in chunk di RAG rompe la struttura intrinseca</strong> dei file Excel, portando alla perdita di informazioni essenziali come intestazioni di colonna, tipi di dato e relazioni tra le colonne.</li></ul><h2 id=2-la-natura-dei-dati-nei-file-excel>2. <strong>La natura dei dati nei file Excel</strong><a hidden class=anchor aria-hidden=true href=#2-la-natura-dei-dati-nei-file-excel>#</a></h2><ul><li>I file Excel sono spesso strutturati o semi-strutturati, con righe e colonne che definiscono chiare relazioni tra i dati. In molti casi, si tratta di vere e proprie estrazioni da database o report finanziari.</li><li>Verosimilmente, l&rsquo;intento dell&rsquo;utente non è quello di estrarre informazioni in maniera &ldquo;narrativa&rdquo;, ma richiede invece l&rsquo;applicazione di <strong>calcoli, aggregazioni e analisi statistiche</strong>.</li><li>Nei dati strutturati, le intestazioni di colonna, i tipi di dato e le relazioni tra celle sono fondamentali e l&rsquo;approccio RAG può completamente ignorare questi elementi chiave.</li></ul><h1 id=la-soluzione-pipeline-excel-to-sql-potenziata-da-llm>La soluzione: Pipeline Excel-to-SQL potenziata da LLM<a hidden class=anchor aria-hidden=true href=#la-soluzione-pipeline-excel-to-sql-potenziata-da-llm>#</a></h1><p>Le capacità degli LLM stanno crescendo rapidamente e oggi una delle aree di applicazione più mature è senza dubbio la <strong>generazione di codice</strong>. In particolare, gli LLM sono molto bravi a generare codice SQL, che è un linguaggio di analisi potente e preciso per l&rsquo;analisi dei dati strutturati.
Quindi, anziché forzare l&rsquo;architettura RAG sui dati strutturati (ad esempio con tecniche di chunking o augmentation creative), ho costruito una piccola soluzione di natura completamente diversa, che utilizza un LLM per <strong>convertire</strong> i dati letti da Excel in <strong>uno schema di database SQL</strong> e che dunque ci consente di sfruttare tutta la <strong>potenza espressiva del linguaggio SQL</strong> per interrogare e analizzare i dati.</p><p>Ecco l’architettura:</p><div class=mermaid>graph TD;
A[Excel File Upload] --> B[LLM Metadata Analysis];
B --> C[Column Type Detection];
C --> D[SQL Schema Generation];
D --> E[Data Insertion];
E --> F[Ready for Queries];
G[Natural Language Query] --> H[LLM SQL Generation];
H --> I[Query Execution];
I --> J[Results & Visualization];
F --> H;
style A fill:#e1f5fe;
style F fill:#e8f5e8;
style J fill:#fff3e0;</div><p>Per quanto riguarda il database, ho utilizzato SQLite per semplicità, ma questa architettura può essere adattata a qualsiasi database SQL.
Per quanto riguarda l’LLM, ho utilizzato il modello gpt-4.1-mini di OpenAI, ma si può usare qualsiasi LLM comparabile.</p><h2 id=componenti-del-sistema>Componenti del sistema<a hidden class=anchor aria-hidden=true href=#componenti-del-sistema>#</a></h2><p>La pipeline è composta da quattro componenti principali:</p><h3 id=1-metadata-analyzer>1. <strong>Metadata Analyzer</strong><a hidden class=anchor aria-hidden=true href=#1-metadata-analyzer>#</a></h3><p>Utilizza un LLM per analizzare i nomi degli sheet e le intestazioni delle colonne, deducendo la semantica del dato e la struttura dei dati:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>metadata_prompt</span> <span class=o>=</span> <span class=n>PromptTemplate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>input_variables</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;sheet_name&#34;</span><span class=p>,</span> <span class=s2>&#34;columns&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>partial_variables</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;format_instructions&#34;</span><span class=p>:</span> <span class=n>metadata_parser</span><span class=o>.</span><span class=n>get_format_instructions</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>template</span><span class=o>=</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Analyze the following metadata of an Excel sheet:
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Sheet name: </span><span class=si>{sheet_name}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Columns: </span><span class=si>{columns}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Based on the column names, please return the following information:
</span></span></span><span class=line><span class=cl><span class=s2>        - suggested_table_name
</span></span></span><span class=line><span class=cl><span class=s2>        - description of the table content
</span></span></span><span class=line><span class=cl><span class=s2>        - primary_key_column_name_if_present
</span></span></span><span class=line><span class=cl><span class=s2>        - category (e.g., financial, sales, inventory, etc.)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=si>{format_instructions}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Use table names in snake_case and in English.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><h3 id=2-type-detection-engine>2. <strong>Type Detection Engine</strong><a hidden class=anchor aria-hidden=true href=#2-type-detection-engine>#</a></h3><p>Combina l&rsquo;analisi LLM con un sampling dei dati per determinare i tipi di dato SQL corretti:</p><div class=mermaid>graph LR
A[Sample Data] --> B[LLM Analysis]
A --> C[Statistical Analysis]
B --> D[Final Type Decision]
C --> D
D --> E[SQL Schema]</div><p>Al termine del processo, il sistema genera uno schema SQL che rappresenta la struttura dei dati e lo esegue per creare la tabella nel database.</p><h3 id=3-sql-generator>3. <strong>SQL Generator</strong><a hidden class=anchor aria-hidden=true href=#3-sql-generator>#</a></h3><p>Converte le domande dell&rsquo;utente espresse sotto forma di linguaggio naturale in query SQL, utilizzando lo schema del database come contesto di arricchimento del prompt:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>sql_prompt</span> <span class=o>=</span> <span class=n>PromptTemplate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>input_variables</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;question&#34;</span><span class=p>,</span> <span class=s2>&#34;schema&#34;</span><span class=p>,</span> <span class=s2>&#34;sample_data&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>template</span><span class=o>=</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Generate an SQL query to answer the following question:
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Question: </span><span class=si>{question}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Database schema:
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=si>{schema}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Sample data:
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=si>{sample_data}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Generate ONLY the SQL query without any additional explanations.
</span></span></span><span class=line><span class=cl><span class=s2>    Use standard SQLite syntax.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><h3 id=4-query-executor>4. <strong>Query Executor</strong><a hidden class=anchor aria-hidden=true href=#4-query-executor>#</a></h3><p>Esegue le query SQL generate e restituisce i risultati in un formato leggibile.</p><h1 id=real-world-example-etf-portfolio-analysis>Real-World Example: ETF Portfolio Analysis<a hidden class=anchor aria-hidden=true href=#real-world-example-etf-portfolio-analysis>#</a></h1><p>Vediamo ora un caso d&rsquo;uso concreto, utilizzando come file di esempio la composizione delle holdings di un ETF XTrackers.<br>Il file Excel è molto semplice e contiene il dettaglio delle posizioni dell’ETF &ldquo;Xtrackers MSCI World ex USA UCITS&rdquo;, con i relativi titoli sottostanti, il peso nel portafoglio e la classificazione settoriale.
Di seguito sono riportati a titolo esemplificativo i primi record del file Excel:</p><h2 id=input-excel-file-structure>Input Excel File Structure<a hidden class=anchor aria-hidden=true href=#input-excel-file-structure>#</a></h2><table><thead><tr><th>ID</th><th>Name</th><th>ISIN</th><th>Country</th><th>Currency</th><th>Exchange</th><th>Type of Security</th><th>Rating</th><th>Industry Classification</th><th>Weighting</th></tr></thead><tbody><tr><td>1</td><td>SAP</td><td>DE0007164600</td><td>Germany</td><td>EUR</td><td>XETRA</td><td>Equity</td><td>-</td><td>Information Technology</td><td>1.47%</td></tr><tr><td>2</td><td>ASML HOLDING NV</td><td>NL0010273215</td><td>Netherlands</td><td>EUR</td><td>Euronext Amsterdam</td><td>Equity</td><td>Baa2</td><td>Information Technology</td><td>1.46%</td></tr><tr><td>3</td><td>NESTLE SA</td><td>CH0038863350</td><td>Switzerland</td><td>CHF</td><td>Scoach Switzerland</td><td>Equity</td><td>Aa2</td><td>Consumer Staples</td><td>1.22%</td></tr><tr><td>4</td><td>NOVARTIS AG</td><td>CH0012005267</td><td>Switzerland</td><td>CHF</td><td>Scoach Switzerland</td><td>Equity</td><td>Aa3</td><td>Health Care</td><td>1.08%</td></tr><tr><td>5</td><td>ROCHE HOLDING PAR AG</td><td>CH0012032048</td><td>Switzerland</td><td>CHF</td><td>Scoach Switzerland</td><td>Equity</td><td>A1</td><td>Health Care</td><td>1.06%</td></tr><tr><td>6</td><td>&mldr;</td><td>&mldr;..</td><td>&mldr;.</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;&mldr;</td><td>..</td><td>&mldr;.</td><td>&mldr;%</td></tr></tbody></table><h2 id=system-processing-steps>System Processing Steps<a hidden class=anchor aria-hidden=true href=#system-processing-steps>#</a></h2><ol><li><p><strong>Metadata Analysis</strong></p><ul><li>L&rsquo;LLM identifica la natura dei dati</li><li>Suggerisce il nome della tabella: <code>securities_list</code></li><li>Identifica <code>ID</code> come candidato chiave primaria</li></ul></li><li><p><strong>Type Detection</strong></p><ul><li><code>ID</code>: NUMBER (sequence number)</li><li><code>Name</code>: TEXT (Company Name)</li><li><code>ISIN</code>: TEXT (Security Identifier)</li><li><code>Country</code>: TEXT (Country of origin)</li><li><code>Currency</code>: TEXT (Currency of the security)</li><li><code>Exchange</code>: TEXT (Trading exchange)</li><li><code>Type of Security</code>: TEXT (e.g., Equity, Bond)</li><li><code>Rating</code>: TEXT (Credit rating)</li><li><code>Industry Classification</code>: TEXT (Sector classification)</li><li><code>Weighting</code>: REAL (Percentage weight in the portfolio)</li></ul></li><li><p><strong>SQL Schema Generation</strong>
DDL della tabella generata automaticamene:</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=w>   </span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>securities_list</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>isin</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>country</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>currency</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>exchange</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>type_of_security</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>rating</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>industry_classification</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>weighting</span><span class=w> </span><span class=nb>REAL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><ol><li><strong>Data Insertion</strong>
Qui l&rsquo;LLM genera automaticamente le istruzioni SQL INSERT per popolare la tabella con i dati del file Excel:<ul><li>Gestisce la conversione dei formati (B per miliardi, % per percentuali, etc&mldr;)</li><li>Valida l’integrità dei dati</li><li>Inserisce tutte le righe delle posizioni</li></ul></li></ol><h2 id=query-examples>Query Examples<a hidden class=anchor aria-hidden=true href=#query-examples>#</a></h2><p>Una volta processato il file, l&rsquo;utente può fare domande in linguaggio naturale.</p><p>Iniziamo con una semplice domanda per verificare che il sistema funzioni correttamente:</p><h4 id=query-how-many-rows-are-there-in-total><strong>Query</strong>: &ldquo;<em>How many rows are there in total?</em>&rdquo;<a hidden class=anchor aria-hidden=true href=#query-how-many-rows-are-there-in-total>#</a></h4><h4 id=generated-sql><strong>Generated SQL</strong><a hidden class=anchor aria-hidden=true href=#generated-sql>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>securities_list</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=output><strong>Output</strong><a hidden class=anchor aria-hidden=true href=#output>#</a></h4><table><thead><tr><th style=text-align:right>N</th></tr></thead><tbody><tr><td style=text-align:right>796</td></tr></tbody></table><hr><p>Ok, adesso vediamo una query più complessa che richiede aggregazione e comprensione della struttura dei dati:</p><h4 id=query-can-you-show-me-the-weight-of-the-portfolio-for-each-country-and-sector><strong>Query</strong>: &ldquo;<em>Can you show me the weight of the portfolio for each Country and Sector?</em>&rdquo;<a hidden class=anchor aria-hidden=true href=#query-can-you-show-me-the-weight-of-the-portfolio-for-each-country-and-sector>#</a></h4><h4 id=generated-sql-1><strong>Generated SQL</strong><a hidden class=anchor aria-hidden=true href=#generated-sql-1>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>country</span><span class=p>,</span><span class=w> </span><span class=n>industry_classification</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sector</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>weighting</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_weight</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>securities_list</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>country</span><span class=p>,</span><span class=w> </span><span class=n>industry_classification</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=output-1><strong>Output</strong><a hidden class=anchor aria-hidden=true href=#output-1>#</a></h4><table><thead><tr><th style=text-align:left>country</th><th style=text-align:left>industry_classification</th><th style=text-align:right>total_weight</th></tr></thead><tbody><tr><td style=text-align:left>-</td><td style=text-align:left>unknown</td><td style=text-align:right>0.00349444</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Communication Services</td><td style=text-align:right>0.00139149</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Consumer Discretionary</td><td style=text-align:right>0.00439915</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Consumer Staples</td><td style=text-align:right>0.00200737</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Energy</td><td style=text-align:right>0.00214571</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Financials</td><td style=text-align:right>0.0250382</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Health Care</td><td style=text-align:right>0.00195356</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Industrials</td><td style=text-align:right>0.00295084</td></tr><tr><td style=text-align:left>Australia</td><td style=text-align:left>Information Technology</td><td style=text-align:right>0.000675708</td></tr><tr><td style=text-align:left>&mldr;.</td><td style=text-align:left>&mldr;.</td><td style=text-align:right>&mldr;.</td></tr></tbody></table><hr><p>Adesso facciamo un passo avanti e applichiamo alcune &ldquo;where&rdquo; conditions:</p><h4 id=query-show-me-the-top-5-non-european-holdings-by-weight><strong>Query</strong>: &ldquo;<em>Show me the top 5 Non-European holdings by weight</em>&rdquo;<a hidden class=anchor aria-hidden=true href=#query-show-me-the-top-5-non-european-holdings-by-weight>#</a></h4><h4 id=generated-sql-2><strong>Generated SQL</strong><a hidden class=anchor aria-hidden=true href=#generated-sql-2>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>country</span><span class=p>,</span><span class=w> </span><span class=n>weighting</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>securities_list</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>country</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Austria&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Belgium&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Bulgaria&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Croatia&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Cyprus&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Czech Republic&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Denmark&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Estonia&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Finland&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;France&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Germany&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Greece&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Hungary&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Iceland&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Ireland&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Italy&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Latvia&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Lithuania&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Luxembourg&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Malta&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Netherlands&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Norway&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Poland&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Portugal&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Romania&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Slovakia&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Slovenia&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Spain&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Sweden&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Switzerland&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;United Kingdom&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>weighting</span><span class=w> </span><span class=k>DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>LIMIT</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=output-2><strong>Output</strong><a hidden class=anchor aria-hidden=true href=#output-2>#</a></h4><table><thead><tr><th style=text-align:left>name</th><th style=text-align:left>Country</th><th style=text-align:right>weighting</th></tr></thead><tbody><tr><td style=text-align:left>COMMONWEALTH BANK OF AUSTRALIA</td><td style=text-align:left>Australia</td><td style=text-align:right>0.00917773</td></tr><tr><td style=text-align:left>ROYAL BANK OF CANADA</td><td style=text-align:left>Canada</td><td style=text-align:right>0.00869856</td></tr><tr><td style=text-align:left>TOYOTA MOTOR CORP</td><td style=text-align:left>Japan</td><td style=text-align:right>0.00762924</td></tr><tr><td style=text-align:left>MITSUBISHI UFJ FINANCIAL GROUP INC</td><td style=text-align:left>Japan</td><td style=text-align:right>0.00730266</td></tr><tr><td style=text-align:left>SONY GROUP CORP</td><td style=text-align:left>Japan</td><td style=text-align:right>0.00721053</td></tr></tbody></table><hr><p>Davvero non male!</p><h2 id=risultati>Risultati<a hidden class=anchor aria-hidden=true href=#risultati>#</a></h2><p>Premettendo che non ho fatto un&rsquo;analisi esaustiva, ho comunque fatto qualche verifica a campione e i risultati sono stati quasi sempre corretti.
Considerando che ho sviluppato il tutto in poche ore, il sistema ha dimostrato di essere molto efficace e preciso:</p><ul><li>Ha processato tutte le righe dell’Excel già al primo tentativo</li><li>Ha identificato e convertito correttamente i tipi di dato</li><li>Ha generato SQL accurato anche per query complesse</li><li>Ha fornito risposte immediate alle domande di analisi del portafoglio</li></ul><h1 id=implementation-highlights>Implementation Highlights<a hidden class=anchor aria-hidden=true href=#implementation-highlights>#</a></h1><h2 id=smart-type-detection>Smart Type Detection<a hidden class=anchor aria-hidden=true href=#smart-type-detection>#</a></h2><p>Il sistema utilizza un approccio a 2 stadi:</p><ol><li><strong>LLM Analysis</strong>: Comprende il conteso e il significato di Business</li><li><strong>Statistical Validation</strong>: Conferma i pattern di validazione dei dati tramite le primitive di pandas, come <code>pd.is_integer_dtype</code>, <code>pd.is_float_dtype</code>, etc.</li></ol><h2 id=conversione-robusta-del-formato-per-i-casi-più-comuni>Conversione robusta del formato per i casi più comuni<a hidden class=anchor aria-hidden=true href=#conversione-robusta-del-formato-per-i-casi-più-comuni>#</a></h2><p>Gestisce i problemi comuni di formattazione Excel:</p><ul><li>Simboli di valuta e abbreviazioni (K, M, B)</li><li>Formattazione delle percentuali</li><li>Variazioni nei formati data</li><li>Celle vuote e validazione dei dati</li></ul><h2 id=context-aware-sql-generation>Context-Aware SQL Generation<a hidden class=anchor aria-hidden=true href=#context-aware-sql-generation>#</a></h2><p>All&rsquo;interno del prompt, l&rsquo;LLM riceve:</p><ul><li>lo schema completo del database</li><li>Alcuni dati di esempio</li><li>le relazioni tra le colonne</li><li>le domande precedenti per apprendere e migliorare le risposte</li></ul><h1 id=limitazioni>Limitazioni<a hidden class=anchor aria-hidden=true href=#limitazioni>#</a></h1><p>Sebbene questo approccio sia potente, presenta alcune limitazioni:</p><ul><li><strong>Efficacia</strong>: la qualità del file Excel è fondamentale. L’esempio utilizzato in questo post è un file “tabellare” piuttosto standard, ma spesso si incontrano strutture più complesse, come tabelle pivot, celle unite o formule articolate che possono risultare difficili da interpretare. Per ottenere i migliori risultati, il file Excel dovrebbe dunque sempre essere ripulito prima dell’analisi.</li><li><strong>Limiti degli LLM</strong>: la capacità dell’LLM di comprendere query complesse è ancora in evoluzione. Potrebbe avere difficoltà con domande molto tecniche o specifiche di un dominio.</li><li><strong>Performance</strong>: con file Excel molto grandi, l’analisi iniziale e la generazione dello schema SQL potrebbero richiedere molto tempo. Tuttavia, una volta creato lo schema, le query consentono dei tempi di analisi rapidissimi.</li><li><strong>Integrità dei dati</strong>: il sistema presuppone che i dati Excel siano puliti e ben strutturati. Se il file contiene errori o incongruenze, si rischia di generare SQL statement non ottimali (per esempio, con join non necessari o condizioni di filtro errate).</li></ul><h1 id=conclusioni-e-sviluppi-futuri>Conclusioni e sviluppi futuri<a hidden class=anchor aria-hidden=true href=#conclusioni-e-sviluppi-futuri>#</a></h1><p>Questo approccio risolve il problema di come sfruttare efficacemente la Generative AI per analizzare i dati su file Excel, combinando la potenza degli LLM con la precisione del linguaggio SQL. I vantaggi principali sono:</p><ul><li>Conservazione delle relazioni e della struttura dei dati</li><li>Possibilità di eseguire query analitiche complesse</li><li>Restituzione di risultati esatti e verificabili</li><li>Mantenimento dell’integrità e dei tipi di dato</li></ul><h2 id=potenziali-sviluppi-futuri>Potenziali sviluppi futuri<a hidden class=anchor aria-hidden=true href=#potenziali-sviluppi-futuri>#</a></h2><h3 id=1-multi-table-relationships>1. <strong>Multi-Table Relationships</strong><a hidden class=anchor aria-hidden=true href=#1-multi-table-relationships>#</a></h3><p>Per gestire file Excel più complessi con più fogli e relazioni tra tabelle, il sistema potrebbe essere esteso per gestire relazioni tra più tabelle. Ad esempio, se il file Excel contiene un foglio con le holdings e un altro con la mappatura dei settori, il sistema potrebbe generare automaticamente le JOIN necessarie per analizzare i dati in modo più complesso.</p><div class=mermaid>graph TD
A[Holdings Table] --> C[JOIN Operations]
B[Sector Mapping] --> C
C --> D[Complex Analytics]</div><h3 id=2-advanced-analytics>2. <strong>Advanced Analytics</strong><a hidden class=anchor aria-hidden=true href=#2-advanced-analytics>#</a></h3><ul><li>Funzioni statistiche (correlazione, regressione)</li><li>Analisi delle serie temporali su dati storici</li><li>Integrazione di modelli di machine learning</li></ul><h3 id=3-visualization-pipeline>3. <strong>Visualization Pipeline</strong><a hidden class=anchor aria-hidden=true href=#3-visualization-pipeline>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Future enhancement: Auto-generate charts</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_visualization</span><span class=p>(</span><span class=n>query_result</span><span class=p>,</span> <span class=n>question</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Analyze result structure</span>
</span></span><span class=line><span class=cl>    <span class=c1># Choose appropriate chart type</span>
</span></span><span class=line><span class=cl>    <span class=c1># Generate visualization code</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span></code></pre></div><h3 id=4-multi-format-support>4. <strong>Multi-Format Support</strong><a hidden class=anchor aria-hidden=true href=#4-multi-format-support>#</a></h3><ul><li>Google Sheets integration</li><li>CSV batch processing</li><li>Database export</li></ul><h3 id=5-query-optimization>5. <strong>Query Optimization</strong><a hidden class=anchor aria-hidden=true href=#5-query-optimization>#</a></h3><ul><li>Query caching and reuse</li><li>Index suggestions</li><li>Performance monitoring</li></ul><h2 id=business-applications>Business Applications<a hidden class=anchor aria-hidden=true href=#business-applications>#</a></h2><p>Questo sistema apre numerosi casi d’uso:</p><ul><li><strong>Analisi finanziaria</strong>: composizione del portafoglio, valutazione del rischio</li><li><strong>Sales Analytics</strong>: monitoraggio delle performance, analisi dei trend</li><li><strong>Gestione dell’inventario</strong>: livelli di stock, previsione della domanda</li><li><strong>HR Analytics</strong>: composizione della forza lavoro, metriche di performance</li><li><strong>Marketing Analytics</strong>: performance delle campagne, segmentazione dei clienti</li></ul><p>L’aspetto chiave è che i dati strutturati richiedono soluzioni strutturate. Combinando la comprensione del linguaggio naturale degli LLM con la potente capacità espressiva di SQL, possiamo creare strumenti potenti che rendono l’analisi di dati complessi accessibile a tutti.</p><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://c-daniele.github.io/it/tags/ai/>ai</a></li><li><a href=https://c-daniele.github.io/it/tags/data/>data</a></li><li><a href=https://c-daniele.github.io/it/tags/analysis/>analysis</a></li><li><a href=https://c-daniele.github.io/it/tags/excel/>excel</a></li><li><a href=https://c-daniele.github.io/it/tags/langchain/>langchain</a></li></ul><nav class=paginav><a class=prev href=https://c-daniele.github.io/it/posts/2025-08-15-agent-reg-for-a2a/><span class=title>« Precedente</span><br><span>Agent-Reg: Costruire un Agent Registry aperto per il Protocollo A2A</span></a>
<a class=next href=https://c-daniele.github.io/it/posts/2025-05-15-policy-puppetry/><span class=title>Successivo »</span><br><span>Policy Puppetry Prompt Injection</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM on twitter" href="https://twitter.com/intent/tweet/?text=Oltre%20il%20RAG%3a%20Come%20analizzare%20efficacemente%20un%20file%20Excel%20tramite%20un%20LLM&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f&amp;hashtags=ai%2cdata%2canalysis%2cexcel%2clangchain"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f&amp;title=Oltre%20il%20RAG%3a%20Come%20analizzare%20efficacemente%20un%20file%20Excel%20tramite%20un%20LLM&amp;summary=Oltre%20il%20RAG%3a%20Come%20analizzare%20efficacemente%20un%20file%20Excel%20tramite%20un%20LLM&amp;source=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f&title=Oltre%20il%20RAG%3a%20Come%20analizzare%20efficacemente%20un%20file%20Excel%20tramite%20un%20LLM"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM on whatsapp" href="https://api.whatsapp.com/send?text=Oltre%20il%20RAG%3a%20Come%20analizzare%20efficacemente%20un%20file%20Excel%20tramite%20un%20LLM%20-%20https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM on telegram" href="https://telegram.me/share/url?text=Oltre%20il%20RAG%3a%20Come%20analizzare%20efficacemente%20un%20file%20Excel%20tramite%20un%20LLM&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Oltre il RAG: Come analizzare efficacemente un file Excel tramite un LLM on ycombinator" href="https://news.ycombinator.com/submitlink?t=Oltre%20il%20RAG%3a%20Come%20analizzare%20efficacemente%20un%20file%20Excel%20tramite%20un%20LLM&u=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-07-05-advanced-tecnique-for-analyzing-excel-files-with-llms%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://c-daniele.github.io/it/>Cdani's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copia";function s(){t.innerHTML="copiato!",setTimeout(()=>{t.innerHTML="copia"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>