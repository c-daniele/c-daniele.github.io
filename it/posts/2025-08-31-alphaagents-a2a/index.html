<!doctype html><html lang=it dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa | Cdani's Blog</title><meta name=keywords content="ai,agent,A2A"><meta name=description content="1. Introduzione La quantità di framework che sta nascendo per lo sviluppo di applicazioni di GenAI è incredibile e a mio avviso inizia ad essere pure eccessiva. Ogniqualvolta salta fuori un nuovo framework, mi sembra che faccia più o meno le stesse cose di quello precedente. Magari alcuni hanno una capacità di modularizzazione migliore, oppure un disegno più robusto contro l&rsquo;obsolescenza nel lungo periodo, ma più o meno mi sembrano tutti gli stessi e, sebbene mi piaccia sperimentare, lo studio di nuovi mirabolanti e promettenti framework di GenAI comincia ad appassionarmi sempre meno."><meta name=author content="Me"><link rel=canonical href=https://c-daniele.github.io/it/posts/2025-08-31-alphaagents-a2a/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3598bbf45621a4ad34d093926efeb15d6df27175e085d2f069483f14ad39d7fa.css integrity="sha256-NZi79FYhpK000JOSbv6xXW3ycXXghdLwaUg/FK051/o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=it href=https://c-daniele.github.io/it/posts/2025-08-31-alphaagents-a2a/><link rel=alternate hreflang=en href=https://c-daniele.github.io/en/posts/2025-08-31-alphaagents-a2a/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-8NZQZ3Z1RN"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8NZQZ3Z1RN",{anonymize_ip:!1})}</script><meta property="og:title" content="AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa"><meta property="og:description" content="1. Introduzione La quantità di framework che sta nascendo per lo sviluppo di applicazioni di GenAI è incredibile e a mio avviso inizia ad essere pure eccessiva. Ogniqualvolta salta fuori un nuovo framework, mi sembra che faccia più o meno le stesse cose di quello precedente. Magari alcuni hanno una capacità di modularizzazione migliore, oppure un disegno più robusto contro l&rsquo;obsolescenza nel lungo periodo, ma più o meno mi sembrano tutti gli stessi e, sebbene mi piaccia sperimentare, lo studio di nuovi mirabolanti e promettenti framework di GenAI comincia ad appassionarmi sempre meno."><meta property="og:type" content="article"><meta property="og:url" content="https://c-daniele.github.io/it/posts/2025-08-31-alphaagents-a2a/"><meta property="og:image" content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-31T00:00:00+02:00"><meta property="article:modified_time" content="2025-08-31T00:00:00+02:00"><meta property="og:site_name" content="Cdani's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa"><meta name=twitter:description content="1. Introduzione La quantità di framework che sta nascendo per lo sviluppo di applicazioni di GenAI è incredibile e a mio avviso inizia ad essere pure eccessiva. Ogniqualvolta salta fuori un nuovo framework, mi sembra che faccia più o meno le stesse cose di quello precedente. Magari alcuni hanno una capacità di modularizzazione migliore, oppure un disegno più robusto contro l&rsquo;obsolescenza nel lungo periodo, ma più o meno mi sembrano tutti gli stessi e, sebbene mi piaccia sperimentare, lo studio di nuovi mirabolanti e promettenti framework di GenAI comincia ad appassionarmi sempre meno."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa","item":"https://c-daniele.github.io/it/posts/2025-08-31-alphaagents-a2a/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa","name":"AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa","description":"1. Introduzione La quantità di framework che sta nascendo per lo sviluppo di applicazioni di GenAI è incredibile e a mio avviso inizia ad essere pure eccessiva. Ogniqualvolta salta fuori un nuovo framework, mi sembra che faccia più o meno le stesse cose di quello precedente. Magari alcuni hanno una capacità di modularizzazione migliore, oppure un disegno più robusto contro l\u0026rsquo;obsolescenza nel lungo periodo, ma più o meno mi sembrano tutti gli stessi e, sebbene mi piaccia sperimentare, lo studio di nuovi mirabolanti e promettenti framework di GenAI comincia ad appassionarmi sempre meno.","keywords":["ai","agent","A2A"],"articleBody":"1. Introduzione La quantità di framework che sta nascendo per lo sviluppo di applicazioni di GenAI è incredibile e a mio avviso inizia ad essere pure eccessiva. Ogniqualvolta salta fuori un nuovo framework, mi sembra che faccia più o meno le stesse cose di quello precedente. Magari alcuni hanno una capacità di modularizzazione migliore, oppure un disegno più robusto contro l’obsolescenza nel lungo periodo, ma più o meno mi sembrano tutti gli stessi e, sebbene mi piaccia sperimentare, lo studio di nuovi mirabolanti e promettenti framework di GenAI comincia ad appassionarmi sempre meno.\nTanto per capirci, qualche giorno fa, mi sono imbattuto in AnyAgent: l’ennesimo framework che fa da wrapper verso altri framework! Nello specifico, non voglio essere frainteso, il lavoro che sta facendo il team di Mozilla in ambito AI è encomiabile e consiglio anche una lettura del loro blog, che pubblica articoli molto interessanti, ma questo genere di sovrastrutture Kafkiane mi sembra che introduca più problemi di quelli che risolva perché ogni stratificazione complica la manutenibilità del software nel lungo periodo, senza contare tutti i problemi di dipendenze, compatibilità e aggiornamenti.\nTrovo inoltre inutilmente dispendioso specializzarmi sull’uno framework o sull’altro in maniera verticale, sia per una questione di lock-in, ma anche per non perdere quella capacità di astrazione che mi serve nel disegnare una soluzione end-to-end.\nUn altro tema su cui quasi tutti i framework stanno dimostrando le loro limitazioni è nel supporto al multi-agent. I primissimi framework per lo sviluppo di GenAI si concentravano principalmente sul wrapping degli LLM, sul tracing e sul chaining, mentre ora la maggior parte dell’attenzione è rivolta alle funzionalità agentiche (odio questa parola), ma nella stragrande maggioranza dei casi, la progettazione originale dei framework è rimasta la stessa.\nLa maggior parte di questi framework è infatti ancora monolitica, il che rende difficile realizzare una vera applicazione multi-agente senza essere vincolati al framework specifico e al runtime sottostante.\nEd è qui che entra in gioco A2A (Agent-to-Agent). Il protocollo A2A mira a consentire una comunicazione e collaborazione fluida tra agenti, indipendentemente dal framework o runtime utilizzato, tramite formati di messaggistica e protocolli di trasporto standardizzati. Piuttosto che proseguire nello studio o approfondimento di questo o quell’altro framework, ho deciso di prendere sul serio il protocollo A2A e cercare di realizzare una soluzione applicativa end-to-end, compatibile con questo standard.\nIl primo passo era quello di risolvere il problema della discovery e nel mio post precedente ho descritto come costruire un semplice Agent Registry che si adatta bene al protocollo A2A.\nIn seguito, volevo buttarmi su un caso d’uso concreto, quindi ho cercato qualche applicazione interessante da affrontare con la mia nuova architettura Multi-Agent A2A-compliant. Mi sono quindi imbattuto per caso nel paper AlphaAgents, pubblicato pochi giorni fa su arXiv dal team di BlackRock.\nIl paper descrive un approccio di collaborazione multi-agente per supportare la stock selection e l’analisi finanziaria a partire da un set di titoli. Ho pensato che fosse un caso d’uso perfetto e mi ci sono buttato! Sfortunatamente, il team BlackRock non ha rilasciato il codice sorgente, quindi ho dovuto implementare l’intera soluzione AlphaAgent da solo, utilizzando il paper come specifica di alto livello. Ho comunque dovuto fare alcune assunzioni e semplificazioni, ad esempio i tool di estrazione e sintesi delle informazioni dell’agente che fa le analisi fondamentali non si basano realmente su RAG, ma piuttosto su tecniche molto banali di lookup tramite parole chiave o prefissi a partire dai dati restituiti da Yahoo Finance. Di conseguenza, l’implementazione non è conforme al 100% a quanto descritto nel paper, ma può essere un valido punto di partenza. In ogni caso, il mio focus è stato più sull’architettura che sull’affidabilità della risposta dei singoli agenti. Ho cercato inoltre di avere una visione agnostica rispetto al framework GenAI sottostante, dove l’agente orchestratore può ricercare e selezionare gli agenti specializzati a runtime, ignorando completamente i dettagli sottostanti in termini di modelli, linguaggi e librerie.\nNei capitoli che seguono, faccio un breve recap di cos’è AlphaAgents e come funziona in teoria, descrivo dunque l’architettura della mia implementazione A2A-compliant e alcuni dettagli tecnici e poi mostrerò cosa accade durante i singoli step di una esecuzione concreta.\nAggiungo anche un disclaimer probabilmente ovvio ma doveroso: l’output del sistema è da intendersi come puramente dimostrativo ai fini della soluzione multi-agent e non deve essere considerato in alcun modo come input per qualsiasi tipo di decisione finanziaria. Aggiungo inoltre che, sebbene abbia fatto qualche controllo puntuale di coerenza sui KPI calcolati, rilevando risultati più o meno in linea con le aspettatove, non è stato fatto un controllo approfondito e rigoroso della validità dei risultati. Non escludo dunque la possibilità di errori sistematici o ri-formulazioni delle risposte condizionate da allucinazioni dell’LLM.\n2. Breve introduzione su AlphaAgents Il paper AlphaAgents introduce un approccio innovativo al problema della selezione di titoli azionari attraverso un sistema multi-agente basato su Large Language Models (LLM).\n2.1 Il problema e la soluzione Le analisi di portafoglio tradizionali richiedono un notevole sforzo umano per processare enormi quantità di dati eterogenee: documenti SEC (10-K, 10-Q), trascrizioni di earnings call, target price, ratio finanziari, news di mercato e ricerche settoriali. Questo processo presenta inoltre significative sfide in termini di scalabilità e obiettività. Uno dei rischi citati più volte nel paper è infatti quello di propendere verso allocazioni sub-ottimali a causa di fattori soggettivi come l’avversione al rischio o l’eccessiva confidenza nelle proprie intuizioni.\nGli AlphaAgents affrontano questi problemi attraverso un framework multi-agente che incorpora alcune tecniche di adversarial reasoning e che suddivide l’analisi finanziaria in aree di specializzazione distinte, ciascuna gestita da un agente dedicato.\n2.2 I tre agenti Fundamental Agent: Si occupa dell’analisi fondamentale tradizionale, esaminando in profondità i bilanci, i flussi di cassa e le performance finanziarie attraverso l’analisi di documenti SEC e report finanziari.\nSentiment Agent: Analizza il sentiment di mercato attraverso l’elaborazione di news finanziarie, cambiamenti nei rating degli analisti e disclosure aziendali per valutare l’impatto potenziale sui prezzi delle azioni.\nValuation Agent: Si concentra sull’analisi tecnica e quantitativa, processando dati storici di prezzi e volumi per calcolare metriche di volatilità, rendimenti corretti per il rischio e indicatori di valutazione.\n2.3 Il meccanismo di collaborazione e debate Il framework implementa un meccanismo di coordinamento centralizzato attraverso un Group Chat Agent che gestisce l’interazione tra gli agenti specializzati. Questo agente coordinatore:\nInstrada le richieste verso gli agenti più appropriati in base al tipo di analisi richiesta usando un approccio basato sull’LLM Gestisce il processo di debate strutturato implementando un approccio di tipo “round-robin” Garantisce la partecipazione equa assicurando che ogni agente parli almeno due volte durante il debate Facilita la convergenza attraverso un sistema di consensus building che prevede la condivisione dei risultati intermedi con tutti gli agenti Sintetizza le analisi multiple in un report coerente che evidenzia il processo di debate Mitiga le allucinazioni attraverso il confronto cross-agent e la validazione collaborativa Ricapitolando in poche parole: gli agenti si confrontano in turni sequenziali fino al raggiungimento del consenso, eliminando il rischio che alcuni agenti dominino la discussione.\ngraph TD A[Richiesta Utente] --\u003e B[Group Chat Agent] B --\u003e C{LLM-based Debate Detection} C --\u003e|Investment Decision| D[Structured Debate Mode] C --\u003e|Factual Query| E[Simple Coordination] D --\u003e F[Round 1: Initial Positions] F --\u003e G[Agent 1 Turn] G --\u003e H[Agent 2 Turn] H --\u003e I[Agent 3 Turn] I --\u003e J[Round 2: Debate \u0026 Counter-arguments] J --\u003e K[Agent 1 Response] K --\u003e L[Agent 2 Response] L --\u003e M[Agent 3 Response] M --\u003e N{Consensus Check} N --\u003e|No Consensus| O[Additional RoundsMax 5 rounds] O --\u003e J N --\u003e|Consensus| P[Participation CheckMin 2 turns each] P --\u003e|Insufficient| Q[Extra Turns] Q --\u003e P P --\u003e|Sufficient| R[Debate Consolidation] E --\u003e S[Concurrent Agent Calls] S --\u003e T[Simple Consolidation] R --\u003e U[Final Report with Debate Metadata] T --\u003e V[Final Report - Standard] style B fill:#e1f5fe style D fill:#fff3e0 style N fill:#ffecb3 style R fill:#e8f5e8 style C fill:#f3e5f5 2.4 Gestione Intelligente del Risk Tolerance Un aspetto innovativo del framework è l’incorporamento di profili di tolleranza al rischio indicati dall’utente. Nel paper non è indicato precisamente in che modo il team di BlackRock ha implemetato l’introduzione di questi profili, ma ipotizzo che abbiano utilizzato dei meccanismi di prompting per inferire automaticamente il livello di rischio dalla query dell’utente. Partendo da questa analisi sulla query utente, viene dunque estrapolata una indicazione precisa del profilo di rischio desiderato, che poi viene utilizzata in tutte le interazioni con gli agenti.\nQuesto semplice accorgimento, consente dunque di aggiungere un livello di personalizzazione alle raccomandazioni fornite dagli agenti.\n2.4.1 Classificazione dei Profili di Rischio Risk-averse: Investitori conservativi che prioritizzano la conservazione del capitale, ricerca di rendimenti stabili, azioni dividend-paying, bassa volatilità, approccio safety-first Risk-neutral: Investitori bilanciati che cercano crescita moderata con rischio ragionevole, portafogli diversificati, esposizione di mercato standard Risk-seeking: Investitori aggressivi che perseguono rendimenti elevati, accettano alta volatilità, azioni growth, investimenti speculativi 2.4.2 Esempi di Classificazione Automatica 🟢 Risk-Averse (Conservativo): \"Sto cercando investimenti sicuri e stabili per la mia pensione\" \"Cerco azioni sicure con dividendi regolari\" \"Voglio preservare il mio capitale senza rischi\" 🟡 Risk-Neutral (Bilanciato): \"Dovrei investire in Tesla? Voglio un'analisi equilibrata\" \"Devo investire in azioni Apple?\" \"Analisi delle azioni Microsoft per il mio portafoglio\" 🔴 Risk-Seeking (Aggressivo): \"Voglio azioni ad alta crescita anche se volatili\" \"Voglio rendimenti massimi, posso gestire un rischio elevato\" \"Cerco investimenti ad alto potenziale\" 2.4.3 Integrazione nel Processo di Debate Il profilo di rischio viene dunque:\nPassato a tutti gli agenti specializzati tramite metadati nel messaggio JSON-RPC Mantenuto durante tutto il debate per coerenza delle raccomandazioni Registrato nei log per trasparenza del processo decisionale Utilizzato per personalizzare le analisi di ciascun agente specialist 2.5 Vantaggi dell’approccio multi-agente con debate strutturato Il sistema offre diversi benefici rispetto all’analisi tradizionale:\nMitigazione dei bias: Ogni agente opera in modo indipendente, riducendo l’impatto dei bias cognitivi umani Partecipazione equa: Il meccanismo di turn-taking consente a tutti gli agenti di contribuire in modo equo Validazione collaborativa: Le posizioni individuali vengono sottoposte a “challenge” e raffinate attraverso il confronto diretto Convergenza guidata: Il sistema di consensus building porta a decisioni più robuste e ponderate Personalizzazione automatica: Risk tolerance inferito automaticamente per analisi su misura Adattamento multilingue: Sistema nativo per utenti di qualsiasi lingua senza configurazione Scalabilità: Capacità di processare volumi molto maggiori di informazioni Specializzazione: Ogni agente può sviluppare expertise approfondita nel proprio dominio Flessibilità: Il framework può essere esteso con agenti aggiuntivi (es. Technical Analysis Agent, Macro Economist Agent) 3. Punto di partenza Per realizzare il codice, ho fatto ampio uso di Claude Code, ma ho dedicato una quantità di tempo rilevante per la definizione delle specifiche tecniche di dettaglio rispetto a ciò che avevo in mente dopo aver letto il paper (es: struttura delle classi, gestione dei tool, etc), nonché per il testing e la modifica o la revisione di alcune classi e metodi.\nPremesso che ciascun agente potrebbe essere implementato in modo indipendente, mi sono basato per semplicità sul seguente ecosistema:\nRuntime: Python3.12 Package manager: uv GenAI Framework: Langchain Agents (ma potrebbe essere sostituito con un altro framework tipo Autogen, CrewAI, Smolagents, etc) Serving Layer: FastAPI Protocollo di comunicazione: JSON-RPC Test: semplici script python rilanciabili Architettura basata sull’Agent Registry, con discovery dynamica dell’Agent Card per ciascun agente LLM: per semplicità ho utilizzato GPT-4o, senza farmi troppi problemi sulla scelta del modello Nei capitoli che seguono, illustro dettagliatamente l’architettura e l’implementazione. Ovviamente, uno degli step propedeutici è stato anche quello di corredare ciascun agente anche di un endpoint in cui esporre la Agent Card secondo il solito path “.well-known/agent-card” e registrare gli agenti all’interno dell’Agent Registry (Figura 1)\nFigura 1 - Aggiunta del Valuation Agent 4. Design di alto livello L’architettura è abbastanza semplice: si tratta di:\n1 Agent Registry che gestisce la registrazione e la discovery degli agenti (si tratta del modulo che ho discusso nel mio precedente articolo) 3 agenti specializzati, ciascuno in esecuzione su un host e una porta specifica (nel mio caso, localhost e porte 3001-3003) 1 agente di orchestrazione, che riceve gli input dell’utente, richiama gli altri agenti e produce la risposta finale. 4.1 Architettura Logica Complessiva Ho lanciato tutti gli agenti in locale e configurato le Agent Card di conseguenza, ma ovviamente il sistema è progettato per supportare anche deployment distribuiti.\n%%{init: {\"themeVariables\": { \"fontSize\": \"16px\", \"nodeSpacing\": 50, \"rankSpacing\": 70 }}}%% graph TD %% Client Layer subgraph \"Client Layer\" CLI[CLI Client] WEB[Web Interface] API[API Client] end %% A2A Protocol Layer subgraph \"A2A Protocol Layer\" JSONRPC[JSON-RPC Transport] A2AMSG[A2A Message Format] end %% Agent Registry subgraph \"Agent Registry\" REG[Agent Registry Service] REGDB[(Agent Cards DB)] end %% Orchestration Layer subgraph \"Orchestration Layer\" GCA[Group Chat Agent] ROUTER[Intelligent Routing] CONSOLIDATOR[Response Consolidator] end %% Specialized Agents subgraph \"Specialized Agents\" FA[Fundamental Agent:3002] SA[Sentiment Agent:3003] VA[Valuation Agent:3001] end %% External Data Sources subgraph \"External Data Sources\" YF[Yahoo Finance API] SEC[SEC EDGAR API] NEWS[\"Financial News APIs\"] end %% AI/LLM Layer subgraph \"AI/LLM Layer\" GPT[OpenAI GPT-4o] VADER[VADER Sentiment] TEXTBLOB[TextBlob Analysis] end %% Connessioni principali CLI --\u003e JSONRPC WEB --\u003e JSONRPC API --\u003e JSONRPC JSONRPC --\u003e A2AMSG A2AMSG --\u003e GCA GCA --\u003e REG REG --\u003e REGDB GCA --\u003e ROUTER ROUTER --\u003e FA ROUTER --\u003e SA ROUTER --\u003e VA FA --\u003e CONSOLIDATOR SA --\u003e CONSOLIDATOR VA --\u003e CONSOLIDATOR CONSOLIDATOR 4.2 Processo di registrazione Nel mio caso, ho eseguito manualmente la registrazione sull’agent registry (Figura 1), tuttavia il processo potrebbe tranquillamente essere automatizzato. In sostanza, ogni Agent che vuole essere pubblicato all’interno dell’organizzazione potrebbe registrarsi autonomamente sull’Agent Registry.\nSia nel caso di registrazione manuale che automatica, il Group Chat Agent può in seguito interrogare l’Agent Registry e scoprire gli agenti specializzati necessari per rispondere a una richiesta dell’utente e decidere come orchestrare la comunicazione tra di essi.\nsequenceDiagram participant GCA as Group Chat Agent participant REG as Agent Registry participant FA as Fundamental Agent participant SA as Sentiment Agent participant VA as Valuation Agent Note over FA,VA: Agent Startup \u0026 Registration FA-\u003e\u003eREG: POST /agents/register{agent_card, endpoints} REG--\u003e\u003eFA: 200 OK {agent_id} SA-\u003e\u003eREG: POST /agents/register{agent_card, endpoints} REG--\u003e\u003eSA: 200 OK {agent_id} VA-\u003e\u003eREG: POST /agents/register{agent_card, endpoints} REG--\u003e\u003eVA: 200 OK {agent_id} Note over GCA,REG: Agent Discovery GCA-\u003e\u003eREG: GET /agents/search?skills=fundamental,sentiment,valuation REG--\u003e\u003eGCA: 200 OK {agents[]} Note over GCA,VA: Health Check \u0026 Validation GCA-\u003e\u003eFA: GET /health FA--\u003e\u003eGCA: 200 OK {status: healthy} GCA-\u003e\u003eSA: GET /health SA--\u003e\u003eGCA: 200 OK {status: healthy} GCA-\u003e\u003eVA: GET /health VA--\u003e\u003eGCA: 200 OK {status: healthy} 4.3 Agent Card Ogni agente espone le proprie capabilities attraverso un Agent Card conforme allo schema A2A. Per esempio, ecco come si presenta l’Agent Card per il Fundamental Agent:\n{ \"name\": \"Fundamental Analysis Agent\", \"description\": \"Specialized agent for fundamental equity analysis. Analyzes 10-K and 10-Q financial reports, financial statements, and company fundamentals to assess stock value and projected trajectory. Provides qualitative and quantitative analysis of a company's financial performance, cash flow, operations, gross margins, and progress towards stated objectives.\", \"version\": \"1.0.0\", \"protocolVersion\": \"0.3.0\", \"url\": \"http://0.0.0.0:3003/\", \"preferredTransport\": \"JSONRPC\", \"provider\": { \"organization\": \"AlphaAgents Financial\", \"url\": \"https://AlphaAgents-dummy-corp.ai\" }, \"capabilities\": { \"streaming\": true, \"pushNotifications\": true, \"stateTransitionHistory\": true }, \"defaultInputModes\": [ \"text/plain\", \"application/json\", \"application/pdf\" ], \"defaultOutputModes\": [ \"text/plain\", \"application/json\" ], \"skills\": [ { \"id\": \"fundamental_analysis\", \"name\": \"Fundamental Financial Analysis\", \"description\": \"Performs comprehensive fundamental analysis of stocks using 10-K and 10-Q reports. Analyzes financial statements, cash flow, income statements, balance sheets, operations, gross margins, and company progress towards objectives. Provides buy/sell/hold recommendations based on fundamental metrics and risk tolerance.\", \"tags\": [ \"financial-analysis\", \"10k-reports\", \"10q-reports\", \"financial-statements\", \"cash-flow-analysis\", \"fundamental-research\", \"equity-valuation\" ], \"examples\": [ \"Analyze Apple's latest 10-K report and provide a fundamental analysis with recommendation\", \"Evaluate Microsoft's cash flow trends and operational efficiency from recent financial filings\", \"Compare Tesla's fundamental metrics against industry benchmarks and provide investment recommendation\" ] }, { \"id\": \"financial_report_extraction\", \"name\": \"Financial Report Data Extraction\", \"description\": \"Extracts and processes key financial data from 10-K and 10-Q SEC filings. Uses RAG capabilities to retrieve relevant sections and perform targeted analysis on specific financial metrics, ratios, and disclosures.\", \"tags\": [ \"data-extraction\", \"sec-filings\", \"financial-metrics\", \"rag-analysis\", \"document-processing\" ], \"examples\": [ \"Extract revenue growth metrics from the latest quarterly report\", \"Pull debt-to-equity ratios and leverage analysis from annual filing\", \"Identify key risk factors mentioned in the 10-K management discussion\" ] }, { \"id\": \"risk_assessment\", \"name\": \"Fundamental Risk Assessment\", \"description\": \"Assesses fundamental risks based on financial health indicators, debt levels, cash flow stability, competitive positioning, and management guidance. Tailors analysis to different risk tolerance profiles (risk-averse, risk-neutral).\", \"tags\": [ \"risk-assessment\", \"financial-health\", \"debt-analysis\", \"competitive-analysis\", \"risk-tolerance\" ], \"examples\": [ \"Assess the fundamental risk profile of Netflix given current debt levels and competitive pressures\", \"Evaluate Amazon's financial stability risks for risk-averse investors\", \"Analyze fundamental downside risks for Google's cloud business segment\" ] } ], \"additionalInterfaces\": [ { \"url\": \"http://0.0.0.0:3003/\", \"transport\": \"JSONRPC\" } ] } 4.4 Flusso di Analisi End-to-End Il processo di analisi prevede che l’orchestratore (il group chat) esegua un sistema di routing intelligente basato su LLM che:\nRileva automaticamente se la query richiede un debate strutturato (decisioni di investimento) o semplice coordinamento (query informative) Determina quali agenti coinvolgere per svolgere l’analisi di dettaglio usando analisi semantica multilingue Gestisce il processo di debate Round Robin quando necessario, garantendo come minimo 2 turni per agente Per le domande che riguardano decisioni di investimento, il sistema attiva il meccanismo di debate strutturato:\nRound iniziale: Ogni agente presenta la sua posizione iniziale sequenzialmente Debate rounds: Gli agenti si confrontano in turni, presentando controargomentazioni Consensus check: Verifica del 75% di accordo dopo ogni round Participation enforcement: Garantisce minimo 2 turni per agente Synthesis finale: Consolida le posizioni finali evidenziando il processo di debate Per le query informative, il sistema usa coordinamento parallelo tradizionale per massimizzare velocità e efficienza.\ngraph TD A[User Request] --\u003e B[Group Chat Agent] B --\u003e C{LLM-based Debate DetectionMulti-language Support} C --\u003e|Investment Decision| D[Structured Debate Path] C --\u003e|Information Query| E[Simple Coordination Path] subgraph \"Structured Debate (Sequential)\" D --\u003e F[Initial Round - Sequential] F --\u003e G[Agent 1: Initial Analysis] G --\u003e H[Agent 2: Initial Analysis] H --\u003e I[Agent 3: Initial Analysis] I --\u003e J[Debate Round 2] J --\u003e K[Agent 1: Counter-arguments] K --\u003e L[Agent 2: Counter-arguments] L --\u003e M[Agent 3: Counter-arguments] M --\u003e N{Consensus Check75% Threshold} N --\u003e|No| O[Continue DebateMax 5 Rounds] O --\u003e J N --\u003e|Yes| P{Participation CheckMin 2 turns each} P --\u003e|No| Q[Extra Turns for Equity] Q --\u003e P P --\u003e|Yes| R[Debate Consolidationwith Metadata] end subgraph \"Simple Coordination (Parallel)\" E --\u003e S[A2A Message/Sendto Required Agents] S --\u003e T[Concurrent Processing] T --\u003e U[Standard Consolidation] end R --\u003e V[Final Report + Debate History] U --\u003e W[Final Report - Standard] style B fill:#e1f5fe style C fill:#f3e5f5 style D fill:#fff3e0 style N fill:#ffecb3 style R fill:#e8f5e8 4.5 Transport Layer e Messaging Protocol Tutto il traffico tra agenti utilizza il protocollo JSON-RPC conforme ad A2A:\nRequest Format:\n{ \"jsonrpc\": \"2.0\", \"method\": \"message/send\", \"params\": { \"message\": { \"kind\": \"message\", \"messageId\": \"uuid\", \"role\": \"user\", \"parts\": [{\"kind\": \"text\", \"text\": \"Analyze AAPL\"}], \"contextId\": \"uuid\", \"taskId\": \"uuid\" }, \"metadata\": {} }, \"id\": \"uuid\" } Response Format:\n{ \"jsonrpc\": \"2.0\", \"result\": { \"kind\": \"message\", \"messageId\": \"uuid\", \"role\": \"agent\", \"parts\": [{\"kind\": \"text\", \"text\": \"Analysis results...\"}], \"contextId\": \"uuid\", \"metadata\": { \"analysis_type\": \"fundamental\", \"confidence_score\": 0.85 } }, \"id\": \"uuid\" } 5. Implementazione L’implementazione di AlphaAgents è stata realizzata con un focus sulla modularità, testabilità e conformità al protocollo A2A. Ogni agente è un’applicazione indipendente con le proprie dipendenze e può essere deployato separatamente.\nNota sull’implementazione: Come menzionato nell’introduzione, l’implementazione differisce dal paper originale in alcuni aspetti tecnici. In particolare:\nIl Sentiment Agent utilizza le librerie VADER e TextBlob che dovrebbero rappresentare una soluzione semplice ma efficace poiché verosimilmente le news saranno esclusivamente in lingua inglese e non richiederanno una comprensione profonda del contesto. In futuro si potrebbero integrare modelli più sofisticati di sentiment analysis basati su LLM o modelli specifici come FinBERT. Il Fundamental Agent impiega keyword matching sui dati di Yahoo Finance invece di vere tecniche RAG con vector databases In generale, mi sono focalizzato sull’architettura piuttosto che sulle performance specifiche dei singoli agenti Tutto il codice è disponibile su GitHub.\n5.1 Stack Tecnologico e Dependencies Il progetto utilizza Python 3.12 come runtime con uv come package manager per gestione rapida delle dependencies. Di seguito un estratto del file di configurazione per dare una idea delle dipendenze:\n# pyproject.toml - Global Dependencies [project] name = \"alpha_agents\" version = \"0.1.0\" requires-python = \"\u003e=3.12\" dependencies = [ \"langchain\u003e=0.3.27\", \"langchain-openai\u003e=0.3.32\", \"langchain-community\u003e=0.3.28\", \"openai\u003e=1.102.0\", \"yfinance\u003e=0.2.65\", \"pandas\u003e=2.3.2\", \"numpy\u003e=2.3.2\", \"fastapi\u003e=0.116.1\", \"uvicorn\u003e=0.35.0\", \"pydantic\u003e=2.11.7\", \"python-dotenv\u003e=1.1.1\", \"httpx\u003e=0.28.1\", \"aiohttp\u003e=3.12.15\", \"requests\u003e=2.32.5\", \"beautifulsoup4\u003e=4.13.5\", \"feedparser\u003e=6.0.11\", \"newspaper3k\u003e=0.2.8\", \"textblob\u003e=0.18.0\", \"vaderSentiment\u003e=3.3.2\", \"python-dateutil\u003e=2.9.0\" ] 5.2 Struttura del Progetto Di seguito una panoramica della struttura del progetto:\nalpha-agents-implementation/ ├── agents/ │ ├── groupchat-agent/ # Orchestratore principale │ │ ├── src/groupchat_agent/ │ │ │ ├── a2a_agent.py # Logica coordinamento │ │ │ ├── registry_service.py # Client Agent Registry │ │ │ └── server.py # FastAPI server │ │ └── pyproject.toml │ ├── fundamental-agent/ # Analisi fondamentale │ │ ├── src/fundamental_agent/ │ │ │ ├── agent.py # Langchain agent │ │ │ ├── tools.py # SEC/Finance tools │ │ │ └── server.py # A2A endpoint │ │ └── pyproject.toml │ ├── sentiment-agent/ # Analisi sentiment │ │ └── src/sentiment_agent/ │ │ │ ├── agent.py # Langchain agent │ │ │ ├── tools.py # News collection / Sentiment Analysis │ │ │ └── server.py # A2A endpoint │ │ └── pyproject.toml │ └── valuation-agent/ # Analisi quantitativa │ └── src/valuation_agent/ │ │ │ ├── agent.py # Langchain agent │ │ │ ├── tools.py # Stock data collection / KPI calculation │ │ │ └── server.py # A2A endpoint │ │ └── pyproject.toml 5.3 Implementazione del Group Chat Agent Il Group Chat Agent è il cuore e l’entry point del sistema, implementato nella classe A2AGroupChatAgent. Le sue responsabilità principali includono:\nRilevamento intelligente del debate: Usa LLM per determinare se la query richiede debate strutturato Inferenza automatica del risk tolerance: Analizza il messaggio utente per identificare il profilo di rischio Routing multilingue: Identifica agenti necessari indipendentemente dalla lingua della query Orchestrazione del debate: Gestisce la partecipazione equa tramite un sistema di turni round-robin Consensus monitoring: Verifica accordo e termina il debate quando appropriato Metadata enhancement: Arricchisce automaticamente i metadati con risk_tolerance per tutti gli agenti 5.3.1 Inferenza del Risk Tolerance Il sistema utilizza un classificatore basato su LLM che analizza il messaggio utente per estrapolare il profilo di rischio. Le linee guida per la classificazione includono:\nPreferenze esplicite di rischio: Termini come “conservativo”, “aggressivo”, “alta crescita”, “sicuro”, “stabile” Timeframe di investimento: Menzioni di “pensionamento”, “lungo termine”, “guadagni rapidi” Analisi del vocabolario: Scelte linguistiche e tono (cauto vs confidente vs speculativo) Tipi di asset menzionati: Bond/dividendi = averse, growth stock = seeking Supporto multilingue: Funziona in qualsiasi lingua analizzando intento e segnali di rischio Come ho anticipato in precedenza, non ho idea di come abbiano fatto i ricercatori di BlackRock per identificare il profilo di rischio. Tuttavia, è facile immaginare che abbiano fatto qualcosa di simile.\n5.3.2 Estratto del codice Di seguito un estratto della classe A2AGroupChatAgent che illustra alcuni dei metodi principali:\nclass A2AGroupChatAgent: def __init__(self, openai_api_key: str, registry_url: str, model_name: str = \"gpt-4o\"): self.llm = ChatOpenAI( model=model_name, openai_api_key=openai_api_key, temperature=0.1 # Bassa temperatura per analisi finanziarie ) self.registry_service = AgentRegistryService(registry_url) self._agent_urls = {} def _requires_debate_analysis(self, user_message: str) -\u003e bool: \"\"\"Usa LLM per determinare intelligentemente se serve debate strutturato.\"\"\" system_prompt = \"\"\"You are a debate necessity classifier for a multi-agent financial analysis system. STRUCTURED DEBATE IS NEEDED when: 1. The query asks for investment decisions or recommendations (buy/sell/hold advice) 2. The query requires weighing conflicting factors or multiple perspectives 3. The query asks for comprehensive analysis that would benefit from specialist disagreement/consensus 4. The query involves risk assessment or strategic financial decisions 5. The query asks for opinions, advice, or evaluations that could have multiple valid perspectives 6. The query involves portfolio management decisions The query can be in ANY language. Focus on the intent and meaning, not specific keywords. Respond with ONLY \"YES\" if structured debate is needed, or \"NO\" if it's not needed.\"\"\" response = self.llm.invoke([ SystemMessage(content=system_prompt), HumanMessage(content=f\"User query: {user_message}\") ]) return response.content.strip().upper() == \"YES\" def _enhance_metadata_with_risk_tolerance( self, user_message: str, metadata: Optional[Dict[str, Any]] = None ) -\u003e Dict[str, Any]: \"\"\"Extract or infer risk tolerance and add it to metadata.\"\"\" enhanced_metadata = metadata.copy() if metadata else {} # If risk_tolerance already provided in metadata, use it if \"risk_tolerance\" in enhanced_metadata: logger.info(f\"Using provided risk_tolerance: {enhanced_metadata['risk_tolerance']}\") return enhanced_metadata # Otherwise, infer using LLM risk_tolerance = self._infer_risk_tolerance_from_message(user_message) enhanced_metadata[\"risk_tolerance\"] = risk_tolerance logger.info(f\"Inferred risk_tolerance: {risk_tolerance} from user message\") return enhanced_metadata def _infer_risk_tolerance_from_message(self, user_message: str) -\u003e str: \"\"\"Use LLM to infer risk tolerance from user message content.\"\"\" system_prompt = \"\"\"You are a financial risk tolerance classifier. Analyze the user's message to determine their risk tolerance profile. RISK TOLERANCE LEVELS: - \"averse\": Conservative investors (capital preservation, stable returns, dividends) - \"neutral\": Balanced investors (moderate growth with reasonable risk) - \"seeking\": Aggressive investors (high returns, accept high volatility) CLASSIFICATION GUIDELINES: 1. Look for explicit risk preferences (\"conservative\", \"aggressive\", \"safe\") 2. Consider investment timeframe (\"retirement\", \"long-term\", \"quick gains\") 3. Analyze vocabulary and tone (cautious vs confident vs speculative) 4. Consider asset mentions (bonds/dividends = averse, growth stocks = seeking) The message can be in any language. Focus on intent and risk signals. Respond with ONLY one word: \"averse\", \"neutral\", or \"seeking\".\"\"\" try: response = self.llm.invoke([ SystemMessage(content=system_prompt), HumanMessage(content=f\"User message: {user_message}\") ]) risk_level = response.content.strip().lower() return risk_level if risk_level in [\"averse\", \"neutral\", \"seeking\"] else \"neutral\" except Exception as e: logger.error(f\"Error inferring risk tolerance: {e}\") return \"neutral\" # Safe default async def _conduct_structured_debate( self, user_message: str, context_id: str, task_id: str, required_agents: List[str], metadata: Optional[Dict[str, Any]] = None ) -\u003e List[Dict[str, Any]]: \"\"\"Conduce debate strutturato con risk tolerance personalizzato.\"\"\" risk_tolerance = metadata.get(\"risk_tolerance\", \"neutral\") if metadata else \"neutral\" logger.info(f\"Starting structured debate with agents: {required_agents} (risk_tolerance: {risk_tolerance})\") # Gli agenti riceveranno il risk_tolerance nei metadati per personalizzare le analisi # ... resto dell'implementazione debate ... 5.4 Pattern di Comunicazione A2A Ogni comunicazione tra agenti segue il protocollo A2A utilizzando JSON-RPC:\nasync def _send_message_to_agent( self, agent_name: str, agent_url: str, message: Dict[str, Any], metadata: Optional[Dict[str, Any]] = None ) -\u003e Dict[str, Any]: \"\"\"Invia messaggio A2A-compliant agli agenti specializzati.\"\"\" request_payload = { \"jsonrpc\": \"2.0\", \"method\": \"message/send\", \"params\": { \"message\": { \"kind\": \"message\", \"messageId\": str(uuid.uuid4()), \"role\": \"user\", \"parts\": [{\"kind\": \"text\", \"text\": user_message}], \"contextId\": context_id, \"taskId\": task_id }, \"metadata\": metadata or {} }, \"id\": str(uuid.uuid4()) } async with aiohttp.ClientSession(timeout=aiohttp.ClientTimeout(total=300.0)) as session: async with session.post(agent_url, json=request_payload, headers={\"Content-Type\": \"application/json\"}) as response: result = await response.json() # Estrai contenuto dalla risposta A2A a2a_result = result.get(\"result\", {}) if a2a_result.get(\"kind\") == \"message\": parts = a2a_result.get(\"parts\", []) analysis = \" \".join([p.get(\"text\", \"\") for p in parts if p.get(\"kind\") == \"text\"]) 5.5 Implementazione degli Agenti Specializzati 5.5.1 Fundamental Agent Il Fundamental Agent utilizza Langchain con pattern di tool calling per accedere a dati finanziari:\nclass FundamentalAgent: def __init__(self, openai_api_key: str, model_name: str = \"gpt-4o\"): self.llm = ChatOpenAI( api_key=openai_api_key, model=model_name, temperature=0.1, max_tokens=4000 ) # Tools specializzati per analisi fondamentale self.tools = get_fundamental_tools() # Yahoo Finance API, keyword-based analysis # Prompt specializzato per analisi fondamentale self.system_prompt = \"\"\"You are a specialized Fundamental Analysis Agent. Your core expertise includes: **Financial Statement Analysis:** - Deep analysis of income statements, balance sheets, and cash flow statements - Assessment of financial health, profitability, and operational efficiency **SEC Filing Analysis:** - Comprehensive review of 10-K and 10-Q reports - Management Discussion \u0026 Analysis (MD\u0026A) insights **Investment Decision Framework:** Your analysis should result in clear BUY/SELL/HOLD recommendations with: - Target price estimates with supporting rationale - Risk assessment (financial, operational, market risks)\"\"\" # Langchain Agent Executor self.agent_executor = AgentExecutor( agent=create_openai_tools_agent(self.llm, self.tools, prompt), tools=self.tools, verbose=True, handle_parsing_errors=True, max_iterations=10 ) 5.5.2 Sentiment Agent - Implementazione VADER Il Sentiment Agent utilizza una combinazione di VADER (Valence Aware Dictionary and sEntiment Reasoner) e TextBlob per analizzare il sentiment delle news finanziarie:\nclass NewsSummarizationTool(BaseTool): name: str = \"analyze_news_sentiment\" description: str = \"Analyzes financial news sentiment using VADER and TextBlob\" def _analyze_vader_sentiment(self, text: str) -\u003e Dict[str, Any]: \"\"\"Analizza sentiment usando VADER - ottimizzato per social media e news.\"\"\" vader_analyzer = SentimentIntensityAnalyzer() scores = vader_analyzer.polarity_scores(text) # Compound score da -1 a +1 compound = scores['compound'] if compound \u003e= 0.05: label = \"positive\" elif compound \u003c= -0.05: label = \"negative\" else: label = \"neutral\" return { \"compound\": float(compound), \"pos\": float(scores['pos']), \"neg\": float(scores['neg']), \"neu\": float(scores['neu']), \"label\": label } def _analyze_textblob_sentiment(self, text: str) -\u003e Dict[str, Any]: \"\"\"Analizza sentiment usando TextBlob.\"\"\" blob = TextBlob(text) polarity = blob.sentiment.polarity # -1 to 1 subjectivity = blob.sentiment.subjectivity # 0 to 1 if polarity \u003e 0.1: label = \"positive\" elif polarity \u003c -0.1: label = \"negative\" else: label = \"neutral\" return {\"polarity\": float(polarity), \"subjectivity\": float(subjectivity), \"label\": label} def _combine_sentiments(self, textblob: Dict, vader: Dict) -\u003e Dict[str, Any]: \"\"\"Combina i risultati con peso maggiore per VADER (migliore per news).\"\"\" combined_score = (textblob[\"polarity\"] * 0.4) + (vader[\"compound\"] * 0.6) if combined_score \u003e 0.1: label = \"positive\" elif combined_score \u003c -0.1: label = \"negative\" else: label = \"neutral\" return {\"score\": float(combined_score), \"label\": label, \"confidence\": abs(combined_score)} 5.5.3 Fundamental Agent - Implementazione Keyword-Based L’analisi fondamentale non utilizza tecniche RAG, ma impiega un approccio molto elementare basato su keyword matching partendo dai metadati restituiti da Yahoo Finance:\nclass RAGAnalysisTool(BaseTool): # Nome mantenuto per compatibilità e futura evoluzione, ma NON è vero RAG name: str = \"rag_fundamental_analysis\" description: str = \"Performs fundamental analysis using keyword-based data extraction\" def _find_cash_flow_key(self, data: Dict[str, Any], possible_keys: List[str]) -\u003e Optional[str]: \"\"\"Trova la chiave corretta per i dati cash flow usando pattern matching.\"\"\" for item_name, _ in data.items(): for key in possible_keys: if key.lower() in item_name.lower(): return item_name return None def _analyze_cash_flow(self, financial_context: Dict[str, Any], guidance: Dict[str, Any]): \"\"\"Analizza cash flow con ricerca per keyword, non RAG.\"\"\" quarterly_data = financial_context.get(\"cash_flow\", {}).get(\"quarterly\", {}).get(\"data\", {}) if quarterly_data: # Cerca \"Operating Cash Flow\" usando keyword matching operating_cf_key = self._find_cash_flow_key( quarterly_data, [\"Operating Cash Flow\", \"Total Cash From Operating Activities\"] ) if operating_cf_key: # Estrai valori usando il pattern trovato cf_values = [] for period, values in quarterly_data.items(): if operating_cf_key in values and values[operating_cf_key] is not None: cf_values.append(values[operating_cf_key]) 5.5.4 Valuation Agent Tools Il Valuation Agent implementa calcoli finanziari specializzati utilizzando pandas e numpy:\nclass VolatilityCalculationTool(BaseTool): name: str = \"calculate_volatility_metrics\" description: str = \"Calculates comprehensive volatility and risk metrics\" def _run(self, symbol: str, risk_free_rate: float = 0.05) -\u003e Dict[str, Any]: \"\"\"Calculate volatility and risk metrics synchronously.\"\"\" try: # First fetch the data stock_tool = StockDataTool() stock_data = stock_tool._run(symbol) if not stock_data[\"success\"]: return stock_data # Convert to pandas DataFrame for calculations price_data = stock_data[\"price_data\"] df = pd.DataFrame({ 'Date': pd.to_datetime(price_data[\"dates\"]), 'Close': price_data[\"close\"], 'Volume': price_data[\"volume\"] }) df.set_index('Date', inplace=True) # Calculate daily returns df['Daily_Return'] = df['Close'].pct_change() df = df.dropna() if len(df) \u003c 2: return { \"success\": False, \"error\": \"Insufficient data for calculations\", \"symbol\": symbol } # Basic metrics daily_returns = df['Daily_Return'] # Daily metrics mean_daily_return = daily_returns.mean() daily_volatility = daily_returns.std() # Calculate cumulative return for proper annualized return start_price = df['Close'].iloc[0] end_price = df['Close'].iloc[-1] cumulative_return = (end_price / start_price) - 1 trading_days = len(df) # Annualized metrics annualized_return = ((1 + cumulative_return) ** (TRADING_DAYS_PER_YEAR / trading_days)) - 1 annualized_volatility = daily_volatility * np.sqrt(TRADING_DAYS_PER_YEAR) # Sharpe ratio sharpe_ratio = (annualized_return - risk_free_rate) / annualized_volatility if annualized_volatility \u003e 0 else 0 # Maximum drawdown calculation cumulative_returns = (1 + daily_returns).cumprod() rolling_max = cumulative_returns.expanding().max() drawdowns = (cumulative_returns - rolling_max) / rolling_max max_drawdown = drawdowns.min() # Value at Risk (VaR) - 5% and 1% var_5 = np.percentile(daily_returns, 5) var_1 = np.percentile(daily_returns, 1) # Additional statistics skewness = daily_returns.skew() kurtosis = daily_returns.kurtosis() # Price performance metrics total_return = (df['Close'].iloc[-1] - df['Close'].iloc[0]) / df['Close'].iloc[0] result = { \"success\": True, \"symbol\": symbol.upper(), \"analysis_period\": { \"start_date\": df.index[0].strftime(\"%Y-%m-%d\"), \"end_date\": df.index[-1].strftime(\"%Y-%m-%d\"), \"trading_days\": len(df) }, \"price_metrics\": { \"start_price\": float(df['Close'].iloc[0]), \"end_price\": float(df['Close'].iloc[-1]), \"total_return\": float(total_return), \"annualized_return\": float(annualized_return) }, \"volatility_metrics\": { \"daily_volatility\": float(daily_volatility), \"annualized_volatility\": float(annualized_volatility), \"volatility_percentage\": float(annualized_volatility * 100) }, \"risk_metrics\": { \"sharpe_ratio\": float(sharpe_ratio), \"max_drawdown\": float(max_drawdown), \"max_drawdown_percentage\": float(max_drawdown * 100), \"var_5_percent\": float(var_5), \"var_1_percent\": float(var_1), \"risk_free_rate\": float(risk_free_rate) }, \"distribution_metrics\": { \"mean_daily_return\": float(mean_daily_return), \"skewness\": float(skewness), \"kurtosis\": float(kurtosis), \"positive_days\": int((daily_returns \u003e 0).sum()), \"negative_days\": int((daily_returns \u003c 0).sum()) }, \"volume_metrics\": { \"average_volume\": float(df['Volume'].mean()), \"volume_volatility\": float(df['Volume'].std()), \"latest_volume\": float(df['Volume'].iloc[-1]) } } logger.info(f\"Successfully calculated metrics for {symbol}\") return result except Exception as e: logger.error(f\"Error calculating metrics for {symbol}: {str(e)}\") return { \"success\": False, \"error\": f\"Failed to calculate metrics for {symbol}: {str(e)}\", \"symbol\": symbol } 5.6 Agent Registration e Discovery Ogni agente espone un endpoint /.well-known/agent-card per la discovery automatica. Prima di avviare tutto lo stack, ho utilizzato questi endpoint per la registrazione all’interno dell’Agent Registry:\n@app.get(\"/.well-known/agent-card\") async def get_agent_card(): return { \"name\": \"Valuation Analysis Agent\", \"description\": \"Specialized agent for stock valuation and technical analysis\", \"version\": \"1.0.0\", \"protocolVersion\": \"0.3.0\", \"url\": \"http://0.0.0.0:3001/\", \"preferredTransport\": \"JSONRPC\", \"skills\": [ { \"id\": \"technical_valuation_analysis\", \"name\": \"Technical Valuation Analysis\", \"description\": \"Comprehensive technical analysis using historical data\", \"tags\": [\"technical-analysis\", \"volatility-analysis\", \"valuation-metrics\"] } ] } 5.7 Consolidation Pattern con LLM Il consolidamento delle analisi specialistiche utilizza un pattern di meta-prompt per sintetizzare le diverse prospettive.\ndef _consolidate_analyses(self, agent_responses: List[Dict], user_message: str) -\u003e str: system_prompt = \"\"\"You are a financial analysis consolidator. Your role is to synthesize insights from multiple specialist agents into a coherent response. CONSOLIDATION GUIDELINES: 1. Integrate insights from all successful agent responses 2. Identify agreements and disagreements between agents 3. Provide clear, actionable recommendations when possible 4. If agents disagree, explain the different perspectives\"\"\" analyses_text = [] for response in successful_responses: agent_name = response.get(\"agent\", \"unknown\") analysis = response.get(\"analysis\", \"No analysis provided\") analyses_text.append(f\"**{agent_name.upper()} AGENT:**\\n{analysis}\") consolidation_prompt = f\"\"\" USER REQUEST: {user_message} AGENT ANALYSES: {chr(10).join(analyses_text)} Please provide a consolidated analysis that synthesizes these perspectives.\"\"\" response = self.llm.invoke([ SystemMessage(content=system_prompt), HumanMessage(content=consolidation_prompt) ]) return response.content Questa soluzione di consolidamento è complementare al sistema di debate strutturato implementato: quando il debate viene attivato, il consolidamento finale evidenzia il processo collaborativo seguito e i metadati del debate (rounds, turni, partecipazione), mentre per query informative usa il consolidamento standard per massimizzare velocità ed efficienza.\n5.8 Semplificazioni dell’implementazione attuale È importante evidenziare alcune semplificazioni che ho adottato rispetto alle specifiche del paper originale, per scendere a compromessi pratici:\nSentiment Analysis: L’uso di VADER e TextBlob è efficace per un prototipo, ma in un’implementazione produttiva sarebbe opportuno valutare:\nModelli transformer specializzati per testo finanziario (FinBERT) Analisi multi-source più sofisticata Gestione del contesto finanziario specifico Fundamental Analysis: L’approccio keyword-based funziona sui dati strutturati di Yahoo Finance, ma un’implementazione produttiva richiederebbe:\nVero sistema RAG con vector embeddings per documenti SEC Integrazione con database finanziari professionali (Bloomberg, Refinitiv) Parsing semantico avanzato dei documenti 10-K/10-Q Validazione: Il sistema manca di:\nBacktesting rigoroso delle raccomandazioni Metriche di performance validate su dataset storici Confronto con benchmark di mercato In ottica di un’evoluzione futura, possiamo facilmente sostituire questi componenti con implementazioni più sofisticate senza modificare l’architettura complessiva.\n6. Scansione ai raggi X di una richiesta utente Per capire bene come funziona il sistema AlphaAgents, vediamolo in azione! Ho eseguito un test end-to-end utilizzando una query utente significativa che richiede il coinvolgimento di tutti e tre gli agenti specializzati.\nQuery dell’utente: “Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato”\nIn questa sezione, documenterò passo passo tutto ciò che accade dietro le quinte dal momento in cui la richiesta viene ricevuta dal Group Chat Agent fino alla generazione del report finale di sintesi.\n6.1 Fase 1: Inizializzazione e Setup dell’Ecosistema Prima che la query utente possa essere elaborata, è necessario che tutto l’ecosistema AlphaAgents sia attivo e operativo:\n6.1.1 Avvio dell’Agent Registry L’Agent Registry è il primo componente che deve essere attivato, in quanto tutti gli agenti dipendono da esso per la discovery:\n# Agent Registry attivo su porta 8000 curl -s http://localhost:8000/health # Response: {\"status\":\"ok\",\"time\":\"2025-08-30T17:06:48.102057+00:00\"} 6.1.2 Startup degli Agenti Specializzati Ho lanciato gli agenti specializzati nella mia configurazione locale nelle porte [3001, 3002, 3003]:\nValuation Agent (porta 3001):\n2025-08-30 19:06:50 - __main__ - INFO - Starting Valuation Agent... 2025-08-30 19:06:50 - valuation_agent.agent - INFO - Valuation Agent initialized successfully 2025-08-30 19:06:50 - valuation_agent.server - INFO - A2A Valuation Server initialized on 0.0.0.0:3001 INFO: Uvicorn running on http://0.0.0.0:3001 Sentiment Agent (porta 3002):\n2025-08-30 19:06:50 - __main__ - INFO - Starting Sentiment Agent... 2025-08-30 19:06:50 - sentiment_agent.agent - INFO - Sentiment Agent initialized successfully 2025-08-30 19:06:50 - sentiment_agent.server - INFO - A2A Sentiment Server initialized on 0.0.0.0:3002 INFO: Uvicorn running on http://0.0.0.0:3002 Fundamental Agent (porta 3003):\n2025-08-30 19:06:50 - __main__ - INFO - Starting Fundamental Agent... 2025-08-30 19:06:50 - fundamental_agent.agent - INFO - Fundamental Agent initialized successfully 2025-08-30 19:06:50 - fundamental_agent.server - INFO - A2A Fundamental Server initialized on 0.0.0.0:3003 INFO: Uvicorn running on http://0.0.0.0:3003 6.1.3 Avvio del Group Chat Agent Il Group Chat Agent è l’ultimo a essere avviato ed agisce come orchestratore:\n2025-08-30 19:07:31 - groupchat_agent.server - INFO - Starting GroupChat Agent server on 0.0.0.0:3000 2025-08-30 19:07:31 - groupchat_agent.a2a_agent - INFO - A2A GroupChat Agent initialized successfully INFO: Uvicorn running on http://0.0.0.0:3000 6.2 Fase 2: Ricezione e Parsing della Query Utente 6.2.1 Richiesta JSON-RPC A2A La query utente viene inviata al Group Chat Agent tramite protocollo JSON-RPC:\n{ \"jsonrpc\": \"2.0\", \"method\": \"message/send\", \"params\": { \"message\": \"Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato\", \"metadata\": { \"user_id\": \"demo_user\", \"session_id\": \"demo_session\" } }, \"id\": \"1\" } 6.2.2 Conversione in Formato A2A Message Il server converte automaticamente la query in formato A2A Message standard:\n{ \"kind\": \"message\", \"messageId\": \"uuid-generated\", \"role\": \"user\", \"parts\": [ { \"kind\": \"text\", \"text\": \"Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato\" } ], \"contextId\": \"demo_session\" } 6.3 Fase 3: Inferenza Automatica del Risk Tolerance 6.3.1 Chiamata LLM per Risk Assessment Il sistema analizza semanticamente la query dell’utente per inferire automaticamente il profilo di rischio:\n2025-08-30 19:09:40 - groupchat_agent.a2a_agent - INFO - Inferred risk_tolerance: seeking from user message Prompt LLM utilizzato:\n\"\"\" You are a financial risk tolerance classifier. Analyze the user's message to determine their risk tolerance profile. RISK TOLERANCE LEVELS: - \"averse\": Conservative investors (capital preservation, stable returns, dividends) - \"neutral\": Balanced investors (moderate growth with reasonable risk) - \"seeking\": Aggressive investors (high returns, accept high volatility) User message: \"Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato\" \"\"\" Risultato: risk_tolerance: \"seeking\"\nCome da attese, il sistema ha identificato un profilo aggressivo basandosi su “rendimenti massimi” e “posso gestire un rischio elevato”.\n6.4 Fase 4: Agent Discovery e Routing Intelligente 6.4.1 Recupero Agent Card dall’Agent Registry Il Group Chat Agent interroga l’Agent Registry per ottenere l’Agent Card e gli endpoint degli agenti richiesti:\n2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Fetching specialist agent URLs from registry... HTTP Request: GET http://localhost:8000/agents?name=valuation HTTP Request: GET http://localhost:8000/agents?name=sentiment HTTP Request: GET http://localhost:8000/agents?name=fundamental 2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Found agent 'valuation' at http://0.0.0.0:3001/ 2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Found agent 'sentiment' at http://0.0.0.0:3002 2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Found agent 'fundamental' at http://0.0.0.0:3003/ 6.4.2 Routing LLM per Selezione Agenti Il sistema usa un prompt per determinare quali agenti coinvolgere:\nPrompt LLM Routing:\n\"\"\" You are a routing coordinator for financial analysis agents. Analyze the user's request and determine which specialist agents should be consulted: AVAILABLE AGENTS: - valuation: Technical analysis, price charts, volatility, quantitative metrics - sentiment: News analysis, market sentiment, social media trends - fundamental: Financial reports, earnings, company fundamentals, SEC filings User request: Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato \"\"\" Risultato:\n2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - 🤖 LLM ROUTING RESPONSE: [\"valuation\", \"sentiment\", \"fundamental\"] 2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - Determined required agents: ['valuation', 'sentiment', 'fundamental'] 6.4.3 Decisione per Debate Strutturato Un altro prompt determina se la query richiede debate strutturato o coordinamento semplice:\n2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - 🤔 LLM DEBATE DECISION: YES for query: 'Sono indeciso se investire in Tesla oppure in Pala...' 2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - Multi-agent analysis detected - initiating structured debate 6.5 Fase 5: Round 1 - Analisi Iniziali Viene attivato il meccanismo di debate strutturato con round-robin. Ogni agente presenta la sua analisi iniziale sequenzialmente.\n2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - Starting structured debate with agents: ['valuation', 'sentiment', 'fundamental'] 2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - === INITIAL ANALYSIS ROUND === 6.5.1 Valuation Agent - Round 1 Ticker Resolution: Il Valuation Agent inizia risolvendo i nomi delle compagnie in ticker di borsa, poi recupera i dati finanziari, calcola le metriche di valutazione ed infine genera un breve report di sintesi in cui consiglia di investire in Palantir:\n\u003e Entering new AgentExecutor chain... Invoking: `resolve_company_ticker` with `{'query': 'Tesla'}` → {'success': True, 'query': 'Tesla', 'ticker': 'TSLA', 'company_name': 'Tesla, Inc.', 'resolution_method': 'company_mapping'} Invoking: `resolve_company_ticker` with `{'query': 'Palantir'}` → {'success': False, 'query': 'Palantir', 'error': \"Could not resolve 'Palantir' to a valid stock ticker\"} Invoking: `resolve_company_ticker` with `{'query': 'PLTR'}` → {'success': True, 'query': 'PLTR', 'ticker': 'PLTR', 'company_name': 'Palantir Technologies Inc.', 'resolution_method': 'direct_ticker'} Recupero Dati Finanziari:\nInvoking: `fetch_stock_data` with `{'symbol': 'TSLA', 'period_days': 365}` → Successfully fetched 250 data points for TSLA Invoking: `fetch_stock_data` with `{'symbol': 'PLTR', 'period_days': 365}` → Successfully fetched 250 data points for PLTR Calcoli di Volatilità e Metriche:\nInvoking: `calculate_volatility_metrics` with `{'symbol': 'TSLA'}` Invoking: `calculate_volatility_metrics` with `{'symbol': 'PLTR'}` Analisi Comparativa del Valuation Agent:\nTesla (TSLA):\nPrezzo attuale: $333.87 Rendimento totale (1 anno): 58.53% Rendimento annualizzato: 59.42% Volatilità annualizzata: 71.44% Sharpe Ratio: 0.76 Max Drawdown: -53.77% Palantir (PLTR):\nPrezzo attuale: $156.71 Rendimento totale (1 anno): 413.63% Rendimento annualizzato: 423.86% Volatilità annualizzata: 72.53% Sharpe Ratio: 5.77 Max Drawdown: -40.61% Raccomandazione Valuation Agent:\nSTRONG BUY Palantir Palantir’s superior risk-adjusted returns and extraordinary growth potential make it a more attractive option for maximizing returns.\n6.5.2 Sentiment Agent - Round 1 Il Sentiment Agent effettua una ricerca di news in merito a Tesla e Palantir su Yahoo Finance e Google News, recupera il testo degli articoli e calcola i punteggi di sentiment utilizzando VADER e TextBlob.\nRaccolta News Finanziarie:\n2025-08-30 19:10:08 - sentiment_agent.tools - INFO - Collecting news for TSLA (Tesla, Inc.) 2025-08-30 19:10:08 - sentiment_agent.tools - INFO - Collecting news for PLTR (Palantir Technologies Inc.) HTTP Request: GET https://feeds.finance.yahoo.com/rss/2.0/headline?s=TSLA\u0026region=US\u0026lang=en-US HTTP Request: GET https://feeds.finance.yahoo.com/rss/2.0/headline?s=PLTR\u0026region=US\u0026lang=en-US HTTP Request: GET https://news.google.com/rss/search?q=\"Tesla,+Inc.\"+OR+\"TSLA\"+stock+finance 2025-08-30 19:10:09 - sentiment_agent.tools - INFO - Successfully collected 9 articles for TSLA 2025-08-30 19:10:09 - sentiment_agent.tools - INFO - Successfully collected 6 articles for PLTR Analisi Sentiment con VADER + TextBlob:\nTesla (TSLA):\nSentiment complessivo: Neutrale TextBlob Average: 0.0024 VADER Average: -0.0651 Combined Average: -0.0381 (leggera tendenza negativa) Distribuzione: 22% positive, 33% negative, 44% neutral Palantir (PLTR):\nSentiment complessivo: Positivo TextBlob Average: 0.0235 VADER Average: 0.4288 Combined Average: 0.2667 (moderatamente positivo) Distribuzione: 83% positive, 17% negative Key News Analysis Tesla:\nNegative: “Nearly Half Of Americans Say Tesla FSD Should Be Illegal” Negative: “Tesla’s sales down 40% in EU while Chinese EV maker BYD is up 200%” Positive: “Tesla Stock is Going Up Today? TSLA Shares Jump to June Highs on Elon Musk’s FSD Optimism” Key News Analysis Palantir:\nPositive: “Palantir Technologies Inc. (PLTR)’s New Name Is ‘Karpe Diem,’ Says Jim Cramer” Positive: “Moody’s Just Upgraded The Top S\u0026P 500 Stock Not Named Palantir” Raccomandazione Sentiment Agent:\nBUY Palantir Strong positive sentiment and market performance vs Tesla’s neutral sentiment with regulatory challenges.\n6.5.3 Fundamental Agent - Round 1 L’output dell’agente Fundamental è molto più articolato e dettagliato. In particolare, non ha indicato una preferenza specifica di investimento, ma ha invece suggerito una strategia bivalente (SELL su Tesla e BUY su Palantir)\nAnalisi Finanziaria Approfondita:\nIn un primo momento, l’agente recupera ed esamina i rapporti finanziari di entrambe le aziende, evidenziando le loro performance e metriche chiave. I dati vengono recuperati tramite le API di Yahoo Finance.\n2025-08-30 19:10:38 - fundamental_agent.tools - INFO - Pulling financial reports for TSLA (Tesla, Inc.) 2025-08-30 19:10:40 - fundamental_agent.tools - INFO - Successfully retrieved financial reports for TSLA 2025-08-30 19:10:40 - fundamental_agent.tools - INFO - Pulling financial reports for PLTR (Palantir Technologies Inc.) 2025-08-30 19:10:42 - fundamental_agent.tools - INFO - Successfully retrieved financial reports for PLTR RAG-based Analysis Results:\nCome anticipato in precedenza, non si tratta di una vera analisi RAG, ma piuttosto di una ricerca delle informazioni rilevanti a partire dall’output delle API di Yahoo finance. Partendo dai dati finanziari recuperati, l’agente calcola i KPI di interesse e produce un parere da “esperto”.\nTesla (TSLA):\nSettore: Consumer Cyclical - Auto Manufacturers Gross Margin: 17.48% Operating Margin: 4.10% Revenue Growth: -11.80% (negativo) Earnings Growth: -17.50% (negativo) Fundamental Score: 0/100 Investment Recommendation: SELL Concerns: “Low operating margin indicates operational challenges, negative revenue growth indicates declining business”\nPalantir (PLTR):\nSettore: Technology - Software Infrastructure Gross Margin: 80.03% (eccellente) Operating Margin: 26.83% (forte) Revenue Growth: 48.00% (robusto) Earnings Growth: 116.70% (straordinario) Fundamental Score: 100/100 Investment Recommendation: BUY Strengths: Strong gross margin indicates good pricing power, Strong operating margin indicates efficient operations, Strong revenue growth indicates market expansion\n6.6 Round 2 del Debate Il sistema procede con il Round 2 del debate strutturato, dove ogni agente ha l’opportunità di rispondere alle analisi degli altri:\n2025-08-30 19:11:12 - groupchat_agent.a2a_agent - INFO - === DEBATE ROUND 2 === 2025-08-30 19:11:12 - groupchat_agent.a2a_agent - INFO - Round 2: valuation's turn (turn #2) 6.6.1 Dibattito Gli agenti, nel Round 2, hanno accesso alle analisi degli altri agenti e possono presentare controargomentazioni o rafforzare le proprie posizioni. Questo processo permette di:\nIdentificare disaccordi: Tesla vs Palantir come investimento ottimale Confrontare metodologie: Analisi tecnica vs fondamentale vs sentiment Raffinare raccomandazioni: Basandosi su feedback peer-to-peer Validazione incrociata: Cross-reference tra diverse prospettive analitiche 6.6.2 Processo di Consensus Building Il Group Agent ha una soglia per il consenso tra gli agenti che è configurata tramite una variabile di ambiente. Nello specifico, ho lasciato il valore di default del 75%, ma potrebbe essere regolato in base alle esigenze del dibattito. In ogni caso, per il test eseguito non ci sono state differenze significative nella risposta, per cui è stato molto facile raggiungere un consenso.\nCiononostante, prima di procedere alla fase di consolidamento, il Group Agent ha comunque evidenziato alcuni elementi distintivi delle risposte dei 3 agenti, e poi ha fornito un commento di sintesi:\nValuation vs Fundamental divergence su Tesla:\nValuation Agent: Tesla ha mostrato 59.42% rendimento annualizzato → Potenziale BUY Fundamental Agent: Tesla ha -11.80% crescita ricavi, margini operativi 4.10% → SELL Consensus su Palantir:\nValuation: 423.86% rendimento annualizzato, Sharpe 5.77 → STRONG BUY Fundamental: Score 100/100, margini 80.03% → BUY Sentiment: 83% sentiment positivo → BUY Risk-adjusted perspective:\nTutti concordano: Per investitore risk-seeking con orizzonte 5-7 anni, Palantir è superiore a Tesla 6.7 Fase 7: Consolidamento Finale e Report Generation 6.7.1 LLM-based Synthesis Il Group Chat Agent utilizza un LLM con prompt ad-hoc per consolidare le analisi multiple. Per dare una idea di come funziona il processo, riporto un esempio di prompt utilizzato, con alcune variabili che fanno riferimento al contesto:\nConsolidation Prompt:\n\"\"\" You are a financial analysis consolidator. Your role is to synthesize insights from multiple specialist agents into a coherent response. USER REQUEST: Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato AGENT ANALYSES: **VALUATION AGENT:** [Analisi completa con metriche quantitative...] **SENTIMENT AGENT:** [Analisi sentiment con distribuzione news...] **FUNDAMENTAL AGENT:** [Analisi fondamentale con score...] \"\"\" 6.7.2 Report Finale Il sistema genera un report finale completo che integra tutte le analisi specialistiche. Ecco il report nella sua interezza:\n📊 ALPHAAGENTS INVESTMENT ANALYSIS REPORT\nThe analysis of whether to invest in Tesla (TSLA) or Palantir (PLTR) over a 5-7 year horizon, with a focus on maximizing returns and a willingness to manage high risk, was conducted through a structured multi-agent debate process. This comprehensive approach involved valuation, sentiment, and fundamental analyses, ensuring a well-rounded perspective.\n🎯 CONSENSUS AND KEY FINDINGS:\n1. Palantir Technologies Inc. (PLTR)\nValuation: Palantir has demonstrated an extraordinary annualized return of 423.86% with a high Sharpe ratio of 5.77, indicating exceptional risk-adjusted returns. The volatility is high, but the risk-reward profile is favorable. Sentiment: The sentiment analysis shows a strong positive outlook, with 83% of articles reflecting positive sentiment. This aligns with the valuation analysis, reinforcing Palantir’s growth potential. Fundamentals: Palantir’s strong growth metrics and operational efficiency support the positive sentiment and valuation findings. Recommendation: STRONG BUY. Palantir is recommended for risk-seeking investors due to its exceptional growth potential and positive sentiment, making it an attractive option for maximizing returns.\n2. Tesla, Inc. (TSLA):\nValuation: Tesla has a strong annualized return of 59.42% with high volatility. The Sharpe ratio of 0.76 suggests moderate risk-adjusted returns. The potential for significant returns exists, but with substantial risk. Sentiment: The sentiment analysis is neutral with a slight negative tilt, reflecting concerns about automotive sector challenges and regulatory issues with Tesla’s Full Self-Driving technology. Fundamentals: Operational challenges and strategic uncertainties contribute to a more cautious outlook. Recommendation: HOLD. While Tesla has potential upside, the current sentiment and operational challenges suggest a more cautious approach. Investors should wait for more positive sentiment or strategic clarity before increasing exposure.\n🏆 FINAL RECOMMENDATION:\nBased on the collective reasoning from the multi-agent debate, Palantir (PLTR) is the preferred choice for a risk-seeking investor aiming for maximum returns over a 5-7 year horizon. Its strong positive sentiment, exceptional risk-adjusted returns, and growth potential make it a compelling investment.\nTesla (TSLA), while still a strong contender, is recommended as a hold due to its current neutral sentiment and operational challenges. Investors should monitor Tesla for strategic developments that could enhance its investment appeal.\nThis analysis benefits from the collaborative insights of multiple expert perspectives, providing increased confidence in the recommendations provided.\n6.7.3 Metadata del Processo di Debate Il report finale include anche alcuni metadati sul processo seguito, che possono essere utilizzati per analisi di explainability:\n{ \"debate_metadata\": { \"total_rounds\": 2, \"agents_participated\": [\"valuation\", \"sentiment\", \"fundamental\"], \"consensus_achieved\": true, \"consensus_percentage\": 100, \"risk_tolerance_inferred\": \"seeking\", \"debate_duration\": \"3m 32s\", \"llm_calls\": { \"risk_inference\": 1, \"agent_routing\": 1, \"debate_detection\": 1, \"consolidation\": 1 } } } 6.8 Performance e Tempi di Esecuzione Un aspetto importante da documentare è il tempo necessario per completare l’intero processo di analisi. Basandomi sui timestamp registrati durante l’esecuzione, ecco il breakdown temporale dettagliato:\n6.8.1 Durata Complessiva Tempo totale di esecuzione: 3 minuti e 32 secondi (dalle 19:09:40 alle 19:13:12)\n6.8.2 Breakdown Temporale per Fasi Fase Durata Timestamp Inizio Timestamp Fine Descrizione Setup Iniziale ~41s 19:06:50 19:07:31 Avvio di tutti gli agenti, Agent Registry, Healthcheck e verifiche di base Query Processing ~1s 19:09:40 19:09:41 Ricezione e parsing della query utente Risk Tolerance Inference \u003c1s 19:09:40 19:09:40 Analisi LLM per inferire profilo di rischio Agent Discovery \u003c1s 19:09:40 19:09:40 Recupero endpoint dall’Agent Registry Agent Routing ~1s 19:09:41 19:09:41 Decisione LLM su agenti da coinvolgere Debate Detection \u003c1s 19:09:41 19:09:41 Decisione LLM per debate strutturato Round 1 Analysis ~91s 19:09:41 19:11:12 Analisi iniziali sequenziali dei 3 agenti Round 2 Debate ~120s 19:11:12 19:13:12 Secondo round e consolidamento finale 6.8.3 Analisi delle Componenti più Costose Le fasi più time-intensive sono:\nRound 1 Analysis (91 secondi):\nValuation Agent: ~30s per recupero dati Yahoo Finance + calcoli volatilità Sentiment Agent: ~30s per raccolta news da fonti multiple + analisi VADER/TextBlob Fundamental Agent: ~31s per processing dati finanziari + keyword matching Round 2 Debate (120 secondi):\nDebate structured: ~60s per secondo round di analisi cross-agent LLM Consolidation: ~60s per sintesi finale e report generation 6.8.4 Bottlenecks e Ottimizzazioni Possibili Colli di bottiglia identificati:\nAPI Latency: Chiamate a Yahoo Finance (~2-3s per request) LLM Processing: Analisi complesse richiedono 10-15s per agente Sequential Execution: Turni sequenziali non parallelizzabili per design Ottimizzazioni future:\nParallelizzazione Round 1: Possibile riduzione da 91s a ~35-40s Caching dati finanziari: Evitare retrieve multipli degli stessi ticker Model optimization: Prompt più efficienti o modelli più veloci 7. Conclusioni 7.1 Motivazioni e Obiettivi del Progetto Questo progetto è nato dall’esigenza di testare concretamente il protocollo A2A e l’Agent Registry in uno scenario applicativo reale, per sperimentare un applicativo multi-agente distribuito.\nCome ho evidenziato nell’introduzione, la proliferazione di framework GenAI monolitici e le loro limitazioni nel supporto multi-agente mi hanno spinto a investire un po’ di tempo per alzare il livello di astrazione e provare a disegnare un’architettura ad agenti basata su A2A in modo da garantire:\nStandardizzazione della comunicazione tra agenti eterogenei Eliminazione del lock-in verso framework specifici Scalabilità orizzontale attraverso deployment distribuiti Interoperabilità tra agenti implementati con stack tecnologici diversi Questo piccolo progetto mi ha tenuto sveglio qualche notte ma mi ha dato modo di mettere le mani in pasta con un sistema multi-agente REALE diverso dal caso di studio monolitico che spesso viene presentato nella sezione “Getting Started” di questo o di quel framework di GenAI.\nSono sempre più convinto che per le soluzioni Enterprise, valga la pena iniziare a pensare seriamente all’architettura degli agenti e ai protocolli di collaborazione piuttosto che allo specifico stack tecnologico per implementare questo o quello Use Case.\n7.2 La Scelta di AlphaAgents La selezione del paper AlphaAgents di BlackRock come caso d’uso si è rivelata particolarmente azzeccata perché, a fronte di una complessità non troppo elevata, mi ha consentito di realizzare una soluzione end-to-end, con risultati tangili e misurabili\nRispetto al paper originale ho dovuto accettare qualche compromesso per semplificare l’implementazione, ma ciò non ha pregiudicato il raggiungimento del mio obiettivo.\n7.3 Sviluppi Futuri Il test end-to-end ha confermato la validità dell’approccio e mi ha anche fornito alcuni spunti per miglioramenti futuri.\n7.4.1 Miglioramenti Tecnici Performance Optimization:\nParallelizzazione Round 1: Riduzione potenziale da 91s a ~35s Data caching: Evitare retrieve multipli degli stessi ticker LLM optimization: Prompt engineering per ridurre latenza Affidabilità degli agenti:\nSentiment Agent: Integrazione FinBERT per analisi più accurate Fundamental Agent: Implementazione vera RAG con vector embeddings Risk Assessment: Modelli più sofisticati per portfolio risk management Miglioramenti sul Registry:\nAgent versioning e gestione delle compatibilità Load balancing per agenti con istanze multiple Health monitoring e automatic failover 7.4.2 Espansioni Funzionali Nuovi Agenti Specializzati:\nTechnical Analysis Agent: Pattern recognition, supporti/resistenze Macro Economic Agent: Analisi macroeconomica e settoriale ESG Agent: Environmental, Social, Governance scoring Options Agent: Analisi derivati e strategie hedging Verifica accurata dei risultati:\nDouble check delle metriche calcolate dal Valuation Agent su ampi campioni di dati Cross-validation con altri modelli di valutazione 7.5 Considerazioni sui Risultati Finanziari 7.5.1 Limitazioni e Rischi Limitazioni Tecniche:\nDati limitati: Buona parte dell’analisi è basata sui dati di Yahoo Finance, non su fonti professionali Mancanza di backtesting: Come ho più volte sottolineato, non ho effettuato nessuna validazione sistematica su dati storici Scope ristretto: Il campione di analisi su cui ho fatto i test end-to-end è limitato a poche azioni e poche tipologie di richieste utente Rischi:\nAllucinazioni LLM: Possibili analisi errate o contraddittorie Data quality: Accuratezza non garantita dei dati di input Model bias: Bias nei modelli di linguaggio utilizzati Market conditions: Non considera condizioni macroeconomiche correnti 7.5.2 ⚠️ Disclaimer Importante Anche alla luce delle limitazioni indicate sopra, tutti i risultati, le raccomandazioni e le analisi presentate in questo articolo sono esclusivamente a scopo esemplificativo per illustrare il funzionamento del sistema multi-agente.\nI risultati qui riportati ed il software rilasciato su GitHub NON devono essere utilizzati in alcun modo come:\nBase per decisioni di investimento reali Consigli finanziari o raccomandazioni di trading Input per strategie di portfolio management ","wordCount":"9055","inLanguage":"it","datePublished":"2025-08-31T00:00:00+02:00","dateModified":"2025-08-31T00:00:00+02:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://c-daniele.github.io/it/posts/2025-08-31-alphaagents-a2a/"},"publisher":{"@type":"Organization","name":"Cdani's Blog","logo":{"@type":"ImageObject","url":"https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://c-daniele.github.io/it/ accesskey=h title="Home (Alt + H)"><img src=https://c-daniele.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://c-daniele.github.io/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://c-daniele.github.io/it/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://c-daniele.github.io/it/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://c-daniele.github.io/it/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://c-daniele.github.io/it/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://c-daniele.github.io/it/>Home</a></div><h1 class=post-title>AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa</h1><div class=post-meta><span title='2025-08-31 00:00:00 +0200 +0200'>agosto 31, 2025</span>&nbsp;·&nbsp;43 minuti&nbsp;·&nbsp;9055 parole&nbsp;·&nbsp;Me&nbsp;|&nbsp;Traduzioni:<ul class=i18n_list><li><a href=https://c-daniele.github.io/en/posts/2025-08-31-alphaagents-a2a/>En</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Indice contenuti</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#21-il-problema-e-la-soluzione>2.1 Il problema e la soluzione</a></li><li><a href=#22-i-tre-agenti>2.2 I tre agenti</a></li><li><a href=#23-il-meccanismo-di-collaborazione-e-debate>2.3 Il meccanismo di collaborazione e debate</a></li><li><a href=#24-gestione-intelligente-del-risk-tolerance>2.4 Gestione Intelligente del Risk Tolerance</a><ul><li><a href=#241-classificazione-dei-profili-di-rischio>2.4.1 Classificazione dei Profili di Rischio</a></li><li><a href=#242-esempi-di-classificazione-automatica>2.4.2 Esempi di Classificazione Automatica</a></li><li><a href=#243-integrazione-nel-processo-di-debate>2.4.3 Integrazione nel Processo di Debate</a></li></ul></li><li><a href=#25-vantaggi-dellapproccio-multi-agente-con-debate-strutturato>2.5 Vantaggi dell&rsquo;approccio multi-agente con debate strutturato</a></li></ul><ul><li><a href=#41-architettura-logica-complessiva>4.1 Architettura Logica Complessiva</a></li><li><a href=#42-processo-di-registrazione>4.2 Processo di registrazione</a></li><li><a href=#43-agent-card>4.3 Agent Card</a></li><li><a href=#44-flusso-di-analisi-end-to-end>4.4 Flusso di Analisi End-to-End</a></li><li><a href=#45-transport-layer-e-messaging-protocol>4.5 Transport Layer e Messaging Protocol</a></li></ul><ul><li><a href=#51-stack-tecnologico-e-dependencies>5.1 Stack Tecnologico e Dependencies</a></li><li><a href=#52-struttura-del-progetto>5.2 Struttura del Progetto</a></li><li><a href=#53-implementazione-del-group-chat-agent>5.3 Implementazione del Group Chat Agent</a><ul><li><a href=#531-inferenza-del-risk-tolerance>5.3.1 Inferenza del Risk Tolerance</a></li><li><a href=#532-estratto-del-codice>5.3.2 Estratto del codice</a></li></ul></li><li><a href=#54-pattern-di-comunicazione-a2a>5.4 Pattern di Comunicazione A2A</a></li><li><a href=#55-implementazione-degli-agenti-specializzati>5.5 Implementazione degli Agenti Specializzati</a><ul><li><a href=#551-fundamental-agent>5.5.1 Fundamental Agent</a></li><li><a href=#552-sentiment-agent---implementazione-vader>5.5.2 Sentiment Agent - Implementazione VADER</a></li><li><a href=#553-fundamental-agent---implementazione-keyword-based>5.5.3 Fundamental Agent - Implementazione Keyword-Based</a></li><li><a href=#554-valuation-agent-tools>5.5.4 Valuation Agent Tools</a></li></ul></li><li><a href=#56-agent-registration-e-discovery>5.6 Agent Registration e Discovery</a></li><li><a href=#57-consolidation-pattern-con-llm>5.7 Consolidation Pattern con LLM</a></li><li><a href=#58-semplificazioni-dellimplementazione-attuale>5.8 Semplificazioni dell&rsquo;implementazione attuale</a></li></ul><ul><li><a href=#61-fase-1-inizializzazione-e-setup-dellecosistema>6.1 Fase 1: Inizializzazione e Setup dell&rsquo;Ecosistema</a><ul><li><a href=#611-avvio-dellagent-registry>6.1.1 Avvio dell&rsquo;Agent Registry</a></li><li><a href=#612-startup-degli-agenti-specializzati>6.1.2 Startup degli Agenti Specializzati</a></li><li><a href=#613-avvio-del-group-chat-agent>6.1.3 Avvio del Group Chat Agent</a></li></ul></li><li><a href=#62-fase-2-ricezione-e-parsing-della-query-utente>6.2 Fase 2: Ricezione e Parsing della Query Utente</a><ul><li><a href=#621-richiesta-json-rpc-a2a>6.2.1 Richiesta JSON-RPC A2A</a></li><li><a href=#622-conversione-in-formato-a2a-message>6.2.2 Conversione in Formato A2A Message</a></li></ul></li><li><a href=#63-fase-3-inferenza-automatica-del-risk-tolerance>6.3 Fase 3: Inferenza Automatica del Risk Tolerance</a><ul><li><a href=#631-chiamata-llm-per-risk-assessment>6.3.1 Chiamata LLM per Risk Assessment</a></li></ul></li><li><a href=#64-fase-4-agent-discovery-e-routing-intelligente>6.4 Fase 4: Agent Discovery e Routing Intelligente</a><ul><li><a href=#641-recupero-agent-card-dallagent-registry>6.4.1 Recupero Agent Card dall&rsquo;Agent Registry</a></li><li><a href=#642-routing-llm-per-selezione-agenti>6.4.2 Routing LLM per Selezione Agenti</a></li><li><a href=#643-decisione-per-debate-strutturato>6.4.3 Decisione per Debate Strutturato</a></li></ul></li><li><a href=#65-fase-5-round-1---analisi-iniziali>6.5 Fase 5: Round 1 - Analisi Iniziali</a><ul><li><a href=#651-valuation-agent---round-1>6.5.1 Valuation Agent - Round 1</a></li><li><a href=#652-sentiment-agent---round-1>6.5.2 Sentiment Agent - Round 1</a></li><li><a href=#653-fundamental-agent---round-1>6.5.3 Fundamental Agent - Round 1</a></li></ul></li><li><a href=#66-round-2-del-debate>6.6 Round 2 del Debate</a><ul><li><a href=#661-dibattito>6.6.1 Dibattito</a></li><li><a href=#662-processo-di-consensus-building>6.6.2 Processo di Consensus Building</a></li></ul></li><li><a href=#67-fase-7-consolidamento-finale-e-report-generation>6.7 Fase 7: Consolidamento Finale e Report Generation</a><ul><li><a href=#671-llm-based-synthesis>6.7.1 LLM-based Synthesis</a></li><li><a href=#672-report-finale>6.7.2 Report Finale</a></li><li><a href=#673-metadata-del-processo-di-debate>6.7.3 Metadata del Processo di Debate</a></li></ul></li><li><a href=#68-performance-e-tempi-di-esecuzione>6.8 Performance e Tempi di Esecuzione</a><ul><li><a href=#681-durata-complessiva>6.8.1 Durata Complessiva</a></li><li><a href=#682-breakdown-temporale-per-fasi>6.8.2 Breakdown Temporale per Fasi</a></li><li><a href=#683-analisi-delle-componenti-più-costose>6.8.3 Analisi delle Componenti più Costose</a></li><li><a href=#684-bottlenecks-e-ottimizzazioni-possibili>6.8.4 Bottlenecks e Ottimizzazioni Possibili</a></li></ul></li></ul><ul><li><a href=#71-motivazioni-e-obiettivi-del-progetto>7.1 Motivazioni e Obiettivi del Progetto</a></li><li><a href=#72-la-scelta-di-alphaagents>7.2 La Scelta di AlphaAgents</a></li><li><a href=#73-sviluppi-futuri>7.3 Sviluppi Futuri</a><ul><li><a href=#741-miglioramenti-tecnici>7.4.1 Miglioramenti Tecnici</a></li><li><a href=#742-espansioni-funzionali>7.4.2 Espansioni Funzionali</a></li></ul></li><li><a href=#75-considerazioni-sui-risultati-finanziari>7.5 Considerazioni sui Risultati Finanziari</a><ul><li><a href=#751-limitazioni-e-rischi>7.5.1 Limitazioni e Rischi</a></li><li><a href=#752--disclaimer-importante>7.5.2 ⚠️ Disclaimer Importante</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h1 id=1-introduzione>1. Introduzione<a hidden class=anchor aria-hidden=true href=#1-introduzione>#</a></h1><p>La quantità di framework che sta nascendo per lo sviluppo di applicazioni di GenAI è incredibile e a mio avviso inizia ad essere pure eccessiva.
Ogniqualvolta salta fuori un nuovo framework, mi sembra che faccia più o meno le stesse cose di quello precedente. Magari alcuni hanno una capacità di modularizzazione migliore, oppure un disegno più robusto contro l&rsquo;obsolescenza nel lungo periodo, ma più o meno mi sembrano tutti gli stessi e, sebbene mi piaccia sperimentare, lo studio di nuovi mirabolanti e promettenti framework di GenAI comincia ad appassionarmi sempre meno.</p><p>Tanto per capirci, qualche giorno fa, mi sono imbattuto in <a href=https://mozilla-ai.github.io/any-agent/>AnyAgent</a>: l&rsquo;ennesimo framework che fa da wrapper verso altri framework!<br>Nello specifico, non voglio essere frainteso, il lavoro che sta facendo il team di Mozilla in ambito AI è encomiabile e consiglio anche una lettura del loro <a href=https://blog.mozilla.ai/>blog</a>, che pubblica articoli molto interessanti, ma questo genere di sovrastrutture <em>Kafkiane</em> mi sembra che introduca più problemi di quelli che risolva perché ogni stratificazione complica la manutenibilità del software nel lungo periodo, senza contare tutti i problemi di dipendenze, compatibilità e aggiornamenti.</p><p>Trovo inoltre inutilmente dispendioso specializzarmi sull&rsquo;uno framework o sull&rsquo;altro in maniera verticale, sia per una questione di lock-in, ma anche per non perdere quella capacità di astrazione che mi serve nel disegnare una soluzione end-to-end.</p><p>Un altro tema su cui quasi tutti i framework stanno dimostrando le loro limitazioni è nel <strong>supporto al multi-agent</strong>.
I primissimi framework per lo sviluppo di GenAI si concentravano principalmente sul wrapping degli LLM, sul tracing e sul chaining, mentre ora la maggior parte dell&rsquo;attenzione è rivolta alle funzionalità <em>agentiche</em> (odio questa parola), ma nella stragrande maggioranza dei casi, la progettazione originale dei framework è rimasta la stessa.</p><p>La maggior parte di questi framework è infatti ancora <strong>monolitica</strong>, il che rende <strong>difficile realizzare una vera applicazione multi-agente</strong> senza essere vincolati al framework specifico e al runtime sottostante.</p><p>Ed è qui che entra in gioco A2A (Agent-to-Agent). Il protocollo A2A mira a consentire una comunicazione e collaborazione fluida tra agenti, indipendentemente dal framework o runtime utilizzato, tramite formati di messaggistica e protocolli di trasporto standardizzati.
Piuttosto che proseguire nello studio o approfondimento di questo o quell&rsquo;altro framework, ho deciso di <strong>prendere sul serio il protocollo A2A</strong> e cercare di realizzare una soluzione applicativa end-to-end, compatibile con questo standard.</p><p>Il primo passo era quello di risolvere il problema della discovery e nel <a href=https://c-daniele.github.io/en/posts/2025-08-15-agent-reg-for-a2a/>mio post precedente</a> ho descritto come costruire un semplice Agent Registry che si adatta bene al protocollo A2A.</p><p>In seguito, volevo buttarmi su un caso d&rsquo;uso concreto, quindi ho cercato qualche applicazione interessante da affrontare con la mia nuova architettura Multi-Agent A2A-compliant.
Mi sono quindi imbattuto per caso nel paper <a href=https://arxiv.org/abs/2508.11152v1>AlphaAgents</a>, pubblicato pochi giorni fa su arXiv dal team di BlackRock.</p><p>Il paper descrive un approccio di collaborazione multi-agente per <strong>supportare la stock selection e l&rsquo;analisi finanziaria a partire da un set di titoli</strong>.
Ho pensato che fosse un caso d&rsquo;uso perfetto e mi ci sono buttato!
Sfortunatamente, il team BlackRock non ha rilasciato il codice sorgente, quindi ho dovuto implementare l&rsquo;intera soluzione AlphaAgent <a href=https://github.com/c-daniele/alpha-agents-a2a>da solo</a>, utilizzando il paper come specifica di alto livello.
Ho comunque dovuto fare alcune assunzioni e semplificazioni, ad esempio i tool di estrazione e sintesi delle informazioni dell&rsquo;agente che fa le analisi fondamentali non si basano realmente su RAG, ma piuttosto su tecniche molto banali di lookup tramite parole chiave o prefissi a partire dai dati restituiti da Yahoo Finance. Di conseguenza, l&rsquo;implementazione non è conforme al 100% a quanto descritto nel paper, ma può essere un valido punto di partenza.
In ogni caso, il mio focus è stato più sull&rsquo;architettura che sull&rsquo;affidabilità della risposta dei singoli agenti. Ho cercato inoltre di avere una visione agnostica rispetto al framework GenAI sottostante, dove l&rsquo;agente orchestratore può <strong>ricercare e selezionare gli agenti specializzati a runtime</strong>, ignorando completamente i dettagli sottostanti in termini di modelli, linguaggi e librerie.</p><p>Nei capitoli che seguono, faccio un breve recap di cos&rsquo;è AlphaAgents e come funziona in teoria, descrivo dunque l&rsquo;architettura della mia implementazione A2A-compliant e alcuni dettagli tecnici e poi mostrerò cosa accade durante i singoli step di una esecuzione concreta.</p><p>Aggiungo anche un disclaimer probabilmente ovvio ma doveroso: l&rsquo;output del sistema è da intendersi come puramente dimostrativo ai fini della soluzione multi-agent e <strong>non deve essere considerato in alcun modo come input per qualsiasi tipo di decisione finanziaria</strong>.
Aggiungo inoltre che, sebbene abbia fatto qualche controllo puntuale di coerenza sui KPI calcolati, rilevando risultati più o meno in linea con le aspettatove, <strong>non è stato fatto un controllo approfondito e rigoroso</strong> della validità dei risultati. Non escludo dunque la possibilità di errori sistematici o ri-formulazioni delle risposte condizionate da allucinazioni dell&rsquo;LLM.</p><h1 id=2-breve-introduzione-su-alphaagents>2. Breve introduzione su AlphaAgents<a hidden class=anchor aria-hidden=true href=#2-breve-introduzione-su-alphaagents>#</a></h1><p>Il paper <a href=https://arxiv.org/abs/2508.11152v1>AlphaAgents</a> introduce un approccio innovativo al problema della selezione di titoli azionari attraverso un sistema multi-agente basato su Large Language Models (LLM).</p><h2 id=21-il-problema-e-la-soluzione>2.1 Il problema e la soluzione<a hidden class=anchor aria-hidden=true href=#21-il-problema-e-la-soluzione>#</a></h2><p>Le analisi di portafoglio tradizionali richiedono un notevole sforzo umano per processare enormi quantità di dati eterogenee: documenti SEC (10-K, 10-Q), trascrizioni di earnings call, target price, ratio finanziari, news di mercato e ricerche settoriali. Questo processo presenta inoltre significative sfide in termini di scalabilità e obiettività. Uno dei rischi citati più volte nel paper è infatti quello di propendere verso allocazioni sub-ottimali a causa di <strong>fattori soggettivi come l&rsquo;avversione al rischio</strong> o l&rsquo;eccessiva confidenza nelle proprie intuizioni.</p><p>Gli AlphaAgents affrontano questi problemi attraverso un framework multi-agente che <strong>incorpora alcune tecniche di adversarial reasoning</strong> e che suddivide l&rsquo;analisi finanziaria in aree di specializzazione distinte, ciascuna gestita da un agente dedicato.</p><h2 id=22-i-tre-agenti>2.2 I tre agenti<a hidden class=anchor aria-hidden=true href=#22-i-tre-agenti>#</a></h2><p><strong>Fundamental Agent</strong>: Si occupa dell&rsquo;analisi fondamentale tradizionale, esaminando in profondità i bilanci, i flussi di cassa e le performance finanziarie attraverso l&rsquo;analisi di documenti SEC e report finanziari.</p><p><strong>Sentiment Agent</strong>: Analizza il sentiment di mercato attraverso l&rsquo;elaborazione di news finanziarie, cambiamenti nei rating degli analisti e disclosure aziendali per valutare l&rsquo;impatto potenziale sui prezzi delle azioni.</p><p><strong>Valuation Agent</strong>: Si concentra sull&rsquo;analisi tecnica e quantitativa, processando dati storici di prezzi e volumi per calcolare metriche di volatilità, rendimenti corretti per il rischio e indicatori di valutazione.</p><h2 id=23-il-meccanismo-di-collaborazione-e-debate>2.3 Il meccanismo di collaborazione e debate<a hidden class=anchor aria-hidden=true href=#23-il-meccanismo-di-collaborazione-e-debate>#</a></h2><p>Il framework implementa un meccanismo di coordinamento centralizzato attraverso un <strong>Group Chat Agent</strong> che gestisce l&rsquo;interazione tra gli agenti specializzati. Questo agente coordinatore:</p><ol><li><strong>Instrada le richieste</strong> verso gli agenti più appropriati in base al tipo di analisi richiesta usando un approccio basato sull&rsquo;LLM</li><li><strong>Gestisce il processo di debate strutturato</strong> implementando un approccio di tipo &ldquo;round-robin&rdquo;</li><li><strong>Garantisce la partecipazione equa</strong> assicurando che ogni agente parli almeno due volte durante il debate</li><li><strong>Facilita la convergenza</strong> attraverso un sistema di consensus building che prevede la condivisione dei risultati intermedi con tutti gli agenti</li><li><strong>Sintetizza le analisi</strong> multiple in un report coerente che evidenzia il processo di debate</li><li><strong>Mitiga le allucinazioni</strong> attraverso il confronto cross-agent e la validazione collaborativa</li></ol><p>Ricapitolando in poche parole: gli agenti si confrontano in turni sequenziali fino al raggiungimento del consenso, eliminando il rischio che alcuni agenti dominino la discussione.</p><div class=mermaid>graph TD
A[Richiesta Utente] --> B[Group Chat Agent]
B --> C{LLM-based Debate Detection}
C -->|Investment Decision| D[Structured Debate Mode]
C -->|Factual Query| E[Simple Coordination]
D --> F[Round 1: Initial Positions]
F --> G[Agent 1 Turn]
G --> H[Agent 2 Turn]
H --> I[Agent 3 Turn]
I --> J[Round 2: Debate & Counter-arguments]
    J --> K[Agent 1 Response]
K --> L[Agent 2 Response]
L --> M[Agent 3 Response]
M --> N{Consensus Check}
N -->|No Consensus| O[Additional Rounds<br>Max 5 rounds]
O --> J
N -->|Consensus| P[Participation Check<br>Min 2 turns each]
P -->|Insufficient| Q[Extra Turns]
Q --> P
P -->|Sufficient| R[Debate Consolidation]
E --> S[Concurrent Agent Calls]
S --> T[Simple Consolidation]
R --> U[Final Report with Debate Metadata]
T --> V[Final Report - Standard]
style B fill:#e1f5fe
style D fill:#fff3e0
style N fill:#ffecb3
style R fill:#e8f5e8
style C fill:#f3e5f5</div><h2 id=24-gestione-intelligente-del-risk-tolerance>2.4 Gestione Intelligente del Risk Tolerance<a hidden class=anchor aria-hidden=true href=#24-gestione-intelligente-del-risk-tolerance>#</a></h2><p>Un aspetto innovativo del framework è l&rsquo;incorporamento di profili di tolleranza al rischio indicati dall&rsquo;utente. Nel paper non è indicato precisamente in che modo il team di BlackRock ha implemetato l&rsquo;introduzione di questi profili, ma ipotizzo che abbiano utilizzato dei meccanismi di prompting per <strong>inferire automaticamente</strong> il livello di rischio dalla query dell&rsquo;utente.
Partendo da questa analisi sulla query utente, viene dunque estrapolata una indicazione precisa del profilo di rischio desiderato, che poi viene utilizzata in tutte le interazioni con gli agenti.</p><p>Questo semplice accorgimento, consente dunque di aggiungere un livello di personalizzazione alle raccomandazioni fornite dagli agenti.</p><h3 id=241-classificazione-dei-profili-di-rischio>2.4.1 Classificazione dei Profili di Rischio<a hidden class=anchor aria-hidden=true href=#241-classificazione-dei-profili-di-rischio>#</a></h3><ul><li><strong>Risk-averse</strong>: Investitori conservativi che prioritizzano la conservazione del capitale, ricerca di rendimenti stabili, azioni dividend-paying, bassa volatilità, approccio safety-first</li><li><strong>Risk-neutral</strong>: Investitori bilanciati che cercano crescita moderata con rischio ragionevole, portafogli diversificati, esposizione di mercato standard</li><li><strong>Risk-seeking</strong>: Investitori aggressivi che perseguono rendimenti elevati, accettano alta volatilità, azioni growth, investimenti speculativi</li></ul><h3 id=242-esempi-di-classificazione-automatica>2.4.2 Esempi di Classificazione Automatica<a hidden class=anchor aria-hidden=true href=#242-esempi-di-classificazione-automatica>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>🟢 Risk-Averse (Conservativo):
</span></span><span class=line><span class=cl>&#34;Sto cercando investimenti sicuri e stabili per la mia pensione&#34;
</span></span><span class=line><span class=cl>&#34;Cerco azioni sicure con dividendi regolari&#34;
</span></span><span class=line><span class=cl>&#34;Voglio preservare il mio capitale senza rischi&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>🟡 Risk-Neutral (Bilanciato):  
</span></span><span class=line><span class=cl>&#34;Dovrei investire in Tesla? Voglio un&#39;analisi equilibrata&#34;
</span></span><span class=line><span class=cl>&#34;Devo investire in azioni Apple?&#34;
</span></span><span class=line><span class=cl>&#34;Analisi delle azioni Microsoft per il mio portafoglio&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>🔴 Risk-Seeking (Aggressivo):
</span></span><span class=line><span class=cl>&#34;Voglio azioni ad alta crescita anche se volatili&#34;
</span></span><span class=line><span class=cl>&#34;Voglio rendimenti massimi, posso gestire un rischio elevato&#34;
</span></span><span class=line><span class=cl>&#34;Cerco investimenti ad alto potenziale&#34;
</span></span></code></pre></div><h3 id=243-integrazione-nel-processo-di-debate>2.4.3 Integrazione nel Processo di Debate<a hidden class=anchor aria-hidden=true href=#243-integrazione-nel-processo-di-debate>#</a></h3><p>Il profilo di rischio viene dunque:</p><ul><li><strong>Passato a tutti gli agenti specializzati</strong> tramite metadati nel messaggio JSON-RPC</li><li><strong>Mantenuto durante tutto il debate</strong> per coerenza delle raccomandazioni</li><li><strong>Registrato nei log</strong> per trasparenza del processo decisionale</li><li><strong>Utilizzato per personalizzare</strong> le analisi di ciascun agente specialist</li></ul><h2 id=25-vantaggi-dellapproccio-multi-agente-con-debate-strutturato>2.5 Vantaggi dell&rsquo;approccio multi-agente con debate strutturato<a hidden class=anchor aria-hidden=true href=#25-vantaggi-dellapproccio-multi-agente-con-debate-strutturato>#</a></h2><p>Il sistema offre diversi benefici rispetto all&rsquo;analisi tradizionale:</p><ul><li><strong>Mitigazione dei bias</strong>: Ogni agente opera in modo indipendente, riducendo l&rsquo;impatto dei bias cognitivi umani</li><li><strong>Partecipazione equa</strong>: Il meccanismo di turn-taking consente a tutti gli agenti di contribuire in modo equo</li><li><strong>Validazione collaborativa</strong>: Le posizioni individuali vengono sottoposte a &ldquo;challenge&rdquo; e raffinate attraverso il confronto diretto</li><li><strong>Convergenza guidata</strong>: Il sistema di consensus building porta a decisioni più robuste e ponderate</li><li><strong>Personalizzazione automatica</strong>: Risk tolerance inferito automaticamente per analisi su misura</li><li><strong>Adattamento multilingue</strong>: Sistema nativo per utenti di qualsiasi lingua senza configurazione</li><li><strong>Scalabilità</strong>: Capacità di processare volumi molto maggiori di informazioni</li><li><strong>Specializzazione</strong>: Ogni agente può sviluppare expertise approfondita nel proprio dominio</li><li><strong>Flessibilità</strong>: Il framework può essere esteso con agenti aggiuntivi (es. Technical Analysis Agent, Macro Economist Agent)</li></ul><h1 id=3-punto-di-partenza>3. Punto di partenza<a hidden class=anchor aria-hidden=true href=#3-punto-di-partenza>#</a></h1><p>Per realizzare il codice, ho fatto ampio uso di Claude Code, ma ho dedicato una quantità di tempo rilevante per la definizione delle specifiche tecniche di dettaglio rispetto a ciò che avevo in mente dopo aver letto il paper (es: struttura delle classi, gestione dei tool, etc), nonché per il testing e la modifica o la revisione di alcune classi e metodi.</p><p>Premesso che ciascun agente potrebbe essere implementato in modo indipendente, mi sono basato per semplicità sul seguente ecosistema:</p><ul><li>Runtime: Python3.12</li><li>Package manager: uv</li><li>GenAI Framework: Langchain Agents (ma potrebbe essere sostituito con un altro framework tipo Autogen, CrewAI, Smolagents, etc)</li><li>Serving Layer: FastAPI</li><li>Protocollo di comunicazione: JSON-RPC</li><li>Test: semplici script python rilanciabili</li><li>Architettura basata sull&rsquo;Agent Registry, con discovery dynamica dell&rsquo;Agent Card per ciascun agente</li><li>LLM: per semplicità ho utilizzato GPT-4o, senza farmi troppi problemi sulla scelta del modello</li></ul><p>Nei capitoli che seguono, illustro dettagliatamente l&rsquo;architettura e l&rsquo;implementazione. Ovviamente, uno degli step propedeutici è stato anche quello di corredare ciascun agente anche di un endpoint in cui esporre la Agent Card secondo il solito path &ldquo;<em>.well-known/agent-card</em>&rdquo; e registrare gli agenti all&rsquo;interno dell&rsquo;Agent Registry (Figura 1)</p><table><thead><tr><th style=text-align:center><a href=/images/2025/add-val-agent.png><img src=/images/2025/add-val-agent.png alt="Figura 1 - Aggiunta del Valuation Agent"></a></th></tr></thead><tbody><tr><td style=text-align:center><em>Figura 1 - Aggiunta del Valuation Agent</em></td></tr></tbody></table><h1 id=4-design-di-alto-livello>4. Design di alto livello<a hidden class=anchor aria-hidden=true href=#4-design-di-alto-livello>#</a></h1><p>L&rsquo;architettura è abbastanza semplice: si tratta di:</p><ul><li>1 Agent Registry che gestisce la registrazione e la discovery degli agenti (si tratta del modulo che ho discusso nel <a href=https://c-daniele.github.io/it/posts/2025-08-15-agent-reg-for-a2a/>mio precedente articolo</a>)</li><li>3 agenti specializzati, ciascuno in esecuzione su un host e una porta specifica (nel mio caso, localhost e porte 3001-3003)</li><li>1 agente di orchestrazione, che riceve gli input dell&rsquo;utente, richiama gli altri agenti e produce la risposta finale.</li></ul><h2 id=41-architettura-logica-complessiva>4.1 Architettura Logica Complessiva<a hidden class=anchor aria-hidden=true href=#41-architettura-logica-complessiva>#</a></h2><p>Ho lanciato tutti gli agenti in locale e configurato le Agent Card di conseguenza, ma ovviamente il sistema è progettato per supportare anche deployment distribuiti.</p><div class=mermaid>%%{init: {"themeVariables": { "fontSize": "16px", "nodeSpacing": 50, "rankSpacing": 70 }}}%%
graph TD
%% Client Layer
subgraph "Client Layer"
CLI[CLI Client]
WEB[Web Interface]
API[API Client]
end
%% A2A Protocol Layer
subgraph "A2A Protocol Layer"
JSONRPC[JSON-RPC Transport]
A2AMSG[A2A Message Format]
end
%% Agent Registry
subgraph "Agent Registry"
REG[Agent Registry Service]
REGDB[(Agent Cards DB)]
end
%% Orchestration Layer
subgraph "Orchestration Layer"
GCA[Group Chat Agent]
ROUTER[Intelligent Routing]
CONSOLIDATOR[Response Consolidator]
end
%% Specialized Agents
subgraph "Specialized Agents"
FA[Fundamental Agent<br>:3002]
SA[Sentiment Agent<br>:3003]
VA[Valuation Agent<br>:3001]
end
%% External Data Sources
subgraph "External Data Sources"
YF[Yahoo Finance API]
SEC[SEC EDGAR API]
NEWS["Financial News APIs"]
end
%% AI/LLM Layer
subgraph "AI/LLM Layer"
GPT[OpenAI GPT-4o]
VADER[VADER Sentiment]
TEXTBLOB[TextBlob Analysis]
end
%% Connessioni principali
CLI --> JSONRPC
WEB --> JSONRPC
API --> JSONRPC
JSONRPC --> A2AMSG
A2AMSG --> GCA
GCA --> REG
REG --> REGDB
GCA --> ROUTER
ROUTER --> FA
ROUTER --> SA
ROUTER --> VA
FA --> CONSOLIDATOR
SA --> CONSOLIDATOR
VA --> CONSOLIDATOR
CONSOLIDATOR</div><h2 id=42-processo-di-registrazione>4.2 Processo di registrazione<a hidden class=anchor aria-hidden=true href=#42-processo-di-registrazione>#</a></h2><p>Nel mio caso, ho eseguito manualmente la registrazione sull&rsquo;agent registry (Figura 1), tuttavia il processo potrebbe tranquillamente essere automatizzato. In sostanza, ogni Agent che vuole essere pubblicato all&rsquo;interno dell&rsquo;organizzazione potrebbe registrarsi autonomamente sull&rsquo;Agent Registry.</p><p>Sia nel caso di registrazione manuale che automatica, il Group Chat Agent può in seguito interrogare l&rsquo;Agent Registry e scoprire gli agenti specializzati necessari per rispondere a una richiesta dell&rsquo;utente e decidere come orchestrare la comunicazione tra di essi.</p><div class=mermaid>sequenceDiagram
participant GCA as Group Chat Agent
participant REG as Agent Registry
participant FA as Fundamental Agent
participant SA as Sentiment Agent
participant VA as Valuation Agent
Note over FA,VA: Agent Startup & Registration
    FA->>REG: POST /agents/register<br>{agent_card, endpoints}
REG-->>FA: 200 OK {agent_id}
SA->>REG: POST /agents/register<br>{agent_card, endpoints}
REG-->>SA: 200 OK {agent_id}
VA->>REG: POST /agents/register<br>{agent_card, endpoints}
REG-->>VA: 200 OK {agent_id}
Note over GCA,REG: Agent Discovery
GCA->>REG: GET /agents/search?skills=fundamental,sentiment,valuation
REG-->>GCA: 200 OK {agents[]}
Note over GCA,VA: Health Check & Validation
    GCA->>FA: GET /health
FA-->>GCA: 200 OK {status: healthy}
GCA->>SA: GET /health
SA-->>GCA: 200 OK {status: healthy}
GCA->>VA: GET /health
VA-->>GCA: 200 OK {status: healthy}</div><h2 id=43-agent-card>4.3 Agent Card<a hidden class=anchor aria-hidden=true href=#43-agent-card>#</a></h2><p>Ogni agente espone le proprie capabilities attraverso un Agent Card conforme allo schema A2A. Per esempio, ecco come si presenta l&rsquo;Agent Card per il Fundamental Agent:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Fundamental Analysis Agent&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Specialized agent for fundamental equity analysis. Analyzes 10-K and 10-Q financial reports, financial statements, and company fundamentals to assess stock value and projected trajectory. Provides qualitative and quantitative analysis of a company&#39;s financial performance, cash flow, operations, gross margins, and progress towards stated objectives.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.0.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;protocolVersion&#34;</span><span class=p>:</span> <span class=s2>&#34;0.3.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://0.0.0.0:3003/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;preferredTransport&#34;</span><span class=p>:</span> <span class=s2>&#34;JSONRPC&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;provider&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;organization&#34;</span><span class=p>:</span> <span class=s2>&#34;AlphaAgents Financial&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://AlphaAgents-dummy-corp.ai&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;capabilities&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;streaming&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;pushNotifications&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;stateTransitionHistory&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;defaultInputModes&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;text/plain&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;application/json&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;application/pdf&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;defaultOutputModes&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;text/plain&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;application/json&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;skills&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;fundamental_analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Fundamental Financial Analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Performs comprehensive fundamental analysis of stocks using 10-K and 10-Q reports. Analyzes financial statements, cash flow, income statements, balance sheets, operations, gross margins, and company progress towards objectives. Provides buy/sell/hold recommendations based on fundamental metrics and risk tolerance.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;tags&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;financial-analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;10k-reports&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;10q-reports&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;financial-statements&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;cash-flow-analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;fundamental-research&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;equity-valuation&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;examples&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Analyze Apple&#39;s latest 10-K report and provide a fundamental analysis with recommendation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Evaluate Microsoft&#39;s cash flow trends and operational efficiency from recent financial filings&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Compare Tesla&#39;s fundamental metrics against industry benchmarks and provide investment recommendation&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;financial_report_extraction&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Financial Report Data Extraction&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Extracts and processes key financial data from 10-K and 10-Q SEC filings. Uses RAG capabilities to retrieve relevant sections and perform targeted analysis on specific financial metrics, ratios, and disclosures.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;tags&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;data-extraction&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sec-filings&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;financial-metrics&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;rag-analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;document-processing&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;examples&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Extract revenue growth metrics from the latest quarterly report&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Pull debt-to-equity ratios and leverage analysis from annual filing&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Identify key risk factors mentioned in the 10-K management discussion&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;risk_assessment&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Fundamental Risk Assessment&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Assesses fundamental risks based on financial health indicators, debt levels, cash flow stability, competitive positioning, and management guidance. Tailors analysis to different risk tolerance profiles (risk-averse, risk-neutral).&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;tags&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;risk-assessment&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;financial-health&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;debt-analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;competitive-analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;risk-tolerance&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;examples&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Assess the fundamental risk profile of Netflix given current debt levels and competitive pressures&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Evaluate Amazon&#39;s financial stability risks for risk-averse investors&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Analyze fundamental downside risks for Google&#39;s cloud business segment&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;additionalInterfaces&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://0.0.0.0:3003/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;transport&#34;</span><span class=p>:</span> <span class=s2>&#34;JSONRPC&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=44-flusso-di-analisi-end-to-end>4.4 Flusso di Analisi End-to-End<a hidden class=anchor aria-hidden=true href=#44-flusso-di-analisi-end-to-end>#</a></h2><p>Il processo di analisi prevede che l&rsquo;orchestratore (il group chat) esegua un <strong>sistema di routing intelligente</strong> basato su LLM che:</p><ul><li><strong>Rileva automaticamente</strong> se la query richiede un debate strutturato (decisioni di investimento) o semplice coordinamento (query informative)</li><li><strong>Determina quali agenti coinvolgere</strong> per svolgere l&rsquo;analisi di dettaglio usando analisi semantica multilingue</li><li><strong>Gestisce il processo di debate Round Robin</strong> quando necessario, garantendo come minimo 2 turni per agente</li></ul><p>Per le domande che riguardano <strong>decisioni di investimento</strong>, il sistema attiva il <strong>meccanismo di debate strutturato</strong>:</p><ol><li><strong>Round iniziale</strong>: Ogni agente presenta la sua posizione iniziale sequenzialmente</li><li><strong>Debate rounds</strong>: Gli agenti si confrontano in turni, presentando controargomentazioni</li><li><strong>Consensus check</strong>: Verifica del 75% di accordo dopo ogni round</li><li><strong>Participation enforcement</strong>: Garantisce minimo 2 turni per agente</li><li><strong>Synthesis finale</strong>: Consolida le posizioni finali evidenziando il processo di debate</li></ol><p>Per le <strong>query informative</strong>, il sistema usa <strong>coordinamento parallelo tradizionale</strong> per massimizzare velocità e efficienza.</p><div class=mermaid>graph TD
A[User Request] --> B[Group Chat Agent]
B --> C{LLM-based Debate Detection<br>Multi-language Support}
C -->|Investment Decision| D[Structured Debate Path]
C -->|Information Query| E[Simple Coordination Path]
subgraph "Structured Debate (Sequential)"
D --> F[Initial Round - Sequential]
F --> G[Agent 1: Initial Analysis]
G --> H[Agent 2: Initial Analysis]
H --> I[Agent 3: Initial Analysis]
I --> J[Debate Round 2]
J --> K[Agent 1: Counter-arguments]
K --> L[Agent 2: Counter-arguments]
L --> M[Agent 3: Counter-arguments]
M --> N{Consensus Check<br>75% Threshold}
N -->|No| O[Continue Debate<br>Max 5 Rounds]
O --> J
N -->|Yes| P{Participation Check<br>Min 2 turns each}
P -->|No| Q[Extra Turns for Equity]
Q --> P
P -->|Yes| R[Debate Consolidation<br>with Metadata]
end
subgraph "Simple Coordination (Parallel)"
E --> S[A2A Message/Send<br>to Required Agents]
S --> T[Concurrent Processing]
T --> U[Standard Consolidation]
end
R --> V[Final Report + Debate History]
U --> W[Final Report - Standard]
style B fill:#e1f5fe
style C fill:#f3e5f5
style D fill:#fff3e0
style N fill:#ffecb3
style R fill:#e8f5e8</div><h2 id=45-transport-layer-e-messaging-protocol>4.5 Transport Layer e Messaging Protocol<a hidden class=anchor aria-hidden=true href=#45-transport-layer-e-messaging-protocol>#</a></h2><p>Tutto il traffico tra agenti utilizza il protocollo JSON-RPC conforme ad A2A:</p><p><strong>Request Format:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;jsonrpc&#34;</span><span class=p>:</span> <span class=s2>&#34;2.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;method&#34;</span><span class=p>:</span> <span class=s2>&#34;message/send&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;params&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;message&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;messageId&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;parts&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=s2>&#34;Analyze AAPL&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;contextId&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;taskId&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Response Format:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;jsonrpc&#34;</span><span class=p>:</span> <span class=s2>&#34;2.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;result&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;message&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=nt>&#34;messageId&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;agent&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;parts&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=s2>&#34;Analysis results...&#34;</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;contextId&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;analysis_type&#34;</span><span class=p>:</span> <span class=s2>&#34;fundamental&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;confidence_score&#34;</span><span class=p>:</span> <span class=mf>0.85</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h1 id=5-implementazione>5. Implementazione<a hidden class=anchor aria-hidden=true href=#5-implementazione>#</a></h1><p>L&rsquo;implementazione di AlphaAgents è stata realizzata con un focus sulla modularità, testabilità e conformità al protocollo A2A. Ogni agente è un&rsquo;applicazione indipendente con le proprie dipendenze e può essere deployato separatamente.</p><p><strong>Nota sull&rsquo;implementazione</strong>: Come menzionato nell&rsquo;introduzione, l&rsquo;implementazione differisce dal paper originale in alcuni aspetti tecnici. In particolare:</p><ul><li>Il <strong>Sentiment Agent</strong> utilizza le librerie VADER e TextBlob che dovrebbero rappresentare una soluzione semplice ma efficace poiché verosimilmente le news saranno esclusivamente in lingua inglese e non richiederanno una comprensione profonda del contesto. In futuro si potrebbero integrare modelli più sofisticati di sentiment analysis basati su LLM o modelli specifici come FinBERT.</li><li>Il <strong>Fundamental Agent</strong> impiega keyword matching sui dati di Yahoo Finance invece di vere tecniche RAG con vector databases</li><li>In generale, mi sono focalizzato sull&rsquo;architettura piuttosto che sulle performance specifiche dei singoli agenti</li></ul><p>Tutto il codice è <a href=https://github.com/c-daniele/alpha-agents-a2a>disponibile su GitHub</a>.</p><h2 id=51-stack-tecnologico-e-dependencies>5.1 Stack Tecnologico e Dependencies<a hidden class=anchor aria-hidden=true href=#51-stack-tecnologico-e-dependencies>#</a></h2><p>Il progetto utilizza <strong>Python 3.12</strong> come runtime con <strong>uv</strong> come package manager per gestione rapida delle dependencies. Di seguito un estratto del file di configurazione per dare una idea delle dipendenze:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=c># pyproject.toml - Global Dependencies</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;alpha_agents&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.12&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;langchain&gt;=0.3.27&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;langchain-openai&gt;=0.3.32&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;langchain-community&gt;=0.3.28&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;openai&gt;=1.102.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;yfinance&gt;=0.2.65&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pandas&gt;=2.3.2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;numpy&gt;=2.3.2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;fastapi&gt;=0.116.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;uvicorn&gt;=0.35.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pydantic&gt;=2.11.7&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;python-dotenv&gt;=1.1.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;httpx&gt;=0.28.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;aiohttp&gt;=3.12.15&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;requests&gt;=2.32.5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;beautifulsoup4&gt;=4.13.5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;feedparser&gt;=6.0.11&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;newspaper3k&gt;=0.2.8&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;textblob&gt;=0.18.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;vaderSentiment&gt;=3.3.2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;python-dateutil&gt;=2.9.0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><h2 id=52-struttura-del-progetto>5.2 Struttura del Progetto<a hidden class=anchor aria-hidden=true href=#52-struttura-del-progetto>#</a></h2><p>Di seguito una panoramica della struttura del progetto:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>alpha-agents-implementation/
</span></span><span class=line><span class=cl>├── agents/
</span></span><span class=line><span class=cl>│   ├── groupchat-agent/          # Orchestratore principale
</span></span><span class=line><span class=cl>│   │   ├── src/groupchat_agent/
</span></span><span class=line><span class=cl>│   │   │   ├── a2a_agent.py      # Logica coordinamento
</span></span><span class=line><span class=cl>│   │   │   ├── registry_service.py # Client Agent Registry
</span></span><span class=line><span class=cl>│   │   │   └── server.py         # FastAPI server
</span></span><span class=line><span class=cl>│   │   └── pyproject.toml
</span></span><span class=line><span class=cl>│   ├── fundamental-agent/        # Analisi fondamentale
</span></span><span class=line><span class=cl>│   │   ├── src/fundamental_agent/
</span></span><span class=line><span class=cl>│   │   │   ├── agent.py          # Langchain agent
</span></span><span class=line><span class=cl>│   │   │   ├── tools.py          # SEC/Finance tools
</span></span><span class=line><span class=cl>│   │   │   └── server.py         # A2A endpoint
</span></span><span class=line><span class=cl>│   │   └── pyproject.toml
</span></span><span class=line><span class=cl>│   ├── sentiment-agent/          # Analisi sentiment
</span></span><span class=line><span class=cl>│   │   └── src/sentiment_agent/
</span></span><span class=line><span class=cl>│   │   │   ├── agent.py          # Langchain agent
</span></span><span class=line><span class=cl>│   │   │   ├── tools.py          # News collection / Sentiment Analysis
</span></span><span class=line><span class=cl>│   │   │   └── server.py         # A2A endpoint
</span></span><span class=line><span class=cl>│   │   └── pyproject.toml
</span></span><span class=line><span class=cl>│   └── valuation-agent/          # Analisi quantitativa
</span></span><span class=line><span class=cl>│       └── src/valuation_agent/
</span></span><span class=line><span class=cl>│   │   │   ├── agent.py          # Langchain agent
</span></span><span class=line><span class=cl>│   │   │   ├── tools.py          # Stock data collection / KPI calculation
</span></span><span class=line><span class=cl>│   │   │   └── server.py         # A2A endpoint
</span></span><span class=line><span class=cl>│   │   └── pyproject.toml
</span></span></code></pre></div><h2 id=53-implementazione-del-group-chat-agent>5.3 Implementazione del Group Chat Agent<a hidden class=anchor aria-hidden=true href=#53-implementazione-del-group-chat-agent>#</a></h2><p>Il <strong>Group Chat Agent</strong> è il cuore e l&rsquo;entry point del sistema, implementato nella classe <code>A2AGroupChatAgent</code>. Le sue responsabilità principali includono:</p><ol><li><strong>Rilevamento intelligente del debate</strong>: Usa LLM per determinare se la query richiede debate strutturato</li><li><strong>Inferenza automatica del risk tolerance</strong>: Analizza il messaggio utente per identificare il profilo di rischio</li><li><strong>Routing multilingue</strong>: Identifica agenti necessari indipendentemente dalla lingua della query</li><li><strong>Orchestrazione del debate</strong>: Gestisce la partecipazione equa tramite un sistema di turni round-robin</li><li><strong>Consensus monitoring</strong>: Verifica accordo e termina il debate quando appropriato</li><li><strong>Metadata enhancement</strong>: Arricchisce automaticamente i metadati con risk_tolerance per tutti gli agenti</li></ol><h3 id=531-inferenza-del-risk-tolerance>5.3.1 Inferenza del Risk Tolerance<a hidden class=anchor aria-hidden=true href=#531-inferenza-del-risk-tolerance>#</a></h3><p>Il sistema utilizza un <strong>classificatore basato su LLM</strong> che analizza il messaggio utente per estrapolare il profilo di rischio. Le linee guida per la classificazione includono:</p><ol><li><strong>Preferenze esplicite di rischio</strong>: Termini come &ldquo;conservativo&rdquo;, &ldquo;aggressivo&rdquo;, &ldquo;alta crescita&rdquo;, &ldquo;sicuro&rdquo;, &ldquo;stabile&rdquo;</li><li><strong>Timeframe di investimento</strong>: Menzioni di &ldquo;pensionamento&rdquo;, &ldquo;lungo termine&rdquo;, &ldquo;guadagni rapidi&rdquo;</li><li><strong>Analisi del vocabolario</strong>: Scelte linguistiche e tono (cauto vs confidente vs speculativo)</li><li><strong>Tipi di asset menzionati</strong>: Bond/dividendi = averse, growth stock = seeking</li><li><strong>Supporto multilingue</strong>: Funziona in qualsiasi lingua analizzando intento e segnali di rischio</li></ol><p>Come ho anticipato in precedenza, non ho idea di come abbiano fatto i ricercatori di BlackRock per identificare il profilo di rischio. Tuttavia, è facile immaginare che abbiano fatto qualcosa di simile.</p><h3 id=532-estratto-del-codice>5.3.2 Estratto del codice<a hidden class=anchor aria-hidden=true href=#532-estratto-del-codice>#</a></h3><p>Di seguito un estratto della classe <code>A2AGroupChatAgent</code> che illustra alcuni dei metodi principali:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>A2AGroupChatAgent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>openai_api_key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>registry_url</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>model_name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;gpt-4o&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>llm</span> <span class=o>=</span> <span class=n>ChatOpenAI</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span><span class=o>=</span><span class=n>model_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>openai_api_key</span><span class=o>=</span><span class=n>openai_api_key</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>temperature</span><span class=o>=</span><span class=mf>0.1</span>  <span class=c1># Bassa temperatura per analisi finanziarie</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>registry_service</span> <span class=o>=</span> <span class=n>AgentRegistryService</span><span class=p>(</span><span class=n>registry_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_agent_urls</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_requires_debate_analysis</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Usa LLM per determinare intelligentemente se serve debate strutturato.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>system_prompt</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;You are a debate necessity classifier for a multi-agent financial analysis system.
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        STRUCTURED DEBATE IS NEEDED when:
</span></span></span><span class=line><span class=cl><span class=s2>        1. The query asks for investment decisions or recommendations (buy/sell/hold advice)
</span></span></span><span class=line><span class=cl><span class=s2>        2. The query requires weighing conflicting factors or multiple perspectives
</span></span></span><span class=line><span class=cl><span class=s2>        3. The query asks for comprehensive analysis that would benefit from specialist disagreement/consensus
</span></span></span><span class=line><span class=cl><span class=s2>        4. The query involves risk assessment or strategic financial decisions
</span></span></span><span class=line><span class=cl><span class=s2>        5. The query asks for opinions, advice, or evaluations that could have multiple valid perspectives
</span></span></span><span class=line><span class=cl><span class=s2>        6. The query involves portfolio management decisions
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        The query can be in ANY language. Focus on the intent and meaning, not specific keywords.
</span></span></span><span class=line><span class=cl><span class=s2>        Respond with ONLY &#34;YES&#34; if structured debate is needed, or &#34;NO&#34; if it&#39;s not needed.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>llm</span><span class=o>.</span><span class=n>invoke</span><span class=p>([</span>
</span></span><span class=line><span class=cl>            <span class=n>SystemMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>system_prompt</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>HumanMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;User query: </span><span class=si>{</span><span class=n>user_message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;YES&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_enhance_metadata_with_risk_tolerance</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=p>,</span> <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>metadata</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Extract or infer risk tolerance and add it to metadata.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>enhanced_metadata</span> <span class=o>=</span> <span class=n>metadata</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span> <span class=k>if</span> <span class=n>metadata</span> <span class=k>else</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># If risk_tolerance already provided in metadata, use it</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;risk_tolerance&#34;</span> <span class=ow>in</span> <span class=n>enhanced_metadata</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Using provided risk_tolerance: </span><span class=si>{</span><span class=n>enhanced_metadata</span><span class=p>[</span><span class=s1>&#39;risk_tolerance&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>enhanced_metadata</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Otherwise, infer using LLM</span>
</span></span><span class=line><span class=cl>        <span class=n>risk_tolerance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_infer_risk_tolerance_from_message</span><span class=p>(</span><span class=n>user_message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>enhanced_metadata</span><span class=p>[</span><span class=s2>&#34;risk_tolerance&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>risk_tolerance</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Inferred risk_tolerance: </span><span class=si>{</span><span class=n>risk_tolerance</span><span class=si>}</span><span class=s2> from user message&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>enhanced_metadata</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_infer_risk_tolerance_from_message</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Use LLM to infer risk tolerance from user message content.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>system_prompt</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;You are a financial risk tolerance classifier. 
</span></span></span><span class=line><span class=cl><span class=s2>        Analyze the user&#39;s message to determine their risk tolerance profile.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        RISK TOLERANCE LEVELS:
</span></span></span><span class=line><span class=cl><span class=s2>        - &#34;averse&#34;: Conservative investors (capital preservation, stable returns, dividends)
</span></span></span><span class=line><span class=cl><span class=s2>        - &#34;neutral&#34;: Balanced investors (moderate growth with reasonable risk)  
</span></span></span><span class=line><span class=cl><span class=s2>        - &#34;seeking&#34;: Aggressive investors (high returns, accept high volatility)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        CLASSIFICATION GUIDELINES:
</span></span></span><span class=line><span class=cl><span class=s2>        1. Look for explicit risk preferences (&#34;conservative&#34;, &#34;aggressive&#34;, &#34;safe&#34;)
</span></span></span><span class=line><span class=cl><span class=s2>        2. Consider investment timeframe (&#34;retirement&#34;, &#34;long-term&#34;, &#34;quick gains&#34;)
</span></span></span><span class=line><span class=cl><span class=s2>        3. Analyze vocabulary and tone (cautious vs confident vs speculative)
</span></span></span><span class=line><span class=cl><span class=s2>        4. Consider asset mentions (bonds/dividends = averse, growth stocks = seeking)
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        The message can be in any language. Focus on intent and risk signals.
</span></span></span><span class=line><span class=cl><span class=s2>        Respond with ONLY one word: &#34;averse&#34;, &#34;neutral&#34;, or &#34;seeking&#34;.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>llm</span><span class=o>.</span><span class=n>invoke</span><span class=p>([</span>
</span></span><span class=line><span class=cl>                <span class=n>SystemMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>system_prompt</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>HumanMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;User message: </span><span class=si>{</span><span class=n>user_message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>])</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>risk_level</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>risk_level</span> <span class=k>if</span> <span class=n>risk_level</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;averse&#34;</span><span class=p>,</span> <span class=s2>&#34;neutral&#34;</span><span class=p>,</span> <span class=s2>&#34;seeking&#34;</span><span class=p>]</span> <span class=k>else</span> <span class=s2>&#34;neutral&#34;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error inferring risk tolerance: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;neutral&#34;</span>  <span class=c1># Safe default</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_conduct_structured_debate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=p>,</span> <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>context_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>task_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=n>required_agents</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=n>metadata</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Conduce debate strutturato con risk tolerance personalizzato.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>risk_tolerance</span> <span class=o>=</span> <span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;risk_tolerance&#34;</span><span class=p>,</span> <span class=s2>&#34;neutral&#34;</span><span class=p>)</span> <span class=k>if</span> <span class=n>metadata</span> <span class=k>else</span> <span class=s2>&#34;neutral&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Starting structured debate with agents: </span><span class=si>{</span><span class=n>required_agents</span><span class=si>}</span><span class=s2> (risk_tolerance: </span><span class=si>{</span><span class=n>risk_tolerance</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Gli agenti riceveranno il risk_tolerance nei metadati per personalizzare le analisi</span>
</span></span><span class=line><span class=cl>        <span class=c1># ... resto dell&#39;implementazione debate ...</span>
</span></span></code></pre></div><h2 id=54-pattern-di-comunicazione-a2a>5.4 Pattern di Comunicazione A2A<a hidden class=anchor aria-hidden=true href=#54-pattern-di-comunicazione-a2a>#</a></h2><p>Ogni comunicazione tra agenti segue il protocollo A2A utilizzando JSON-RPC:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>_send_message_to_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=p>,</span> <span class=n>agent_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>agent_url</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>message</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>metadata</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Invia messaggio A2A-compliant agli agenti specializzati.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>request_payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;jsonrpc&#34;</span><span class=p>:</span> <span class=s2>&#34;2.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;method&#34;</span><span class=p>:</span> <span class=s2>&#34;message/send&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;params&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;message&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;messageId&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                <span class=s2>&#34;parts&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=s2>&#34;text&#34;</span><span class=p>:</span> <span class=n>user_message</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;contextId&#34;</span><span class=p>:</span> <span class=n>context_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;taskId&#34;</span><span class=p>:</span> <span class=n>task_id</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;metadata&#34;</span><span class=p>:</span> <span class=n>metadata</span> <span class=ow>or</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>aiohttp</span><span class=o>.</span><span class=n>ClientSession</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=n>aiohttp</span><span class=o>.</span><span class=n>ClientTimeout</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=mf>300.0</span><span class=p>))</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>with</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>agent_url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>request_payload</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                              <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json&#34;</span><span class=p>})</span> <span class=k>as</span> <span class=n>response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Estrai contenuto dalla risposta A2A</span>
</span></span><span class=line><span class=cl>            <span class=n>a2a_result</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;result&#34;</span><span class=p>,</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>a2a_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;kind&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&#34;message&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>parts</span> <span class=o>=</span> <span class=n>a2a_result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;parts&#34;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>                <span class=n>analysis</span> <span class=o>=</span> <span class=s2>&#34; &#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>p</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>parts</span> 
</span></span><span class=line><span class=cl>                                   <span class=k>if</span> <span class=n>p</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;kind&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&#34;text&#34;</span><span class=p>])</span>
</span></span></code></pre></div><h2 id=55-implementazione-degli-agenti-specializzati>5.5 Implementazione degli Agenti Specializzati<a hidden class=anchor aria-hidden=true href=#55-implementazione-degli-agenti-specializzati>#</a></h2><h3 id=551-fundamental-agent>5.5.1 Fundamental Agent<a hidden class=anchor aria-hidden=true href=#551-fundamental-agent>#</a></h3><p>Il Fundamental Agent utilizza <strong>Langchain</strong> con pattern di <strong>tool calling</strong> per accedere a dati finanziari:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>FundamentalAgent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>openai_api_key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>model_name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;gpt-4o&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>llm</span> <span class=o>=</span> <span class=n>ChatOpenAI</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>api_key</span><span class=o>=</span><span class=n>openai_api_key</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span><span class=o>=</span><span class=n>model_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>temperature</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>max_tokens</span><span class=o>=</span><span class=mi>4000</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Tools specializzati per analisi fondamentale</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tools</span> <span class=o>=</span> <span class=n>get_fundamental_tools</span><span class=p>()</span>  <span class=c1># Yahoo Finance API, keyword-based analysis</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Prompt specializzato per analisi fondamentale</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>system_prompt</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;You are a specialized Fundamental Analysis Agent.
</span></span></span><span class=line><span class=cl><span class=s2>        Your core expertise includes:
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        **Financial Statement Analysis:**
</span></span></span><span class=line><span class=cl><span class=s2>        - Deep analysis of income statements, balance sheets, and cash flow statements
</span></span></span><span class=line><span class=cl><span class=s2>        - Assessment of financial health, profitability, and operational efficiency
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        **SEC Filing Analysis:**  
</span></span></span><span class=line><span class=cl><span class=s2>        - Comprehensive review of 10-K and 10-Q reports
</span></span></span><span class=line><span class=cl><span class=s2>        - Management Discussion &amp; Analysis (MD&amp;A) insights
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        **Investment Decision Framework:**
</span></span></span><span class=line><span class=cl><span class=s2>        Your analysis should result in clear BUY/SELL/HOLD recommendations with:
</span></span></span><span class=line><span class=cl><span class=s2>        - Target price estimates with supporting rationale
</span></span></span><span class=line><span class=cl><span class=s2>        - Risk assessment (financial, operational, market risks)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Langchain Agent Executor</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>agent_executor</span> <span class=o>=</span> <span class=n>AgentExecutor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>agent</span><span class=o>=</span><span class=n>create_openai_tools_agent</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>llm</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>tools</span><span class=p>,</span> <span class=n>prompt</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>tools</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>tools</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>handle_parsing_errors</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>max_iterations</span><span class=o>=</span><span class=mi>10</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span></code></pre></div><h3 id=552-sentiment-agent---implementazione-vader>5.5.2 Sentiment Agent - Implementazione VADER<a hidden class=anchor aria-hidden=true href=#552-sentiment-agent---implementazione-vader>#</a></h3><p>Il Sentiment Agent utilizza una combinazione di <strong>VADER</strong> (Valence Aware Dictionary and sEntiment Reasoner) e <strong>TextBlob</strong> per analizzare il sentiment delle news finanziarie:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>NewsSummarizationTool</span><span class=p>(</span><span class=n>BaseTool</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;analyze_news_sentiment&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;Analyzes financial news sentiment using VADER and TextBlob&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_analyze_vader_sentiment</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Analizza sentiment usando VADER - ottimizzato per social media e news.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>vader_analyzer</span> <span class=o>=</span> <span class=n>SentimentIntensityAnalyzer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>scores</span> <span class=o>=</span> <span class=n>vader_analyzer</span><span class=o>.</span><span class=n>polarity_scores</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Compound score da -1 a +1</span>
</span></span><span class=line><span class=cl>        <span class=n>compound</span> <span class=o>=</span> <span class=n>scores</span><span class=p>[</span><span class=s1>&#39;compound&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>compound</span> <span class=o>&gt;=</span> <span class=mf>0.05</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;positive&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>compound</span> <span class=o>&lt;=</span> <span class=o>-</span><span class=mf>0.05</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;negative&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;neutral&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;compound&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>compound</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;pos&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;pos&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;neg&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;neg&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;neu&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;neu&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;label&#34;</span><span class=p>:</span> <span class=n>label</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_analyze_textblob_sentiment</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Analizza sentiment usando TextBlob.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>blob</span> <span class=o>=</span> <span class=n>TextBlob</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>polarity</span> <span class=o>=</span> <span class=n>blob</span><span class=o>.</span><span class=n>sentiment</span><span class=o>.</span><span class=n>polarity</span>  <span class=c1># -1 to 1</span>
</span></span><span class=line><span class=cl>        <span class=n>subjectivity</span> <span class=o>=</span> <span class=n>blob</span><span class=o>.</span><span class=n>sentiment</span><span class=o>.</span><span class=n>subjectivity</span>  <span class=c1># 0 to 1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>polarity</span> <span class=o>&gt;</span> <span class=mf>0.1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;positive&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>polarity</span> <span class=o>&lt;</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;negative&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;neutral&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;polarity&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>polarity</span><span class=p>),</span> <span class=s2>&#34;subjectivity&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>subjectivity</span><span class=p>),</span> <span class=s2>&#34;label&#34;</span><span class=p>:</span> <span class=n>label</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_combine_sentiments</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>textblob</span><span class=p>:</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>vader</span><span class=p>:</span> <span class=n>Dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Combina i risultati con peso maggiore per VADER (migliore per news).&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>combined_score</span> <span class=o>=</span> <span class=p>(</span><span class=n>textblob</span><span class=p>[</span><span class=s2>&#34;polarity&#34;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.4</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>vader</span><span class=p>[</span><span class=s2>&#34;compound&#34;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>combined_score</span> <span class=o>&gt;</span> <span class=mf>0.1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;positive&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>combined_score</span> <span class=o>&lt;</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;negative&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;neutral&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;score&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>combined_score</span><span class=p>),</span> <span class=s2>&#34;label&#34;</span><span class=p>:</span> <span class=n>label</span><span class=p>,</span> <span class=s2>&#34;confidence&#34;</span><span class=p>:</span> <span class=nb>abs</span><span class=p>(</span><span class=n>combined_score</span><span class=p>)}</span>
</span></span></code></pre></div><h3 id=553-fundamental-agent---implementazione-keyword-based>5.5.3 Fundamental Agent - Implementazione Keyword-Based<a hidden class=anchor aria-hidden=true href=#553-fundamental-agent---implementazione-keyword-based>#</a></h3><p>L&rsquo;analisi fondamentale <strong>non utilizza tecniche RAG</strong>, ma impiega un approccio molto elementare basato su <strong>keyword matching</strong> partendo dai metadati restituiti da Yahoo Finance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>RAGAnalysisTool</span><span class=p>(</span><span class=n>BaseTool</span><span class=p>):</span>  <span class=c1># Nome mantenuto per compatibilità e futura evoluzione, ma NON è vero RAG</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;rag_fundamental_analysis&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;Performs fundamental analysis using keyword-based data extraction&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_find_cash_flow_key</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>possible_keys</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Trova la chiave corretta per i dati cash flow usando pattern matching.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>item_name</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>possible_keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>key</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=n>item_name</span><span class=o>.</span><span class=n>lower</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>item_name</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_analyze_cash_flow</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>financial_context</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>guidance</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Analizza cash flow con ricerca per keyword, non RAG.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>quarterly_data</span> <span class=o>=</span> <span class=n>financial_context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;cash_flow&#34;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;quarterly&#34;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;data&#34;</span><span class=p>,</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>quarterly_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Cerca &#34;Operating Cash Flow&#34; usando keyword matching</span>
</span></span><span class=line><span class=cl>            <span class=n>operating_cf_key</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_find_cash_flow_key</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>quarterly_data</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=s2>&#34;Operating Cash Flow&#34;</span><span class=p>,</span> <span class=s2>&#34;Total Cash From Operating Activities&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>operating_cf_key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Estrai valori usando il pattern trovato</span>
</span></span><span class=line><span class=cl>                <span class=n>cf_values</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>period</span><span class=p>,</span> <span class=n>values</span> <span class=ow>in</span> <span class=n>quarterly_data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>operating_cf_key</span> <span class=ow>in</span> <span class=n>values</span> <span class=ow>and</span> <span class=n>values</span><span class=p>[</span><span class=n>operating_cf_key</span><span class=p>]</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>cf_values</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>values</span><span class=p>[</span><span class=n>operating_cf_key</span><span class=p>])</span>
</span></span></code></pre></div><h3 id=554-valuation-agent-tools>5.5.4 Valuation Agent Tools<a hidden class=anchor aria-hidden=true href=#554-valuation-agent-tools>#</a></h3><p>Il Valuation Agent implementa calcoli finanziari specializzati utilizzando <strong>pandas</strong> e <strong>numpy</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>VolatilityCalculationTool</span><span class=p>(</span><span class=n>BaseTool</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;calculate_volatility_metrics&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;Calculates comprehensive volatility and risk metrics&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>symbol</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>risk_free_rate</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.05</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Calculate volatility and risk metrics synchronously.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># First fetch the data</span>
</span></span><span class=line><span class=cl>            <span class=n>stock_tool</span> <span class=o>=</span> <span class=n>StockDataTool</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>stock_data</span> <span class=o>=</span> <span class=n>stock_tool</span><span class=o>.</span><span class=n>_run</span><span class=p>(</span><span class=n>symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>stock_data</span><span class=p>[</span><span class=s2>&#34;success&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>stock_data</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Convert to pandas DataFrame for calculations</span>
</span></span><span class=line><span class=cl>            <span class=n>price_data</span> <span class=o>=</span> <span class=n>stock_data</span><span class=p>[</span><span class=s2>&#34;price_data&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>price_data</span><span class=p>[</span><span class=s2>&#34;dates&#34;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Close&#39;</span><span class=p>:</span> <span class=n>price_data</span><span class=p>[</span><span class=s2>&#34;close&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Volume&#39;</span><span class=p>:</span> <span class=n>price_data</span><span class=p>[</span><span class=s2>&#34;volume&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;Date&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Calculate daily returns</span>
</span></span><span class=line><span class=cl>            <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Daily_Return&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;success&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Insufficient data for calculations&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;symbol&#34;</span><span class=p>:</span> <span class=n>symbol</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Basic metrics</span>
</span></span><span class=line><span class=cl>            <span class=n>daily_returns</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Daily_Return&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Daily metrics</span>
</span></span><span class=line><span class=cl>            <span class=n>mean_daily_return</span> <span class=o>=</span> <span class=n>daily_returns</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>daily_volatility</span> <span class=o>=</span> <span class=n>daily_returns</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Calculate cumulative return for proper annualized return</span>
</span></span><span class=line><span class=cl>            <span class=n>start_price</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>end_price</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>cumulative_return</span> <span class=o>=</span> <span class=p>(</span><span class=n>end_price</span> <span class=o>/</span> <span class=n>start_price</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>trading_days</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Annualized metrics</span>
</span></span><span class=line><span class=cl>            <span class=n>annualized_return</span> <span class=o>=</span> <span class=p>((</span><span class=mi>1</span> <span class=o>+</span> <span class=n>cumulative_return</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=n>TRADING_DAYS_PER_YEAR</span> <span class=o>/</span> <span class=n>trading_days</span><span class=p>))</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>annualized_volatility</span> <span class=o>=</span> <span class=n>daily_volatility</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>TRADING_DAYS_PER_YEAR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Sharpe ratio</span>
</span></span><span class=line><span class=cl>            <span class=n>sharpe_ratio</span> <span class=o>=</span> <span class=p>(</span><span class=n>annualized_return</span> <span class=o>-</span> <span class=n>risk_free_rate</span><span class=p>)</span> <span class=o>/</span> <span class=n>annualized_volatility</span> <span class=k>if</span> <span class=n>annualized_volatility</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Maximum drawdown calculation</span>
</span></span><span class=line><span class=cl>            <span class=n>cumulative_returns</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>daily_returns</span><span class=p>)</span><span class=o>.</span><span class=n>cumprod</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>rolling_max</span> <span class=o>=</span> <span class=n>cumulative_returns</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>drawdowns</span> <span class=o>=</span> <span class=p>(</span><span class=n>cumulative_returns</span> <span class=o>-</span> <span class=n>rolling_max</span><span class=p>)</span> <span class=o>/</span> <span class=n>rolling_max</span>
</span></span><span class=line><span class=cl>            <span class=n>max_drawdown</span> <span class=o>=</span> <span class=n>drawdowns</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Value at Risk (VaR) - 5% and 1%</span>
</span></span><span class=line><span class=cl>            <span class=n>var_5</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>daily_returns</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>var_1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>daily_returns</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Additional statistics</span>
</span></span><span class=line><span class=cl>            <span class=n>skewness</span> <span class=o>=</span> <span class=n>daily_returns</span><span class=o>.</span><span class=n>skew</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>kurtosis</span> <span class=o>=</span> <span class=n>daily_returns</span><span class=o>.</span><span class=n>kurtosis</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Price performance metrics</span>
</span></span><span class=line><span class=cl>            <span class=n>total_return</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;success&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;symbol&#34;</span><span class=p>:</span> <span class=n>symbol</span><span class=o>.</span><span class=n>upper</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;analysis_period&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;start_date&#34;</span><span class=p>:</span> <span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&#34;%Y-%m-</span><span class=si>%d</span><span class=s2>&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;end_date&#34;</span><span class=p>:</span> <span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&#34;%Y-%m-</span><span class=si>%d</span><span class=s2>&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;trading_days&#34;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;price_metrics&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;start_price&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;end_price&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;total_return&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>total_return</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;annualized_return&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>annualized_return</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;volatility_metrics&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;daily_volatility&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>daily_volatility</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;annualized_volatility&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>annualized_volatility</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;volatility_percentage&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>annualized_volatility</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;risk_metrics&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;sharpe_ratio&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>sharpe_ratio</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;max_drawdown&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>max_drawdown</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;max_drawdown_percentage&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>max_drawdown</span> <span class=o>*</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;var_5_percent&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>var_5</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;var_1_percent&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>var_1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;risk_free_rate&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>risk_free_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;distribution_metrics&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;mean_daily_return&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>mean_daily_return</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;skewness&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>skewness</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;kurtosis&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>kurtosis</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;positive_days&#34;</span><span class=p>:</span> <span class=nb>int</span><span class=p>((</span><span class=n>daily_returns</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;negative_days&#34;</span><span class=p>:</span> <span class=nb>int</span><span class=p>((</span><span class=n>daily_returns</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;volume_metrics&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;average_volume&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Volume&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;volume_volatility&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Volume&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;latest_volume&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Volume&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully calculated metrics for </span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error calculating metrics for </span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;success&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Failed to calculate metrics for </span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;symbol&#34;</span><span class=p>:</span> <span class=n>symbol</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span></code></pre></div><h2 id=56-agent-registration-e-discovery>5.6 Agent Registration e Discovery<a hidden class=anchor aria-hidden=true href=#56-agent-registration-e-discovery>#</a></h2><p>Ogni agente espone un endpoint <code>/.well-known/agent-card</code> per la discovery automatica. Prima di avviare tutto lo stack, ho utilizzato questi endpoint per la registrazione all&rsquo;interno dell&rsquo;Agent Registry:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/.well-known/agent-card&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_agent_card</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Valuation Analysis Agent&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Specialized agent for stock valuation and technical analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.0.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;protocolVersion&#34;</span><span class=p>:</span> <span class=s2>&#34;0.3.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://0.0.0.0:3001/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;preferredTransport&#34;</span><span class=p>:</span> <span class=s2>&#34;JSONRPC&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;skills&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;technical_valuation_analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Technical Valuation Analysis&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Comprehensive technical analysis using historical data&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;tags&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;technical-analysis&#34;</span><span class=p>,</span> <span class=s2>&#34;volatility-analysis&#34;</span><span class=p>,</span> <span class=s2>&#34;valuation-metrics&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><h2 id=57-consolidation-pattern-con-llm>5.7 Consolidation Pattern con LLM<a hidden class=anchor aria-hidden=true href=#57-consolidation-pattern-con-llm>#</a></h2><p>Il consolidamento delle analisi specialistiche utilizza un pattern di <strong>meta-prompt</strong> per sintetizzare le diverse prospettive.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>_consolidate_analyses</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>agent_responses</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>],</span> <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>system_prompt</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;You are a financial analysis consolidator. Your role is to 
</span></span></span><span class=line><span class=cl><span class=s2>    synthesize insights from multiple specialist agents into a coherent response.
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    CONSOLIDATION GUIDELINES:
</span></span></span><span class=line><span class=cl><span class=s2>    1. Integrate insights from all successful agent responses
</span></span></span><span class=line><span class=cl><span class=s2>    2. Identify agreements and disagreements between agents
</span></span></span><span class=line><span class=cl><span class=s2>    3. Provide clear, actionable recommendations when possible
</span></span></span><span class=line><span class=cl><span class=s2>    4. If agents disagree, explain the different perspectives&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>analyses_text</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>response</span> <span class=ow>in</span> <span class=n>successful_responses</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>agent_name</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;agent&#34;</span><span class=p>,</span> <span class=s2>&#34;unknown&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>analysis</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;analysis&#34;</span><span class=p>,</span> <span class=s2>&#34;No analysis provided&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>analyses_text</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;**</span><span class=si>{</span><span class=n>agent_name</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span><span class=si>}</span><span class=s2> AGENT:**</span><span class=se>\n</span><span class=si>{</span><span class=n>analysis</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>consolidation_prompt</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    USER REQUEST: </span><span class=si>{</span><span class=n>user_message</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    AGENT ANALYSES:
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=si>{</span><span class=nb>chr</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>analyses_text</span><span class=p>)</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Please provide a consolidated analysis that synthesizes these perspectives.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>llm</span><span class=o>.</span><span class=n>invoke</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=n>SystemMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>system_prompt</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>HumanMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>consolidation_prompt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>content</span>
</span></span></code></pre></div><p>Questa soluzione di consolidamento è complementare al <strong>sistema di debate strutturato</strong> implementato: quando il debate viene attivato, il consolidamento finale evidenzia il processo collaborativo seguito e i metadati del debate (rounds, turni, partecipazione), mentre per query informative usa il consolidamento standard per massimizzare velocità ed efficienza.</p><h2 id=58-semplificazioni-dellimplementazione-attuale>5.8 Semplificazioni dell&rsquo;implementazione attuale<a hidden class=anchor aria-hidden=true href=#58-semplificazioni-dellimplementazione-attuale>#</a></h2><p>È importante evidenziare alcune semplificazioni che ho adottato rispetto alle specifiche del paper originale, per scendere a compromessi pratici:</p><p><strong>Sentiment Analysis</strong>: L&rsquo;uso di VADER e TextBlob è efficace per un prototipo, ma in un&rsquo;implementazione produttiva sarebbe opportuno valutare:</p><ul><li>Modelli transformer specializzati per testo finanziario (FinBERT)</li><li>Analisi multi-source più sofisticata</li><li>Gestione del contesto finanziario specifico</li></ul><p><strong>Fundamental Analysis</strong>: L&rsquo;approccio keyword-based funziona sui dati strutturati di Yahoo Finance, ma un&rsquo;implementazione produttiva richiederebbe:</p><ul><li>Vero sistema RAG con vector embeddings per documenti SEC</li><li>Integrazione con database finanziari professionali (Bloomberg, Refinitiv)</li><li>Parsing semantico avanzato dei documenti 10-K/10-Q</li></ul><p><strong>Validazione</strong>: Il sistema manca di:</p><ul><li>Backtesting rigoroso delle raccomandazioni</li><li>Metriche di performance validate su dataset storici</li><li>Confronto con benchmark di mercato</li></ul><p>In ottica di un&rsquo;evoluzione futura, possiamo facilmente sostituire questi componenti con implementazioni più sofisticate senza modificare l&rsquo;architettura complessiva.</p><h1 id=6-scansione-ai-raggi-x-di-una-richiesta-utente>6. Scansione ai raggi X di una richiesta utente<a hidden class=anchor aria-hidden=true href=#6-scansione-ai-raggi-x-di-una-richiesta-utente>#</a></h1><p>Per capire bene come funziona il sistema AlphaAgents, vediamolo in azione!
Ho eseguito un test end-to-end utilizzando una query utente significativa che richiede il coinvolgimento di tutti e tre gli agenti specializzati.</p><p><strong>Query dell&rsquo;utente</strong>: <em>&ldquo;Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato&rdquo;</em></p><p>In questa sezione, documenterò passo passo tutto ciò che accade dietro le quinte dal momento in cui la richiesta viene ricevuta dal Group Chat Agent fino alla generazione del report finale di sintesi.</p><h2 id=61-fase-1-inizializzazione-e-setup-dellecosistema>6.1 Fase 1: Inizializzazione e Setup dell&rsquo;Ecosistema<a hidden class=anchor aria-hidden=true href=#61-fase-1-inizializzazione-e-setup-dellecosistema>#</a></h2><p>Prima che la query utente possa essere elaborata, è necessario che tutto l&rsquo;ecosistema AlphaAgents sia attivo e operativo:</p><h3 id=611-avvio-dellagent-registry>6.1.1 Avvio dell&rsquo;Agent Registry<a hidden class=anchor aria-hidden=true href=#611-avvio-dellagent-registry>#</a></h3><p>L&rsquo;Agent Registry è il primo componente che deve essere attivato, in quanto tutti gli agenti dipendono da esso per la discovery:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Agent Registry attivo su porta 8000</span>
</span></span><span class=line><span class=cl>curl -s http://localhost:8000/health
</span></span><span class=line><span class=cl><span class=c1># Response: {&#34;status&#34;:&#34;ok&#34;,&#34;time&#34;:&#34;2025-08-30T17:06:48.102057+00:00&#34;}</span>
</span></span></code></pre></div><h3 id=612-startup-degli-agenti-specializzati>6.1.2 Startup degli Agenti Specializzati<a hidden class=anchor aria-hidden=true href=#612-startup-degli-agenti-specializzati>#</a></h3><p>Ho lanciato gli agenti specializzati nella mia configurazione locale nelle porte [3001, 3002, 3003]:</p><p><strong>Valuation Agent</strong> (porta 3001):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:06:50 - __main__ - INFO - Starting Valuation Agent...
</span></span><span class=line><span class=cl>2025-08-30 19:06:50 - valuation_agent.agent - INFO - Valuation Agent initialized successfully
</span></span><span class=line><span class=cl>2025-08-30 19:06:50 - valuation_agent.server - INFO - A2A Valuation Server initialized on 0.0.0.0:3001
</span></span><span class=line><span class=cl>INFO: Uvicorn running on http://0.0.0.0:3001
</span></span></code></pre></div><p><strong>Sentiment Agent</strong> (porta 3002):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:06:50 - __main__ - INFO - Starting Sentiment Agent...
</span></span><span class=line><span class=cl>2025-08-30 19:06:50 - sentiment_agent.agent - INFO - Sentiment Agent initialized successfully
</span></span><span class=line><span class=cl>2025-08-30 19:06:50 - sentiment_agent.server - INFO - A2A Sentiment Server initialized on 0.0.0.0:3002
</span></span><span class=line><span class=cl>INFO: Uvicorn running on http://0.0.0.0:3002
</span></span></code></pre></div><p><strong>Fundamental Agent</strong> (porta 3003):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:06:50 - __main__ - INFO - Starting Fundamental Agent...
</span></span><span class=line><span class=cl>2025-08-30 19:06:50 - fundamental_agent.agent - INFO - Fundamental Agent initialized successfully
</span></span><span class=line><span class=cl>2025-08-30 19:06:50 - fundamental_agent.server - INFO - A2A Fundamental Server initialized on 0.0.0.0:3003
</span></span><span class=line><span class=cl>INFO: Uvicorn running on http://0.0.0.0:3003
</span></span></code></pre></div><h3 id=613-avvio-del-group-chat-agent>6.1.3 Avvio del Group Chat Agent<a hidden class=anchor aria-hidden=true href=#613-avvio-del-group-chat-agent>#</a></h3><p>Il Group Chat Agent è l&rsquo;ultimo a essere avviato ed agisce come orchestratore:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:07:31 - groupchat_agent.server - INFO - Starting GroupChat Agent server on 0.0.0.0:3000
</span></span><span class=line><span class=cl>2025-08-30 19:07:31 - groupchat_agent.a2a_agent - INFO - A2A GroupChat Agent initialized successfully
</span></span><span class=line><span class=cl>INFO: Uvicorn running on http://0.0.0.0:3000
</span></span></code></pre></div><h2 id=62-fase-2-ricezione-e-parsing-della-query-utente>6.2 Fase 2: Ricezione e Parsing della Query Utente<a hidden class=anchor aria-hidden=true href=#62-fase-2-ricezione-e-parsing-della-query-utente>#</a></h2><h3 id=621-richiesta-json-rpc-a2a>6.2.1 Richiesta JSON-RPC A2A<a hidden class=anchor aria-hidden=true href=#621-richiesta-json-rpc-a2a>#</a></h3><p>La query utente viene inviata al Group Chat Agent tramite protocollo JSON-RPC:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;jsonrpc&#34;</span><span class=p>:</span> <span class=s2>&#34;2.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;method&#34;</span><span class=p>:</span> <span class=s2>&#34;message/send&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;params&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;user_id&#34;</span><span class=p>:</span> <span class=s2>&#34;demo_user&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&#34;session_id&#34;</span><span class=p>:</span> <span class=s2>&#34;demo_session&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=622-conversione-in-formato-a2a-message>6.2.2 Conversione in Formato A2A Message<a hidden class=anchor aria-hidden=true href=#622-conversione-in-formato-a2a-message>#</a></h3><p>Il server converte automaticamente la query in formato A2A Message standard:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;message&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;messageId&#34;</span><span class=p>:</span> <span class=s2>&#34;uuid-generated&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=nt>&#34;parts&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=s2>&#34;Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;contextId&#34;</span><span class=p>:</span> <span class=s2>&#34;demo_session&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=63-fase-3-inferenza-automatica-del-risk-tolerance>6.3 Fase 3: Inferenza Automatica del Risk Tolerance<a hidden class=anchor aria-hidden=true href=#63-fase-3-inferenza-automatica-del-risk-tolerance>#</a></h2><h3 id=631-chiamata-llm-per-risk-assessment>6.3.1 Chiamata LLM per Risk Assessment<a hidden class=anchor aria-hidden=true href=#631-chiamata-llm-per-risk-assessment>#</a></h3><p>Il sistema analizza semanticamente la query dell&rsquo;utente per inferire automaticamente il profilo di rischio:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:09:40 - groupchat_agent.a2a_agent - INFO - Inferred risk_tolerance: seeking from user message
</span></span></code></pre></div><p><strong>Prompt LLM utilizzato</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>You are a financial risk tolerance classifier. 
</span></span></span><span class=line><span class=cl><span class=s2>Analyze the user&#39;s message to determine their risk tolerance profile.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>RISK TOLERANCE LEVELS:
</span></span></span><span class=line><span class=cl><span class=s2>- &#34;averse&#34;: Conservative investors (capital preservation, stable returns, dividends)
</span></span></span><span class=line><span class=cl><span class=s2>- &#34;neutral&#34;: Balanced investors (moderate growth with reasonable risk)  
</span></span></span><span class=line><span class=cl><span class=s2>- &#34;seeking&#34;: Aggressive investors (high returns, accept high volatility)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>User message: &#34;Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato&#34;
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></div><p><strong>Risultato</strong>: <code>risk_tolerance: "seeking"</code></p><p>Come da attese, il sistema ha identificato un profilo aggressivo basandosi su &ldquo;rendimenti massimi&rdquo; e &ldquo;posso gestire un rischio elevato&rdquo;.</p><h2 id=64-fase-4-agent-discovery-e-routing-intelligente>6.4 Fase 4: Agent Discovery e Routing Intelligente<a hidden class=anchor aria-hidden=true href=#64-fase-4-agent-discovery-e-routing-intelligente>#</a></h2><h3 id=641-recupero-agent-card-dallagent-registry>6.4.1 Recupero Agent Card dall&rsquo;Agent Registry<a hidden class=anchor aria-hidden=true href=#641-recupero-agent-card-dallagent-registry>#</a></h3><p>Il Group Chat Agent interroga l&rsquo;Agent Registry per ottenere l&rsquo;Agent Card e gli endpoint degli agenti richiesti:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Fetching specialist agent URLs from registry...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP Request: GET http://localhost:8000/agents?name=valuation
</span></span><span class=line><span class=cl>HTTP Request: GET http://localhost:8000/agents?name=sentiment  
</span></span><span class=line><span class=cl>HTTP Request: GET http://localhost:8000/agents?name=fundamental
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Found agent &#39;valuation&#39; at http://0.0.0.0:3001/
</span></span><span class=line><span class=cl>2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Found agent &#39;sentiment&#39; at http://0.0.0.0:3002
</span></span><span class=line><span class=cl>2025-08-30 19:09:40 - groupchat_agent.registry_service - INFO - Found agent &#39;fundamental&#39; at http://0.0.0.0:3003/
</span></span></code></pre></div><h3 id=642-routing-llm-per-selezione-agenti>6.4.2 Routing LLM per Selezione Agenti<a hidden class=anchor aria-hidden=true href=#642-routing-llm-per-selezione-agenti>#</a></h3><p>Il sistema usa un prompt per determinare quali agenti coinvolgere:</p><p><strong>Prompt LLM Routing</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>You are a routing coordinator for financial analysis agents. 
</span></span></span><span class=line><span class=cl><span class=s2>Analyze the user&#39;s request and determine which specialist agents should be consulted:
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>AVAILABLE AGENTS:
</span></span></span><span class=line><span class=cl><span class=s2>- valuation: Technical analysis, price charts, volatility, quantitative metrics
</span></span></span><span class=line><span class=cl><span class=s2>- sentiment: News analysis, market sentiment, social media trends  
</span></span></span><span class=line><span class=cl><span class=s2>- fundamental: Financial reports, earnings, company fundamentals, SEC filings
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>User request: Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></div><p><strong>Risultato</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - 🤖 LLM ROUTING RESPONSE: [&#34;valuation&#34;, &#34;sentiment&#34;, &#34;fundamental&#34;]
</span></span><span class=line><span class=cl>2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - Determined required agents: [&#39;valuation&#39;, &#39;sentiment&#39;, &#39;fundamental&#39;]
</span></span></code></pre></div><h3 id=643-decisione-per-debate-strutturato>6.4.3 Decisione per Debate Strutturato<a hidden class=anchor aria-hidden=true href=#643-decisione-per-debate-strutturato>#</a></h3><p>Un altro prompt determina se la query richiede debate strutturato o coordinamento semplice:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - 🤔 LLM DEBATE DECISION: YES for query: &#39;Sono indeciso se investire in Tesla oppure in Pala...&#39;
</span></span><span class=line><span class=cl>2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - Multi-agent analysis detected - initiating structured debate
</span></span></code></pre></div><h2 id=65-fase-5-round-1---analisi-iniziali>6.5 Fase 5: Round 1 - Analisi Iniziali<a hidden class=anchor aria-hidden=true href=#65-fase-5-round-1---analisi-iniziali>#</a></h2><p>Viene attivato il meccanismo di debate strutturato con round-robin. Ogni agente presenta la sua analisi iniziale sequenzialmente.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - Starting structured debate with agents: [&#39;valuation&#39;, &#39;sentiment&#39;, &#39;fundamental&#39;]
</span></span><span class=line><span class=cl>2025-08-30 19:09:41 - groupchat_agent.a2a_agent - INFO - === INITIAL ANALYSIS ROUND ===
</span></span></code></pre></div><h3 id=651-valuation-agent---round-1>6.5.1 Valuation Agent - Round 1<a hidden class=anchor aria-hidden=true href=#651-valuation-agent---round-1>#</a></h3><p><strong>Ticker Resolution</strong>:
Il Valuation Agent inizia risolvendo i nomi delle compagnie in ticker di borsa, poi recupera i dati finanziari, calcola le metriche di valutazione ed infine genera un breve report di sintesi in cui consiglia di investire in Palantir:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; Entering new AgentExecutor chain...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Invoking: <span class=sb>`</span>resolve_company_ticker<span class=sb>`</span> with <span class=sb>`</span><span class=o>{</span><span class=s1>&#39;query&#39;</span>: <span class=s1>&#39;Tesla&#39;</span><span class=o>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>→ <span class=o>{</span><span class=s1>&#39;success&#39;</span>: True, <span class=s1>&#39;query&#39;</span>: <span class=s1>&#39;Tesla&#39;</span>, <span class=s1>&#39;ticker&#39;</span>: <span class=s1>&#39;TSLA&#39;</span>, <span class=s1>&#39;company_name&#39;</span>: <span class=s1>&#39;Tesla, Inc.&#39;</span>, <span class=s1>&#39;resolution_method&#39;</span>: <span class=s1>&#39;company_mapping&#39;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Invoking: <span class=sb>`</span>resolve_company_ticker<span class=sb>`</span> with <span class=sb>`</span><span class=o>{</span><span class=s1>&#39;query&#39;</span>: <span class=s1>&#39;Palantir&#39;</span><span class=o>}</span><span class=sb>`</span>  
</span></span><span class=line><span class=cl>→ <span class=o>{</span><span class=s1>&#39;success&#39;</span>: False, <span class=s1>&#39;query&#39;</span>: <span class=s1>&#39;Palantir&#39;</span>, <span class=s1>&#39;error&#39;</span>: <span class=s2>&#34;Could not resolve &#39;Palantir&#39; to a valid stock ticker&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Invoking: <span class=sb>`</span>resolve_company_ticker<span class=sb>`</span> with <span class=sb>`</span><span class=o>{</span><span class=s1>&#39;query&#39;</span>: <span class=s1>&#39;PLTR&#39;</span><span class=o>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>→ <span class=o>{</span><span class=s1>&#39;success&#39;</span>: True, <span class=s1>&#39;query&#39;</span>: <span class=s1>&#39;PLTR&#39;</span>, <span class=s1>&#39;ticker&#39;</span>: <span class=s1>&#39;PLTR&#39;</span>, <span class=s1>&#39;company_name&#39;</span>: <span class=s1>&#39;Palantir Technologies Inc.&#39;</span>, <span class=s1>&#39;resolution_method&#39;</span>: <span class=s1>&#39;direct_ticker&#39;</span><span class=o>}</span>
</span></span></code></pre></div><p><strong>Recupero Dati Finanziari</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Invoking: <span class=sb>`</span>fetch_stock_data<span class=sb>`</span> with <span class=sb>`</span><span class=o>{</span><span class=s1>&#39;symbol&#39;</span>: <span class=s1>&#39;TSLA&#39;</span>, <span class=s1>&#39;period_days&#39;</span>: 365<span class=o>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>→ Successfully fetched <span class=m>250</span> data points <span class=k>for</span> TSLA
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Invoking: <span class=sb>`</span>fetch_stock_data<span class=sb>`</span> with <span class=sb>`</span><span class=o>{</span><span class=s1>&#39;symbol&#39;</span>: <span class=s1>&#39;PLTR&#39;</span>, <span class=s1>&#39;period_days&#39;</span>: 365<span class=o>}</span><span class=sb>`</span>  
</span></span><span class=line><span class=cl>→ Successfully fetched <span class=m>250</span> data points <span class=k>for</span> PLTR
</span></span></code></pre></div><p><strong>Calcoli di Volatilità e Metriche</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Invoking: <span class=sb>`</span>calculate_volatility_metrics<span class=sb>`</span> with <span class=sb>`</span><span class=o>{</span><span class=s1>&#39;symbol&#39;</span>: <span class=s1>&#39;TSLA&#39;</span><span class=o>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>Invoking: <span class=sb>`</span>calculate_volatility_metrics<span class=sb>`</span> with <span class=sb>`</span><span class=o>{</span><span class=s1>&#39;symbol&#39;</span>: <span class=s1>&#39;PLTR&#39;</span><span class=o>}</span><span class=sb>`</span>
</span></span></code></pre></div><p><strong>Analisi Comparativa del Valuation Agent</strong>:</p><p><strong>Tesla (TSLA)</strong>:</p><ul><li>Prezzo attuale: $333.87</li><li>Rendimento totale (1 anno): <strong>58.53%</strong></li><li>Rendimento annualizzato: <strong>59.42%</strong></li><li>Volatilità annualizzata: <strong>71.44%</strong></li><li>Sharpe Ratio: <strong>0.76</strong></li><li>Max Drawdown: <strong>-53.77%</strong></li></ul><p><strong>Palantir (PLTR)</strong>:</p><ul><li>Prezzo attuale: $156.71</li><li>Rendimento totale (1 anno): <strong>413.63%</strong></li><li>Rendimento annualizzato: <strong>423.86%</strong></li><li>Volatilità annualizzata: <strong>72.53%</strong></li><li>Sharpe Ratio: <strong>5.77</strong></li><li>Max Drawdown: <strong>-40.61%</strong></li></ul><p><strong>Raccomandazione Valuation Agent</strong>:</p><blockquote><p><em><strong>STRONG BUY Palantir</strong></em><br><em>Palantir&rsquo;s superior risk-adjusted returns and extraordinary growth potential make it a more attractive option for maximizing returns.</em></p></blockquote><h3 id=652-sentiment-agent---round-1>6.5.2 Sentiment Agent - Round 1<a hidden class=anchor aria-hidden=true href=#652-sentiment-agent---round-1>#</a></h3><p>Il Sentiment Agent effettua una ricerca di news in merito a Tesla e Palantir su Yahoo Finance e Google News, recupera il testo degli articoli e calcola i punteggi di sentiment utilizzando VADER e TextBlob.</p><p><strong>Raccolta News Finanziarie</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:10:08 - sentiment_agent.tools - INFO - Collecting news for TSLA (Tesla, Inc.)
</span></span><span class=line><span class=cl>2025-08-30 19:10:08 - sentiment_agent.tools - INFO - Collecting news for PLTR (Palantir Technologies Inc.)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP Request: GET https://feeds.finance.yahoo.com/rss/2.0/headline?s=TSLA&amp;region=US&amp;lang=en-US
</span></span><span class=line><span class=cl>HTTP Request: GET https://feeds.finance.yahoo.com/rss/2.0/headline?s=PLTR&amp;region=US&amp;lang=en-US
</span></span><span class=line><span class=cl>HTTP Request: GET https://news.google.com/rss/search?q=&#34;Tesla,+Inc.&#34;+OR+&#34;TSLA&#34;+stock+finance
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2025-08-30 19:10:09 - sentiment_agent.tools - INFO - Successfully collected 9 articles for TSLA
</span></span><span class=line><span class=cl>2025-08-30 19:10:09 - sentiment_agent.tools - INFO - Successfully collected 6 articles for PLTR
</span></span></code></pre></div><p><strong>Analisi Sentiment con VADER + TextBlob</strong>:</p><p><strong>Tesla (TSLA)</strong>:</p><ul><li>Sentiment complessivo: <strong>Neutrale</strong></li><li>TextBlob Average: 0.0024</li><li>VADER Average: -0.0651</li><li>Combined Average: <strong>-0.0381</strong> (leggera tendenza negativa)</li><li>Distribuzione: 22% positive, 33% negative, 44% neutral</li></ul><p><strong>Palantir (PLTR)</strong>:</p><ul><li>Sentiment complessivo: <strong>Positivo</strong></li><li>TextBlob Average: 0.0235</li><li>VADER Average: 0.4288</li><li>Combined Average: <strong>0.2667</strong> (moderatamente positivo)</li><li>Distribuzione: 83% positive, 17% negative</li></ul><p><strong>Key News Analysis Tesla</strong>:</p><ul><li><strong>Negative</strong>: &ldquo;Nearly Half Of Americans Say Tesla FSD Should Be Illegal&rdquo;</li><li><strong>Negative</strong>: &ldquo;Tesla&rsquo;s sales down 40% in EU while Chinese EV maker BYD is up 200%&rdquo;</li><li><strong>Positive</strong>: &ldquo;Tesla Stock is Going Up Today? TSLA Shares Jump to June Highs on Elon Musk&rsquo;s FSD Optimism&rdquo;</li></ul><p><strong>Key News Analysis Palantir</strong>:</p><ul><li><strong>Positive</strong>: &ldquo;Palantir Technologies Inc. (PLTR)&rsquo;s New Name Is &lsquo;Karpe Diem,&rsquo; Says Jim Cramer&rdquo;</li><li><strong>Positive</strong>: &ldquo;Moody&rsquo;s Just Upgraded The Top S&amp;P 500 Stock Not Named Palantir&rdquo;</li></ul><p><strong>Raccomandazione Sentiment Agent</strong>:</p><blockquote><p><em><strong>BUY Palantir</strong></em><br><em>Strong positive sentiment and market performance vs Tesla&rsquo;s neutral sentiment with regulatory challenges.</em></p></blockquote><h3 id=653-fundamental-agent---round-1>6.5.3 Fundamental Agent - Round 1<a hidden class=anchor aria-hidden=true href=#653-fundamental-agent---round-1>#</a></h3><p>L&rsquo;output dell&rsquo;agente Fundamental è molto più articolato e dettagliato. In particolare, non ha indicato una preferenza specifica di investimento, ma ha invece suggerito una strategia bivalente (SELL su Tesla e BUY su Palantir)</p><p><strong>Analisi Finanziaria Approfondita</strong>:</p><p>In un primo momento, l&rsquo;agente recupera ed esamina i rapporti finanziari di entrambe le aziende, evidenziando le loro performance e metriche chiave. I dati vengono recuperati tramite le API di Yahoo Finance.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:10:38 - fundamental_agent.tools - INFO - Pulling financial reports for TSLA (Tesla, Inc.)
</span></span><span class=line><span class=cl>2025-08-30 19:10:40 - fundamental_agent.tools - INFO - Successfully retrieved financial reports for TSLA
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2025-08-30 19:10:40 - fundamental_agent.tools - INFO - Pulling financial reports for PLTR (Palantir Technologies Inc.) 
</span></span><span class=line><span class=cl>2025-08-30 19:10:42 - fundamental_agent.tools - INFO - Successfully retrieved financial reports for PLTR
</span></span></code></pre></div><p><strong>RAG-based Analysis Results</strong>:</p><p>Come anticipato in precedenza, non si tratta di una vera analisi RAG, ma piuttosto di una ricerca delle informazioni rilevanti a partire dall&rsquo;output delle API di Yahoo finance. Partendo dai dati finanziari recuperati, l&rsquo;agente calcola i KPI di interesse e produce un parere da &ldquo;<em>esperto</em>&rdquo;.</p><p><strong>Tesla (TSLA)</strong>:</p><ul><li>Settore: Consumer Cyclical - Auto Manufacturers</li><li><strong>Gross Margin</strong>: 17.48%</li><li><strong>Operating Margin</strong>: 4.10%</li><li><strong>Revenue Growth</strong>: <strong>-11.80%</strong> (negativo)</li><li><strong>Earnings Growth</strong>: <strong>-17.50%</strong> (negativo)</li><li><strong>Fundamental Score</strong>: <strong>0/100</strong></li><li><strong>Investment Recommendation</strong>: <strong>SELL</strong></li></ul><blockquote><p><strong>Concerns</strong>: <em>&ldquo;Low operating margin indicates operational challenges, negative revenue growth indicates declining business</em>&rdquo;</p></blockquote><p><strong>Palantir (PLTR)</strong>:</p><ul><li>Settore: Technology - Software Infrastructure</li><li><strong>Gross Margin</strong>: <strong>80.03%</strong> (eccellente)</li><li><strong>Operating Margin</strong>: <strong>26.83%</strong> (forte)</li><li><strong>Revenue Growth</strong>: <strong>48.00%</strong> (robusto)</li><li><strong>Earnings Growth</strong>: <strong>116.70%</strong> (straordinario)</li><li><strong>Fundamental Score</strong>: <strong>100/100</strong></li><li><strong>Investment Recommendation</strong>: <strong>BUY</strong></li></ul><blockquote><p><strong>Strengths</strong>: <em>Strong gross margin indicates good pricing power, Strong operating margin indicates efficient operations, Strong revenue growth indicates market expansion</em></p></blockquote><h2 id=66-round-2-del-debate>6.6 Round 2 del Debate<a hidden class=anchor aria-hidden=true href=#66-round-2-del-debate>#</a></h2><p>Il sistema procede con il Round 2 del debate strutturato, dove ogni agente ha l&rsquo;opportunità di rispondere alle analisi degli altri:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>2025-08-30 19:11:12 - groupchat_agent.a2a_agent - INFO - === DEBATE ROUND 2 ===
</span></span><span class=line><span class=cl>2025-08-30 19:11:12 - groupchat_agent.a2a_agent - INFO - Round 2: valuation&#39;s turn (turn #2)
</span></span></code></pre></div><h3 id=661-dibattito>6.6.1 Dibattito<a hidden class=anchor aria-hidden=true href=#661-dibattito>#</a></h3><p>Gli agenti, nel Round 2, hanno accesso alle analisi degli altri agenti e possono presentare controargomentazioni o rafforzare le proprie posizioni. Questo processo permette di:</p><ul><li><strong>Identificare disaccordi</strong>: Tesla vs Palantir come investimento ottimale</li><li><strong>Confrontare metodologie</strong>: Analisi tecnica vs fondamentale vs sentiment</li><li><strong>Raffinare raccomandazioni</strong>: Basandosi su feedback peer-to-peer</li><li><strong>Validazione incrociata</strong>: Cross-reference tra diverse prospettive analitiche</li></ul><h3 id=662-processo-di-consensus-building>6.6.2 Processo di Consensus Building<a hidden class=anchor aria-hidden=true href=#662-processo-di-consensus-building>#</a></h3><p>Il Group Agent ha una soglia per il consenso tra gli agenti che è configurata tramite una variabile di ambiente. Nello specifico, ho lasciato il valore di default del 75%, ma potrebbe essere regolato in base alle esigenze del dibattito.
In ogni caso, per il test eseguito non ci sono state differenze significative nella risposta, per cui è stato molto facile raggiungere un consenso.</p><p>Ciononostante, prima di procedere alla fase di consolidamento, il Group Agent ha comunque evidenziato alcuni elementi distintivi delle risposte dei 3 agenti, e poi ha fornito un commento di sintesi:</p><blockquote><ol><li><p><strong>Valuation vs Fundamental divergence su Tesla</strong>:</p><ul><li><strong>Valuation Agent</strong>: Tesla ha mostrato 59.42% rendimento annualizzato → Potenziale BUY</li><li><strong>Fundamental Agent</strong>: Tesla ha -11.80% crescita ricavi, margini operativi 4.10% → SELL</li></ul></li><li><p><strong>Consensus su Palantir</strong>:</p><ul><li><strong>Valuation</strong>: 423.86% rendimento annualizzato, Sharpe 5.77 → STRONG BUY</li><li><strong>Fundamental</strong>: Score 100/100, margini 80.03% → BUY</li><li><strong>Sentiment</strong>: 83% sentiment positivo → BUY</li></ul></li><li><p><strong>Risk-adjusted perspective</strong>:</p><ul><li><strong>Tutti concordano</strong>: Per investitore risk-seeking con orizzonte 5-7 anni, Palantir è superiore a Tesla</li></ul></li></ol></blockquote><h2 id=67-fase-7-consolidamento-finale-e-report-generation>6.7 Fase 7: Consolidamento Finale e Report Generation<a hidden class=anchor aria-hidden=true href=#67-fase-7-consolidamento-finale-e-report-generation>#</a></h2><h3 id=671-llm-based-synthesis>6.7.1 LLM-based Synthesis<a hidden class=anchor aria-hidden=true href=#671-llm-based-synthesis>#</a></h3><p>Il Group Chat Agent utilizza un LLM con prompt ad-hoc per consolidare le analisi multiple.
Per dare una idea di come funziona il processo, riporto un esempio di prompt utilizzato, con alcune variabili che fanno riferimento al contesto:</p><p><strong>Consolidation Prompt</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>You are a financial analysis consolidator. Your role is to synthesize insights from multiple specialist agents into a coherent response.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>USER REQUEST: Sono indeciso se investire in Tesla oppure in Palantir. Il mio orizzonte di investimento è di 5-7 anni e voglio rendimenti massimi, posso gestire un rischio elevato
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>AGENT ANALYSES:
</span></span></span><span class=line><span class=cl><span class=s2>**VALUATION AGENT:**
</span></span></span><span class=line><span class=cl><span class=s2>[Analisi completa con metriche quantitative...]
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>**SENTIMENT AGENT:** 
</span></span></span><span class=line><span class=cl><span class=s2>[Analisi sentiment con distribuzione news...]
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>**FUNDAMENTAL AGENT:**
</span></span></span><span class=line><span class=cl><span class=s2>[Analisi fondamentale con score...]
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></div><h3 id=672-report-finale>6.7.2 Report Finale<a hidden class=anchor aria-hidden=true href=#672-report-finale>#</a></h3><p>Il sistema genera un report finale completo che integra tutte le analisi specialistiche. Ecco il report nella sua interezza:</p><hr><p><strong>📊 ALPHAAGENTS INVESTMENT ANALYSIS REPORT</strong></p><p>The analysis of whether to invest in Tesla (TSLA) or Palantir (PLTR) over a 5-7 year horizon, with a focus on maximizing returns and a willingness to manage high risk, was conducted through a structured multi-agent debate process. This comprehensive approach involved valuation, sentiment, and fundamental analyses, ensuring a well-rounded perspective.</p><p><strong>🎯 CONSENSUS AND KEY FINDINGS:</strong></p><p><strong>1. Palantir Technologies Inc. (PLTR)</strong></p><ul><li><strong>Valuation</strong>: Palantir has demonstrated an extraordinary annualized return of 423.86% with a high Sharpe ratio of 5.77, indicating exceptional risk-adjusted returns. The volatility is high, but the risk-reward profile is favorable.</li><li><strong>Sentiment</strong>: The sentiment analysis shows a strong positive outlook, with 83% of articles reflecting positive sentiment. This aligns with the valuation analysis, reinforcing Palantir&rsquo;s growth potential.</li><li><strong>Fundamentals</strong>: Palantir&rsquo;s strong growth metrics and operational efficiency support the positive sentiment and valuation findings.</li></ul><p><strong>Recommendation: STRONG BUY</strong>. Palantir is recommended for risk-seeking investors due to its exceptional growth potential and positive sentiment, making it an attractive option for maximizing returns.</p><p><strong>2. Tesla, Inc. (TSLA):</strong></p><ul><li><strong>Valuation</strong>: Tesla has a strong annualized return of 59.42% with high volatility. The Sharpe ratio of 0.76 suggests moderate risk-adjusted returns. The potential for significant returns exists, but with substantial risk.</li><li><strong>Sentiment</strong>: The sentiment analysis is neutral with a slight negative tilt, reflecting concerns about automotive sector challenges and regulatory issues with Tesla&rsquo;s Full Self-Driving technology.</li><li><strong>Fundamentals</strong>: Operational challenges and strategic uncertainties contribute to a more cautious outlook.</li></ul><p><strong>Recommendation: HOLD</strong>. While Tesla has potential upside, the current sentiment and operational challenges suggest a more cautious approach. Investors should wait for more positive sentiment or strategic clarity before increasing exposure.</p><p><strong>🏆 FINAL RECOMMENDATION:</strong></p><p>Based on the collective reasoning from the multi-agent debate, <strong>Palantir (PLTR)</strong> is the preferred choice for a risk-seeking investor aiming for maximum returns over a 5-7 year horizon. Its strong positive sentiment, exceptional risk-adjusted returns, and growth potential make it a compelling investment.</p><p><strong>Tesla (TSLA)</strong>, while still a strong contender, is recommended as a hold due to its current neutral sentiment and operational challenges. Investors should monitor Tesla for strategic developments that could enhance its investment appeal.</p><p>This analysis benefits from the collaborative insights of multiple expert perspectives, providing increased confidence in the recommendations provided.</p><hr><h3 id=673-metadata-del-processo-di-debate>6.7.3 Metadata del Processo di Debate<a hidden class=anchor aria-hidden=true href=#673-metadata-del-processo-di-debate>#</a></h3><p>Il report finale include anche alcuni metadati sul processo seguito, che possono essere utilizzati per analisi di explainability:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;debate_metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;total_rounds&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;agents_participated&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;valuation&#34;</span><span class=p>,</span> <span class=s2>&#34;sentiment&#34;</span><span class=p>,</span> <span class=s2>&#34;fundamental&#34;</span><span class=p>],</span>  
</span></span><span class=line><span class=cl>    <span class=nt>&#34;consensus_achieved&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;consensus_percentage&#34;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;risk_tolerance_inferred&#34;</span><span class=p>:</span> <span class=s2>&#34;seeking&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;debate_duration&#34;</span><span class=p>:</span> <span class=s2>&#34;3m 32s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;llm_calls&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;risk_inference&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;agent_routing&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&#34;debate_detection&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;consolidation&#34;</span><span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=68-performance-e-tempi-di-esecuzione>6.8 Performance e Tempi di Esecuzione<a hidden class=anchor aria-hidden=true href=#68-performance-e-tempi-di-esecuzione>#</a></h2><p>Un aspetto importante da documentare è il tempo necessario per completare l&rsquo;intero processo di analisi. Basandomi sui timestamp registrati durante l&rsquo;esecuzione, ecco il breakdown temporale dettagliato:</p><h3 id=681-durata-complessiva>6.8.1 Durata Complessiva<a hidden class=anchor aria-hidden=true href=#681-durata-complessiva>#</a></h3><p><strong>Tempo totale di esecuzione</strong>: <strong>3 minuti e 32 secondi</strong> (dalle 19:09:40 alle 19:13:12)</p><h3 id=682-breakdown-temporale-per-fasi>6.8.2 Breakdown Temporale per Fasi<a hidden class=anchor aria-hidden=true href=#682-breakdown-temporale-per-fasi>#</a></h3><table><thead><tr><th>Fase</th><th>Durata</th><th>Timestamp Inizio</th><th>Timestamp Fine</th><th>Descrizione</th></tr></thead><tbody><tr><td><strong>Setup Iniziale</strong></td><td>~41s</td><td>19:06:50</td><td>19:07:31</td><td>Avvio di tutti gli agenti, Agent Registry, Healthcheck e verifiche di base</td></tr><tr><td><strong>Query Processing</strong></td><td>~1s</td><td>19:09:40</td><td>19:09:41</td><td>Ricezione e parsing della query utente</td></tr><tr><td><strong>Risk Tolerance Inference</strong></td><td>&lt;1s</td><td>19:09:40</td><td>19:09:40</td><td>Analisi LLM per inferire profilo di rischio</td></tr><tr><td><strong>Agent Discovery</strong></td><td>&lt;1s</td><td>19:09:40</td><td>19:09:40</td><td>Recupero endpoint dall&rsquo;Agent Registry</td></tr><tr><td><strong>Agent Routing</strong></td><td>~1s</td><td>19:09:41</td><td>19:09:41</td><td>Decisione LLM su agenti da coinvolgere</td></tr><tr><td><strong>Debate Detection</strong></td><td>&lt;1s</td><td>19:09:41</td><td>19:09:41</td><td>Decisione LLM per debate strutturato</td></tr><tr><td><strong>Round 1 Analysis</strong></td><td><strong>~91s</strong></td><td>19:09:41</td><td>19:11:12</td><td>Analisi iniziali sequenziali dei 3 agenti</td></tr><tr><td><strong>Round 2 Debate</strong></td><td><strong>~120s</strong></td><td>19:11:12</td><td>19:13:12</td><td>Secondo round e consolidamento finale</td></tr></tbody></table><h3 id=683-analisi-delle-componenti-più-costose>6.8.3 Analisi delle Componenti più Costose<a hidden class=anchor aria-hidden=true href=#683-analisi-delle-componenti-più-costose>#</a></h3><p><strong>Le fasi più time-intensive sono</strong>:</p><ol><li><p><strong>Round 1 Analysis (91 secondi)</strong>:</p><ul><li><strong>Valuation Agent</strong>: ~30s per recupero dati Yahoo Finance + calcoli volatilità</li><li><strong>Sentiment Agent</strong>: ~30s per raccolta news da fonti multiple + analisi VADER/TextBlob</li><li><strong>Fundamental Agent</strong>: ~31s per processing dati finanziari + keyword matching</li></ul></li><li><p><strong>Round 2 Debate (120 secondi)</strong>:</p><ul><li><strong>Debate structured</strong>: ~60s per secondo round di analisi cross-agent</li><li><strong>LLM Consolidation</strong>: ~60s per sintesi finale e report generation</li></ul></li></ol><h3 id=684-bottlenecks-e-ottimizzazioni-possibili>6.8.4 Bottlenecks e Ottimizzazioni Possibili<a hidden class=anchor aria-hidden=true href=#684-bottlenecks-e-ottimizzazioni-possibili>#</a></h3><p><strong>Colli di bottiglia identificati</strong>:</p><ul><li><strong>API Latency</strong>: Chiamate a Yahoo Finance (~2-3s per request)</li><li><strong>LLM Processing</strong>: Analisi complesse richiedono 10-15s per agente</li><li><strong>Sequential Execution</strong>: Turni sequenziali non parallelizzabili per design</li></ul><p><strong>Ottimizzazioni future</strong>:</p><ul><li><strong>Parallelizzazione Round 1</strong>: Possibile riduzione da 91s a ~35-40s</li><li><strong>Caching dati finanziari</strong>: Evitare retrieve multipli degli stessi ticker</li><li><strong>Model optimization</strong>: Prompt più efficienti o modelli più veloci</li></ul><h1 id=7-conclusioni>7. Conclusioni<a hidden class=anchor aria-hidden=true href=#7-conclusioni>#</a></h1><h2 id=71-motivazioni-e-obiettivi-del-progetto>7.1 Motivazioni e Obiettivi del Progetto<a hidden class=anchor aria-hidden=true href=#71-motivazioni-e-obiettivi-del-progetto>#</a></h2><p>Questo progetto è nato dall&rsquo;esigenza di <strong>testare concretamente il protocollo A2A e l&rsquo;Agent Registry</strong> in uno scenario applicativo reale, per sperimentare un applicativo multi-agente distribuito.</p><p>Come ho evidenziato nell&rsquo;introduzione, la proliferazione di framework GenAI monolitici e le loro limitazioni nel supporto multi-agente mi hanno spinto a investire un po&rsquo; di tempo per <strong>alzare il livello di astrazione</strong> e provare a disegnare un&rsquo;architettura ad agenti basata su A2A in modo da garantire:</p><ul><li><strong>Standardizzazione della comunicazione</strong> tra agenti eterogenei</li><li><strong>Eliminazione del lock-in</strong> verso framework specifici</li><li><strong>Scalabilità orizzontale</strong> attraverso deployment distribuiti</li><li><strong>Interoperabilità</strong> tra agenti implementati con stack tecnologici diversi</li></ul><p>Questo piccolo progetto mi ha tenuto sveglio qualche notte ma mi ha dato modo di mettere le mani in pasta con <strong>un sistema multi-agente REALE</strong> diverso dal caso di studio monolitico che spesso viene presentato nella sezione &ldquo;Getting Started&rdquo; di questo o di quel framework di GenAI.</p><p>Sono sempre più convinto che per le soluzioni Enterprise, valga la pena iniziare a pensare seriamente all&rsquo;architettura degli agenti e ai protocolli di collaborazione piuttosto che allo specifico stack tecnologico per implementare questo o quello Use Case.</p><h2 id=72-la-scelta-di-alphaagents>7.2 La Scelta di AlphaAgents<a hidden class=anchor aria-hidden=true href=#72-la-scelta-di-alphaagents>#</a></h2><p>La selezione del paper <strong>AlphaAgents di BlackRock</strong> come caso d&rsquo;uso si è rivelata particolarmente azzeccata perché, a fronte di una complessità non troppo elevata, mi ha consentito di realizzare una soluzione end-to-end, con risultati tangili e misurabili</p><p>Rispetto al paper originale ho dovuto accettare qualche compromesso per semplificare l&rsquo;implementazione, ma ciò non ha pregiudicato il raggiungimento del mio obiettivo.</p><h2 id=73-sviluppi-futuri>7.3 Sviluppi Futuri<a hidden class=anchor aria-hidden=true href=#73-sviluppi-futuri>#</a></h2><p>Il test end-to-end ha confermato la validità dell&rsquo;approccio e mi ha anche fornito alcuni spunti per miglioramenti futuri.</p><h3 id=741-miglioramenti-tecnici>7.4.1 Miglioramenti Tecnici<a hidden class=anchor aria-hidden=true href=#741-miglioramenti-tecnici>#</a></h3><p><strong>Performance Optimization</strong>:</p><ul><li><strong>Parallelizzazione Round 1</strong>: Riduzione potenziale da 91s a ~35s</li><li><strong>Data caching</strong>: Evitare retrieve multipli degli stessi ticker</li><li><strong>LLM optimization</strong>: Prompt engineering per ridurre latenza</li></ul><p><strong>Affidabilità degli agenti</strong>:</p><ul><li><strong>Sentiment Agent</strong>: Integrazione FinBERT per analisi più accurate</li><li><strong>Fundamental Agent</strong>: Implementazione vera RAG con vector embeddings</li><li><strong>Risk Assessment</strong>: Modelli più sofisticati per portfolio risk management</li></ul><p><strong>Miglioramenti sul Registry</strong>:</p><ul><li><strong>Agent versioning</strong> e gestione delle compatibilità</li><li><strong>Load balancing</strong> per agenti con istanze multiple</li><li><strong>Health monitoring</strong> e automatic failover</li></ul><h3 id=742-espansioni-funzionali>7.4.2 Espansioni Funzionali<a hidden class=anchor aria-hidden=true href=#742-espansioni-funzionali>#</a></h3><p><strong>Nuovi Agenti Specializzati</strong>:</p><ul><li><strong>Technical Analysis Agent</strong>: Pattern recognition, supporti/resistenze</li><li><strong>Macro Economic Agent</strong>: Analisi macroeconomica e settoriale</li><li><strong>ESG Agent</strong>: Environmental, Social, Governance scoring</li><li><strong>Options Agent</strong>: Analisi derivati e strategie hedging</li></ul><p><strong>Verifica accurata dei risultati</strong>:</p><ul><li><strong>Double check</strong> delle metriche calcolate dal Valuation Agent su ampi campioni di dati</li><li><strong>Cross-validation</strong> con altri modelli di valutazione</li></ul><h2 id=75-considerazioni-sui-risultati-finanziari>7.5 Considerazioni sui Risultati Finanziari<a hidden class=anchor aria-hidden=true href=#75-considerazioni-sui-risultati-finanziari>#</a></h2><h3 id=751-limitazioni-e-rischi>7.5.1 Limitazioni e Rischi<a hidden class=anchor aria-hidden=true href=#751-limitazioni-e-rischi>#</a></h3><p><strong>Limitazioni Tecniche</strong>:</p><ul><li><strong>Dati limitati</strong>: Buona parte dell&rsquo;analisi è basata sui dati di Yahoo Finance, non su fonti professionali</li><li><strong>Mancanza di backtesting</strong>: Come ho più volte sottolineato, non ho effettuato nessuna validazione sistematica su dati storici</li><li><strong>Scope ristretto</strong>: Il campione di analisi su cui ho fatto i test end-to-end è limitato a poche azioni e poche tipologie di richieste utente</li></ul><p><strong>Rischi</strong>:</p><ul><li><strong>Allucinazioni LLM</strong>: Possibili analisi errate o contraddittorie</li><li><strong>Data quality</strong>: Accuratezza non garantita dei dati di input</li><li><strong>Model bias</strong>: Bias nei modelli di linguaggio utilizzati</li><li><strong>Market conditions</strong>: Non considera condizioni macroeconomiche correnti</li></ul><h3 id=752--disclaimer-importante>7.5.2 ⚠️ Disclaimer Importante<a hidden class=anchor aria-hidden=true href=#752--disclaimer-importante>#</a></h3><p>Anche alla luce delle limitazioni indicate sopra, tutti i risultati, le raccomandazioni e le analisi presentate in questo articolo sono <strong>esclusivamente a scopo esemplificativo</strong> per illustrare il funzionamento del sistema multi-agente.</p><p><strong>I risultati qui riportati ed il software rilasciato su GitHub NON devono essere utilizzati in alcun modo come</strong>:</p><ul><li>Base per decisioni di investimento reali</li><li>Consigli finanziari o raccomandazioni di trading</li><li>Input per strategie di portfolio management</li></ul><hr><section id=comments><script src=https://giscus.app/client.js data-repo=c-daniele/c-daniele.github.io data-repo-id=R_kgDOKIObxg data-category=Announcements data-category-id=DIC_kwDOKIObxs4Cu2th data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=it crossorigin=anonymous async></script></section></div><footer class=post-footer><ul class=post-tags><li><a href=https://c-daniele.github.io/it/tags/ai/>ai</a></li><li><a href=https://c-daniele.github.io/it/tags/agent/>agent</a></li><li><a href=https://c-daniele.github.io/it/tags/a2a/>A2A</a></li></ul><nav class=paginav><a class=prev href=https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/><span class=title>« Precedente</span><br><span>Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit</span></a>
<a class=next href=https://c-daniele.github.io/it/posts/2025-08-15-agent-reg-for-a2a/><span class=title>Successivo »</span><br><span>Agent-Reg: Costruire un Agent Registry aperto per il Protocollo A2A</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa on twitter" href="https://twitter.com/intent/tweet/?text=AlphaAgents%3a%20Implementazione%20Multi-Agent%20A2A%20per%20Analisi%20Finanziaria%20Collaborativa&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f&amp;hashtags=ai%2cagent%2cA2A"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f&amp;title=AlphaAgents%3a%20Implementazione%20Multi-Agent%20A2A%20per%20Analisi%20Finanziaria%20Collaborativa&amp;summary=AlphaAgents%3a%20Implementazione%20Multi-Agent%20A2A%20per%20Analisi%20Finanziaria%20Collaborativa&amp;source=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f&title=AlphaAgents%3a%20Implementazione%20Multi-Agent%20A2A%20per%20Analisi%20Finanziaria%20Collaborativa"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa on whatsapp" href="https://api.whatsapp.com/send?text=AlphaAgents%3a%20Implementazione%20Multi-Agent%20A2A%20per%20Analisi%20Finanziaria%20Collaborativa%20-%20https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa on telegram" href="https://telegram.me/share/url?text=AlphaAgents%3a%20Implementazione%20Multi-Agent%20A2A%20per%20Analisi%20Finanziaria%20Collaborativa&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa on ycombinator" href="https://news.ycombinator.com/submitlink?t=AlphaAgents%3a%20Implementazione%20Multi-Agent%20A2A%20per%20Analisi%20Finanziaria%20Collaborativa&u=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-08-31-alphaagents-a2a%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://c-daniele.github.io/it/>Cdani's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copia";function s(){t.innerHTML="copiato!",setTimeout(()=>{t.innerHTML="copia"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>