<!doctype html><html lang=it dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit | Cdani's Blog</title><meta name=keywords content="Einstein,Bell,Quantum Mechanics,Entanglement"><meta name=description content="1. Introduzione 1.1. Intro dell&rsquo;intro Non so bene cosa sia questo articolo, un misto tra esperimento di coding, divulgazione e forse uno svago di qualcuno che in un&rsquo;altra vita avrebbe voluto fare il fisico.
Ce l&rsquo;avevo nel cassetto da un po&rsquo; di tempo, da quando avevo letto questo articolo di alcuni ricercatori del CERN, che spiega come sia possibile simulare un esperimento sulle disuguaglianze di Bell usando il framework Qibo."><meta name=author content="Me"><link rel=canonical href=https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3598bbf45621a4ad34d093926efeb15d6df27175e085d2f069483f14ad39d7fa.css integrity="sha256-NZi79FYhpK000JOSbv6xXW3ycXXghdLwaUg/FK051/o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=it href=https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/><link rel=alternate hreflang=en href=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-8NZQZ3Z1RN"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8NZQZ3Z1RN",{anonymize_ip:!1})}</script><meta property="og:title" content="Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit"><meta property="og:description" content="1. Introduzione 1.1. Intro dell&rsquo;intro Non so bene cosa sia questo articolo, un misto tra esperimento di coding, divulgazione e forse uno svago di qualcuno che in un&rsquo;altra vita avrebbe voluto fare il fisico.
Ce l&rsquo;avevo nel cassetto da un po&rsquo; di tempo, da quando avevo letto questo articolo di alcuni ricercatori del CERN, che spiega come sia possibile simulare un esperimento sulle disuguaglianze di Bell usando il framework Qibo."><meta property="og:type" content="article"><meta property="og:url" content="https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/"><meta property="og:image" content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-12T00:00:00+02:00"><meta property="article:modified_time" content="2025-10-12T00:00:00+02:00"><meta property="og:site_name" content="Cdani's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c-daniele.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit"><meta name=twitter:description content="1. Introduzione 1.1. Intro dell&rsquo;intro Non so bene cosa sia questo articolo, un misto tra esperimento di coding, divulgazione e forse uno svago di qualcuno che in un&rsquo;altra vita avrebbe voluto fare il fisico.
Ce l&rsquo;avevo nel cassetto da un po&rsquo; di tempo, da quando avevo letto questo articolo di alcuni ricercatori del CERN, che spiega come sia possibile simulare un esperimento sulle disuguaglianze di Bell usando il framework Qibo."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit","item":"https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit","name":"Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit","description":"1. Introduzione 1.1. Intro dell\u0026rsquo;intro Non so bene cosa sia questo articolo, un misto tra esperimento di coding, divulgazione e forse uno svago di qualcuno che in un\u0026rsquo;altra vita avrebbe voluto fare il fisico.\nCe l\u0026rsquo;avevo nel cassetto da un po\u0026rsquo; di tempo, da quando avevo letto questo articolo di alcuni ricercatori del CERN, che spiega come sia possibile simulare un esperimento sulle disuguaglianze di Bell usando il framework Qibo.","keywords":["Einstein","Bell","Quantum Mechanics","Entanglement"],"articleBody":"1. Introduzione 1.1. Intro dell’intro Non so bene cosa sia questo articolo, un misto tra esperimento di coding, divulgazione e forse uno svago di qualcuno che in un’altra vita avrebbe voluto fare il fisico.\nCe l’avevo nel cassetto da un po’ di tempo, da quando avevo letto questo articolo di alcuni ricercatori del CERN, che spiega come sia possibile simulare un esperimento sulle disuguaglianze di Bell usando il framework Qibo.\nLa lettura dell’articolo mi ha portato ad una constatazione che, almeno per me è super-affascinante: oggi nel 2025 chiunque con un minimo di conoscenze di programmazione e un paio di concetti di base, può fare (o almeno simulare) un esperimento di meccanica quantistica che 20 o 30 anni fa sarebbe stato possibile solo in un laboratorio di fisica con attrezzature costosissime.\nTuttavia, l’esercizio di fare COPIA/INCOLLA del codice e lanciarlo, non mi sembra di particolare interesse, per lo meno senza capire bene di cosa stiamo parlando. Per questo motivo, ho iniziato a studiare un po’ la storia e qualche principio di base.\nQuesto piccolo esercizio di approfondimento, che attraversa più di un secolo di storia, dalle origini (1905) fino al premio Nobel del 2022 (secondo me meriterebbe un film o un romanzo) e sfiora alcuni dei problemi epistemologici più profondi che il genere umano abbia mai affrontato, ha dunque dato un senso all’esercizio finale, che rimane comunque poco più di un COPIA/INCOLLA dall’articolo del CERN e da qualche suggerimento di Claude 😃\n1.2. Intro vera In molti si chiedono se/quando il quantum computing diventerà una realtà. A dire il vero, dopo una forte espansione del mercato nel periodo post-covid c’è stato un trend crescita moderato tra il 2022 ed il 2024, probabilmente a causa della crisi economica globale e dell’attenzione spostata sull’intelligenza artificiale generativa.\nYear Global Market Revenues 2020 ████████ $412M 2021 ████████ $391M 2022 ██████████████ $713M 2023 █████████████████ $885M 2024 ███████████████████████ $1,160M Fonti:\nFortune Business Insights SRI In particolare, nel 2024 i principali player che operano nel settore del Quantum Computing, hanno frenato un po’ la corsa al numero di qubit, concrentrandosi sullo sviluppo di nuove architetture per ridurre il cosiddetto fenomeno della decoerenza quantistica, che è uno dei principali ostacoli per la scalabilità dei sistemi attuali. Tuttavia, nel 2025 c’è stato un ritorno di fiamma, con annunci di nuovi prototipi da parte di IBM, Google e Microsoft e negli ultimi 6 mesi, il titolo di Rigetti (altro player che a differenza dei precedenti, opera esclusivamente nel settore del quantum computing) è cresciuto in borsa del 380%!\nIn ogni caso, non si è vista ancora alcuna vera rivoluzione e quasi tutti concordano sul fatto che probabilmente il QC non sostituità mai il modello di calcolo classico, ma nel migliore dei casi lo affiancherà, permettendo di risolvere problemi complessi in maniera efficiente.\nUn esempio di problema che potrebbe essere risolto in maniera efficiente con un computer quantistico è la scomposizione in fattori primi di numeri interi molto grandi, tramite l’algoritmo di Shor allo scopo di far evolvere (o violare) i sistemi di crittografia attualmente in uso.\nLe limitazioni attuali dei computer quantistici, però, non permettono ancora di eseguire questo algoritmo in maniera efficiente su numeri di grandezza tale da minare la sicurezza dei sistemi crittografici attuali. A parte questo caso d’uso potenziale, e qualche altro caso particolare e circoscritto ad ambiti molto particolari, come ad esempio l’algoritmo di Grover per la ricerca in liste non ordinate, non si vedono ancora applicazioni pratiche del quantum computing. Mentre aspettiamo che arrivino applicazioni pratiche, possiamo però già oggi usarla per fare veri e propri esperimenti di meccanica quantistica. Tali esperimenti, che per me sono poco più che un gioco, fanno riferimento a dei lavori molto più seri, durati qualche decennio, che nel 2022 hanno portato John Clauser, Alain Aspect e Anton Zeilinger a vincere il premio Nobel per la Fisica: gli esperimenti sulle Disuguaglianze di Bell.\nInutile dire che quello riportato qui non è neanche un vero e proprio “esperimento”, poiché mi sono basato su un simulatore (e non un vero computer quantistico). Inoltre il circuito che ho implementato è basato su una semplificazione estrema dell’esperimento originale, ma i principi teorici sono gli stessi ed inoltre potrebbe essere portato su un vero Quantum Computer commerciale con poco sforzo, dunque è un esercizio interessante per capire che cosa significa veramente la “non-località” in meccanica quantistica e come gli stessi principi siano alla base del funzionamento del Quantum Computing.\nPer farlo, ci servono alcuni ingredienti:\nUn po’ di storia Qualche nozione di meccanica quantistica Un deep dive sulle disuguaglianze di Bell Le basi del Quantum Computing 2. Un po’ di storia 2.1. Einstein e la meccanica quantistica Forse non tutti sanno che Albert Einstein non vinse il premio Nobel per le sue teorie sulla relatività, ma bensì per la spiegazione dell’effetto fotoelettrico, traendo spunto da un’idea di Max Planck. Analogamente agli studi sulla relatività, quel lavoro di Einstein fu di enorme importanza per la fisica del XX secolo, perché diede il via all’altra grande branca della fisica: la meccanica quantistica. Un fatto degno di nota è che nessun premio Nobel è mai stato assegnato per scoperte direttamente collegate alla teoria della relatività, mentre dal 1920 almeno 16 Nobel sono stati assegnati per studi o scoperte direttamente collegati alla meccanica quantistica.\nAgli inizi del ventesimo secolo, l’idea della luce come “corpuscolo” era in contrasto con la rappresentazione ondulatoria della luce, che era ormai ben consolidata e risaliva addirittura ai lavori di Christiaan Huygens svolti intorno alla metà del 1600. Nel corso dei secoli, la natura ondulatoria venne più volte messa in discussione, ma gli esperimenti di interferenza le solide basi teoriche introdotte da Thomas Young nel 1801, e successivamente da James Clerk Maxwell con la sua teoria elettromagnetica della luce, sembravano aver definitivamente chiuso la questione. Di conseguenza, lo stesso Planck, quando introdusse l’idea dei quanti nel 1900, non credeva veramente nella natura corpuscolare della luce. Dal suo punto di vista, si trattava solo di una astrazione teorica, che serviva a spiegare il problema dell’emissione di radiazione di corpo nero, ma che non aveva una reale corrispondenza fisica.\nIl grande merito di Einstein fu quello di prendere sul serio l’intuzione di Planck, secondo cui l’energia non poteva essere scambiata in maniera continua, ma bensì a “pacchetti” discreti, che Planck chiamò “quanti” (da cui il nome “meccanica quantistica”). Nel 1905, Einstein applicò questa idea per spiegare l’effetto fotoelettrico, ipotizzando che la luce fosse composta da “quanti di luce”, che oggi chiamiamo fotoni e ciò gli valse il premio Nobel per la fisica nel 1921.\nTuttavia, all’inizio nessuno credette ad Einstein, neppure Max Planck, che pure aveva fornito l’intuizione iniziale. Fu solo grazie al lavoro di Robert Millikan che, con l’obiettivo di screditare la tesi di Einstein, fece numerosi esperimenti e impiegò diversi anni per arrendersi al fatto che la spiegazione dell’effetto fotoelettrico fornita da Einstein era corretta e dunque l’ipotesi dei quanti era tutt’altro che una semplice astrazione teorica.\nDa qui in avanti, è un susseguirsi di studi e scoperte che fanno della meccanica quantistica la teoria fisica più accurata e precisa mai sviluppata e che hanno portato in pochi anni ad una sequenza incredibile di premi Nobel, tra cui i più importanti sono:\n1922 - Niels Bohr per i suoi studi sulla struttura atomica 1923 - Millikan per il suo lavoro sperimentale sull’effetto fotoelettrico e la misura della carica dell’elettrone 1927 - Arthur Compton per la scoperta dell’effetto Compton 1929 - Louis de Broglie per la scoperta della natura ondulatoria dell’elettrone 1932 - Werner Heisenberg per la formulazione della meccanica quantistica 1933 - Erwin Schrödinger e Paul Dirac per la formulazione della meccanica ondulatoria 1945 - Wolfgang Pauli per la scoperta del principio di esclusione 1954 - Max Born per la formulazione della meccanica quantistica in termini probabilistici 1965 - Richard Feynman, Julian Schwinger e Sin-itiro Tomonaga per lo sviluppo dell’elettrodinamica quantistica Ironia della sorte, proprio Einstein che aveva dato il via a quella rivoluzione, iniziò ad essere sempre più scettico sulla teoria stessa mano a mano che andava sviluppandosi, fino al punto di isolarsi dalla comunità scientifica che nel frattempo l’aveva abbracciata pienamente.\nMa perché Einstein era così scettico in merito alla rappresentazione della realtà secondo la meccanica quantistica? La risposta a questa domanda ha appunto a che fare con il concetto stesso di Realtà e richiede un approfondimento per capire il punto di vista di Einstein.\n2.2. Che cos’è la realtà? Da un certo punto di vista, l’approccio di Einstein ai problemi sollevati meccanica quantistica è stato simile a quello che aveva caratterizzato il suo approccio alla Relatività. Nel momento in cui si trovava di fronte ad un problema apparentemente insolubile (come ad esempio la costanza della velocità della luce su tutti i sistemi di riferimento inerziali), non cercava a tutti i costi di adattare la teoria, ma piuttosto iniziava a mettere in discussione e a definire un nuovo formalismo, per concetti che sembravano ormai assodati, come ad esempio il concetto di simultaneità, di tempo e di spazio.\nQualcosa di analogo avvenne anche per il concetto di Realtà, attraverso cui poi Einsten, Podolsky e Rosen formularono il famoso paradosso EPR, che metteva in discussione la completezza della meccanica quantistica.\nDal punto di vista di Einstein, la descrizione del mondo fisico doveva obbedire a 2 principi fondamentali:\nLocalità: un oggetto può essere influenzato solo dal suo immediato intorno, e non da eventi che avvengono a distanza arbitrariamente elevata. In altre parole, non possono esistere “azioni a distanza” (spooky action at a distance). Realismo: gli oggetti hanno proprietà definite indipendentemente dall’osservazione. In altre parole, la realtà esiste indipendentemente dal fatto che noi la osserviamo o meno. Il Paradosso EPR descrive alcuni esperimenti mentali attraverso cui gli autori provano a dimostrare che la meccanica quantistica non può essere una teoria completa, perché viola almeno uno dei principi sopra elencati.\nℹ️ Note In altre parole, se la meccanica quantistica è corretta, allora vale almeno una delle seguenti affermazioni:\nil principio di località è falso, e quindi esistono azioni a distanza che violano il limite della velocità della luce il principio di realismo è falso, e quindi gli oggetti non hanno proprietà definite indipendentemente dall’osservazione, ma bensì le proprietà fisiche si manifestano solo nel momento in cui esse vengono misurate Da un punto di vista tecnico, il paradosso EPR si basa sul concetto di entanglement che, oltre ad essere uno dei concetti più strani e affascinanti della meccanica quantistica (spesso frainteso e mal interpretato), è anche alla base del funzionamento dei computer quantistici.\n2.3 L’interesse del mondo scientifico alla questione Per decenni, l’intera questione del paradosso EPR e della interpretazione epistemologica della meccanica quantistica rimase confinata a discussioni filosofiche tra pochi addetti ai lavori, e già dopo gli anni 30 la meccanica quantistica era talmente ben consolidata che nessuno si preoccupava più di questi aspetti. Lo stesso Bell, ha lavorato come fisico delle particelle presso diversi enti di ricerca in UK e poi al CERN e si dedicava a questo tema solo nel tempo libero. Nel 1964, durante un anno sabbatico negli Stati Uniti, Bell pubblicò il famoso articolo “On the Einstein Podolsky Rosen paradox” in cui propose un modo per verificare sperimentalmente se Einstein avesse ragione o meno. L’articolo suscitò un certo interesse, ma tuttavia, anche dopo la pubblicazione di Bell, solo pochi temerari si interessarono ad un potenziale esperimento per verificare le disuguaglianze di Bell, anche perché dopo poco tempo la stessa rivista su cui Bell aveva pubblicato l’articolo fallì e questo non contribuì certo a diffondere l’idea.\nLo stesso John Clauser, uno dei tre premi Nobel del 2022, inzialmente non era molto convinto di voler affrontare la questione e racconta che quando chiese un consiglio al mitico Richard Feynman di fare il suo primo esperimento per testare le disuguaglianze di Bell, gli venne risposto che si trattava di una “perdita di tempo”, perché la meccanica quantistica era già stata ampiamente verificata e nessuno si aspettava che Einstein avesse ragione.\n3. Qualche nozione di meccanica quantistica 3.1. Sovrapposizione quantistica In meccanica quantistica, un sistema può trovarsi in uno stato di sovrapposizione, cioè in una combinazione di più stati contemporaneamente.\nNel mondo del quantum computing, lo stato di sovrapposizione può essere implementato tramite l’applicazione di alcuni operatori (quantum gates) sui qubit, l’analogo quantistico del bit classico. Mentre un bit classico può assumere solo i valori 0 o 1, un qubit può trovarsi in una sovrapposizione dei due stati, rappresentata matematicamente come:\n$$|\\psi\\rangle = \\alpha|0\\rangle + \\beta|1\\rangle$$\ndove $\\alpha$ e $\\beta$ sono numeri complessi che soddisfano la condizione $|\\alpha|^2 + |\\beta|^2 = 1$.\n3.2. Misura quantistica Quando misuriamo un qubit, la sovrapposizione “collassa” in uno dei due stati base (0 o 1), con probabilità rispettivamente $|\\alpha|^2$ e $|\\beta|^2$.\nQuesto è uno degli aspetti più controversi della meccanica quantistica: prima della misura, il sistema è effettivamente in entrambi gli stati contemporaneamente (almeno secondo l’interpretazione di Copenaghen), ma nel momento in cui lo misuriamo, la realtà “sceglie” uno dei due stati in modo probabilistico.\nEinstein non ha mai accettato questa interpretazione. In un primo momento cercò di dimostrare che la meccanica quantistica fosse errata. Sono ormai celebri le sue critiche a Bohr durante i congressi Solvay e gli esperimenti mentali con cui cercava di mettere in difficoltà l’impostazione teoretica della meccanica quantistica che oggi possiamo definire “ortodossa”. Tuttavia, Bohr e Heisenberg riuscivano sempre a trovare una risposta alla challenge di Einstein, supportata dalla teoria stessa. Alla fine, Einstein si arrese all’evidenza: la meccanica quantistica era corretta.\nTuttavia continuò a sostenere che fosse una teoria incompleta e che doveva esistere una descrizione più completa della realtà, che includesse delle “variabili nascoste” che permettono di predire il risultato della misura in modo deterministico.\nAl di là delle implicazioni filosofiche, il concetto di “misura” ha delle implicazioni pratiche anche nella programmazione quantistica poiché, ad esempio, non possiamo semplicemente “leggere” lo stato di un qubit in uno stato di sovrapposizione senza alterarlo. Nella interpretazione di Copenhagen, questa alterazione (cioè questa “misura”) equivale al concetto di collasso della funzione d’onda.\n3.3. Entanglement L’entanglement (correlazione quantistica) è forse il fenomeno più strano e controintuitivo della meccanica quantistica. Quando due particelle sono entangled, esse formano un unico sistema quantistico, anche se sono separate da distanze arbitrariamente grandi.\nQuesta correlazione porta a fenomeni che Einstein chiamava “azioni fantasma a distanza” (spooky actions at a distance) e che lo portarono a credere che la meccanica quantistica dovesse essere una teoria incompleta.\nCiononostante, per quanto strana e controintuitiva (anzi, forse proprio a causa di questo aspetto), il fenomeno dell’entanglement è stato sperimentato e verificato innumerevoli volte in laboratorio.\nNella stragrande maggioranza dei casi, i test fanno riferimento a singole particelle, ma esistono anche casi in cui è stato verificato lo stato entangled di sistemi macroscopici come molecole.\nL’esempio più estremo e famoso è quello dell’esperimento mentale del gatto di Schrödinger, che si trova contemporaneamente vivo e morto fino a quando non viene osservato.\n3.3.1. Entanglement e Quantum Computing Dal punto di vista del Quantum Computing, un esempio classico è quello di due qubit in stato di Bell:\n$$|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$$\nQuesto stato rappresenta una sovrapposizione in cui i due qubit sono entrambi 0 oppure entrambi 1 con probabilità 50%. La cosa straordinaria è che quando misuriamo il primo qubit e otteniamo (ad esempio) 0, istantaneamente il secondo qubit collassa anche lui nello stato 0, indipendentemente dalla distanza che li separa.\n3.4 Teorie a variabili nascoste Secondo Einstein, la meccanica quantistica era una teoria incompleta: le probabilità che osserviamo nelle misure quantistiche non rifletterebbero una reale indeterminazione della natura, ma semplicemente la nostra ignoranza di alcune variabili nascoste che in teoria potrebbero essere utilizzate per determinare in modo preciso il risultato di una misura.\nPer capire meglio questo concetto, possiamo fare un’analogia con il lancio di una moneta:\nDal punto di vista pratico, il risultato (testa o croce) sembra casuale con probabilità 50% Ma sappiamo che in realtà il risultato è completamente determinato dalle condizioni iniziali: velocità, angolo di lancio, forza, resistenza dell’aria, ecc. Se conoscessimo perfettamente tutte queste “variabili nascoste”, potremmo predire con certezza il risultato Einstein credeva che qualcosa di simile avvenisse anche in meccanica quantistica. Quando prepariamo un elettrone in uno stato di sovrapposizione e poi lo misuriamo, secondo Einstein:\nL’elettrone possiede già una proprietà definita prima della misura Questa proprietà è determinata da variabili che la teoria attuale non include (variabili “nascoste”) La natura probabilistica della meccanica quantistica deriva solo dalla nostra ignoranza di queste variabili Una teoria più completa, che includesse queste variabili, sarebbe completamente deterministica Questo punto di vista è chiamato realismo locale con variabili nascoste:\nLocale: le variabili nascoste sono proprietà intrinseche del sistema, non influenzate da eventi distanti Realista: le proprietà fisiche esistono indipendentemente dall’osservazione Deterministico: conoscendo le variabili nascoste, il risultato della misura sarebbe predeterminato Il paradosso EPR fu proprio un tentativo di Einstein, Podolsky e Rosen di dimostrare che tali variabili nascoste dovevano necessariamente esistere per mantenere i principi di località e realismo.\n4. Un deep dive sulle disuguaglianze di Bell 4.1. Il lavoro di John Bell Nel 1964, il fisico irlandese John Stewart Bell propose un modo per verificare sperimentalmente se Einstein avesse ragione. Bell formulò una serie di disuguaglianze matematiche che devono essere soddisfatte se vale il principio di realismo locale (cioè se valgono insieme sia il principio di località che quello di realismo).\nL’idea geniale di Bell fu di trovare una quantità misurabile che:\nSe la meccanica quantistica è corretta, viola le disuguaglianze Se esiste una teoria a “variabili nascoste locali” (come Einstein sosteneva), rispetta le disuguaglianze Questo lavoro, tuttavia, era di natura interamente matematica. La bravura dei fisici che vennero in seguito (e per cui alla fine è stato riconosciuto il Nobel nel 2022) fu quella di progettare e realizzare esperimenti per declinarlo nel mondo reale.\n4.2. Il test CHSH Una delle formulazioni più utilizzate delle disuguaglianze di Bell è il test CHSH (da Clauser, Horne, Shimony e Holt), che prende il nome dai quattro fisici che lo proposero nel 1969.\nL’esperimento prevede:\nUna sorgente che produce coppie di particelle entangled (ad esempio fotoni polarizzati) I soliti “Alice” e “Bob” di tutti gli esperimenti di fisica, i quali possono scegliere tra due possibili misure da effettuare Si misurano le correlazioni tra i risultati ottenuti da Alice e Bob Più formalmente:\nAlice può scegliere di misurare secondo l’angolo $a_0$ oppure $a_1$ Bob può scegliere di misurare secondo l’angolo $b_0$ oppure $b_1$ Ogni misura produce un risultato +1 oppure -1 Si definisce quindi la quantità CHSH:\n$$S = E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)$$\ndove $E(a_i, b_j)$ è la correlazione tra le misure di Alice e Bob.\n4.2.1. Grandezze non commutative Nel test CHSH Alice e Bob misurano la polarizzazione dei fotoni secondo angoli diversi, ma esperienti analoghi possono essere fatti con altre grandezze fisiche, come lo spin di elettroni (anch’essi in stato entangled).\nIn ogni caso, l’esperimento funziona solo se le grandezze misurate sono di natura non commutativa.\nIn fisica classica, se vogliamo misurare due proprietà di un oggetto (ad esempio, la sua posizione e la sua velocità), possiamo farlo in qualsiasi ordine e ottenere sempre gli stessi risultati. L’ordine delle misure non conta.\nIn meccanica quantistica, invece, esistono coppie di grandezze fisiche per cui l’ordine delle misure è importante. Quando misuriamo prima A e poi B, otteniamo risultati diversi rispetto a quando misuriamo prima B e poi A. Matematicamente, questo si esprime dicendo che gli operatori corrispondenti non commutano:\n$$\\hat{A}\\hat{B} \\neq \\hat{B}\\hat{A}$$\nℹ️ Note La non-commutatività è strettamente collegata al principio di indeterminazione di Heisenberg. Gli esempi più famosi di grandezze non commutative sono:\nPosizione e quantità di moto: formulazione classica del principio di indeterminazione Componenti dello spin lungo assi diversi: misurare lo spin lungo l’asse x e poi lungo l’asse y dà risultati diversi rispetto all’ordine inverso Polarizzazione del fotone secondo angoli diversi: proprio quello che misuriamo nel test CHSH Nel nostro esperimento, quando Alice misura la polarizzazione secondo l’angolo $a_0 = 0°$ e Bob secondo $b_0 = 45°$, stanno misurando grandezze non commutative perché associate allo stesso sistema entangled.\nConfigurazione tipica di un esperimento CHSH. Una sorgente produce coppie di particelle entangled che vengono inviate a due osservatori spazialmente separati (Alice e Bob). Ciascun osservatore può scegliere tra due possibili angoli di misura (ad esempio, polarizzatori orientati a 0° o 45° per Alice e 22.5° o 67.5° per Bob). I risultati delle misure (+1 o -1) ricevuti dai 4 rivelatori vengono poi utilizzati per calcolare la quantità CHSH $S$.\nFonte: wikipedia Secondo la meccanica quantistica “ortodossa”, possiamo riassumere che:\nNon possiamo conoscere simultaneamente entrambe le polarizzazioni con certezza assoluta La prima misura influenza la seconda: se Alice misura prima, il risultato di Bob sarà influenzato dal collasso della funzione d’onda causato dalla misura di Alice Non esistono “valori preesistenti” per entrambe le polarizzazioni: le proprietà si manifestano solo al momento della misura Di converso, le teorie a variabili nascoste assumono che ogni particella porti con sé un “istruzione nascosta” che predetermina il risultato per ogni possibile angolo di misura. Ma se le grandezze non commutano, non possono esistere contemporaneamente valori predeterminati per tutte le possibili misure.\nIl genio di Bell fu capire che questa differenza tra il mondo classico (dove tutte le grandezze commutano) e quello quantistico (dove alcune grandezze non commutano) si traduce in una differenza misurabile nelle correlazioni statistiche su un campione di misure sufficientemente ampio.\nSecondo il realismo locale: $|S| \\leq 2$ Secondo la meccanica quantistica: $|S|$ può arrivare fino a $2\\sqrt{2} \\approx 2.828$ Ma perché questi limiti? Cerchiamo di capirlo con un’analogia intuitiva.\n4.2.1.1. Il ragionamento del realismo locale (il limite di 2) Immaginiamo che ogni coppia di particelle entangled porti con sé un “foglietto di istruzioni” nascosto che predetermina il risultato per ogni possibile angolo di misura. Questo foglietto contiene 4 valori predeterminati:\n$A_0$: risultato di Alice se misura secondo $a_0$ (può essere +1 o -1) $A_1$: risultato di Alice se misura secondo $a_1$ (può essere +1 o -1) $B_0$: risultato di Bob se misura secondo $b_0$ (può essere +1 o -1) $B_1$: risultato di Bob se misura secondo $b_1$ (può essere +1 o -1) Per ogni singola coppia di particelle, possiamo calcolare:\n$$S_{\\text{singola}} = A_0 B_0 + A_0 B_1 + A_1 B_0 - A_1 B_1$$\nFacciamo un esempio concreto. Supponiamo che una particolare coppia abbia:\n$A_0 = +1$, $A_1 = -1$, $B_0 = +1$, $B_1 = +1$ Allora: $$S = (+1)(+1) + (+1)(+1) + (-1)(+1) - (-1)(+1) = 1 + 1 - 1 + 1 = 2$$\nProviamo un’altra combinazione:\n$A_0 = +1$, $A_1 = +1$, $B_0 = +1$, $B_1 = -1$ $$S = (+1)(+1) + (+1)(-1) + (+1)(+1) - (+1)(-1) = 1 - 1 + 1 + 1 = 2$$\nPossiamo riscrivere $S$ come: $$S = A_0(B_0 + B_1) + A_1(B_0 - B_1)$$\nOra osserviamo che:\nSe $B_0 = B_1$, allora $(B_0 + B_1) = \\pm 2$ e $(B_0 - B_1) = 0$, quindi $S = \\pm 2A_0$, cioè $|S| = 2$ Se $B_0 = -B_1$, allora $(B_0 + B_1) = 0$ e $(B_0 - B_1) = \\pm 2$, quindi $S = \\pm 2A_1$, cioè $|S| = 2$ In entrambi i casi, per una singola coppia con valori predeterminati, otteniamo sempre $|S| = 2$\nQuando facciamo molte misure e calcoliamo la media delle correlazioni $E(a_i, b_j)$, stiamo mediando su tutte le possibili combinazioni di istruzioni nascoste. Ma siccome ogni singola coppia dà $|S| = 2$, la media non può mai superare questo valore:\n$$|S| = |E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)| \\leq 2$$\nQuesto è dunque il limite classico ed è valido per qualsiasi teoria a variabili nascoste locali.\n4.2.1.2. Il ragionamento quantistico (il limite di 2√2) Nella meccanica quantistica, invece, non esistono valori predeterminati. Le particelle sono in uno stato di Bell entangled:\n$$|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$$\nQuando Alice e Bob misurano secondo angoli diversi, le correlazioni dipendono dalla differenza angolare $\\theta$ tra le loro direzioni di misura secondo la formula:\n$$E(\\theta) = \\cos(2\\theta)$$\nPer gli angoli ottimali del test CHSH:\n$a_0 = 0°$, $a_1 = 45°$ $b_0 = 22.5°$, $b_1 = -22.5°$ Con questi angoli:\n$E(a_0, b_0) = \\cos(2 \\times 22.5°) = \\cos(45°) = \\frac{1}{\\sqrt{2}}$ $E(a_0, b_1) = \\cos(2 \\times 22.5°) = \\cos(45°) = \\frac{1}{\\sqrt{2}}$ $E(a_1, b_0) = \\cos(2 \\times 22.5°) = \\cos(45°) = \\frac{1}{\\sqrt{2}}$ $E(a_1, b_1) = \\cos(2 \\times 67.5°) = \\cos(135°) = -\\frac{1}{\\sqrt{2}}$ Quindi: $$S = \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} - \\left(-\\frac{1}{\\sqrt{2}}\\right) = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2} \\approx 2.828$$\nQuesto invece è il limite di Tsirelson ed è il massimo valore teorico previsto dalla meccanica quantistica.\nℹ️ Note per capire meglio cosa intendiamo per “angoli di misura” e come si calcolano le correlazioni in meccanica quantistica, ho fatto un piccolo approfondimento el paragrafo 6.5. 4.2.1.3. Da dove viene questa differenza? La differenza fondamentale è questa:\nRealismo locale: assume che ogni particella abbia 4 proprietà definite contemporaneamente ($A_0, A_1, B_0, B_1$), anche se ne misuriamo solo una. Questa assunzione limita le correlazioni possibili.\nMeccanica quantistica: le proprietà non esistono prima della misura. Le particelle sono in sovrapposizione e l’angolo di misura determina la “base” in cui proiettiamo lo stato. Questo permette correlazioni più forti.\nUn’analogia: è come se nel caso classico ogni particella portasse con sé 4 monete già lanciate (ma coperte), mentre nel caso quantistico le monete vengono lanciate solo quando le scopriamo, e il modo in cui scopriamo quella di Alice influenza istantaneamente le probabilità per quella di Bob, anche se sono lontane.\n4.3. Gli esperimenti che valsero il Nobel 2022 A partire dagli anni ‘70, una serie di esperimenti basati sull’impostazione teorica di Bell ed in particolare sul test CHSH hanno dimostrato indiscutibilmente che le disuguaglianze di Bell vengono violate esattamente secondo quanto previsto dall’impostazione teorica della meccanica quantistica, confermando che il realismo locale non può essere mantenuto:\n1972 - John Clauser: primo esperimento che violò le disuguaglianze di Bell usando fotoni polarizzati 1982 - Alain Aspect: esperimenti più raffinati che eliminarono diverse possibili “scappatoie” (loopholes) 1998-2015 - Anton Zeilinger: esperimenti con entanglement su distanze sempre maggiori, fino a dimostrare il teletrasporto quantistico Nel 2022, questi tre fisici ricevettero il Premio Nobel per la fisica proprio per questi esperimenti pionieristici.\n4.3.1. Le “scappatoie” (loopholes) e come sono state eliminate Nonostante i primi esperimenti di Clauser negli anni ‘70 avessero violato le disuguaglianze di Bell, rimanevano alcune possibili obiezioni tecniche che avrebbero potuto permettere a un sostenitore del realismo locale di mettere in dubbio i risultati. Queste obiezioni sono chiamate loopholes (scappatoie), e gran parte del lavoro sperimentale successivo si è concentrato nell’eliminarle una per una.\n4.3.1.1. Locality Loophole Il problema: Nei primi esperimenti, le misure di Alice e Bob non erano sufficientemente separate nello spazio-tempo. In teoria, un segnale classico (viaggiando alla velocità della luce o meno) avrebbe potuto viaggiare da un rivelatore all’altro influenzando il risultato senza che l’apparato sperimentale fosse in grado di rilevarlo.\nLa soluzione di Alain Aspect (1982): Aspect introdusse un sistema di switching ultraveloce degli angoli di misura:\nGli angoli di misura venivano cambiati casualmente durante il volo dei fotoni Il cambiamento avveniva così velocemente che nessun segnale subluminale poteva viaggiare da un rivelatore all’altro Questo garantiva la separazione spazio-temporale (spacelike separation) delle misure Tali modifiche vennero implementate di modo che l’intervallo di tempo fra produzione e detection fosse di 20 ns, mentre gli switch dei canali invertissero orientazione in modo asincrono ogni 10 ns, tenendo le varie sezioni sufficientemente lontane da garantire distanze di tipo spazio fra loro. Ciò assicura che l’evento di misura di Alice sia causalmente disconnesso da quello di Bob.\n4.3.1.2. Fair Sampling Loophole Il problema: Nessun rivelatore è perfetto al 100%. Nei primi esperimenti con fotoni, solo una piccola frazione delle coppie di particelle prodotte veniva effettivamente rivelata e misurata. Negli esperimenti di Clauser, ad esempio, l’efficienza di rivelazione era inferiore al 5%.\nQuesto apre una possibile obiezione: come possiamo essere sicuri che le coppie di particelle effettivamente rivelate siano un campione rappresentativo di tutte le coppie prodotte?\nUn sostenitore del realismo locale potrebbe sostenere che:\nLe particelle portano con sé “istruzioni nascoste” che determinano sia il risultato della misura che la probabilità di essere rivelate Le particelle con certe combinazioni di istruzioni nascoste hanno una maggiore probabilità di essere rivelate rispetto ad altre Il campione osservato è quindi distorto (biased), e le correlazioni misurate non riflettono le vere correlazioni dell’insieme completo In altre parole, è come se facessimo un sondaggio politico intervistando solo le persone che rispondono al telefono: il campione potrebbe non essere rappresentativo della popolazione generale.\nMatematicamente, questa obiezione funziona perché la dimostrazione delle Disuguaglianze di Bell assume che tutte le coppie prodotte vengano misurate. Se possiamo misurare solo un sottoinsieme, e questo sottoinsieme non è scelto in modo casuale ma dipende dalle variabili nascoste, allora le disuguaglianze potrebbero essere violate anche in una teoria a variabili nascoste locali.\nL’assunzione del campionamento equo: Per molti anni, gli esperimenti si sono basati sull’ipotesi del campionamento equo (fair sampling assumption), che assume che le particelle rivelate siano un campione casuale rappresentativo. Questa ipotesi è ragionevole dal punto di vista fisico, ma non è una dimostrazione rigorosa.\nLa soluzione: Per eliminare completamente questo loophole, serve raggiungere un’efficienza di rivelazione superiore a una soglia critica. Per il test CHSH, questa soglia è circa 82.8% (più precisamente, $\\eta \u003e 2/3 \\approx 66.7%$ per configurazioni ottimali, ma in pratica serve un’efficienza più alta per tenere conto di altri fattori).\nQuesto obiettivo è stato molto difficile da raggiungere e ha richiesto decenni di progressi tecnologici:\nPrima soluzione - Ioni intrappolati (anni 2000):\nGli ioni (atomi carichi intrappolati in campi elettromagnetici) sono molto più controllabili dei fotoni Possono essere mantenuti in posizioni precise e misurati con efficienza molto alta (\u003e90%) Esperimenti pioneristici di Rowe et al. (2001) e Matsukevich et al. (2008) raggiunsero efficienze superiori alla soglia critica Svantaggio: gli ioni sono difficili da separare spazialmente, rendendo più complicato chiudere simultaneamente il locality loophole Seconda soluzione - Rivelatori superconduttori per fotoni (anni 2010):\nI rivelatori a nanofili superconduttori (SNSPDs - Superconducting Nanowire Single-Photon Detectors) hanno rivoluzionato la rivelazione di fotoni Operano a temperature criogeniche (vicine allo zero assoluto) Raggiungono efficienze del 75-98% nella banda infrarossa Permettono di usare fotoni (facilmente separabili su grandi distanze) mantenendo alta efficienza di rivelazione Terza soluzione - Atomi neutri e centri di colore:\nCentri di colore in diamante: tecnica che sfrutta alcuni difetti nella struttura cristallina del diamante Atomi neutri intrappolati: atomi raffreddati con laser e intrappolati in pinze ottiche ℹ️ Note Perché questa soglia dell'82.8%?: Questa percentuale deriva dall’analisi matematica del test CHSH. Con efficienza inferiore, è possibile costruire un modello a variabili nascoste locali che riproduce le statistiche osservate sfruttando proprio il campionamento non equo. Sopra questa soglia, invece, diventa matematicamente impossibile spiegare i risultati con il realismo locale, anche assumendo il peggior caso possibile di bias nel campionamento. 4.3.1.3. Freedom-of-Choice Loophole Il problema: Come vengono scelti gli angoli di misura per Alice e Bob? Se la scelta non è veramente casuale, ma è in qualche modo correlata con le “istruzioni nascoste” delle particelle, allora i risultati potrebbero essere spiegati con il realismo locale.\nQuesta obiezione può sembrare strana, ma dal punto di vista logico è valida: se l’universo è deterministico, allora anche la scelta “casuale” dell’angolo potrebbe essere predeterminata dalle stesse variabili nascoste che determinano il risultato della misura!\nLa soluzione: Usare sorgenti di casualità il più “libere” possibile:\nGeneratori quantistici di numeri casuali (QRNG): sfruttano processi quantistici intrinsecamente casuali\nLuce da stelle distanti (esperimenti di Zeilinger, 2017): usarono la luce proveniente da stelle lontane migliaia di anni luce per decidere gli angoli di misura. In questo modo, le “istruzioni nascoste” avrebbero dovuto essere correlate con eventi che, almeno in prima approssimazione, possiamo assumere essere causalmente disconnessi dalle particelle entangled.\nPartecipazione umana: in un esperimento chiamato “The BIG Bell Test” (2016), migliaia di persone in tutto il mondo hanno scelto gli angoli di misura tramite un videogioco online\n4.3.1.4. Memory Loophole Il problema: Se le coppie di particelle vengono misurate in sequenza e i risultati vengono accumulati nel tempo, potrebbero esserci correlazioni spurie dovute a variazioni nell’apparato sperimentale.\nLa soluzione: Garantire che l’apparato sia stabile nel tempo o, meglio ancora, completare l’esperimento in un tempo così breve da escludere drift strumentali.\n4.3.1.5. Gli esperimenti “loophole-free” Il vero traguardo è stato raggiunto nel 2015, quando tre gruppi indipendenti riuscirono a realizzare esperimenti che chiudevano simultaneamente tutti i principali loopholes:\nDelft (Olanda) - Hensen et al.: usarono due centri di colore in diamante (difetti nella struttura cristallina) separati da 1.3 km, connessi tramite entanglement\n✓ Locality loophole chiuso (distanza 1.3 km) ✓ Detection loophole chiuso (efficienza \u003e 90%) Vienna (Austria) - Giustina et al.: usarono fotoni entangled con rivelatori superconduttori\n✓ Locality loophole chiuso ✓ Detection loophole chiuso (efficienza 75%) Boulder, Colorado (USA) - Shalm et al.: usarono fotoni entangled separati da 185 metri\n✓ Locality loophole chiuso ✓ Detection loophole chiuso (efficienza 75%) Questi esperimenti hanno definitivamente dimostrato che non è possibile salvare il realismo locale: la natura viola veramente le disuguaglianze di Bell, e non si tratta di un artefatto sperimentale.\n4.3.1.6. Rimangono ancora loopholes aperti? Dal punto di vista pratico, no: gli esperimenti moderni sono convincenti oltre ogni ragionevole dubbio. Tuttavia, dal punto di vista filosofico, esiste ancora una “scappatoia” teorica estremamente speculativa:\nSi tratta del cosiddetto Superdeterminismo: l’ipotesi che tutto nell’universo sia predeterminato dal Big Bang, incluse le scelte degli sperimentatori e i risultati delle misure. In questo scenario estremo, non esisterebbe il libero arbitrio nemmeno in senso operativo. Questa posizione è considerata dalla maggior parte dei fisici come un’ipotesi non falsificabile e quindi non scientifica.\nIn conclusione, il consenso scientifico è unanime: le disuguaglianze di Bell sono violate, il realismo locale è incompatibile con la natura, e gli esperimenti che lo hanno dimostrato meritavano pienamente il Premio Nobel 2022.\n5. Le basi del Quantum Computing 5.1. Qubit e porte quantistiche Nel quantum computing, l’informazione è codificata in qubit invece che in bit classici. I qubit possono essere implementati fisicamente in vari modi: spin di elettroni, fotoni polarizzati, stati energetici di atomi intrappolati, ecc.\nLe operazioni sui qubit vengono eseguite attraverso porte quantistiche, che sono l’analogo delle porte logiche classiche (AND, OR, NOT, ecc.). Le porte quantistiche più comuni sono:\nPorta X: simile al NOT classico, scambia gli stati |0⟩ e |1⟩ Porta H (Hadamard): crea una sovrapposizione equiprobabile tra |0⟩ e |1⟩ Porta CNOT: porta a due qubit che inverte il secondo qubit se il primo è |1⟩ Porte di rotazione: permettono di manipolare lo stato del qubit con precisione 5.2. Circuiti quantistici Un programma quantistico è rappresentato come un circuito quantistico, una sequenza di porte quantistiche applicate a uno o più qubit. A differenza dei circuiti classici, i circuiti quantistici sono reversibili (tranne la misura, che è irreversibile).\nPer creare entanglement tra due qubit, tipicamente si usa una combinazione di porta Hadamard e CNOT:\nSi applica una porta H al primo qubit per creare una sovrapposizione Si applica una porta CNOT usando il primo qubit come controllo e il secondo come target Questo crea uno stato di Bell, completamente entangled.\nq0: ──H──■── │ q1: ─────X── 5.3. Piattaforme di Quantum Computing Oggi esistono diverse piattaforme che permettono di eseguire veri e propri programmi su computer quantistici reali, tra cui ad esempio:\nIBM Quantum Experience: permette di accedere gratuitamente a computer quantistici reali di IBM Amazon Braket: il servizio di quantum computing di AWS Google Quantum AI: la piattaforma di Google per il quantum computing Simulatori locali: librerie come Qiskit, Cirq, Q# permettono di simulare circuiti quantistici sul proprio computer 6. Facciamo l’esperimento 6.1. Setup dell’esperimento Possiamo riprodurre il test CHSH usando un computer quantistico reale o un simulatore. Useremo due qubit in stato entangled e misureremo le correlazioni secondo diverse configurazioni.\nIngredienti necessari: Una piattaforma di quantum computing (Qiskit, IBM Quantum, ecc.) Due qubit Circuiti quantistici per creare entanglement e eseguire rotazioni 6.2. Il circuito quantistico Il circuito base per il test CHSH è il seguente:\nfrom qiskit import QuantumCircuit, QuantumRegister, ClassicalRegister # Creiamo 2 qubit e 2 bit classici per le misure qr = QuantumRegister(2, 'q') cr = ClassicalRegister(2, 'c') qc = QuantumCircuit(qr, cr) # Step 1: Creiamo uno stato di Bell entangled qc.h(qr[0]) # Hadamard sul primo qubit qc.cx(qr[0], qr[1]) # CNOT per creare entanglement # Step 2: Applichiamo le rotazioni per Alice e Bob # (gli angoli dipendono dalla configurazione che vogliamo testare) qc.ry(theta_a, qr[0]) # Rotazione per Alice qc.ry(theta_b, qr[1]) # Rotazione per Bob # Step 3: Misuriamo qc.measure(qr, cr) Per il test CHSH ottimale, gli angoli devono essere:\n$a_0 = 0°$, $a_1 = 45°$ (per Alice) $b_0 = 22.5°$, $b_1 = -22.5°$ (per Bob) ℹ️ Note ovviamente, la misurazione deve essere ripetuta per un certo numero di volte (shots) per ottenere campioni statistici significativi su cui applicare la formula di CHSH. 6.3. Codice completo from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator import numpy as np def create_chsh_circuit(theta_a, theta_b): \"\"\"Crea un circuito per il test CHSH con angoli specifici\"\"\" qc = QuantumCircuit(2, 2) # Crea stato entangled qc.h(0) qc.cx(0, 1) # Rotazioni per Alice e Bob qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) # Misura qc.measure([0, 1], [0, 1]) return qc def compute_correlation(theta_a, theta_b, shots=8192): \"\"\"Calcola la correlazione E(a,b) per dati angoli\"\"\" qc = create_chsh_circuit(theta_a, theta_b) # Esegui il circuito simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() # Calcola la correlazione correlation = 0 for outcome, count in counts.items(): # +1 se i bit sono uguali, -1 se diversi parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation # Angoli ottimali per il test CHSH (in radianti) a0, a1 = 0, np.pi/4 b0, b1 = np.pi/8, -np.pi/8 # Calcola le 4 correlazioni E_a0_b0 = compute_correlation(a0, b0) E_a0_b1 = compute_correlation(a0, b1) E_a1_b0 = compute_correlation(a1, b0) E_a1_b1 = compute_correlation(a1, b1) # Calcola il valore CHSH S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 print(f\"E(a0, b0) = {E_a0_b0:.3f}\") print(f\"E(a0, b1) = {E_a0_b1:.3f}\") print(f\"E(a1, b0) = {E_a1_b0:.3f}\") print(f\"E(a1, b1) = {E_a1_b1:.3f}\") print(f\"\\nValore CHSH S = {S:.3f}\") print(f\"Limite classico: |S| ≤ 2\") print(f\"Limite quantistico: |S| ≤ 2√2 ≈ 2.828\") if abs(S) \u003e 2: print(f\"\\n✓ Le disuguaglianze di Bell sono VIOLATE!\") print(f\" Einstein aveva torto: il realismo locale è incompatibile con i risultati.\") else: print(f\"\\n✗ Le disuguaglianze di Bell sono rispettate.\") 6.4. Risultati attesi Eseguendo il codice sopra, dovremmo ottenere un valore di $S$ vicino a $2\\sqrt{2} \\approx 2.828$, violando quindi le disuguaglianze di Bell.\nIn pratica, a causa del rumore e delle imperfezioni dei computer quantistici reali, potremmo ottenere valori leggermente inferiori, ma comunque superiori a 2, dimostrando la violazione del realismo locale.\n6.5. Significato degli angoli e sfera di Bloch Per capire veramente cosa stiamo facendo quando scegliamo questi angoli specifici nel test CHSH, possiamo introdurre uno strumento abbastanza intuitivo spesso utilizzato in meccanica quantistica: la sfera di Bloch.\n6.5.1. La sfera di Bloch La sfera di Bloch è una rappresentazione geometrica dello stato di un singolo qubit. Ogni punto sulla superficie della sfera rappresenta uno stato quantistico puro. I due poli della sfera rappresentano gli stati base:\nPolo nord: stato $|0\\rangle$ Polo sud: stato $|1\\rangle$ Lo stato generale di un qubit può essere scritto come: $$|\\psi\\rangle = \\cos(\\theta/2)|0\\rangle + e^{i\\phi}\\sin(\\theta/2)|1\\rangle$$\ndove:\n$\\theta$ è l’angolo polare (da 0° al polo nord a 180° al polo sud) $\\phi$ è l’angolo azimutale (rotazione attorno all’asse z) Cosa significa “misurare secondo un angolo”? Immaginiamo il polarizzatore come un filtro orientabile: possiamo decidere in quale direzione orientarlo per misurare la polarizzazione del fotone.\nEsempio fisico con polarizzatori:\nAlice orienta il suo polarizzatore a $a_0 = 0°$ (verticale): sta chiedendo “il fotone è polarizzato verticalmente o orizzontalmente?” Alice orienta il suo polarizzatore a $a_1 = 45°$ (diagonale): sta chiedendo “il fotone è polarizzato a 45° o a 135°?” Ogni angolo di orientamento del polarizzatore corrisponde a una domanda diversa che facciamo al fotone.\nNel quantum computing: Siccome i computer quantistici possono misurare solo nella base standard (chiamata base Z: $|0\\rangle$ e $|1\\rangle$), per misurare secondo un angolo diverso dobbiamo:\nRuotare lo stato del qubit con l’angolo desiderato Misurare nella base standard Il risultato è equivalente ad aver misurato nella base ruotata In pratica, nel codice usiamo la gate ry(2*θ) prima della misura. Il fattore 2 è una convenzione matematica della sfera di Bloch (gli angoli fisici vengono raddoppiati nella rappresentazione matematica).\n6.5.2. Gli angoli ottimali del test CHSH Gli angoli ottimali per massimizzare la violazione delle disuguaglianze di Bell sono:\nAlice: $a_0 = 0°$ e $a_1 = 45°$ Bob: $b_0 = 22.5°$ e $b_1 = -22.5°$ Questi angoli sono disposti simmetricamente e formano un pattern specifico sulla sfera di Bloch. La chiave è che:\nLe direzioni di misura di Alice ($a_0$ e $a_1$) sono separate da 45° Le direzioni di Bob ($b_0$ e $b_1$) sono separate da 45° (da -22.5° a +22.5°) $b_0 = 22.5°$ è esattamente a metà strada tra $a_0$ e $a_1$ $b_1 = -22.5°$ è simmetrico a $b_0$ rispetto all’asse a₀ La configurazione crea una disposizione simmetrica dove:\nLa differenza angolare tra $a_0$ e $b_0$ è 22.5° La differenza angolare tra $a_0$ e $b_1$ è 22.5° (in valore assoluto) La differenza angolare tra $a_1$ e $b_0$ è 22.5° La differenza angolare tra $a_1$ e $b_1$ è 67.5° Questa simmetria, con tre differenze di 22.5° e una di 67.5°, massimizza le correlazioni quantistiche che violano le disuguaglianze di Bell.\n6.5.3. Visualizzazione degli angoli ottimali 6.5.3.1. Versione interattiva (Plotly - per Jupyter Notebook) Per una visualizzazione interattiva degli angoli ottimali all’interno della sfera di Bloch possiamo usare questo codice basato Plotly (ideale per Jupyter Notebook):\nimport numpy as np import plotly.graph_objects as go def angle_to_bloch_vector(theta, phi=0): \"\"\"Converte angoli (theta, phi) in un vettore sulla sfera di Bloch\"\"\" theta_rad = np.radians(theta) phi_rad = np.radians(phi) x = np.sin(theta_rad) * np.cos(phi_rad) y = np.sin(theta_rad) * np.sin(phi_rad) z = np.cos(theta_rad) return x, y, z def create_sphere_mesh(): \"\"\"Crea la mesh per la sfera di Bloch\"\"\" u = np.linspace(0, 2 * np.pi, 50) v = np.linspace(0, np.pi, 50) x = np.outer(np.cos(u), np.sin(v)) y = np.outer(np.sin(u), np.sin(v)) z = np.outer(np.ones(np.size(u)), np.cos(v)) return x, y, z def plot_interactive_bloch_sphere(): \"\"\"Crea una visualizzazione interattiva della sfera di Bloch con angoli CHSH\"\"\" fig = go.Figure() # Aggiungiamo la sfera di Bloch x_sphere, y_sphere, z_sphere = create_sphere_mesh() fig.add_trace(go.Surface( x=x_sphere, y=y_sphere, z=z_sphere, opacity=0.15, colorscale=[[0, 'lightgray'], [1, 'lightgray']], showscale=False, hoverinfo='skip' )) # Aggiungiamo gli assi coordinati axis_length = 1.3 # Asse X fig.add_trace(go.Scatter3d( x=[-axis_length, axis_length], y=[0, 0], z=[0, 0], mode='lines', line=dict(color='darkgray', width=3, dash='dash'), showlegend=False, hoverinfo='skip' )) fig.add_trace(go.Scatter3d( x=[axis_length*1.05], y=[0], z=[0], mode='text', text=['X'], textfont=dict(size=18, color='darkgray'), showlegend=False, hoverinfo='skip' )) # Asse Y fig.add_trace(go.Scatter3d( x=[0, 0], y=[-axis_length, axis_length], z=[0, 0], mode='lines', line=dict(color='darkgray', width=3, dash='dash'), showlegend=False, hoverinfo='skip' )) fig.add_trace(go.Scatter3d( x=[0], y=[axis_length*1.05], z=[0], mode='text', text=['Y'], textfont=dict(size=18, color='darkgray'), showlegend=False, hoverinfo='skip' )) # Asse Z fig.add_trace(go.Scatter3d( x=[0, 0], y=[0, 0], z=[-axis_length, axis_length], mode='lines', line=dict(color='black', width=3, dash='dash'), showlegend=False, hoverinfo='skip' )) # Etichette |0⟩ e |1⟩ for z_pos, label in [(axis_length*1.05, '|0⟩'), (-axis_length*1.05, '|1⟩')]: fig.add_trace(go.Scatter3d( x=[0], y=[0], z=[z_pos], mode='text', text=[label], textfont=dict(size=20, color='black'), showlegend=False )) # Angoli ottimali CHSH alice_angles = [0, 45] bob_angles = [22.5, -22.5] colors_alice = ['red', 'darkred'] colors_bob = ['blue', 'darkblue'] labels_alice = ['a₀ (0°)', 'a₁ (45°)'] labels_bob = ['b₀ (22.5°)', 'b₁ (-22.5°)'] # Aggiungiamo i vettori di Alice for i, angle in enumerate(alice_angles): x, y, z = angle_to_bloch_vector(angle, phi=0) fig.add_trace(go.Scatter3d( x=[0, x], y=[0, y], z=[0, z], mode='lines+markers', line=dict(color=colors_alice[i], width=8), marker=dict(size=[0, 10]), name=labels_alice[i], hovertemplate=f'{labels_alice[i]}' )) fig.add_trace(go.Scatter3d( x=[x*1.25], y=[y*1.25], z=[z*1.25], mode='text', text=[labels_alice[i]], textfont=dict(size=14, color=colors_alice[i]), showlegend=False )) # Aggiungiamo i vettori di Bob for i, angle in enumerate(bob_angles): x, y, z = angle_to_bloch_vector(angle, phi=0) fig.add_trace(go.Scatter3d( x=[0, x], y=[0, y], z=[0, z], mode='lines+markers', line=dict(color=colors_bob[i], width=8), marker=dict(size=[0, 10]), name=labels_bob[i], hovertemplate=f'{labels_bob[i]}' )) fig.add_trace(go.Scatter3d( x=[x*1.25], y=[y*1.25], z=[z*1.25], mode='text', text=[labels_bob[i]], textfont=dict(size=14, color=colors_bob[i]), showlegend=False )) # Layout fig.update_layout( title='Sfera di Bloch Interattiva: Angoli Ottimali CHSH\n' + 'Ruota con il mouse • Zoom con la rotellina • Pan con Shift+drag', scene=dict( xaxis=dict(showbackground=False, showticklabels=False, title=''), yaxis=dict(showbackground=False, showticklabels=False, title=''), zaxis=dict(showbackground=False, showticklabels=False, title=''), aspectmode='cube', camera=dict(eye=dict(x=1.5, y=1.5, z=1.2)) ), height=700, showlegend=True ) return fig # Creiamo e mostra il grafico interattivo fig = plot_interactive_bloch_sphere() fig.show() # fig.write_html(\"bloch_sphere_interactive.html\") 6.5.4. Interpretazione dei grafici Sfera di Bloch (3D e 2D): Disposizione geometrica degli angoli di misura. Si nota la simmetria della configurazione: $b_0$ (22.5°) è posizionato esattamente a metà strada tra $a_0$ (0°) e $a_1$ (45°), mentre $b_1$ (-22.5°) è simmetrico rispetto all’origine.\nCorrelazione vs Differenza Angolare: Mostra come la correlazione quantistica $E(\\theta) = \\cos(2\\theta)$ dipenda dalla differenza angolare. Gli angoli CHSH sono scelti per ottenere valori specifici di correlazione che massimizzano S. Ottimizzazione del valore CHSH: Dimostra visivamente che la configurazione con $a_1 = 45°$ (e conseguentemente $b_0 = 22.5°$, $b_1 = -22.5°$) massimizza effettivamente la violazione delle disuguaglianze di Bell. Nell’esperimento CHSH le direzioni di misura sono disposte simmetricamente in modo da sfruttare al massimo le correlazioni quantistiche permesse dall’entanglement, superando il limite classico di 2 e raggiungendo il limite di Tsirelson di $2\\sqrt{2}$.\n6.6. Cosa significa questo risultato? La violazione delle disuguaglianze di Bell ci dice che:\nNon può esistere una descrizione del mondo fisico che soddisfi i principi di località e realismo.\nIn altre parole:\nO esistono “azioni a distanza” che permettono alle particelle entangled di “comunicare” istantaneamente (violazione della località) O le proprietà fisiche non esistono prima della misura, ma vengono create dall’atto stesso dell’osservazione (violazione del realismo) La maggior parte dei fisici oggi accetta l’interpretazione secondo cui è il realismo ad essere violato, mentre la località è preservata (anche se in modo sottile).\n6.7. Altri esperimenti interattivi Ora che abbiamo visto il test CHSH di base, esploriamo alcuni esperimenti aggiuntivi che ci aiutano a comprendere meglio la violazione delle disuguaglianze di Bell e le differenze tra meccanica quantistica e realismo locale.\n6.7.1. Variazione del valore CHSH con gli angoli Questo esperimento mostra come il valore CHSH varia al variare dell’angolo $a_1$ di Alice, mantenendo fissi gli altri angoli. Ci permette di vedere graficamente perché 45° è l’angolo ottimale.\nimport numpy as np import matplotlib.pyplot as plt from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator def compute_chsh_value(a0, a1, b0, b1, shots=8192): \"\"\"Calcola il valore CHSH per una data configurazione di angoli\"\"\" def compute_correlation(theta_a, theta_b): qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation E_a0_b0 = compute_correlation(a0, b0) E_a0_b1 = compute_correlation(a0, b1) E_a1_b0 = compute_correlation(a1, b0) E_a1_b1 = compute_correlation(a1, b1) S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 return S, (E_a0_b0, E_a0_b1, E_a1_b0, E_a1_b1) # Varia l'angolo a1 da 0 a 90 gradi a1_values = np.linspace(0, np.pi/2, 20) s_values_quantum = [] s_values_classical = 2 * np.ones_like(a1_values) # Limite classico print(\"Calcolando valori CHSH per diversi angoli...\") for a1 in a1_values: # Angoli fissi a0 = 0 b0 = a1 / 2 # Ottimale: a metà strada tra a0 e a1 b1 = -a1 / 2 # Simmetrico rispetto a a0 S, _ = compute_chsh_value(a0, a1, b0, b1, shots=4096) s_values_quantum.append(S) print(f\"a1 = {np.degrees(a1):.1f}°, S = {S:.3f}\") # Grafico plt.figure(figsize=(12, 6)) plt.plot(np.degrees(a1_values), s_values_quantum, 'b-o', linewidth=2, markersize=6, label='Simulazione Quantistica') plt.axhline(y=2, color='r', linestyle='--', linewidth=2, label='Limite Classico (|S| ≤ 2)') plt.axhline(y=2*np.sqrt(2), color='g', linestyle='--', linewidth=2, label=f'Limite di Tsirelson (2√2 ≈ {2*np.sqrt(2):.3f})') plt.axvline(x=45, color='orange', linestyle=':', linewidth=2, label='Angolo ottimale (45°)') plt.xlabel('Angolo a₁ (gradi)', fontsize=12) plt.ylabel('Valore CHSH (S)', fontsize=12) plt.title('Violazione delle Disuguaglianze di Bell al Variare dell\\'Angolo', fontsize=14, fontweight='bold') plt.legend(fontsize=10) plt.grid(True, alpha=0.3) plt.ylim([0, 3]) plt.tight_layout() plt.savefig('chsh_angle_variation.png', dpi=300, bbox_inches='tight') plt.show() print(f\"\\nMassima violazione a 45°: S ≈ {max(s_values_quantum):.3f}\") print(f\"Limite teorico: 2√2 ≈ {2*np.sqrt(2):.3f}\") Risultato atteso: Il grafico mostra che la massima violazione si ottiene proprio a 45°, dove S raggiunge circa 2.828.\n6.7.2. Confronto quantistico vs classico: heatmap delle correlazioni Questo esperimento visualizza le correlazioni quantistiche e classiche come heatmap, permettendo di vedere chiaramente la differenza.\nimport numpy as np import matplotlib.pyplot as plt from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator def compute_quantum_correlation(theta_a, theta_b, shots=8192): \"\"\"Calcola la correlazione quantistica per due angoli\"\"\" qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation def compute_classical_correlation(theta_diff): \"\"\" Correlazione classica massima possibile per una differenza angolare. Con variabili nascoste locali, la correlazione massima è limitata. \"\"\" # Modello classico: correlazione lineare decrescente return 1 - 2 * abs(theta_diff) / (np.pi/2) # Griglia di angoli angles = np.linspace(0, np.pi/2, 12) angles_deg = np.degrees(angles) # Matrici per le correlazioni quantum_corr = np.zeros((len(angles), len(angles))) classical_corr = np.zeros((len(angles), len(angles))) print(\"Calcolando correlazioni quantistiche e classiche...\") for i, theta_a in enumerate(angles): for j, theta_b in enumerate(angles): # Correlazione quantistica quantum_corr[i, j] = compute_quantum_correlation(theta_a, theta_b, shots=2048) # Correlazione classica teorica theta_diff = abs(theta_a - theta_b) classical_corr[i, j] = compute_classical_correlation(theta_diff) print(f\"Progresso: {i+1}/{len(angles)}\") # Visualizzazione fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(18, 5)) # Heatmap quantistica im1 = ax1.imshow(quantum_corr, cmap='RdBu_r', aspect='auto', vmin=-1, vmax=1, origin='lower') ax1.set_xlabel('Angolo Bob (gradi)', fontsize=11) ax1.set_ylabel('Angolo Alice (gradi)', fontsize=11) ax1.set_title('Correlazioni Quantistiche\\n(Simulazione)', fontsize=12, fontweight='bold') ax1.set_xticks(range(len(angles_deg))) ax1.set_yticks(range(len(angles_deg))) ax1.set_xticklabels([f'{a:.0f}' for a in angles_deg], rotation=45) ax1.set_yticklabels([f'{a:.0f}' for a in angles_deg]) plt.colorbar(im1, ax=ax1, label='Correlazione E(a,b)') # Heatmap classica im2 = ax2.imshow(classical_corr, cmap='RdBu_r', aspect='auto', vmin=-1, vmax=1, origin='lower') ax2.set_xlabel('Angolo Bob (gradi)', fontsize=11) ax2.set_ylabel('Angolo Alice (gradi)', fontsize=11) ax2.set_title('Correlazioni Classiche\\n(Variabili Nascoste Locali)', fontsize=12, fontweight='bold') ax2.set_xticks(range(len(angles_deg))) ax2.set_yticks(range(len(angles_deg))) ax2.set_xticklabels([f'{a:.0f}' for a in angles_deg], rotation=45) ax2.set_yticklabels([f'{a:.0f}' for a in angles_deg]) plt.colorbar(im2, ax=ax2, label='Correlazione E(a,b)') # Differenza difference = quantum_corr - classical_corr im3 = ax3.imshow(difference, cmap='seismic', aspect='auto', vmin=-0.5, vmax=0.5, origin='lower') ax3.set_xlabel('Angolo Bob (gradi)', fontsize=11) ax3.set_ylabel('Angolo Alice (gradi)', fontsize=11) ax3.set_title('Differenza\\n(Quantistica - Classica)', fontsize=12, fontweight='bold') ax3.set_xticks(range(len(angles_deg))) ax3.set_yticks(range(len(angles_deg))) ax3.set_xticklabels([f'{a:.0f}' for a in angles_deg], rotation=45) ax3.set_yticklabels([f'{a:.0f}' for a in angles_deg]) plt.colorbar(im3, ax=ax3, label='Differenza') plt.tight_layout() plt.savefig('correlation_heatmaps.png', dpi=300, bbox_inches='tight') plt.show() print(\"\\nLe zone rosse nella mappa delle differenze mostrano dove\") print(\"le correlazioni quantistiche superano quelle classiche!\") Interpretazione: Le heatmap mostrano come le correlazioni quantistiche (che seguono $\\cos(2\\theta)$) differiscano significativamente da quelle classiche, soprattutto per angoli intermedi.\n6.7.3. Esplorazione interattiva dei parametri CHSH Questo esperimento crea un’analisi parametrica completa dello spazio degli angoli CHSH.\nimport numpy as np import matplotlib.pyplot as plt from matplotlib.widgets import Slider from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator def compute_single_correlation(theta_a, theta_b, shots=4096): \"\"\"Calcola una singola correlazione\"\"\" qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) simulator = AerSimulator() compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation # Analisi 2D: variazione simultanea di a1 e b0 a1_range = np.linspace(0, np.pi/2, 25) b0_range = np.linspace(0, np.pi/2, 25) S_matrix = np.zeros((len(a1_range), len(b0_range))) print(\"Esplorazione dello spazio dei parametri CHSH...\") print(\"Questo può richiedere qualche minuto...\\n\") for i, a1 in enumerate(a1_range): for j, b0 in enumerate(b0_range): a0 = 0 b1 = -b0 E_a0_b0 = compute_single_correlation(a0, b0, shots=2048) E_a0_b1 = compute_single_correlation(a0, b1, shots=2048) E_a1_b0 = compute_single_correlation(a1, b0, shots=2048) E_a1_b1 = compute_single_correlation(a1, b1, shots=2048) S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 S_matrix[i, j] = S if (i + 1) % 5 == 0: print(f\"Progresso: {i+1}/{len(a1_range)}\") # Visualizzazione 3D fig = plt.figure(figsize=(16, 6)) # Subplot 1: Heatmap 2D ax1 = fig.add_subplot(121) im = ax1.contourf(np.degrees(b0_range), np.degrees(a1_range), S_matrix, levels=20, cmap='RdYlGn') ax1.contour(np.degrees(b0_range), np.degrees(a1_range), S_matrix, levels=[2.0], colors='red', linewidths=3, linestyles='--') ax1.plot(22.5, 45, 'b*', markersize=20, label='Configurazione ottimale') ax1.set_xlabel('Angolo b₀ (gradi)', fontsize=12) ax1.set_ylabel('Angolo a₁ (gradi)', fontsize=12) ax1.set_title('Valore CHSH nello Spazio dei Parametri', fontsize=13, fontweight='bold') ax1.legend(fontsize=10) ax1.grid(True, alpha=0.3) cbar = plt.colorbar(im, ax=ax1, label='S') cbar.ax.axhline(y=2, color='red', linewidth=2, linestyle='--') cbar.ax.text(1.5, 2, 'Limite classico', rotation=0, va='center', fontsize=9) # Subplot 2: Superficie 3D ax2 = fig.add_subplot(122, projection='3d') B0, A1 = np.meshgrid(np.degrees(b0_range), np.degrees(a1_range)) surf = ax2.plot_surface(B0, A1, S_matrix, cmap='RdYlGn', alpha=0.9, edgecolor='none') # Piano del limite classico xx, yy = np.meshgrid(np.degrees(b0_range), np.degrees(a1_range)) zz = 2 * np.ones_like(xx) ax2.plot_surface(xx, yy, zz, alpha=0.3, color='red') ax2.set_xlabel('Angolo b₀ (gradi)', fontsize=10) ax2.set_ylabel('Angolo a₁ (gradi)', fontsize=10) ax2.set_zlabel('Valore CHSH (S)', fontsize=10) ax2.set_title('Superficie CHSH 3D', fontsize=13, fontweight='bold') ax2.view_init(elev=25, azim=45) fig.colorbar(surf, ax=ax2, shrink=0.5, aspect=5, label='S') plt.tight_layout() plt.savefig('chsh_parameter_space.png', dpi=300, bbox_inches='tight') plt.show() # Trova il massimo max_idx = np.unravel_index(np.argmax(S_matrix), S_matrix.shape) max_a1 = np.degrees(a1_range[max_idx[0]]) max_b0 = np.degrees(b0_range[max_idx[1]]) max_S = S_matrix[max_idx] print(f\"\\n{'='*50}\") print(f\"Configurazione ottimale trovata:\") print(f\" a₁ = {max_a1:.1f}°\") print(f\" b₀ = {max_b0:.1f}°\") print(f\" S = {max_S:.3f}\") print(f\"\\nValore teorico ottimale: a₁=45°, b₀=22.5°, S=2√2≈2.828\") print(f\"{'='*50}\") Risultato: Questo grafico mostra la “montagna” del valore CHSH nello spazio dei parametri, con il picco proprio alla configurazione ottimale (45°, 22.5°).\n6.7.4. Simulazione con rumore realistico Nell’ultimo esperimento, aggiungiamo rumore per simulare le imperfezioni dei computer quantistici reali.\nimport numpy as np import matplotlib.pyplot as plt from qiskit import QuantumCircuit, transpile from qiskit_aer import AerSimulator from qiskit_aer.noise import NoiseModel, depolarizing_error, thermal_relaxation_error def create_noisy_simulator(error_rate=0.01, t1=50, t2=70): \"\"\" Crea un simulatore con rumore realistico. Args: error_rate: probabilità di errore per gate (depolarizing) t1: tempo di rilassamento T1 (microseconds) t2: tempo di decoerenza T2 (microseconds) \"\"\" noise_model = NoiseModel() # Errore di depolarizzazione sui gate error_gate1 = depolarizing_error(error_rate, 1) error_gate2 = depolarizing_error(error_rate * 2, 2) # Aggiungi errori ai gate noise_model.add_all_qubit_quantum_error(error_gate1, ['h', 'ry']) noise_model.add_all_qubit_quantum_error(error_gate2, ['cx']) # Errore di rilassamento termico # gate_times = {'h': 50, 'ry': 50, 'cx': 200, 'measure': 1000} # in nanoseconds # thermal_error = thermal_relaxation_error(t1*1000, t2*1000, gate_times['cx']) # noise_model.add_all_qubit_quantum_error(thermal_error, ['cx']) return noise_model def run_chsh_with_noise(error_rate, shots=8192): \"\"\"Esegue il test CHSH con un dato livello di rumore\"\"\" noise_model = create_noisy_simulator(error_rate=error_rate) simulator = AerSimulator(noise_model=noise_model) # Angoli ottimali a0, a1 = 0, np.pi/4 b0, b1 = np.pi/8, -np.pi/8 def compute_correlation(theta_a, theta_b): qc = QuantumCircuit(2, 2) qc.h(0) qc.cx(0, 1) qc.ry(2 * theta_a, 0) qc.ry(2 * theta_b, 1) qc.measure([0, 1], [0, 1]) compiled_circuit = transpile(qc, simulator) result = simulator.run(compiled_circuit, shots=shots).result() counts = result.get_counts() correlation = 0 for outcome, count in counts.items(): parity = 1 if outcome[0] == outcome[1] else -1 correlation += parity * count / shots return correlation E_a0_b0 = compute_correlation(a0, b0) E_a0_b1 = compute_correlation(a0, b1) E_a1_b0 = compute_correlation(a1, b0) E_a1_b1 = compute_correlation(a1, b1) S = E_a0_b0 + E_a0_b1 + E_a1_b0 - E_a1_b1 return S, (E_a0_b0, E_a0_b1, E_a1_b0, E_a1_b1) # Test con diversi livelli di rumore error_rates = np.linspace(0, 0.10, 20) s_values_noisy = [] s_std = [] print(\"Simulazione con rumore realistico...\") print(\"Questo simula le imperfezioni dei computer quantistici reali.\\n\") for error_rate in error_rates: # Esegui multiple volte per stimare la varianza s_trials = [] for _ in range(5): S, _ = run_chsh_with_noise(error_rate, shots=4096) s_trials.append(S) s_values_noisy.append(np.mean(s_trials)) s_std.append(np.std(s_trials)) print(f\"Error rate: {error_rate*100:.1f}% → S = {np.mean(s_trials):.3f} ± {np.std(s_trials):.3f}\") # Visualizzazione fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 6)) # Subplot 1: S vs Error Rate s_values_noisy = np.array(s_values_noisy) s_std = np.array(s_std) ax1.errorbar(error_rates * 100, s_values_noisy, yerr=s_std, fmt='o-', linewidth=2, markersize=8, capsize=5, color='blue', label='Simulazione con rumore') ax1.axhline(y=2, color='red', linestyle='--', linewidth=2, label='Limite classico (S=2)') ax1.axhline(y=2*np.sqrt(2), color='green', linestyle='--', linewidth=2, label=f'Limite ideale (S=2√2≈{2*np.sqrt(2):.3f})') ax1.fill_between(error_rates * 100, 2, s_values_noisy, where=(s_values_noisy \u003e 2), alpha=0.3, color='green', label='Zona di violazione') ax1.set_xlabel('Tasso di errore per gate (%)', fontsize=12) ax1.set_ylabel('Valore CHSH (S)', fontsize=12) ax1.set_title('Effetto del Rumore sulla Violazione di Bell', fontsize=13, fontweight='bold') ax1.legend(fontsize=10) ax1.grid(True, alpha=0.3) ax1.set_ylim([1.5, 3]) # Subplot 2: Violazione vs Error Rate violation = s_values_noisy - 2 ax2.bar(error_rates * 100, violation, width=0.25, color=['green' if v \u003e 0 else 'red' for v in violation], alpha=0.7, edgecolor='black') ax2.axhline(y=0, color='black', linestyle='-', linewidth=1) ax2.set_xlabel('Tasso di errore per gate (%)', fontsize=12) ax2.set_ylabel('Violazione (S - 2)', fontsize=12) ax2.set_title('Margine di Violazione delle Disuguaglianze di Bell', fontsize=13, fontweight='bold') ax2.grid(True, alpha=0.3, axis='y') # Trova il punto critico dove S scende sotto 2 critical_idx = np.where(s_values_noisy \u003c 2)[0] if len(critical_idx) \u003e 0: critical_error = error_rates[critical_idx[0]] * 100 ax2.axvline(x=critical_error, color='red', linestyle=':', linewidth=2) ax2.text(critical_error, ax2.get_ylim()[1] * 0.8, f'Punto critico\\n~{critical_error:.1f}%', ha='center', fontsize=10, bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5)) plt.tight_layout() plt.savefig('chsh_with_noise.png', dpi=300, bbox_inches='tight') plt.show() print(f\"\\n{'='*60}\") print(\"RISULTATI:\") print(f\" - Con rumore 0%: S ≈ {s_values_noisy[0]:.3f} (ideale)\") print(f\" - Con rumore 1%: S ≈ {s_values_noisy[int(len(s_values_noisy)*0.2)]:.3f}\") print(f\" - Con rumore 3%: S ≈ {s_values_noisy[int(len(s_values_noisy)*0.6)]:.3f}\") if len(critical_idx) \u003e 0: print(f\" - Limite critico: ~{critical_error:.1f}% (S scende sotto 2)\") else: print(f\" - La violazione persiste fino a {error_rates[-1]*100:.1f}%\") print(f\"{'='*60}\") Interpretazione: Questo grafico mostra quanto siano delicati i computer quantistici. Anche piccoli errori riducono la violazione di Bell, ma fortunatamente serve un errore abbastanza alto (\u003e8%) prima che la violazione scompaia completamente.\n7. Conclusioni e riflessioni filosofiche 7.1. Chi aveva ragione? Il dibattito Einstein-Bohr è stato uno dei più affascinanti della storia della fisica. Da un punto di vista puramente scientifico, possiamo dire che Bohr aveva ragione: la meccanica quantistica è una teoria completa e corretta, e i fenomeni quantistici non possono essere spiegati con teorie a variabili nascoste locali.\nIl destino di Einstein è stato per certi versi paradossale: pur essendo riconosciuto come uno dei più grandi fisici di tutti i tempi, è stato spesso incompreso ed isolato della comunità scientifica “mainstream”, sia nelle fasi iniziali della sua carriera (con la relatività) sia in quelle finali (con la meccanica quantistica).\nIn ogni caso, credo che la formulazione stessa del problema EPR, che poi ha portato agli studi di Bell, gli esperimenti di Aspect e di molti altri, sia stato anche stavolta un contributo enorme alla fisica e al sapere umano.\n7.2. La natura della realtà Dal punto di vista filosofico, gli esperimenti di Bell ci insegnano qualcosa di profondo sulla natura della realtà:\nIl mondo non è fatto di “cose” con proprietà definite che esistono indipendentemente dall’osservazione La realtà emerge dall’interazione tra sistema osservato e apparato di misura Non possiamo separare completamente l’osservatore dall’osservato Questo non significa che la realtà “non esiste” o che sia puramente soggettiva, ma piuttosto che la nostra intuizione classica su cosa significhi “esistere” deve essere profondamente rivista alla luce dei fenomeni quantistici.\nIn un certo senso, quella che noi identifichiamo come “realtà” è un costrutto emergente e non prescinde dalle nostre interazioni con il mondo.\nRiferimenti Articolo originale di Bell (1964) “ON THE EINSTEIN PODOLSKY ROSEN PARADOX” Nobel Prize 2022 - Announcement Qiskit Documentation IBM Quantum Experience Closing the Door on Einstein and Bohr’s Quantum Debate Simulating Bell’s inequalities with Qibo ","wordCount":"9576","inLanguage":"it","datePublished":"2025-10-12T00:00:00+02:00","dateModified":"2025-10-12T00:00:00+02:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://c-daniele.github.io/it/posts/2025-10-11-bells-inequalities/"},"publisher":{"@type":"Organization","name":"Cdani's Blog","logo":{"@type":"ImageObject","url":"https://c-daniele.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://c-daniele.github.io/it/ accesskey=h title="Home (Alt + H)"><img src=https://c-daniele.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://c-daniele.github.io/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://c-daniele.github.io/it/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://c-daniele.github.io/it/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://c-daniele.github.io/it/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://c-daniele.github.io/it/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://c-daniele.github.io/it/>Home</a></div><h1 class=post-title>Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit</h1><div class=post-meta><span title='2025-10-12 00:00:00 +0200 +0200'>ottobre 12, 2025</span>&nbsp;·&nbsp;45 minuti&nbsp;·&nbsp;9576 parole&nbsp;·&nbsp;Me&nbsp;|&nbsp;Traduzioni:<ul class=i18n_list><li><a href=https://c-daniele.github.io/en/posts/2025-10-11-bells-inequalities/>En</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Indice contenuti</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#11-intro-dellintro>1.1. Intro dell&rsquo;intro</a></li><li><a href=#12-intro-vera>1.2. Intro vera</a></li></ul><ul><li><a href=#21-einstein-e-la-meccanica-quantistica>2.1. Einstein e la meccanica quantistica</a></li><li><a href=#22-che-cosè-la-realtà>2.2. Che cos&rsquo;è la realtà?</a></li><li><a href=#23-linteresse-del-mondo-scientifico-alla-questione>2.3 L&rsquo;interesse del mondo scientifico alla questione</a></li></ul><ul><li><a href=#31-sovrapposizione-quantistica>3.1. Sovrapposizione quantistica</a></li><li><a href=#32-misura-quantistica>3.2. Misura quantistica</a></li><li><a href=#33-entanglement>3.3. Entanglement</a><ul><li><a href=#331-entanglement-e-quantum-computing>3.3.1. Entanglement e Quantum Computing</a></li></ul></li><li><a href=#34-teorie-a-variabili-nascoste>3.4 Teorie a variabili nascoste</a></li></ul><ul><li><a href=#41-il-lavoro-di-john-bell>4.1. Il lavoro di John Bell</a></li><li><a href=#42-il-test-chsh>4.2. Il test CHSH</a><ul><li><a href=#421-grandezze-non-commutative>4.2.1. Grandezze non commutative</a></li></ul></li><li><a href=#43-gli-esperimenti-che-valsero-il-nobel-2022>4.3. Gli esperimenti che valsero il Nobel 2022</a><ul><li><a href=#431-le-scappatoie-loopholes-e-come-sono-state-eliminate>4.3.1. Le &ldquo;scappatoie&rdquo; (loopholes) e come sono state eliminate</a></li></ul></li></ul><ul><li><a href=#51-qubit-e-porte-quantistiche>5.1. Qubit e porte quantistiche</a></li><li><a href=#52-circuiti-quantistici>5.2. Circuiti quantistici</a></li><li><a href=#53-piattaforme-di-quantum-computing>5.3. Piattaforme di Quantum Computing</a></li></ul><ul><li><a href=#61-setup-dellesperimento>6.1. Setup dell&rsquo;esperimento</a><ul><li><a href=#ingredienti-necessari>Ingredienti necessari:</a></li></ul></li><li><a href=#62-il-circuito-quantistico>6.2. Il circuito quantistico</a></li><li><a href=#63-codice-completo>6.3. Codice completo</a></li><li><a href=#64-risultati-attesi>6.4. Risultati attesi</a></li><li><a href=#65-significato-degli-angoli-e-sfera-di-bloch>6.5. Significato degli angoli e sfera di Bloch</a><ul><li><a href=#651-la-sfera-di-bloch>6.5.1. La sfera di Bloch</a></li><li><a href=#cosa-significa-misurare-secondo-un-angolo>Cosa significa &ldquo;misurare secondo un angolo&rdquo;?</a></li><li><a href=#652-gli-angoli-ottimali-del-test-chsh>6.5.2. Gli angoli ottimali del test CHSH</a></li><li><a href=#653-visualizzazione-degli-angoli-ottimali>6.5.3. Visualizzazione degli angoli ottimali</a></li><li><a href=#654-interpretazione-dei-grafici>6.5.4. Interpretazione dei grafici</a></li></ul></li><li><a href=#66-cosa-significa-questo-risultato>6.6. Cosa significa questo risultato?</a></li><li><a href=#67-altri-esperimenti-interattivi>6.7. Altri esperimenti interattivi</a><ul><li><a href=#671-variazione-del-valore-chsh-con-gli-angoli>6.7.1. Variazione del valore CHSH con gli angoli</a></li><li><a href=#672-confronto-quantistico-vs-classico-heatmap-delle-correlazioni>6.7.2. Confronto quantistico vs classico: heatmap delle correlazioni</a></li><li><a href=#673-esplorazione-interattiva-dei-parametri-chsh>6.7.3. Esplorazione interattiva dei parametri CHSH</a></li><li><a href=#674-simulazione-con-rumore-realistico>6.7.4. Simulazione con rumore realistico</a></li></ul></li></ul><ul><li><a href=#71-chi-aveva-ragione>7.1. Chi aveva ragione?</a></li><li><a href=#72-la-natura-della-realtà>7.2. La natura della realtà</a></li><li><a href=#riferimenti>Riferimenti</a></li></ul></nav></div></details></div><div class=post-content><h1 id=1-introduzione>1. Introduzione<a hidden class=anchor aria-hidden=true href=#1-introduzione>#</a></h1><h2 id=11-intro-dellintro>1.1. Intro dell&rsquo;intro<a hidden class=anchor aria-hidden=true href=#11-intro-dellintro>#</a></h2><p>Non so bene cosa sia questo articolo, un misto tra esperimento di coding, divulgazione e forse uno svago di qualcuno che in un&rsquo;altra vita avrebbe voluto fare il fisico.</p><p>Ce l&rsquo;avevo nel cassetto da un po&rsquo; di tempo, da quando avevo letto <a href=https://arxiv.org/html/2501.01434v1#abstract>questo articolo</a> di alcuni ricercatori del CERN, che spiega come sia possibile simulare un esperimento sulle disuguaglianze di Bell usando il framework Qibo.</p><p>La lettura dell&rsquo;articolo mi ha portato ad una constatazione che, almeno per me è super-affascinante: oggi nel 2025 chiunque con un minimo di conoscenze di programmazione e un paio di concetti di base, può fare (o almeno <strong>simulare</strong>) un esperimento di meccanica quantistica che 20 o 30 anni fa sarebbe stato possibile solo in un laboratorio di fisica con attrezzature costosissime.</p><p>Tuttavia, l&rsquo;esercizio di fare COPIA/INCOLLA del codice e lanciarlo, non mi sembra di particolare interesse, per lo meno senza capire bene di cosa stiamo parlando. Per questo motivo, ho iniziato a studiare un po&rsquo; la storia e qualche principio di base.</p><p>Questo piccolo esercizio di approfondimento, che attraversa più di un secolo di storia, dalle origini (1905) fino al premio Nobel del 2022 (secondo me meriterebbe un film o un romanzo) e sfiora alcuni dei problemi epistemologici più profondi che il genere umano abbia mai affrontato, ha dunque dato un senso all&rsquo;esercizio finale, che rimane comunque poco più di un COPIA/INCOLLA dall&rsquo;articolo del CERN e da qualche suggerimento di Claude 😃</p><h2 id=12-intro-vera>1.2. Intro vera<a hidden class=anchor aria-hidden=true href=#12-intro-vera>#</a></h2><p>In molti si chiedono se/quando il quantum computing diventerà una realtà. A dire il vero, dopo una forte espansione del mercato nel periodo post-covid c&rsquo;è stato un trend crescita moderato tra il 2022 ed il 2024, probabilmente a causa della crisi economica globale e dell&rsquo;attenzione spostata sull&rsquo;intelligenza artificiale generativa.</p><table><thead><tr><th>Year</th><th>Global Market Revenues</th></tr></thead><tbody><tr><td>2020</td><td>████████ $412M</td></tr><tr><td>2021</td><td>████████ $391M</td></tr><tr><td>2022</td><td>██████████████ $713M</td></tr><tr><td>2023</td><td>█████████████████ $885M</td></tr><tr><td>2024</td><td>███████████████████████ $1,160M</td></tr></tbody></table><p>Fonti:</p><ul><li><a href=https://www.fortunebusinessinsights.com/quantum-computing-market-104855>Fortune Business Insights</a></li><li><a href=https://www.sri.com/press/story/new-data-on-the-growing-quantum-industry/>SRI</a></li></ul><p>In particolare, nel 2024 i principali player che operano nel settore del Quantum Computing, hanno frenato un po&rsquo; la corsa al numero di qubit, concrentrandosi sullo sviluppo di nuove architetture per ridurre il cosiddetto fenomeno della <a href=https://en.wikipedia.org/wiki/Quantum_decoherence>decoerenza quantistica</a>, che è uno dei principali ostacoli per la scalabilità dei sistemi attuali.
Tuttavia, nel 2025 c&rsquo;è stato un ritorno di fiamma, con annunci di nuovi prototipi da parte di IBM, Google e Microsoft e negli ultimi 6 mesi, il titolo di Rigetti (altro player che a differenza dei precedenti, opera esclusivamente nel settore del quantum computing) è cresciuto in borsa del 380%!</p><p>In ogni caso, non si è vista ancora alcuna vera rivoluzione e quasi tutti concordano sul fatto che probabilmente il QC non sostituità mai il modello di calcolo classico, ma nel migliore dei casi lo affiancherà, permettendo di risolvere problemi complessi in maniera efficiente.</p><p>Un esempio di problema che potrebbe essere risolto in maniera efficiente con un computer quantistico è la scomposizione in fattori primi di numeri interi molto grandi, tramite <a href=https://en.wikipedia.org/wiki/Shor%27s_algorithm>l&rsquo;algoritmo di Shor</a> allo scopo di far evolvere (o violare) i sistemi di crittografia attualmente in uso.</p><p>Le limitazioni attuali dei computer quantistici, però, non permettono ancora di eseguire questo algoritmo in maniera efficiente su numeri di grandezza tale da minare la sicurezza dei sistemi crittografici attuali.
A parte questo caso d&rsquo;uso potenziale, e qualche altro caso particolare e circoscritto ad ambiti molto particolari, come ad esempio <a href=https://arxiv.org/pdf/quant-ph/9605043>l&rsquo;algoritmo di Grover</a> per la ricerca in liste non ordinate, non si vedono ancora applicazioni pratiche del quantum computing.
Mentre aspettiamo che arrivino applicazioni pratiche, possiamo però già oggi usarla per fare veri e propri esperimenti di meccanica quantistica.
Tali esperimenti, che per me sono poco più che un gioco, fanno riferimento a dei lavori molto più seri, durati qualche decennio, che nel 2022 hanno portato John Clauser, Alain Aspect e Anton Zeilinger a vincere il premio Nobel per la Fisica: <a href=https://it.wikipedia.org/wiki/Esperimento_sulla_correlazione_quantistica_di_Aspect>gli esperimenti sulle Disuguaglianze di Bell</a>.</p><p>Inutile dire che quello riportato qui non è neanche un vero e proprio &ldquo;esperimento&rdquo;, poiché mi sono basato su un simulatore (e non un vero computer quantistico). Inoltre il circuito che ho implementato è basato su una <strong>semplificazione estrema dell&rsquo;esperimento originale</strong>, ma i principi teorici sono gli stessi ed inoltre potrebbe essere portato su un vero Quantum Computer commerciale con poco sforzo, dunque è un esercizio interessante per capire che cosa significa veramente la &ldquo;non-località&rdquo; in meccanica quantistica e come gli stessi principi siano alla base del funzionamento del Quantum Computing.</p><p>Per farlo, ci servono alcuni ingredienti:</p><ol><li>Un po&rsquo; di storia</li><li>Qualche nozione di meccanica quantistica</li><li>Un deep dive sulle disuguaglianze di Bell</li><li>Le basi del Quantum Computing</li></ol><h1 id=2-un-po-di-storia>2. Un po&rsquo; di storia<a hidden class=anchor aria-hidden=true href=#2-un-po-di-storia>#</a></h1><h2 id=21-einstein-e-la-meccanica-quantistica>2.1. Einstein e la meccanica quantistica<a hidden class=anchor aria-hidden=true href=#21-einstein-e-la-meccanica-quantistica>#</a></h2><p>Forse non tutti sanno che Albert Einstein non vinse il premio Nobel per le sue teorie sulla relatività, ma bensì per la spiegazione dell&rsquo;<a href=https://it.wikipedia.org/wiki/Effetto_fotoelettrico>effetto fotoelettrico</a>, traendo spunto da un&rsquo;idea di Max Planck.
Analogamente agli studi sulla relatività, quel lavoro di Einstein fu di enorme importanza per la fisica del XX secolo, perché diede il via all&rsquo;altra grande branca della fisica: la meccanica quantistica. Un fatto degno di nota è che nessun premio Nobel è mai stato assegnato per scoperte direttamente collegate alla teoria della relatività, mentre dal 1920 almeno 16 Nobel sono stati assegnati per studi o scoperte direttamente collegati alla meccanica quantistica.</p><p>Agli inizi del ventesimo secolo, l&rsquo;idea della luce come &ldquo;corpuscolo&rdquo; era in contrasto con la rappresentazione ondulatoria della luce, che era ormai ben consolidata e risaliva addirittura ai lavori di <a href=https://it.wikipedia.org/wiki/Christiaan_Huygens>Christiaan Huygens</a> svolti intorno alla metà del 1600. Nel corso dei secoli, la natura ondulatoria venne più volte messa in discussione, ma gli esperimenti di interferenza le solide basi teoriche introdotte da Thomas Young nel 1801, e successivamente da James Clerk Maxwell con la sua teoria elettromagnetica della luce, sembravano aver definitivamente chiuso la questione.
Di conseguenza, lo stesso Planck, quando introdusse l&rsquo;idea dei quanti nel 1900, non credeva veramente nella natura corpuscolare della luce. Dal suo punto di vista, si trattava solo di una astrazione teorica, che serviva a spiegare il problema dell&rsquo;<a href=https://it.wikipedia.org/wiki/Catastrofe_ultravioletta>emissione di radiazione di corpo nero</a>, ma che non aveva una reale corrispondenza fisica.</p><p>Il grande merito di Einstein fu quello di prendere sul serio l&rsquo;intuzione di Planck, secondo cui l&rsquo;energia non poteva essere scambiata in maniera continua, ma bensì a &ldquo;pacchetti&rdquo; discreti, che Planck chiamò &ldquo;quanti&rdquo; (da cui il nome &ldquo;meccanica quantistica&rdquo;).
Nel 1905, Einstein applicò questa idea per spiegare l&rsquo;effetto fotoelettrico, ipotizzando che la luce fosse composta da &ldquo;quanti di luce&rdquo;, che oggi chiamiamo fotoni e ciò gli valse il premio Nobel per la fisica nel 1921.</p><p>Tuttavia, all&rsquo;inizio nessuno credette ad Einstein, neppure Max Planck, che pure aveva fornito l&rsquo;intuizione iniziale. Fu solo grazie al <a href=https://en.wikipedia.org/wiki/Robert_Millikan#Photoelectric_effect>lavoro di Robert Millikan</a> che, con l&rsquo;obiettivo di screditare la tesi di Einstein, fece numerosi esperimenti e impiegò diversi anni per arrendersi al fatto che la spiegazione dell&rsquo;effetto fotoelettrico fornita da Einstein era corretta e dunque l&rsquo;ipotesi dei quanti era tutt&rsquo;altro che una semplice astrazione teorica.</p><p>Da qui in avanti, è un susseguirsi di studi e scoperte che fanno della meccanica quantistica la teoria fisica più accurata e precisa mai sviluppata e che hanno portato in pochi anni ad una sequenza incredibile di premi Nobel, tra cui i più importanti sono:</p><ul><li>1922 - Niels Bohr per i suoi studi sulla struttura atomica</li><li>1923 - Millikan per il suo lavoro sperimentale sull&rsquo;effetto fotoelettrico e la misura della carica dell&rsquo;elettrone</li><li>1927 - Arthur Compton per la scoperta dell&rsquo;effetto Compton</li><li>1929 - Louis de Broglie per la scoperta della natura ondulatoria dell&rsquo;elettrone</li><li>1932 - Werner Heisenberg per la formulazione della meccanica quantistica</li><li>1933 - Erwin Schrödinger e Paul Dirac per la formulazione della meccanica ondulatoria</li><li>1945 - Wolfgang Pauli per la scoperta del principio di esclusione</li><li>1954 - Max Born per la formulazione della meccanica quantistica in termini probabilistici</li><li>1965 - Richard Feynman, Julian Schwinger e Sin-itiro Tomonaga per lo sviluppo dell&rsquo;elettrodinamica quantistica</li></ul><p>Ironia della sorte, proprio Einstein che aveva dato il via a quella rivoluzione, iniziò ad essere sempre più scettico sulla teoria stessa mano a mano che andava sviluppandosi, fino al punto di isolarsi dalla comunità scientifica che nel frattempo l&rsquo;aveva abbracciata pienamente.</p><p>Ma perché Einstein era così scettico in merito alla rappresentazione della realtà secondo la meccanica quantistica?
La risposta a questa domanda ha appunto a che fare con il concetto stesso di Realtà e richiede un approfondimento per capire il punto di vista di Einstein.</p><h2 id=22-che-cosè-la-realtà>2.2. Che cos&rsquo;è la realtà?<a hidden class=anchor aria-hidden=true href=#22-che-cosè-la-realtà>#</a></h2><p>Da un certo punto di vista, l&rsquo;approccio di Einstein ai problemi sollevati meccanica quantistica è stato simile a quello che aveva caratterizzato il suo approccio alla Relatività. Nel momento in cui si trovava di fronte ad un problema apparentemente insolubile (come ad esempio la costanza della velocità della luce su tutti i sistemi di riferimento inerziali), non cercava a tutti i costi di adattare la teoria, ma piuttosto iniziava a mettere in discussione e a definire un nuovo formalismo, per concetti che sembravano ormai assodati, come ad esempio il concetto di simultaneità, di tempo e di spazio.</p><p>Qualcosa di analogo avvenne anche per il concetto di Realtà, attraverso cui poi Einsten, Podolsky e Rosen formularono il famoso paradosso EPR, che metteva in discussione la completezza della meccanica quantistica.</p><p>Dal punto di vista di Einstein, la descrizione del mondo fisico doveva obbedire a 2 principi fondamentali:</p><ul><li><strong>Località</strong>: un oggetto può essere influenzato solo dal suo <strong>immediato intorno</strong>, e non da eventi che avvengono a distanza arbitrariamente elevata. In altre parole, non possono esistere &ldquo;azioni a distanza&rdquo; (<em>spooky action at a distance</em>).</li><li><strong>Realismo</strong>: gli oggetti hanno <strong>proprietà definite</strong> indipendentemente dall&rsquo;osservazione. In altre parole, la realtà esiste indipendentemente dal fatto che noi la osserviamo o meno.</li></ul><p>Il <a href=https://en.wikipedia.org/wiki/Einstein%E2%80%93Podolsky%E2%80%93Rosen_paradox>Paradosso EPR</a> descrive alcuni esperimenti mentali attraverso cui gli autori provano a dimostrare che la meccanica quantistica non può essere una teoria completa, perché viola almeno uno dei principi sopra elencati.</p><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content><p>In altre parole, se la meccanica quantistica è corretta, allora vale almeno una delle seguenti affermazioni:</p><ul><li><em>il principio di località è falso, e quindi esistono azioni a distanza che violano il limite della velocità della luce</em></li><li><em>il principio di realismo è falso, e quindi gli oggetti non hanno proprietà definite indipendentemente dall&rsquo;osservazione, ma bensì le proprietà fisiche si manifestano solo nel momento in cui esse vengono misurate</em></li></ul></div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><p>Da un punto di vista tecnico, il paradosso EPR si basa sul concetto di <strong>entanglement</strong> che, oltre ad essere uno dei concetti più strani e affascinanti della meccanica quantistica (spesso frainteso e mal interpretato), è anche alla base del funzionamento dei computer quantistici.</p><h2 id=23-linteresse-del-mondo-scientifico-alla-questione>2.3 L&rsquo;interesse del mondo scientifico alla questione<a hidden class=anchor aria-hidden=true href=#23-linteresse-del-mondo-scientifico-alla-questione>#</a></h2><p>Per decenni, l&rsquo;intera questione del paradosso EPR e della interpretazione epistemologica della meccanica quantistica rimase confinata a discussioni filosofiche tra pochi addetti ai lavori, e già dopo gli anni 30 la meccanica quantistica era talmente ben consolidata che nessuno si preoccupava più di questi aspetti.
Lo stesso Bell, ha lavorato come fisico delle particelle presso diversi enti di ricerca in UK e poi al CERN e si dedicava a questo tema solo nel tempo libero.
Nel 1964, durante un anno sabbatico negli Stati Uniti, Bell pubblicò il famoso articolo &ldquo;<em>On the Einstein Podolsky Rosen paradox</em>&rdquo; in cui propose un modo per verificare sperimentalmente se Einstein avesse ragione o meno.
L&rsquo;articolo suscitò un certo interesse, ma tuttavia, anche dopo la pubblicazione di Bell, solo pochi temerari si interessarono ad un potenziale esperimento per verificare le disuguaglianze di Bell, anche perché dopo poco tempo la stessa rivista su cui Bell aveva pubblicato l&rsquo;articolo fallì e questo non contribuì certo a diffondere l&rsquo;idea.</p><p>Lo stesso John Clauser, uno dei tre premi Nobel del 2022, inzialmente non era molto convinto di voler affrontare la questione e racconta che quando chiese un consiglio al mitico Richard Feynman di fare il suo primo esperimento per testare le disuguaglianze di Bell, gli venne risposto che si trattava di una &ldquo;perdita di tempo&rdquo;, perché la meccanica quantistica era già stata ampiamente verificata e nessuno si aspettava che Einstein avesse ragione.</p><h1 id=3-qualche-nozione-di-meccanica-quantistica>3. Qualche nozione di meccanica quantistica<a hidden class=anchor aria-hidden=true href=#3-qualche-nozione-di-meccanica-quantistica>#</a></h1><h2 id=31-sovrapposizione-quantistica>3.1. Sovrapposizione quantistica<a hidden class=anchor aria-hidden=true href=#31-sovrapposizione-quantistica>#</a></h2><p>In meccanica quantistica, un sistema può trovarsi in uno stato di <strong>sovrapposizione</strong>, cioè in una combinazione di più stati contemporaneamente.</p><p>Nel mondo del quantum computing, lo stato di sovrapposizione può essere implementato tramite l&rsquo;applicazione di alcuni operatori (<em>quantum gates</em>) sui <strong>qubit</strong>, l&rsquo;analogo quantistico del bit classico. Mentre un bit classico può assumere solo i valori 0 o 1, un qubit può trovarsi in una sovrapposizione dei due stati, rappresentata matematicamente come:</p><p>$$|\psi\rangle = \alpha|0\rangle + \beta|1\rangle$$</p><p>dove $\alpha$ e $\beta$ sono numeri complessi che soddisfano la condizione $|\alpha|^2 + |\beta|^2 = 1$.</p><h2 id=32-misura-quantistica>3.2. Misura quantistica<a hidden class=anchor aria-hidden=true href=#32-misura-quantistica>#</a></h2><p>Quando misuriamo un qubit, la sovrapposizione &ldquo;collassa&rdquo; in uno dei due stati base (0 o 1), con probabilità rispettivamente $|\alpha|^2$ e $|\beta|^2$.</p><p>Questo è uno degli aspetti più controversi della meccanica quantistica: prima della misura, il sistema è effettivamente in entrambi gli stati contemporaneamente (almeno secondo l&rsquo;<a href=https://en.wikipedia.org/wiki/Copenhagen_interpretation>interpretazione di Copenaghen</a>), ma nel momento in cui lo misuriamo, la realtà &ldquo;<em>sceglie</em>&rdquo; uno dei due stati in modo probabilistico.</p><p>Einstein non ha mai accettato questa interpretazione. In un primo momento cercò di dimostrare che la meccanica quantistica fosse errata. Sono ormai celebri le sue critiche a Bohr durante <a href=https://en.wikipedia.org/wiki/Solvay_Conference>i congressi Solvay</a> e gli esperimenti mentali con cui cercava di mettere in difficoltà l&rsquo;impostazione teoretica della meccanica quantistica che oggi possiamo definire &ldquo;ortodossa&rdquo;.
Tuttavia, Bohr e Heisenberg riuscivano sempre a trovare una risposta alla challenge di Einstein, supportata dalla teoria stessa.
Alla fine, Einstein si arrese all&rsquo;evidenza: <strong>la meccanica quantistica era corretta</strong>.</p><p>Tuttavia continuò a sostenere che fosse una teoria incompleta e che doveva esistere una descrizione più completa della realtà, che includesse delle &ldquo;variabili nascoste&rdquo; che permettono di predire il risultato della misura in modo deterministico.</p><p>Al di là delle implicazioni filosofiche, il concetto di &ldquo;misura&rdquo; ha delle implicazioni pratiche anche nella programmazione quantistica poiché, ad esempio, non possiamo semplicemente &ldquo;leggere&rdquo; lo stato di un qubit in uno stato di sovrapposizione senza alterarlo. Nella interpretazione di Copenhagen, questa alterazione (cioè questa &ldquo;misura&rdquo;) equivale al concetto di <strong>collasso della funzione d&rsquo;onda</strong>.</p><h2 id=33-entanglement>3.3. Entanglement<a hidden class=anchor aria-hidden=true href=#33-entanglement>#</a></h2><p>L&rsquo;<strong>entanglement</strong> (correlazione quantistica) è forse il fenomeno più strano e controintuitivo della meccanica quantistica. Quando due particelle sono entangled, esse formano un unico sistema quantistico, anche se sono separate da distanze arbitrariamente grandi.</p><p>Questa correlazione porta a fenomeni che Einstein chiamava &ldquo;azioni fantasma a distanza&rdquo; (spooky actions at a distance) e che lo portarono a credere che la meccanica quantistica dovesse essere una teoria incompleta.</p><p>Ciononostante, per quanto strana e controintuitiva (anzi, forse proprio a causa di questo aspetto), il fenomeno dell&rsquo;entanglement è stato sperimentato e verificato innumerevoli volte in laboratorio.</p><p>Nella stragrande maggioranza dei casi, i test fanno riferimento a singole particelle, ma esistono anche casi in cui è stato verificato lo <a href=https://research.princeton.edu/news/physicists-%E2%80%98entangle%E2%80%99-individual-molecules-first-time-bringing-about-new-platform-quantum>stato entangled di sistemi macroscopici come molecole</a>.</p><p>L&rsquo;esempio più estremo e famoso è quello dell&rsquo;esperimento mentale del <a href=https://it.wikipedia.org/wiki/Gatto_di_Schr%C3%B6dinger>gatto di Schrödinger</a>, che si trova contemporaneamente vivo e morto fino a quando non viene osservato.</p><h3 id=331-entanglement-e-quantum-computing>3.3.1. Entanglement e Quantum Computing<a hidden class=anchor aria-hidden=true href=#331-entanglement-e-quantum-computing>#</a></h3><p>Dal punto di vista del Quantum Computing, un esempio classico è quello di due qubit in stato di Bell:</p><p>$$|\Phi^+\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle)$$</p><p>Questo stato rappresenta una <strong>sovrapposizione</strong> in cui i due qubit sono entrambi 0 oppure entrambi 1 con probabilità 50%. La cosa straordinaria è che quando misuriamo il primo qubit e otteniamo (ad esempio) 0, istantaneamente il secondo qubit collassa anche lui nello stato 0, indipendentemente dalla distanza che li separa.</p><h2 id=34-teorie-a-variabili-nascoste>3.4 Teorie a variabili nascoste<a hidden class=anchor aria-hidden=true href=#34-teorie-a-variabili-nascoste>#</a></h2><p>Secondo Einstein, la meccanica quantistica era una teoria <strong>incompleta</strong>: le probabilità che osserviamo nelle misure quantistiche non rifletterebbero una reale indeterminazione della natura, ma semplicemente la nostra ignoranza di alcune <strong>variabili nascoste</strong> che in teoria potrebbero essere utilizzate per determinare in modo preciso il risultato di una misura.</p><p>Per capire meglio questo concetto, possiamo fare un&rsquo;analogia con il lancio di una moneta:</p><ul><li>Dal punto di vista pratico, il risultato (testa o croce) sembra casuale con probabilità 50%</li><li>Ma sappiamo che in realtà il risultato è completamente determinato dalle condizioni iniziali: velocità, angolo di lancio, forza, resistenza dell&rsquo;aria, ecc.</li><li>Se conoscessimo perfettamente tutte queste &ldquo;variabili nascoste&rdquo;, potremmo predire con certezza il risultato</li></ul><p>Einstein credeva che qualcosa di simile avvenisse anche in meccanica quantistica. Quando prepariamo un elettrone in uno stato di sovrapposizione e poi lo misuriamo, secondo Einstein:</p><ol><li>L&rsquo;elettrone possiede già una proprietà definita <strong>prima</strong> della misura</li><li>Questa proprietà è determinata da variabili che la teoria attuale non include (variabili &ldquo;nascoste&rdquo;)</li><li>La natura probabilistica della meccanica quantistica deriva solo dalla nostra ignoranza di queste variabili</li><li>Una teoria più completa, che includesse queste variabili, sarebbe completamente deterministica</li></ol><p>Questo punto di vista è chiamato <strong>realismo locale con variabili nascoste</strong>:</p><ul><li><strong>Locale</strong>: le variabili nascoste sono proprietà intrinseche del sistema, non influenzate da eventi distanti</li><li><strong>Realista</strong>: le proprietà fisiche esistono indipendentemente dall&rsquo;osservazione</li><li><strong>Deterministico</strong>: conoscendo le variabili nascoste, il risultato della misura sarebbe predeterminato</li></ul><p>Il paradosso EPR fu proprio un tentativo di Einstein, Podolsky e Rosen di dimostrare che tali variabili nascoste dovevano necessariamente esistere per mantenere i principi di località e realismo.</p><h1 id=4-un-deep-dive-sulle-disuguaglianze-di-bell>4. Un deep dive sulle disuguaglianze di Bell<a hidden class=anchor aria-hidden=true href=#4-un-deep-dive-sulle-disuguaglianze-di-bell>#</a></h1><h2 id=41-il-lavoro-di-john-bell>4.1. Il lavoro di John Bell<a hidden class=anchor aria-hidden=true href=#41-il-lavoro-di-john-bell>#</a></h2><p>Nel 1964, il fisico irlandese John Stewart Bell propose un modo per verificare sperimentalmente se Einstein avesse ragione. Bell formulò una serie di disuguaglianze matematiche che devono essere soddisfatte se vale il principio di <strong>realismo locale</strong> (cioè se valgono insieme sia il principio di località che quello di realismo).</p><p>L&rsquo;idea geniale di Bell fu di trovare una quantità misurabile che:</p><ul><li>Se la meccanica quantistica è corretta, viola le disuguaglianze</li><li>Se esiste una teoria a &ldquo;variabili nascoste locali&rdquo; (come Einstein sosteneva), rispetta le disuguaglianze</li></ul><p>Questo lavoro, tuttavia, era di natura interamente matematica. La bravura dei fisici che vennero in seguito (e per cui alla fine è stato riconosciuto il Nobel nel 2022) fu quella di progettare e realizzare esperimenti per declinarlo nel mondo reale.</p><h2 id=42-il-test-chsh>4.2. Il test CHSH<a hidden class=anchor aria-hidden=true href=#42-il-test-chsh>#</a></h2><p>Una delle formulazioni più utilizzate delle disuguaglianze di Bell è il test CHSH (da Clauser, Horne, Shimony e Holt), che prende il nome dai quattro fisici che lo proposero nel 1969.</p><p>L&rsquo;esperimento prevede:</p><ol><li>Una sorgente che produce coppie di particelle entangled (ad esempio fotoni polarizzati)</li><li>I soliti &ldquo;Alice&rdquo; e &ldquo;Bob&rdquo; di tutti gli esperimenti di fisica, i quali possono scegliere tra due possibili misure da effettuare</li><li>Si misurano le <strong>correlazioni</strong> tra i risultati ottenuti da Alice e Bob</li></ol><p>Più formalmente:</p><ul><li>Alice può scegliere di misurare secondo l&rsquo;angolo $a_0$ oppure $a_1$</li><li>Bob può scegliere di misurare secondo l&rsquo;angolo $b_0$ oppure $b_1$</li><li>Ogni misura produce un risultato +1 oppure -1</li></ul><p>Si definisce quindi la quantità CHSH:</p><p>$$S = E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)$$</p><p>dove $E(a_i, b_j)$ è la correlazione tra le misure di Alice e Bob.</p><h3 id=421-grandezze-non-commutative>4.2.1. Grandezze non commutative<a hidden class=anchor aria-hidden=true href=#421-grandezze-non-commutative>#</a></h3><p>Nel test CHSH Alice e Bob misurano la <strong>polarizzazione dei fotoni secondo angoli diversi</strong>, ma esperienti analoghi possono essere fatti con altre grandezze fisiche, come lo spin di elettroni (anch&rsquo;essi in stato entangled).</p><p>In ogni caso, l&rsquo;esperimento funziona solo se le grandezze misurate sono di natura <strong>non commutativa</strong>.</p><p>In fisica classica, se vogliamo misurare due proprietà di un oggetto (ad esempio, la sua posizione e la sua velocità), possiamo farlo in qualsiasi ordine e ottenere sempre gli stessi risultati. L&rsquo;ordine delle misure non conta.</p><p>In meccanica quantistica, invece, esistono coppie di grandezze fisiche per cui <strong>l&rsquo;ordine delle misure è importante</strong>. Quando misuriamo prima A e poi B, otteniamo risultati diversi rispetto a quando misuriamo prima B e poi A. Matematicamente, questo si esprime dicendo che gli operatori corrispondenti non commutano:</p><p>$$\hat{A}\hat{B} \neq \hat{B}\hat{A}$$</p><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content>La non-commutatività è strettamente collegata al principio di indeterminazione di Heisenberg.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><p>Gli esempi più famosi di grandezze non commutative sono:</p><ul><li><strong>Posizione e quantità di moto</strong>: formulazione classica del principio di indeterminazione</li><li><strong>Componenti dello spin lungo assi diversi</strong>: misurare lo spin lungo l&rsquo;asse x e poi lungo l&rsquo;asse y dà risultati diversi rispetto all&rsquo;ordine inverso</li><li><strong>Polarizzazione del fotone secondo angoli diversi</strong>: proprio quello che misuriamo nel test CHSH</li></ul><p>Nel nostro esperimento, quando Alice misura la polarizzazione secondo l&rsquo;angolo $a_0 = 0°$ e Bob secondo $b_0 = 45°$, stanno misurando grandezze non commutative perché <strong>associate allo stesso sistema entangled</strong>.</p><figure><img src=/images/2025/bell/image-11.png alt="Schema di un test delle disuguaglianze di Bell a 2 Canali" style=max-width:100%;margin:auto;display:block><figcaption>Configurazione tipica di un esperimento CHSH. Una sorgente produce coppie di particelle entangled che vengono inviate a due osservatori spazialmente separati (Alice e Bob). Ciascun osservatore può scegliere tra due possibili angoli di misura (ad esempio, polarizzatori orientati a 0° o 45° per Alice e 22.5° o 67.5° per Bob). I risultati delle misure (+1 o -1) ricevuti dai 4 rivelatori vengono poi utilizzati per calcolare la quantità CHSH $S$.<br>Fonte: wikipedia</figcaption></figure><p>Secondo la meccanica quantistica &ldquo;ortodossa&rdquo;, possiamo riassumere che:</p><ol><li><strong>Non possiamo conoscere simultaneamente</strong> entrambe le polarizzazioni con certezza assoluta</li><li><strong>La prima misura influenza la seconda</strong>: se Alice misura prima, il risultato di Bob sarà influenzato dal collasso della funzione d&rsquo;onda causato dalla misura di Alice</li><li><strong>Non esistono &ldquo;valori preesistenti&rdquo;</strong> per entrambe le polarizzazioni: le proprietà si manifestano solo al momento della misura</li></ol><p>Di converso, le teorie a variabili nascoste assumono che ogni particella porti con sé un &ldquo;istruzione nascosta&rdquo; che predetermina il risultato per ogni possibile angolo di misura. Ma se le grandezze non commutano, non possono esistere contemporaneamente valori predeterminati per tutte le possibili misure.</p><p>Il genio di Bell fu capire che questa differenza tra il mondo classico (dove tutte le grandezze commutano) e quello quantistico (dove alcune grandezze non commutano) si traduce in una differenza <strong>misurabile</strong> nelle correlazioni statistiche su un campione di misure sufficientemente ampio.</p><ul><li><strong>Secondo il realismo locale</strong>: $|S| \leq 2$</li><li><strong>Secondo la meccanica quantistica</strong>: $|S|$ può arrivare fino a $2\sqrt{2} \approx 2.828$</li></ul><p>Ma perché questi limiti? Cerchiamo di capirlo con un&rsquo;analogia intuitiva.</p><h4 id=4211-il-ragionamento-del-realismo-locale-il-limite-di-2>4.2.1.1. Il ragionamento del realismo locale (il limite di 2)<a hidden class=anchor aria-hidden=true href=#4211-il-ragionamento-del-realismo-locale-il-limite-di-2>#</a></h4><p>Immaginiamo che ogni coppia di particelle entangled porti con sé un &ldquo;foglietto di istruzioni&rdquo; nascosto che predetermina il risultato per ogni possibile angolo di misura. Questo foglietto contiene 4 valori predeterminati:</p><ul><li>$A_0$: risultato di Alice se misura secondo $a_0$ (può essere +1 o -1)</li><li>$A_1$: risultato di Alice se misura secondo $a_1$ (può essere +1 o -1)</li><li>$B_0$: risultato di Bob se misura secondo $b_0$ (può essere +1 o -1)</li><li>$B_1$: risultato di Bob se misura secondo $b_1$ (può essere +1 o -1)</li></ul><p>Per ogni singola coppia di particelle, possiamo calcolare:</p><p>$$S_{\text{singola}} = A_0 B_0 + A_0 B_1 + A_1 B_0 - A_1 B_1$$</p><p>Facciamo un esempio concreto. Supponiamo che una particolare coppia abbia:</p><ul><li>$A_0 = +1$, $A_1 = -1$, $B_0 = +1$, $B_1 = +1$</li></ul><p>Allora:
$$S = (+1)(+1) + (+1)(+1) + (-1)(+1) - (-1)(+1) = 1 + 1 - 1 + 1 = 2$$</p><p>Proviamo un&rsquo;altra combinazione:</p><ul><li>$A_0 = +1$, $A_1 = +1$, $B_0 = +1$, $B_1 = -1$</li></ul><p>$$S = (+1)(+1) + (+1)(-1) + (+1)(+1) - (+1)(-1) = 1 - 1 + 1 + 1 = 2$$</p><p>Possiamo riscrivere $S$ come:
$$S = A_0(B_0 + B_1) + A_1(B_0 - B_1)$$</p><p>Ora osserviamo che:</p><ul><li>Se $B_0 = B_1$, allora $(B_0 + B_1) = \pm 2$ e $(B_0 - B_1) = 0$, quindi $S = \pm 2A_0$, cioè $|S| = 2$</li><li>Se $B_0 = -B_1$, allora $(B_0 + B_1) = 0$ e $(B_0 - B_1) = \pm 2$, quindi $S = \pm 2A_1$, cioè $|S| = 2$</li></ul><p>In entrambi i casi, per una singola coppia con valori predeterminati, otteniamo sempre $|S| = 2$</p><p>Quando facciamo molte misure e calcoliamo la media delle correlazioni $E(a_i, b_j)$, stiamo mediando su tutte le possibili combinazioni di istruzioni nascoste. Ma siccome ogni singola coppia dà $|S| = 2$, la media non può mai superare questo valore:</p><p>$$|S| = |E(a_0, b_0) + E(a_0, b_1) + E(a_1, b_0) - E(a_1, b_1)| \leq 2$$</p><p>Questo è dunque il <strong>limite classico</strong> ed è valido per qualsiasi teoria a variabili nascoste locali.</p><h4 id=4212-il-ragionamento-quantistico-il-limite-di-22>4.2.1.2. Il ragionamento quantistico (il limite di 2√2)<a hidden class=anchor aria-hidden=true href=#4212-il-ragionamento-quantistico-il-limite-di-22>#</a></h4><p>Nella meccanica quantistica, invece, non esistono valori predeterminati. Le particelle sono in uno stato di Bell entangled:</p><p>$$|\Phi^+\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle)$$</p><p>Quando Alice e Bob misurano secondo angoli diversi, le correlazioni dipendono dalla differenza angolare $\theta$ tra le loro direzioni di misura secondo la formula:</p><p>$$E(\theta) = \cos(2\theta)$$</p><p>Per gli angoli ottimali del test CHSH:</p><ul><li>$a_0 = 0°$, $a_1 = 45°$</li><li>$b_0 = 22.5°$, $b_1 = -22.5°$</li></ul><p>Con questi angoli:</p><ul><li>$E(a_0, b_0) = \cos(2 \times 22.5°) = \cos(45°) = \frac{1}{\sqrt{2}}$</li><li>$E(a_0, b_1) = \cos(2 \times 22.5°) = \cos(45°) = \frac{1}{\sqrt{2}}$</li><li>$E(a_1, b_0) = \cos(2 \times 22.5°) = \cos(45°) = \frac{1}{\sqrt{2}}$</li><li>$E(a_1, b_1) = \cos(2 \times 67.5°) = \cos(135°) = -\frac{1}{\sqrt{2}}$</li></ul><p>Quindi:
$$S = \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} - \left(-\frac{1}{\sqrt{2}}\right) = \frac{4}{\sqrt{2}} = 2\sqrt{2} \approx 2.828$$</p><p>Questo invece è il <strong>limite di Tsirelson</strong> ed è il massimo valore teorico previsto dalla meccanica quantistica.</p><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content>per capire meglio cosa intendiamo per &ldquo;angoli di misura&rdquo; e come si calcolano le correlazioni in meccanica quantistica, ho fatto un piccolo approfondimento el paragrafo 6.5.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h4 id=4213-da-dove-viene-questa-differenza>4.2.1.3. Da dove viene questa differenza?<a hidden class=anchor aria-hidden=true href=#4213-da-dove-viene-questa-differenza>#</a></h4><p>La differenza fondamentale è questa:</p><ul><li><p><strong>Realismo locale</strong>: assume che ogni particella abbia 4 proprietà definite contemporaneamente ($A_0, A_1, B_0, B_1$), anche se ne misuriamo solo una. Questa assunzione limita le correlazioni possibili.</p></li><li><p><strong>Meccanica quantistica</strong>: le proprietà non esistono prima della misura. Le particelle sono in sovrapposizione e l&rsquo;angolo di misura determina la &ldquo;base&rdquo; in cui proiettiamo lo stato. Questo permette correlazioni più forti.</p></li></ul><p>Un&rsquo;analogia: è come se nel caso classico ogni particella portasse con sé 4 monete già lanciate (ma coperte), mentre nel caso quantistico le monete vengono lanciate solo quando le scopriamo, e il modo in cui scopriamo quella di Alice <strong>influenza istantaneamente le probabilità</strong> per quella di Bob, anche se sono lontane.</p><h2 id=43-gli-esperimenti-che-valsero-il-nobel-2022>4.3. Gli esperimenti che valsero il Nobel 2022<a hidden class=anchor aria-hidden=true href=#43-gli-esperimenti-che-valsero-il-nobel-2022>#</a></h2><p>A partire dagli anni &lsquo;70, una serie di esperimenti basati sull&rsquo;impostazione teorica di Bell ed in particolare sul test CHSH hanno dimostrato indiscutibilmente che le disuguaglianze di Bell vengono violate esattamente secondo quanto previsto dall&rsquo;impostazione teorica della meccanica quantistica, confermando che il realismo locale non può essere mantenuto:</p><ol><li><strong>1972 - John Clauser</strong>: primo esperimento che violò le disuguaglianze di Bell usando fotoni polarizzati</li><li><strong>1982 - Alain Aspect</strong>: esperimenti più raffinati che eliminarono diverse possibili &ldquo;scappatoie&rdquo; (loopholes)</li><li><strong>1998-2015 - Anton Zeilinger</strong>: esperimenti con entanglement su distanze sempre maggiori, fino a dimostrare il teletrasporto quantistico</li></ol><p>Nel 2022, questi tre fisici ricevettero il Premio Nobel per la fisica proprio per questi esperimenti pionieristici.</p><h3 id=431-le-scappatoie-loopholes-e-come-sono-state-eliminate>4.3.1. Le &ldquo;scappatoie&rdquo; (loopholes) e come sono state eliminate<a hidden class=anchor aria-hidden=true href=#431-le-scappatoie-loopholes-e-come-sono-state-eliminate>#</a></h3><p>Nonostante i primi esperimenti di Clauser negli anni &lsquo;70 avessero violato le disuguaglianze di Bell, rimanevano alcune possibili obiezioni tecniche che avrebbero potuto permettere a un sostenitore del realismo locale di mettere in dubbio i risultati. Queste obiezioni sono chiamate <strong>loopholes</strong> (scappatoie), e gran parte del lavoro sperimentale successivo si è concentrato nell&rsquo;eliminarle una per una.</p><h4 id=4311-locality-loophole>4.3.1.1. Locality Loophole<a hidden class=anchor aria-hidden=true href=#4311-locality-loophole>#</a></h4><p><strong>Il problema</strong>: Nei primi esperimenti, le misure di Alice e Bob non erano sufficientemente separate nello spazio-tempo. In teoria, un segnale classico (viaggiando alla velocità della luce o meno) avrebbe potuto viaggiare da un rivelatore all&rsquo;altro influenzando il risultato senza che l&rsquo;apparato sperimentale fosse in grado di rilevarlo.</p><p><strong>La soluzione di Alain Aspect (1982)</strong>: Aspect introdusse un sistema di <strong>switching ultraveloce</strong> degli angoli di misura:</p><ul><li>Gli angoli di misura venivano cambiati casualmente durante il volo dei fotoni</li><li>Il cambiamento avveniva così velocemente che nessun segnale subluminale poteva viaggiare da un rivelatore all&rsquo;altro</li><li>Questo garantiva la <strong>separazione spazio-temporale</strong> (spacelike separation) delle misure</li></ul><p>Tali modifiche vennero implementate di modo che l’intervallo di tempo fra produzione e detection fosse di 20 ns, mentre gli switch dei canali invertissero orientazione in modo asincrono ogni 10 ns, tenendo le varie sezioni sufficientemente lontane da garantire distanze di tipo spazio fra loro.
Ciò assicura che l&rsquo;evento di misura di Alice sia causalmente disconnesso da quello di Bob.</p><h4 id=4312-fair-sampling-loophole>4.3.1.2. Fair Sampling Loophole<a hidden class=anchor aria-hidden=true href=#4312-fair-sampling-loophole>#</a></h4><p><strong>Il problema</strong>: Nessun rivelatore è perfetto al 100%. Nei primi esperimenti con fotoni, solo una piccola frazione delle coppie di particelle prodotte veniva effettivamente rivelata e misurata. Negli esperimenti di Clauser, ad esempio, l&rsquo;efficienza di rivelazione era inferiore al 5%.</p><p>Questo apre una possibile obiezione: come possiamo essere sicuri che le coppie di particelle <strong>effettivamente rivelate</strong> siano un campione rappresentativo di tutte le coppie prodotte?</p><p>Un sostenitore del realismo locale potrebbe sostenere che:</p><ul><li>Le particelle portano con sé &ldquo;istruzioni nascoste&rdquo; che determinano sia il risultato della misura che la probabilità di essere rivelate</li><li>Le particelle con certe combinazioni di istruzioni nascoste hanno una maggiore probabilità di essere rivelate rispetto ad altre</li><li>Il campione osservato è quindi <strong>distorto</strong> (biased), e le correlazioni misurate non riflettono le vere correlazioni dell&rsquo;insieme completo</li></ul><p>In altre parole, è come se facessimo un sondaggio politico intervistando solo le persone che rispondono al telefono: il campione potrebbe non essere rappresentativo della popolazione generale.</p><p>Matematicamente, questa obiezione funziona perché la dimostrazione delle Disuguaglianze di Bell assume che tutte le coppie prodotte vengano misurate. Se possiamo misurare solo un sottoinsieme, e questo sottoinsieme non è scelto in modo casuale ma dipende dalle variabili nascoste, allora le disuguaglianze potrebbero essere violate anche in una teoria a variabili nascoste locali.</p><p><strong>L&rsquo;assunzione del campionamento equo</strong>: Per molti anni, gli esperimenti si sono basati sull&rsquo;<strong>ipotesi del campionamento equo</strong> (fair sampling assumption), che assume che le particelle rivelate siano un campione casuale rappresentativo. Questa ipotesi è ragionevole dal punto di vista fisico, ma non è una dimostrazione rigorosa.</p><p><strong>La soluzione</strong>: Per eliminare completamente questo loophole, serve raggiungere un&rsquo;<strong>efficienza di rivelazione</strong> superiore a una soglia critica. Per il test CHSH, questa soglia è circa <strong>82.8%</strong> (più precisamente, $\eta > 2/3 \approx 66.7%$ per configurazioni ottimali, ma in pratica serve un&rsquo;efficienza più alta per tenere conto di altri fattori).</p><p>Questo obiettivo è stato molto difficile da raggiungere e ha richiesto decenni di progressi tecnologici:</p><p><strong>Prima soluzione - Ioni intrappolati (anni 2000)</strong>:</p><ul><li>Gli <strong>ioni</strong> (atomi carichi intrappolati in campi elettromagnetici) sono molto più controllabili dei fotoni</li><li>Possono essere mantenuti in posizioni precise e misurati con efficienza molto alta (>90%)</li><li>Esperimenti pioneristici di Rowe et al. (2001) e Matsukevich et al. (2008) raggiunsero efficienze superiori alla soglia critica</li><li><strong>Svantaggio</strong>: gli ioni sono difficili da separare spazialmente, rendendo più complicato chiudere simultaneamente il locality loophole</li></ul><p><strong>Seconda soluzione - Rivelatori superconduttori per fotoni (anni 2010)</strong>:</p><ul><li>I <strong>rivelatori a nanofili superconduttori</strong> (SNSPDs - Superconducting Nanowire Single-Photon Detectors) hanno rivoluzionato la rivelazione di fotoni</li><li>Operano a temperature criogeniche (vicine allo zero assoluto)</li><li>Raggiungono efficienze del 75-98% nella banda infrarossa</li><li>Permettono di usare fotoni (facilmente separabili su grandi distanze) mantenendo alta efficienza di rivelazione</li></ul><p><strong>Terza soluzione - Atomi neutri e centri di colore</strong>:</p><ul><li><strong>Centri di colore in diamante</strong>: tecnica che sfrutta alcuni difetti nella struttura cristallina del diamante</li><li><strong>Atomi neutri intrappolati</strong>: atomi raffreddati con laser e intrappolati in pinze ottiche</li></ul><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content><strong>Perché questa soglia dell'82.8%?</strong>: Questa percentuale deriva dall&rsquo;analisi matematica del test CHSH. Con efficienza inferiore, è possibile costruire un modello a variabili nascoste locali che riproduce le statistiche osservate sfruttando proprio il campionamento non equo. Sopra questa soglia, invece, diventa matematicamente impossibile spiegare i risultati con il realismo locale, anche assumendo il peggior caso possibile di bias nel campionamento.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h4 id=4313-freedom-of-choice-loophole>4.3.1.3. Freedom-of-Choice Loophole<a hidden class=anchor aria-hidden=true href=#4313-freedom-of-choice-loophole>#</a></h4><p><strong>Il problema</strong>: Come vengono scelti gli angoli di misura per Alice e Bob? Se la scelta non è veramente casuale, ma è in qualche modo correlata con le &ldquo;istruzioni nascoste&rdquo; delle particelle, allora i risultati potrebbero essere spiegati con il realismo locale.</p><p>Questa obiezione può sembrare strana, ma dal punto di vista logico è valida: se l&rsquo;universo è deterministico, allora anche la scelta &ldquo;casuale&rdquo; dell&rsquo;angolo potrebbe essere predeterminata dalle stesse variabili nascoste che determinano il risultato della misura!</p><p><strong>La soluzione</strong>: Usare sorgenti di casualità il più &ldquo;libere&rdquo; possibile:</p><ul><li><p><strong>Generatori quantistici di numeri casuali</strong> (QRNG): sfruttano processi quantistici intrinsecamente casuali</p></li><li><p><strong>Luce da stelle distanti</strong> (esperimenti di Zeilinger, 2017): usarono la luce proveniente da stelle lontane migliaia di anni luce per decidere gli angoli di misura. In questo modo, le &ldquo;istruzioni nascoste&rdquo; avrebbero dovuto essere correlate con eventi che, almeno in prima approssimazione, possiamo assumere essere causalmente disconnessi dalle particelle entangled.</p></li><li><p><strong>Partecipazione umana</strong>: in un esperimento chiamato &ldquo;The BIG Bell Test&rdquo; (2016), migliaia di persone in tutto il mondo hanno scelto gli angoli di misura tramite un videogioco online</p></li></ul><h4 id=4314-memory-loophole>4.3.1.4. Memory Loophole<a hidden class=anchor aria-hidden=true href=#4314-memory-loophole>#</a></h4><p><strong>Il problema</strong>: Se le coppie di particelle vengono misurate in sequenza e i risultati vengono accumulati nel tempo, potrebbero esserci correlazioni spurie dovute a variazioni nell&rsquo;apparato sperimentale.</p><p><strong>La soluzione</strong>: Garantire che l&rsquo;apparato sia stabile nel tempo o, meglio ancora, completare l&rsquo;esperimento in un tempo così breve da escludere drift strumentali.</p><h4 id=4315-gli-esperimenti-loophole-free>4.3.1.5. Gli esperimenti &ldquo;loophole-free&rdquo;<a hidden class=anchor aria-hidden=true href=#4315-gli-esperimenti-loophole-free>#</a></h4><p>Il vero traguardo è stato raggiunto nel <strong>2015</strong>, quando tre gruppi indipendenti riuscirono a realizzare esperimenti che chiudevano <strong>simultaneamente</strong> tutti i principali loopholes:</p><ol><li><p><strong><a href=https://www.nature.com/articles/nature15759>Delft (Olanda) - Hensen et al</a>.</strong>: usarono due <strong>centri di colore in diamante</strong> (difetti nella struttura cristallina) separati da 1.3 km, connessi tramite entanglement</p><ul><li>✓ Locality loophole chiuso (distanza 1.3 km)</li><li>✓ Detection loophole chiuso (efficienza > 90%)</li></ul></li><li><p><strong><a href=https://arxiv.org/abs/1511.03190>Vienna (Austria) - Giustina et al</a>.</strong>: usarono <strong>fotoni entangled</strong> con rivelatori superconduttori</p><ul><li>✓ Locality loophole chiuso</li><li>✓ Detection loophole chiuso (efficienza 75%)</li></ul></li><li><p><strong><a href=https://www.nist.gov/news-events/news/2025/06/nist-and-partners-use-quantum-mechanics-make-factory-random-numbers>Boulder, Colorado (USA) - Shalm et al</a>.</strong>: usarono <strong>fotoni entangled</strong> separati da 185 metri</p><ul><li>✓ Locality loophole chiuso</li><li>✓ Detection loophole chiuso (efficienza 75%)</li></ul></li></ol><p>Questi esperimenti hanno definitivamente dimostrato che <strong>non è possibile salvare il realismo locale</strong>: la natura viola veramente le disuguaglianze di Bell, e non si tratta di un artefatto sperimentale.</p><h4 id=4316-rimangono-ancora-loopholes-aperti>4.3.1.6. Rimangono ancora loopholes aperti?<a hidden class=anchor aria-hidden=true href=#4316-rimangono-ancora-loopholes-aperti>#</a></h4><p>Dal punto di vista pratico, <strong>no</strong>: gli esperimenti moderni sono convincenti oltre ogni ragionevole dubbio. Tuttavia, dal punto di vista filosofico, esiste ancora una &ldquo;scappatoia&rdquo; teorica estremamente speculativa:</p><p>Si tratta del cosiddetto <strong>Superdeterminismo</strong>: l&rsquo;ipotesi che <em>tutto</em> nell&rsquo;universo sia predeterminato dal Big Bang, incluse le scelte degli sperimentatori e i risultati delle misure. In questo scenario estremo, non esisterebbe il libero arbitrio nemmeno in senso operativo. Questa posizione è considerata dalla maggior parte dei fisici come un&rsquo;ipotesi non falsificabile e quindi non scientifica.</p><p>In conclusione, il consenso scientifico è unanime: le disuguaglianze di Bell sono violate, il realismo locale è incompatibile con la natura, e gli esperimenti che lo hanno dimostrato meritavano pienamente il Premio Nobel 2022.</p><h1 id=5-le-basi-del-quantum-computing>5. Le basi del Quantum Computing<a hidden class=anchor aria-hidden=true href=#5-le-basi-del-quantum-computing>#</a></h1><h2 id=51-qubit-e-porte-quantistiche>5.1. Qubit e porte quantistiche<a hidden class=anchor aria-hidden=true href=#51-qubit-e-porte-quantistiche>#</a></h2><p>Nel quantum computing, l&rsquo;informazione è codificata in qubit invece che in bit classici. I qubit possono essere implementati fisicamente in vari modi: spin di elettroni, fotoni polarizzati, stati energetici di atomi intrappolati, ecc.</p><p>Le operazioni sui qubit vengono eseguite attraverso <strong>porte quantistiche</strong>, che sono l&rsquo;analogo delle porte logiche classiche (AND, OR, NOT, ecc.). Le porte quantistiche più comuni sono:</p><ul><li><strong>Porta X</strong>: simile al NOT classico, scambia gli stati |0⟩ e |1⟩</li><li><strong>Porta H (Hadamard)</strong>: crea una sovrapposizione equiprobabile tra |0⟩ e |1⟩</li><li><strong>Porta CNOT</strong>: porta a due qubit che inverte il secondo qubit se il primo è |1⟩</li><li><strong>Porte di rotazione</strong>: permettono di manipolare lo stato del qubit con precisione</li></ul><h2 id=52-circuiti-quantistici>5.2. Circuiti quantistici<a hidden class=anchor aria-hidden=true href=#52-circuiti-quantistici>#</a></h2><p>Un programma quantistico è rappresentato come un <strong>circuito quantistico</strong>, una sequenza di porte quantistiche applicate a uno o più qubit. A differenza dei circuiti classici, i circuiti quantistici sono reversibili (tranne la misura, che è irreversibile).</p><p>Per creare entanglement tra due qubit, tipicamente si usa una combinazione di porta Hadamard e CNOT:</p><ol><li>Si applica una porta H al primo qubit per creare una sovrapposizione</li><li>Si applica una porta CNOT usando il primo qubit come controllo e il secondo come target</li></ol><p>Questo crea uno stato di Bell, completamente entangled.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nf>q0</span><span class=o>:</span> ──<span class=n>H</span>──■──
</span></span><span class=line><span class=cl>         │
</span></span><span class=line><span class=cl><span class=nf>q1</span><span class=o>:</span> ─────<span class=n>X</span>──
</span></span></code></pre></div><h2 id=53-piattaforme-di-quantum-computing>5.3. Piattaforme di Quantum Computing<a hidden class=anchor aria-hidden=true href=#53-piattaforme-di-quantum-computing>#</a></h2><p>Oggi esistono diverse piattaforme che permettono di eseguire veri e propri programmi su computer quantistici reali, tra cui ad esempio:</p><ul><li><strong>IBM Quantum Experience</strong>: permette di accedere gratuitamente a computer quantistici reali di IBM</li><li><strong>Amazon Braket</strong>: il servizio di quantum computing di AWS</li><li><strong>Google Quantum AI</strong>: la piattaforma di Google per il quantum computing</li><li><strong>Simulatori locali</strong>: librerie come Qiskit, Cirq, Q# permettono di simulare circuiti quantistici sul proprio computer</li></ul><h1 id=6-facciamo-lesperimento>6. Facciamo l&rsquo;esperimento<a hidden class=anchor aria-hidden=true href=#6-facciamo-lesperimento>#</a></h1><h2 id=61-setup-dellesperimento>6.1. Setup dell&rsquo;esperimento<a hidden class=anchor aria-hidden=true href=#61-setup-dellesperimento>#</a></h2><p>Possiamo riprodurre il test CHSH usando un computer quantistico reale o un simulatore. Useremo due qubit in stato entangled e misureremo le correlazioni secondo diverse configurazioni.</p><h3 id=ingredienti-necessari>Ingredienti necessari:<a hidden class=anchor aria-hidden=true href=#ingredienti-necessari>#</a></h3><ol><li>Una piattaforma di quantum computing (Qiskit, IBM Quantum, ecc.)</li><li>Due qubit</li><li>Circuiti quantistici per creare entanglement e eseguire rotazioni</li></ol><h2 id=62-il-circuito-quantistico>6.2. Il circuito quantistico<a hidden class=anchor aria-hidden=true href=#62-il-circuito-quantistico>#</a></h2><p>Il circuito base per il test CHSH è il seguente:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>QuantumRegister</span><span class=p>,</span> <span class=n>ClassicalRegister</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Creiamo 2 qubit e 2 bit classici per le misure</span>
</span></span><span class=line><span class=cl><span class=n>qr</span> <span class=o>=</span> <span class=n>QuantumRegister</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;q&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cr</span> <span class=o>=</span> <span class=n>ClassicalRegister</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=n>qr</span><span class=p>,</span> <span class=n>cr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 1: Creiamo uno stato di Bell entangled</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>        <span class=c1># Hadamard sul primo qubit</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=c1># CNOT per creare entanglement</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: Applichiamo le rotazioni per Alice e Bob</span>
</span></span><span class=line><span class=cl><span class=c1># (gli angoli dipendono dalla configurazione che vogliamo testare)</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>qr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># Rotazione per Alice</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=n>theta_b</span><span class=p>,</span> <span class=n>qr</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Rotazione per Bob</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: Misuriamo</span>
</span></span><span class=line><span class=cl><span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=n>qr</span><span class=p>,</span> <span class=n>cr</span><span class=p>)</span>
</span></span></code></pre></div><p>Per il test CHSH ottimale, gli angoli devono essere:</p><ul><li>$a_0 = 0°$, $a_1 = 45°$ (per Alice)</li><li>$b_0 = 22.5°$, $b_1 = -22.5°$ (per Bob)</li></ul><div class="callout callout-note"><div class=callout-title>ℹ️ Note</div><div class=callout-content>ovviamente, la misurazione deve essere ripetuta per un certo numero di volte (shots) per ottenere campioni statistici significativi su cui applicare la formula di CHSH.</div></div><style>.callout{border-left:4px solid;padding:1rem;margin:1.5rem 0;border-radius:4px;background-color:var(--callout-bg)}.callout-title{font-weight:700;margin-bottom:.5rem}.callout-note{border-color:#0969da;background-color:#ddf4ff}.callout-tip{border-color:#1a7f37;background-color:#dcffe4}.callout-important{border-color:#8250df;background-color:#fbefff}.callout-warning{border-color:#9a6700;background-color:#fff8c5}.callout-caution{border-color:#cf222e;background-color:#ffebe9}[data-theme=dark] .callout-note,.dark .callout-note{background-color:#0969da1a;color:#e6edf3}[data-theme=dark] .callout-tip,.dark .callout-tip{background-color:#1a7f371a;color:#e6edf3}[data-theme=dark] .callout-important,.dark .callout-important{background-color:#8250df1a;color:#e6edf3}[data-theme=dark] .callout-warning,.dark .callout-warning{background-color:#9a67001a;color:#e6edf3}[data-theme=dark] .callout-caution,.dark .callout-caution{background-color:#cf222e1a;color:#e6edf3}</style><h2 id=63-codice-completo>6.3. Codice completo<a hidden class=anchor aria-hidden=true href=#63-codice-completo>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_chsh_circuit</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Crea un circuito per il test CHSH con angoli specifici&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Crea stato entangled</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Rotazioni per Alice e Bob</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Misura</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>qc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calcola la correlazione E(a,b) per dati angoli&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>create_chsh_circuit</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Esegui il circuito</span>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Calcola la correlazione</span>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=c1># +1 se i bit sono uguali, -1 se diversi</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Angoli ottimali per il test CHSH (in radianti)</span>
</span></span><span class=line><span class=cl><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>b0</span><span class=p>,</span> <span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span><span class=p>,</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Calcola le 4 correlazioni</span>
</span></span><span class=line><span class=cl><span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Calcola il valore CHSH</span>
</span></span><span class=line><span class=cl><span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a0, b0) = </span><span class=si>{</span><span class=n>E_a0_b0</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a0, b1) = </span><span class=si>{</span><span class=n>E_a0_b1</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a1, b0) = </span><span class=si>{</span><span class=n>E_a1_b0</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;E(a1, b1) = </span><span class=si>{</span><span class=n>E_a1_b1</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Valore CHSH S = </span><span class=si>{</span><span class=n>S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Limite classico: |S| ≤ 2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Limite quantistico: |S| ≤ 2√2 ≈ 2.828&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>S</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>✓ Le disuguaglianze di Bell sono VIOLATE!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Einstein aveva torto: il realismo locale è incompatibile con i risultati.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>✗ Le disuguaglianze di Bell sono rispettate.&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=64-risultati-attesi>6.4. Risultati attesi<a hidden class=anchor aria-hidden=true href=#64-risultati-attesi>#</a></h2><p>Eseguendo il codice sopra, dovremmo ottenere un valore di $S$ vicino a $2\sqrt{2} \approx 2.828$, violando quindi le disuguaglianze di Bell.</p><p>In pratica, a causa del rumore e delle imperfezioni dei computer quantistici reali, potremmo ottenere valori leggermente inferiori, ma comunque superiori a 2, dimostrando la violazione del realismo locale.</p><h2 id=65-significato-degli-angoli-e-sfera-di-bloch>6.5. Significato degli angoli e sfera di Bloch<a hidden class=anchor aria-hidden=true href=#65-significato-degli-angoli-e-sfera-di-bloch>#</a></h2><p>Per capire veramente cosa stiamo facendo quando scegliamo questi angoli specifici nel test CHSH, possiamo introdurre uno strumento abbastanza intuitivo spesso utilizzato in meccanica quantistica: la <strong>sfera di Bloch</strong>.</p><h3 id=651-la-sfera-di-bloch>6.5.1. La sfera di Bloch<a hidden class=anchor aria-hidden=true href=#651-la-sfera-di-bloch>#</a></h3><p>La sfera di Bloch è una rappresentazione geometrica dello stato di un singolo qubit. Ogni punto sulla superficie della sfera rappresenta uno stato quantistico puro. I due poli della sfera rappresentano gli stati base:</p><ul><li>Polo nord: stato $|0\rangle$</li><li>Polo sud: stato $|1\rangle$</li></ul><p>Lo stato generale di un qubit può essere scritto come:
$$|\psi\rangle = \cos(\theta/2)|0\rangle + e^{i\phi}\sin(\theta/2)|1\rangle$$</p><p>dove:</p><ul><li>$\theta$ è l&rsquo;angolo polare (da 0° al polo nord a 180° al polo sud)</li><li>$\phi$ è l&rsquo;angolo azimutale (rotazione attorno all&rsquo;asse z)</li></ul><h3 id=cosa-significa-misurare-secondo-un-angolo>Cosa significa &ldquo;misurare secondo un angolo&rdquo;?<a hidden class=anchor aria-hidden=true href=#cosa-significa-misurare-secondo-un-angolo>#</a></h3><p>Immaginiamo il polarizzatore come un filtro orientabile: possiamo decidere in quale direzione orientarlo per misurare la polarizzazione del fotone.</p><p><strong>Esempio fisico con polarizzatori:</strong></p><ul><li>Alice orienta il suo polarizzatore a $a_0 = 0°$ (verticale): sta chiedendo &ldquo;il fotone è polarizzato verticalmente o orizzontalmente?&rdquo;</li><li>Alice orienta il suo polarizzatore a $a_1 = 45°$ (diagonale): sta chiedendo &ldquo;il fotone è polarizzato a 45° o a 135°?&rdquo;</li></ul><p>Ogni angolo di orientamento del polarizzatore corrisponde a una <strong>domanda diversa</strong> che facciamo al fotone.</p><p><strong>Nel quantum computing:</strong>
Siccome i computer quantistici possono misurare solo nella base standard (chiamata base Z: $|0\rangle$ e $|1\rangle$), per misurare secondo un angolo diverso dobbiamo:</p><ol><li><strong>Ruotare</strong> lo stato del qubit con l&rsquo;angolo desiderato</li><li><strong>Misurare</strong> nella base standard</li><li>Il risultato è equivalente ad aver misurato nella base ruotata</li></ol><p>In pratica, nel codice usiamo la gate <code>ry(2*θ)</code> prima della misura. Il fattore 2 è una convenzione matematica della sfera di Bloch (gli angoli fisici vengono raddoppiati nella rappresentazione matematica).</p><h3 id=652-gli-angoli-ottimali-del-test-chsh>6.5.2. Gli angoli ottimali del test CHSH<a hidden class=anchor aria-hidden=true href=#652-gli-angoli-ottimali-del-test-chsh>#</a></h3><p>Gli angoli ottimali per massimizzare la violazione delle disuguaglianze di Bell sono:</p><ul><li>Alice: $a_0 = 0°$ e $a_1 = 45°$</li><li>Bob: $b_0 = 22.5°$ e $b_1 = -22.5°$</li></ul><p>Questi angoli sono disposti simmetricamente e formano un pattern specifico sulla sfera di Bloch. La chiave è che:</p><ul><li>Le direzioni di misura di Alice ($a_0$ e $a_1$) sono separate da 45°</li><li>Le direzioni di Bob ($b_0$ e $b_1$) sono separate da 45° (da -22.5° a +22.5°)</li><li>$b_0 = 22.5°$ è esattamente a metà strada tra $a_0$ e $a_1$</li><li>$b_1 = -22.5°$ è simmetrico a $b_0$ rispetto all&rsquo;asse a₀</li></ul><p>La configurazione crea una disposizione simmetrica dove:</p><ul><li>La differenza angolare tra $a_0$ e $b_0$ è 22.5°</li><li>La differenza angolare tra $a_0$ e $b_1$ è 22.5° (in valore assoluto)</li><li>La differenza angolare tra $a_1$ e $b_0$ è 22.5°</li><li>La differenza angolare tra $a_1$ e $b_1$ è 67.5°</li></ul><p>Questa simmetria, con tre differenze di 22.5° e una di 67.5°, massimizza le correlazioni quantistiche che violano le disuguaglianze di Bell.</p><h3 id=653-visualizzazione-degli-angoli-ottimali>6.5.3. Visualizzazione degli angoli ottimali<a hidden class=anchor aria-hidden=true href=#653-visualizzazione-degli-angoli-ottimali>#</a></h3><h4 id=6531-versione-interattiva-plotly---per-jupyter-notebook>6.5.3.1. Versione interattiva (Plotly - per Jupyter Notebook)<a hidden class=anchor aria-hidden=true href=#6531-versione-interattiva-plotly---per-jupyter-notebook>#</a></h4><p>Per una visualizzazione <strong>interattiva</strong> degli angoli ottimali all&rsquo;interno della sfera di Bloch possiamo usare questo codice basato Plotly (ideale per Jupyter Notebook):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>plotly.graph_objects</span> <span class=k>as</span> <span class=nn>go</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>angle_to_bloch_vector</span><span class=p>(</span><span class=n>theta</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Converte angoli (theta, phi) in un vettore sulla sfera di Bloch&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>theta_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>theta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>phi_rad</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>radians</span><span class=p>(</span><span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>phi_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>phi_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>theta_rad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_sphere_mesh</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Crea la mesh per la sfera di Bloch&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>size</span><span class=p>(</span><span class=n>u</span><span class=p>)),</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>plot_interactive_bloch_sphere</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Crea una visualizzazione interattiva della sfera di Bloch con angoli CHSH&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fig</span> <span class=o>=</span> <span class=n>go</span><span class=o>.</span><span class=n>Figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Aggiungiamo la sfera di Bloch</span>
</span></span><span class=line><span class=cl>    <span class=n>x_sphere</span><span class=p>,</span> <span class=n>y_sphere</span><span class=p>,</span> <span class=n>z_sphere</span> <span class=o>=</span> <span class=n>create_sphere_mesh</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Surface</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=n>x_sphere</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_sphere</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=n>z_sphere</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>opacity</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>colorscale</span><span class=o>=</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;lightgray&#39;</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;lightgray&#39;</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>        <span class=n>showscale</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Aggiungiamo gli assi coordinati</span>
</span></span><span class=line><span class=cl>    <span class=n>axis_length</span> <span class=o>=</span> <span class=mf>1.3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Asse X</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;&lt;b&gt;X&lt;/b&gt;&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Asse Y</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;&lt;b&gt;Y&lt;/b&gt;&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkgray&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Asse Z</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=o>-</span><span class=n>axis_length</span><span class=p>,</span> <span class=n>axis_length</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>dash</span><span class=o>=</span><span class=s1>&#39;dash&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>hoverinfo</span><span class=o>=</span><span class=s1>&#39;skip&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Etichette |0⟩ e |1⟩</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>z_pos</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=p>[(</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>,</span> <span class=s1>&#39;&lt;b&gt;|0⟩&lt;/b&gt;&#39;</span><span class=p>),</span> <span class=p>(</span><span class=o>-</span><span class=n>axis_length</span><span class=o>*</span><span class=mf>1.05</span><span class=p>,</span> <span class=s1>&#39;&lt;b&gt;|1⟩&lt;/b&gt;&#39;</span><span class=p>)]:</span>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z_pos</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>label</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Angoli ottimali CHSH</span>
</span></span><span class=line><span class=cl>    <span class=n>alice_angles</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>45</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>bob_angles</span> <span class=o>=</span> <span class=p>[</span><span class=mf>22.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>22.5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>colors_alice</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;darkred&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>colors_bob</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;darkblue&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>labels_alice</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;a₀ (0°)&#39;</span><span class=p>,</span> <span class=s1>&#39;a₁ (45°)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>labels_bob</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;b₀ (22.5°)&#39;</span><span class=p>,</span> <span class=s1>&#39;b₁ (-22.5°)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Aggiungiamo i vettori di Alice</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>angle</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>alice_angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span> <span class=o>=</span> <span class=n>angle_to_bloch_vector</span><span class=p>(</span><span class=n>angle</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>y</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines+markers&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors_alice</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>8</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>marker</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>hovertemplate</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>}</span><span class=s1>&lt;extra&gt;&lt;/extra&gt;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>x</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>y</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>labels_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors_alice</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Aggiungiamo i vettori di Bob</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>angle</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>bob_angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span> <span class=o>=</span> <span class=n>angle_to_bloch_vector</span><span class=p>(</span><span class=n>angle</span><span class=p>,</span> <span class=n>phi</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>y</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;lines+markers&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=n>colors_bob</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>width</span><span class=o>=</span><span class=mi>8</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>marker</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>hovertemplate</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>}</span><span class=s1>&lt;extra&gt;&lt;/extra&gt;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>fig</span><span class=o>.</span><span class=n>add_trace</span><span class=p>(</span><span class=n>go</span><span class=o>.</span><span class=n>Scatter3d</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=n>x</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>y</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span> <span class=n>z</span><span class=o>=</span><span class=p>[</span><span class=n>z</span><span class=o>*</span><span class=mf>1.25</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span><span class=o>=</span><span class=p>[</span><span class=n>labels_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>            <span class=n>textfont</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors_bob</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>showlegend</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Layout</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>update_layout</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>title</span><span class=o>=</span><span class=s1>&#39;Sfera di Bloch Interattiva: Angoli Ottimali CHSH&lt;br&gt;&#39;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s1>&#39;&lt;sub&gt;Ruota con il mouse • Zoom con la rotellina • Pan con Shift+drag&lt;/sub&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>scene</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>xaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>yaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>zaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>showbackground</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>showticklabels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>aspectmode</span><span class=o>=</span><span class=s1>&#39;cube&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>camera</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>eye</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=mf>1.2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>height</span><span class=o>=</span><span class=mi>700</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>showlegend</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fig</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Creiamo e mostra il grafico interattivo</span>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plot_interactive_bloch_sphere</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># fig.write_html(&#34;bloch_sphere_interactive.html&#34;)</span>
</span></span></code></pre></div><h3 id=654-interpretazione-dei-grafici>6.5.4. Interpretazione dei grafici<a hidden class=anchor aria-hidden=true href=#654-interpretazione-dei-grafici>#</a></h3><p><a href=/images/2025/bell/image-12.png><img src=/images/2025/bell/image-12.png alt="Visualizzazione degli angoli ottimali nella Sfera di Bloch"></a></p><p><strong>Sfera di Bloch (3D e 2D)</strong>: Disposizione geometrica degli angoli di misura. Si nota la simmetria della configurazione: $b_0$ (22.5°) è posizionato esattamente a metà strada tra $a_0$ (0°) e $a_1$ (45°), mentre $b_1$ (-22.5°) è simmetrico rispetto all&rsquo;origine.</p><p><a href=/images/2025/bell/image-3.png><img src=/images/2025/bell/image-3.png alt="Correlazione vs Differenza Angolare"></a></p><ul><li><strong>Correlazione vs Differenza Angolare</strong>: Mostra come la correlazione quantistica $E(\theta) = \cos(2\theta)$ dipenda dalla differenza angolare. Gli angoli CHSH sono scelti per ottenere valori specifici di correlazione che massimizzano S.</li><li><strong>Ottimizzazione del valore CHSH</strong>: Dimostra visivamente che la configurazione con $a_1 = 45°$ (e conseguentemente $b_0 = 22.5°$, $b_1 = -22.5°$) massimizza effettivamente la violazione delle disuguaglianze di Bell.</li></ul><p>Nell&rsquo;esperimento CHSH le direzioni di misura sono disposte simmetricamente in modo da sfruttare al massimo le correlazioni quantistiche permesse dall&rsquo;entanglement, superando il limite classico di 2 e raggiungendo il limite di Tsirelson di $2\sqrt{2}$.</p><h2 id=66-cosa-significa-questo-risultato>6.6. Cosa significa questo risultato?<a hidden class=anchor aria-hidden=true href=#66-cosa-significa-questo-risultato>#</a></h2><p>La violazione delle disuguaglianze di Bell ci dice che:</p><blockquote><p><strong>Non può esistere una descrizione del mondo fisico che soddisfi i principi di località e realismo.</strong></p></blockquote><p>In altre parole:</p><ul><li>O esistono &ldquo;azioni a distanza&rdquo; che permettono alle particelle entangled di &ldquo;comunicare&rdquo; istantaneamente (violazione della località)</li><li>O le proprietà fisiche non esistono prima della misura, ma vengono create dall&rsquo;atto stesso dell&rsquo;osservazione (violazione del realismo)</li></ul><p>La maggior parte dei fisici oggi accetta l&rsquo;interpretazione secondo cui è il <strong>realismo</strong> ad essere violato, mentre la località è preservata (anche se in modo sottile).</p><h2 id=67-altri-esperimenti-interattivi>6.7. Altri esperimenti interattivi<a hidden class=anchor aria-hidden=true href=#67-altri-esperimenti-interattivi>#</a></h2><p>Ora che abbiamo visto il test CHSH di base, esploriamo alcuni esperimenti aggiuntivi che ci aiutano a comprendere meglio la violazione delle disuguaglianze di Bell e le differenze tra meccanica quantistica e realismo locale.</p><h3 id=671-variazione-del-valore-chsh-con-gli-angoli>6.7.1. Variazione del valore CHSH con gli angoli<a hidden class=anchor aria-hidden=true href=#671-variazione-del-valore-chsh-con-gli-angoli>#</a></h3><p>Questo esperimento mostra come il valore CHSH varia al variare dell&rsquo;angolo $a_1$ di Alice, mantenendo fissi gli altri angoli. Ci permette di vedere graficamente perché 45° è l&rsquo;angolo ottimale.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_chsh_value</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calcola il valore CHSH per una data configurazione di angoli&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>S</span><span class=p>,</span> <span class=p>(</span><span class=n>E_a0_b0</span><span class=p>,</span> <span class=n>E_a0_b1</span><span class=p>,</span> <span class=n>E_a1_b0</span><span class=p>,</span> <span class=n>E_a1_b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Varia l&#39;angolo a1 da 0 a 90 gradi</span>
</span></span><span class=line><span class=cl><span class=n>a1_values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_values_quantum</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>s_values_classical</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>a1_values</span><span class=p>)</span>  <span class=c1># Limite classico</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Calcolando valori CHSH per diversi angoli...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a1</span> <span class=ow>in</span> <span class=n>a1_values</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Angoli fissi</span>
</span></span><span class=line><span class=cl>    <span class=n>a0</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>b0</span> <span class=o>=</span> <span class=n>a1</span> <span class=o>/</span> <span class=mi>2</span>  <span class=c1># Ottimale: a metà strada tra a0 e a1</span>
</span></span><span class=line><span class=cl>    <span class=n>b1</span> <span class=o>=</span> <span class=o>-</span><span class=n>a1</span> <span class=o>/</span> <span class=mi>2</span>  <span class=c1># Simmetrico rispetto a a0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>compute_chsh_value</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s_values_quantum</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;a1 = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1</span><span class=p>)</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>°, S = </span><span class=si>{</span><span class=n>S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Grafico</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_values</span><span class=p>),</span> <span class=n>s_values_quantum</span><span class=p>,</span> <span class=s1>&#39;b-o&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Simulazione Quantistica&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Limite Classico (|S| ≤ 2)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;g&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Limite di Tsirelson (2√2 ≈ </span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;orange&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Angolo ottimale (45°)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Angolo a₁ (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Valore CHSH (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Violazione delle Disuguaglianze di Bell al Variare dell</span><span class=se>\&#39;</span><span class=s1>Angolo&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_angle_variation.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Massima violazione a 45°: S ≈ </span><span class=si>{</span><span class=nb>max</span><span class=p>(</span><span class=n>s_values_quantum</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Limite teorico: 2√2 ≈ </span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Risultato atteso</strong>: Il grafico mostra che la massima violazione si ottiene proprio a 45°, dove S raggiunge circa 2.828.</p><h3 id=672-confronto-quantistico-vs-classico-heatmap-delle-correlazioni>6.7.2. Confronto quantistico vs classico: heatmap delle correlazioni<a hidden class=anchor aria-hidden=true href=#672-confronto-quantistico-vs-classico-heatmap-delle-correlazioni>#</a></h3><p>Questo esperimento visualizza le correlazioni quantistiche e classiche come heatmap, permettendo di vedere chiaramente la differenza.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_quantum_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calcola la correlazione quantistica per due angoli&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_classical_correlation</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Correlazione classica massima possibile per una differenza angolare.
</span></span></span><span class=line><span class=cl><span class=s2>    Con variabili nascoste locali, la correlazione massima è limitata.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Modello classico: correlazione lineare decrescente</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=nb>abs</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Griglia di angoli</span>
</span></span><span class=line><span class=cl><span class=n>angles</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>angles_deg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>angles</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Matrici per le correlazioni</span>
</span></span><span class=line><span class=cl><span class=n>quantum_corr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>classical_corr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Calcolando correlazioni quantistiche e classiche...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>theta_a</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>theta_b</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>angles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Correlazione quantistica</span>
</span></span><span class=line><span class=cl>        <span class=n>quantum_corr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>compute_quantum_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Correlazione classica teorica</span>
</span></span><span class=line><span class=cl>        <span class=n>theta_diff</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>theta_a</span> <span class=o>-</span> <span class=n>theta_b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>classical_corr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>compute_classical_correlation</span><span class=p>(</span><span class=n>theta_diff</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Progresso: </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>angles</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Visualizzazione</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>,</span> <span class=n>ax3</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Heatmap quantistica</span>
</span></span><span class=line><span class=cl><span class=n>im1</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>quantum_corr</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdBu_r&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angolo Bob (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angolo Alice (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Correlazioni Quantistiche</span><span class=se>\n</span><span class=s1>(Simulazione)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im1</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax1</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Correlazione E(a,b)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Heatmap classica</span>
</span></span><span class=line><span class=cl><span class=n>im2</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>classical_corr</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdBu_r&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angolo Bob (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angolo Alice (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Correlazioni Classiche</span><span class=se>\n</span><span class=s1>(Variabili Nascoste Locali)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im2</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Correlazione E(a,b)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Differenza</span>
</span></span><span class=line><span class=cl><span class=n>difference</span> <span class=o>=</span> <span class=n>quantum_corr</span> <span class=o>-</span> <span class=n>classical_corr</span>
</span></span><span class=line><span class=cl><span class=n>im3</span> <span class=o>=</span> <span class=n>ax3</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>difference</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;seismic&#39;</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vmin</span><span class=o>=-</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;lower&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angolo Bob (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angolo Alice (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Differenza</span><span class=se>\n</span><span class=s1>(Quantistica - Classica)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>angles_deg</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax3</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>a</span><span class=si>:</span><span class=s1>.0f</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>angles_deg</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im3</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax3</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Differenza&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;correlation_heatmaps.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Le zone rosse nella mappa delle differenze mostrano dove&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;le correlazioni quantistiche superano quelle classiche!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=/images/2025/bell/image-13.png><img src=/images/2025/bell/image-13.png alt="alt text"></a>
<strong>Interpretazione</strong>: Le heatmap mostrano come le correlazioni quantistiche (che seguono $\cos(2\theta)$) differiscano significativamente da quelle classiche, soprattutto per angoli intermedi.</p><h3 id=673-esplorazione-interattiva-dei-parametri-chsh>6.7.3. Esplorazione interattiva dei parametri CHSH<a hidden class=anchor aria-hidden=true href=#673-esplorazione-interattiva-dei-parametri-chsh>#</a></h3><p>Questo esperimento crea un&rsquo;analisi parametrica completa dello spazio degli angoli CHSH.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib.widgets</span> <span class=kn>import</span> <span class=n>Slider</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_single_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calcola una singola correlazione&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Analisi 2D: variazione simultanea di a1 e b0</span>
</span></span><span class=line><span class=cl><span class=n>a1_range</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b0_range</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>S_matrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>b0_range</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Esplorazione dello spazio dei parametri CHSH...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Questo può richiedere qualche minuto...</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>a1</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>a1_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=n>b0</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>b0_range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a0</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>b1</span> <span class=o>=</span> <span class=o>-</span><span class=n>b0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_single_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>2048</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>        <span class=n>S_matrix</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>S</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>5</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Progresso: </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>a1_range</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Visualizzazione 3D</span>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 1: Heatmap 2D</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>(</span><span class=mi>121</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>im</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>contourf</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=n>S_matrix</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=n>levels</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdYlGn&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>contour</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>),</span> <span class=n>S_matrix</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>levels</span><span class=o>=</span><span class=p>[</span><span class=mf>2.0</span><span class=p>],</span> <span class=n>colors</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>linestyles</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=mf>22.5</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=s1>&#39;b*&#39;</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Configurazione ottimale&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angolo b₀ (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angolo a₁ (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Valore CHSH nello Spazio dei Parametri&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>im</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax1</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;Limite classico&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 2: Superficie 3D</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>(</span><span class=mi>122</span><span class=p>,</span> <span class=n>projection</span><span class=o>=</span><span class=s1>&#39;3d&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>B0</span><span class=p>,</span> <span class=n>A1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>surf</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>plot_surface</span><span class=p>(</span><span class=n>B0</span><span class=p>,</span> <span class=n>A1</span><span class=p>,</span> <span class=n>S_matrix</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;RdYlGn&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.9</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Piano del limite classico</span>
</span></span><span class=line><span class=cl><span class=n>xx</span><span class=p>,</span> <span class=n>yy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>zz</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>xx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>plot_surface</span><span class=p>(</span><span class=n>xx</span><span class=p>,</span> <span class=n>yy</span><span class=p>,</span> <span class=n>zz</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Angolo b₀ (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Angolo a₁ (gradi)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_zlabel</span><span class=p>(</span><span class=s1>&#39;Valore CHSH (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Superficie CHSH 3D&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>view_init</span><span class=p>(</span><span class=n>elev</span><span class=o>=</span><span class=mi>25</span><span class=p>,</span> <span class=n>azim</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>surf</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax2</span><span class=p>,</span> <span class=n>shrink</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>aspect</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_parameter_space.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trova il massimo</span>
</span></span><span class=line><span class=cl><span class=n>max_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unravel_index</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>S_matrix</span><span class=p>),</span> <span class=n>S_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>max_a1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>a1_range</span><span class=p>[</span><span class=n>max_idx</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>max_b0</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>degrees</span><span class=p>(</span><span class=n>b0_range</span><span class=p>[</span><span class=n>max_idx</span><span class=p>[</span><span class=mi>1</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>max_S</span> <span class=o>=</span> <span class=n>S_matrix</span><span class=p>[</span><span class=n>max_idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Configurazione ottimale trovata:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  a₁ = </span><span class=si>{</span><span class=n>max_a1</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>°&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  b₀ = </span><span class=si>{</span><span class=n>max_b0</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>°&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  S = </span><span class=si>{</span><span class=n>max_S</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Valore teorico ottimale: a₁=45°, b₀=22.5°, S=2√2≈2.828&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>50</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=/images/2025/bell/image-14.png><img src=/images/2025/bell/image-14.png alt="alt text"></a>
<strong>Risultato</strong>: Questo grafico mostra la &ldquo;montagna&rdquo; del valore CHSH nello spazio dei parametri, con il picco proprio alla configurazione ottimale (45°, 22.5°).</p><h3 id=674-simulazione-con-rumore-realistico>6.7.4. Simulazione con rumore realistico<a hidden class=anchor aria-hidden=true href=#674-simulazione-con-rumore-realistico>#</a></h3><p>Nell&rsquo;ultimo esperimento, aggiungiamo rumore per simulare le imperfezioni dei computer quantistici reali.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit</span> <span class=kn>import</span> <span class=n>QuantumCircuit</span><span class=p>,</span> <span class=n>transpile</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer</span> <span class=kn>import</span> <span class=n>AerSimulator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qiskit_aer.noise</span> <span class=kn>import</span> <span class=n>NoiseModel</span><span class=p>,</span> <span class=n>depolarizing_error</span><span class=p>,</span> <span class=n>thermal_relaxation_error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_noisy_simulator</span><span class=p>(</span><span class=n>error_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>t1</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>t2</span><span class=o>=</span><span class=mi>70</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Crea un simulatore con rumore realistico.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        error_rate: probabilità di errore per gate (depolarizing)
</span></span></span><span class=line><span class=cl><span class=s2>        t1: tempo di rilassamento T1 (microseconds)
</span></span></span><span class=line><span class=cl><span class=s2>        t2: tempo di decoerenza T2 (microseconds)
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span> <span class=o>=</span> <span class=n>NoiseModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Errore di depolarizzazione sui gate</span>
</span></span><span class=line><span class=cl>    <span class=n>error_gate1</span> <span class=o>=</span> <span class=n>depolarizing_error</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>error_gate2</span> <span class=o>=</span> <span class=n>depolarizing_error</span><span class=p>(</span><span class=n>error_rate</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Aggiungi errori ai gate</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span><span class=o>.</span><span class=n>add_all_qubit_quantum_error</span><span class=p>(</span><span class=n>error_gate1</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;h&#39;</span><span class=p>,</span> <span class=s1>&#39;ry&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span><span class=o>.</span><span class=n>add_all_qubit_quantum_error</span><span class=p>(</span><span class=n>error_gate2</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;cx&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Errore di rilassamento termico</span>
</span></span><span class=line><span class=cl>    <span class=c1># gate_times = {&#39;h&#39;: 50, &#39;ry&#39;: 50, &#39;cx&#39;: 200, &#39;measure&#39;: 1000}  # in nanoseconds</span>
</span></span><span class=line><span class=cl>    <span class=c1># thermal_error = thermal_relaxation_error(t1*1000, t2*1000, gate_times[&#39;cx&#39;])</span>
</span></span><span class=line><span class=cl>    <span class=c1># noise_model.add_all_qubit_quantum_error(thermal_error, [&#39;cx&#39;])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>noise_model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_chsh_with_noise</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Esegue il test CHSH con un dato livello di rumore&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>noise_model</span> <span class=o>=</span> <span class=n>create_noisy_simulator</span><span class=p>(</span><span class=n>error_rate</span><span class=o>=</span><span class=n>error_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>simulator</span> <span class=o>=</span> <span class=n>AerSimulator</span><span class=p>(</span><span class=n>noise_model</span><span class=o>=</span><span class=n>noise_model</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Angoli ottimali</span>
</span></span><span class=line><span class=cl>    <span class=n>a0</span><span class=p>,</span> <span class=n>a1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=n>b0</span><span class=p>,</span> <span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span><span class=p>,</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>compute_correlation</span><span class=p>(</span><span class=n>theta_a</span><span class=p>,</span> <span class=n>theta_b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span> <span class=o>=</span> <span class=n>QuantumCircuit</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>h</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>cx</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_a</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>ry</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>theta_b</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>qc</span><span class=o>.</span><span class=n>measure</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>compiled_circuit</span> <span class=o>=</span> <span class=n>transpile</span><span class=p>(</span><span class=n>qc</span><span class=p>,</span> <span class=n>simulator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>simulator</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>compiled_circuit</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>)</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>counts</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>get_counts</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>outcome</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>parity</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>outcome</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>correlation</span> <span class=o>+=</span> <span class=n>parity</span> <span class=o>*</span> <span class=n>count</span> <span class=o>/</span> <span class=n>shots</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a0_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a0</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b0</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>E_a1_b1</span> <span class=o>=</span> <span class=n>compute_correlation</span><span class=p>(</span><span class=n>a1</span><span class=p>,</span> <span class=n>b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>S</span> <span class=o>=</span> <span class=n>E_a0_b0</span> <span class=o>+</span> <span class=n>E_a0_b1</span> <span class=o>+</span> <span class=n>E_a1_b0</span> <span class=o>-</span> <span class=n>E_a1_b1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>S</span><span class=p>,</span> <span class=p>(</span><span class=n>E_a0_b0</span><span class=p>,</span> <span class=n>E_a0_b1</span><span class=p>,</span> <span class=n>E_a1_b0</span><span class=p>,</span> <span class=n>E_a1_b1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test con diversi livelli di rumore</span>
</span></span><span class=line><span class=cl><span class=n>error_rates</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_values_noisy</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>s_std</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Simulazione con rumore realistico...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Questo simula le imperfezioni dei computer quantistici reali.</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>error_rate</span> <span class=ow>in</span> <span class=n>error_rates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Esegui multiple volte per stimare la varianza</span>
</span></span><span class=line><span class=cl>    <span class=n>s_trials</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>S</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>run_chsh_with_noise</span><span class=p>(</span><span class=n>error_rate</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>s_trials</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>s_values_noisy</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>s_trials</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>s_std</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>s_trials</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error rate: </span><span class=si>{</span><span class=n>error_rate</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% → S = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>s_trials</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ± </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>s_trials</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Visualizzazione</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 1: S vs Error Rate</span>
</span></span><span class=line><span class=cl><span class=n>s_values_noisy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s_std</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>s_std</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>errorbar</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>s_values_noisy</span><span class=p>,</span> <span class=n>yerr</span><span class=o>=</span><span class=n>s_std</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;o-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>color</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Simulazione con rumore&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Limite classico (S=2)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Limite ideale (S=2√2≈</span><span class=si>{</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>fill_between</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>s_values_noisy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>where</span><span class=o>=</span><span class=p>(</span><span class=n>s_values_noisy</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>),</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;green&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Zona di violazione&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Tasso di errore per gate (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Valore CHSH (S)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Effetto del Rumore sulla Violazione di Bell&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax1</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>([</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Subplot 2: Violazione vs Error Rate</span>
</span></span><span class=line><span class=cl><span class=n>violation</span> <span class=o>=</span> <span class=n>s_values_noisy</span> <span class=o>-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>error_rates</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>violation</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;green&#39;</span> <span class=k>if</span> <span class=n>v</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s1>&#39;red&#39;</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>violation</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Tasso di errore per gate (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Violazione (S - 2)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Margine di Violazione delle Disuguaglianze di Bell&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trova il punto critico dove S scende sotto 2</span>
</span></span><span class=line><span class=cl><span class=n>critical_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>s_values_noisy</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>critical_idx</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>critical_error</span> <span class=o>=</span> <span class=n>error_rates</span><span class=p>[</span><span class=n>critical_idx</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>critical_error</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>critical_error</span><span class=p>,</span> <span class=n>ax2</span><span class=o>.</span><span class=n>get_ylim</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s1>&#39;Punto critico</span><span class=se>\n</span><span class=s1>~</span><span class=si>{</span><span class=n>critical_error</span><span class=si>:</span><span class=s1>.1f</span><span class=si>}</span><span class=s1>%&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>bbox</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>boxstyle</span><span class=o>=</span><span class=s1>&#39;round&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>facecolor</span><span class=o>=</span><span class=s1>&#39;wheat&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;chsh_with_noise.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>60</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;RISULTATI:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Con rumore 0%: S ≈ </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> (ideale)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Con rumore 1%: S ≈ </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span><span class=o>*</span><span class=mf>0.2</span><span class=p>)]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Con rumore 3%: S ≈ </span><span class=si>{</span><span class=n>s_values_noisy</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>s_values_noisy</span><span class=p>)</span><span class=o>*</span><span class=mf>0.6</span><span class=p>)]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>critical_idx</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - Limite critico: ~</span><span class=si>{</span><span class=n>critical_error</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% (S scende sotto 2)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - La violazione persiste fino a </span><span class=si>{</span><span class=n>error_rates</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>60</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><a href=/images/2025/bell/image-15.png><img src=/images/2025/bell/image-15.png alt="alt text"></a>
<strong>Interpretazione</strong>: Questo grafico mostra quanto siano delicati i computer quantistici. Anche piccoli errori riducono la violazione di Bell, ma fortunatamente serve un errore abbastanza alto (>8%) prima che la violazione scompaia completamente.</p><h1 id=7-conclusioni-e-riflessioni-filosofiche>7. Conclusioni e riflessioni filosofiche<a hidden class=anchor aria-hidden=true href=#7-conclusioni-e-riflessioni-filosofiche>#</a></h1><h2 id=71-chi-aveva-ragione>7.1. Chi aveva ragione?<a hidden class=anchor aria-hidden=true href=#71-chi-aveva-ragione>#</a></h2><p>Il dibattito Einstein-Bohr è stato uno dei più affascinanti della storia della fisica. Da un punto di vista puramente scientifico, possiamo dire che <strong>Bohr aveva ragione</strong>: la meccanica quantistica è una teoria completa e corretta, e i fenomeni quantistici non possono essere spiegati con teorie a variabili nascoste locali.</p><p>Il destino di Einstein è stato per certi versi paradossale: pur essendo riconosciuto come uno dei più grandi fisici di tutti i tempi, è stato spesso incompreso ed isolato della comunità scientifica &ldquo;mainstream&rdquo;, sia nelle fasi iniziali della sua carriera (con la relatività) sia in quelle finali (con la meccanica quantistica).</p><p>In ogni caso, credo che la formulazione stessa del problema EPR, che poi ha portato agli studi di Bell, gli esperimenti di Aspect e di molti altri, sia stato anche stavolta un contributo enorme alla fisica e al sapere umano.</p><h2 id=72-la-natura-della-realtà>7.2. La natura della realtà<a hidden class=anchor aria-hidden=true href=#72-la-natura-della-realtà>#</a></h2><p>Dal punto di vista filosofico, gli esperimenti di Bell ci insegnano qualcosa di profondo sulla natura della realtà:</p><ol><li><strong>Il mondo non è fatto di &ldquo;cose&rdquo; con proprietà definite</strong> che esistono indipendentemente dall&rsquo;osservazione</li><li><strong>La realtà emerge dall&rsquo;interazione</strong> tra sistema osservato e apparato di misura</li><li><strong>Non possiamo separare completamente l&rsquo;osservatore dall&rsquo;osservato</strong></li></ol><p>Questo non significa che la realtà &ldquo;non esiste&rdquo; o che sia puramente soggettiva, ma piuttosto che la nostra intuizione classica su cosa significhi &ldquo;esistere&rdquo; deve essere profondamente rivista alla luce dei fenomeni quantistici.</p><p>In un certo senso, quella che noi identifichiamo come &ldquo;realtà&rdquo; è un costrutto emergente e non prescinde dalle nostre interazioni con il mondo.</p><hr><h2 id=riferimenti>Riferimenti<a hidden class=anchor aria-hidden=true href=#riferimenti>#</a></h2><ul><li>Articolo originale di Bell (1964) &ldquo;<a href=https://cds.cern.ch/record/111654/files/vol1p195-200_001.pdf>ON THE EINSTEIN PODOLSKY ROSEN PARADOX</a>&rdquo;</li><li><a href=https://www.nobelprize.org/prizes/physics/2022/summary/>Nobel Prize 2022 - Announcement</a></li><li><a href=https://qiskit.org/documentation/>Qiskit Documentation</a></li><li><a href=https://quantum-computing.ibm.com/>IBM Quantum Experience</a></li><li><a href=https://physics.aps.org/articles/v8/123>Closing the Door on Einstein and Bohr’s Quantum Debate</a></li><li><a href=https://arxiv.org/html/2501.01434v1>Simulating Bell&rsquo;s inequalities with Qibo</a></li></ul><section id=comments><script src=https://giscus.app/client.js data-repo=c-daniele/c-daniele.github.io data-repo-id=R_kgDOKIObxg data-category=Announcements data-category-id=DIC_kwDOKIObxs4Cu2th data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=it crossorigin=anonymous async></script></section></div><footer class=post-footer><ul class=post-tags><li><a href=https://c-daniele.github.io/it/tags/einstein/>Einstein</a></li><li><a href=https://c-daniele.github.io/it/tags/bell/>Bell</a></li><li><a href=https://c-daniele.github.io/it/tags/quantum-mechanics/>Quantum Mechanics</a></li><li><a href=https://c-daniele.github.io/it/tags/entanglement/>Entanglement</a></li></ul><nav class=paginav><a class=next href=https://c-daniele.github.io/it/posts/2025-08-31-alphaagents-a2a/><span class=title>Successivo »</span><br><span>AlphaAgents: Implementazione Multi-Agent A2A per Analisi Finanziaria Collaborativa</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit on twitter" href="https://twitter.com/intent/tweet/?text=Disuguaglianze%20di%20Bell%3a%20un%20esperimento%20di%20meccanica%20quantistica%20con%20Qiskit&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f&amp;hashtags=Einstein%2cBell%2cQuantumMechanics%2cEntanglement"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f&amp;title=Disuguaglianze%20di%20Bell%3a%20un%20esperimento%20di%20meccanica%20quantistica%20con%20Qiskit&amp;summary=Disuguaglianze%20di%20Bell%3a%20un%20esperimento%20di%20meccanica%20quantistica%20con%20Qiskit&amp;source=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f&title=Disuguaglianze%20di%20Bell%3a%20un%20esperimento%20di%20meccanica%20quantistica%20con%20Qiskit"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit on whatsapp" href="https://api.whatsapp.com/send?text=Disuguaglianze%20di%20Bell%3a%20un%20esperimento%20di%20meccanica%20quantistica%20con%20Qiskit%20-%20https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit on telegram" href="https://telegram.me/share/url?text=Disuguaglianze%20di%20Bell%3a%20un%20esperimento%20di%20meccanica%20quantistica%20con%20Qiskit&amp;url=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Disuguaglianze di Bell: un esperimento di meccanica quantistica con Qiskit on ycombinator" href="https://news.ycombinator.com/submitlink?t=Disuguaglianze%20di%20Bell%3a%20un%20esperimento%20di%20meccanica%20quantistica%20con%20Qiskit&u=https%3a%2f%2fc-daniele.github.io%2fit%2fposts%2f2025-10-11-bells-inequalities%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://c-daniele.github.io/it/>Cdani's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copia";function s(){t.innerHTML="copiato!",setTimeout(()=>{t.innerHTML="copia"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>